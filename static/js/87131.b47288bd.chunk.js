"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[12245,27980,60664,78059,87131],{12245:(e,t,i)=>{i.r(t),i.d(t,{default:()=>w});var n=i(35143),s=i(95085),o=i(78059),r=i(60664),l=i(19276),a=i(3975),c=i(68134),u=i(46053),d=(i(81806),i(76460),i(47249),i(85842)),p=i(9624),h=i(42294),v=i(12482);const y=l.default.ofType(r.default);let g=class extends s.A{constructor(e){super(e),this.type="line-of-sight",this.observer=null,this.extent=null}initialize(){this.addHandles((0,c.watch)((()=>this._computeExtent()),(e=>{null==(null===e||void 0===e?void 0:e.pending)&&this._set("extent",null!=e?e.extent:null)}),c.syncAndInitial))}get targets(){return this._get("targets")||new y}set targets(e){this._set("targets",(0,a.V)(e,this.targets,y))}get spatialReference(){var e;return null!=(null===(e=this.observer)||void 0===e?void 0:e.position)?this.observer.position.spatialReference:null}get requiredPropertiesForEditing(){var e;return[null===(e=this.observer)||void 0===e?void 0:e.position]}async waitComputeExtent(){const e=this._computeExtent();return null!=e?e.pending:Promise.resolve()}_computeExtent(){var e;const t=this.spatialReference;if(null==(null===(e=this.observer)||void 0===e?void 0:e.position)||null==t)return null;const i=e=>"absolute-height"===(0,v.w7)(e.position,e.elevationInfo),n=this.observer.position,s=(0,h.fA)(n.x,n.y,n.z,n.x,n.y,n.z);for(const r of this.targets)if(null!=r.position){const e=(0,p.projectOrLoad)(r.position,t);if(null!=e.pending)return{pending:e.pending,extent:null};if(null!=e.geometry){const{x:t,y:i,z:n}=e.geometry;(0,h.iT)(s,[t,i,n])}}const o=(0,h.w1)(s,t);return i(this.observer)&&this.targets.every(i)||(o.zmin=void 0,o.zmax=void 0),{pending:null,extent:o}}clear(){this.observer=null,this.targets.removeAll()}};(0,n._)([(0,u.MZ)({type:["line-of-sight"]})],g.prototype,"type",void 0),(0,n._)([(0,u.MZ)({type:o.default,json:{read:!0,write:!0}})],g.prototype,"observer",void 0),(0,n._)([(0,u.MZ)({cast:a.H,type:y,nonNullable:!0,json:{read:!0,write:!0}})],g.prototype,"targets",null),(0,n._)([(0,u.MZ)({value:null,readOnly:!0})],g.prototype,"extent",void 0),(0,n._)([(0,u.MZ)({readOnly:!0})],g.prototype,"spatialReference",null),(0,n._)([(0,u.MZ)({readOnly:!0})],g.prototype,"requiredPropertiesForEditing",null),g=(0,n._)([(0,d.$)("esri.analysis.LineOfSightAnalysis")],g);const w=g},27980:(e,t,i)=>{i.r(t),i.d(t,{default:()=>u});var n=i(35143),s=i(39356),o=i(91967),r=i(46053),l=(i(81806),i(76460),i(47249),i(85842)),a=i(19247);let c=class extends o.default{constructor(e){super(e),this.location=null,this.intersectedLocation=null,this.intersectedGraphic=null,this.visible=void 0}};(0,n._)([(0,r.MZ)({type:a.default})],c.prototype,"location",void 0),(0,n._)([(0,r.MZ)({type:a.default})],c.prototype,"intersectedLocation",void 0),(0,n._)([(0,r.MZ)({type:s.default})],c.prototype,"intersectedGraphic",void 0),(0,n._)([(0,r.MZ)({type:Boolean})],c.prototype,"visible",void 0),c=(0,n._)([(0,l.$)("esri.widgets.LineOfSight.LineOfSightTarget")],c);const u=c},29078:(e,t,i)=>{i.d(t,{D:()=>g});var n=i(53986),s=i(35143),o=i(91967),r=i(98773),l=(i(81806),i(76460)),a=i(30726),c=i(50346),u=i(68134),d=i(46053),p=(i(47249),i(85842));const h=["analysis"];var v,y;(y=v||(v={}))[y.PENDING=0]="PENDING",y[y.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY",y[y.RUNNING=2]="RUNNING";let g=class extends o.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.view=null,this.analysisView=null,this._reconnectViewTask=null,this._forceInteractiveHandle=null,this._parentChangeFromReconnect=!1,this._startUserOperation=null;const t=null===e||void 0===e?void 0:e.analysis;null!=t?this.analysis=t:(this._set("analysis",this.constructAnalysis()),this._set("isAnalysisOwner",!0)),null!=(null===e||void 0===e?void 0:e.visible)&&(this.visible=e.visible)}normalizeCtorArgs(e){const{analysis:t}=e;return(0,n.A)(e,h)}initialize(){this.addHandles([(0,u.watch)((()=>({readyAndNotSupported:null!=this.view&&this.view.ready&&!this.supported})),(e=>{let{readyAndNotSupported:t}=e;t&&l.A.getLogger(this).errorOnce(this.unsupportedErrorMessage)}),u.syncAndInitial),(0,u.watch)((()=>{var e;return null===(e=this.analysis)||void 0===e?void 0:e.parent}),(e=>{this._parentChangeFromReconnect||e===this.view||this._set("isAnalysisOwner",!1);const t=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1,t&&this._scheduleViewReconnect()}),u.sync),(0,u.watch)((()=>({view:this.view,ready:null!=this.view&&this.view.ready,supported:this.supported})),((e,t)=>{let{view:i}=e;const n=null===t||void 0===t?void 0:t.view;i!==n&&(this._startUserOperation=(0,a.DC)(this._startUserOperation),this._disconnectFromView(n)),this._scheduleViewReconnect()}),u.syncAndInitial)])}destroy(){this._reconnectViewTask=(0,a.DC)(this._reconnectViewTask),this._startUserOperation=(0,a.DC)(this._startUserOperation),null!=this.analysisView&&(this.analysisView.visible=void 0),this._disconnectFromView(this.view),this._set("view",null),null!=this.analysis&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))}get supported(){return null==this.view||this.view.type===this.supportedViewType}set visible(e){this._set("visible",e),null!=this.analysisView&&(this.analysisView.visible=e)}get active(){return null!=this.tool&&this.tool.active}get disabled(){return null==this.view||!this.view.ready||!this.supported}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=(0,a.DC)(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get ready(){return null!=this.analysisView&&!this.connectingToView}get connectingToView(){return null!=this._reconnectViewTask}get isAnalysisOwner(){return this._get("isAnalysisOwner")}get tool(){return null!=this.analysisView?this.analysisView.tool:null}clear(){this._startUserOperation=(0,a.DC)(this._startUserOperation),this._resetInteractiveCreationState(),null!=this.tool&&null!=this.view&&this.view.activeTool===this.tool&&(this.view.activeTool=null)}async start(){if(!this.visible)return void l.A.getLogger(this).warn("Cannot start analysis when not visible");this.clear();const e={task:null,abort:null,state:v.PENDING},t=(0,r.UT)((async t=>{if(e.state=v.WAIT_FOR_VIEW_READY,await(0,u.whenOnce)((()=>this.ready),t),e.state=v.RUNNING,null==this.analysisView||null==this.view)return;const i=this.analysisView.tool;null!=i&&(this.view.activeTool=i,(0,u.when)((()=>i.created),(()=>{i.active&&null!=this.view&&(this.view.activeTool=null)}),{initial:!0,once:!0}))}));return e.task=t,e.abort=()=>t.abort(),this._startUserOperation=e,t.promise}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=(0,a.DC)(this._reconnectViewTask);const e=(0,r.UT)((async t=>{try{await this._reconnectView(t)}catch(i){if((0,c.throwIfAborted)(t),!(0,c.isAbortError)(i))return void l.A.getLogger(this).warn("Failed to use analysis in view model",i);throw i}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=null)}}));this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,i=null!=t&&t.ready&&this.supported,n=this.analysis;if(this._startUserOperation=w(this._startUserOperation),this._disconnectFromView(t),i&&null!=t&&null!=n){if(this.isAnalysisOwner){if(null!=n.parent)return void l.A.getLogger(this).errorOnce("expected owned analysis to have null parent when connecting to view");this._parentChangeFromReconnect=!0,t.analyses.add(n)}this.analysisView=await t.whenAnalysisView(n),(0,c.isAborted)(e)?this._startUserOperation=w(this._startUserOperation):(this.analysisView.visible=this.visible,this._forceInteractiveHandle=this.analysisView.forceInteractiveForViewModel(),this.addHandles(this._forceInteractiveHandle),this.onConnectToAnalysisView(this.analysisView))}}_disconnectFromView(e){null!=e&&this.isAnalysisOwner&&e.analyses.includes(this.analysis)&&(this._parentChangeFromReconnect=!0,this.analysis.clear(),e.analyses.remove(this.analysis)),this.onDisconnectFromAnalysisView(),this._forceInteractiveHandle=(0,a.xt)(this._forceInteractiveHandle),this.analysisView=null}_setExternalAnalysis(e){null==this.analysisView||this.isAnalysisOwner||(this.analysisView.visible=void 0,this._forceInteractiveHandle=(0,a.xt)(this._forceInteractiveHandle)),this.analysisView=null,this._set("isAnalysisOwner",!1),this._set("analysis",e),this._parentChangeFromReconnect=!1}_resetInteractiveCreationState(){this.analysis.clear(),null!=this.tool&&this.tool.resetCreated()}get testInfo(){}};function w(e){return null!=e&&e.state>=v.RUNNING?(e.abort(),null):e}(0,s._)([(0,d.MZ)()],g.prototype,"supported",null),(0,s._)([(0,d.MZ)()],g.prototype,"view",void 0),(0,s._)([(0,d.MZ)({type:Boolean,value:!0})],g.prototype,"visible",null),(0,s._)([(0,d.MZ)()],g.prototype,"active",null),(0,s._)([(0,d.MZ)()],g.prototype,"disabled",null),(0,s._)([(0,d.MZ)({nonNullable:!0})],g.prototype,"analysis",null),(0,s._)([(0,d.MZ)()],g.prototype,"analysisView",void 0),(0,s._)([(0,d.MZ)()],g.prototype,"ready",null),(0,s._)([(0,d.MZ)()],g.prototype,"connectingToView",null),(0,s._)([(0,d.MZ)({readOnly:!0})],g.prototype,"isAnalysisOwner",null),(0,s._)([(0,d.MZ)()],g.prototype,"_reconnectViewTask",void 0),(0,s._)([(0,d.MZ)()],g.prototype,"_forceInteractiveHandle",void 0),(0,s._)([(0,d.MZ)()],g.prototype,"tool",null),g=(0,s._)([(0,p.$)("esri.widgets.support.AnalysisViewModel")],g)},37546:(e,t,i)=>{i.d(t,{P:()=>v});var n=i(89379),s=i(50076),o=i(53514),r=i(24387),l=i(90534),a=i(49723),c=i(19258),u=i(49140),d=i(46053),p=i(73093),h=i(79453);function v(e){var t;const i=null!==(t=null===e||void 0===e?void 0:e.origins)&&void 0!==t?t:[void 0];return(t,s)=>{const o=function(e,t,i){var s;if("resource"===(null===e||void 0===e?void 0:e.type))return function(e,t,i){var s;const o=(0,c.z4)(t,i);return{type:String,read:(e,t,i)=>{const n=(0,h.r)(e,t,i);return o.type===String?n:"function"==typeof o.type?new o.type({url:n}):void 0},write:{isRequired:null===(s=o.json)||void 0===s||null===(s=s.write)||void 0===s?void 0:s.isRequired,writer(t,s,a,c){if(null===c||void 0===c||!c.resources)return"string"==typeof t?void(s[a]=(0,h.t)(t,c)):void(s[a]=t.write({},c));const d=function(e){return null==e?null:"string"==typeof e?e:e.url}(t),v=(0,h.t)(d,(0,n.A)((0,n.A)({},c),{},{verifyItemRelativeUrls:null!==c&&void 0!==c&&c.verifyItemRelativeUrls?{writtenUrls:c.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0}),h.M.NO),f=o.type!==String&&(!(0,r.H)(this)||(null===c||void 0===c?void 0:c.origin)&&this.originIdOf(i)>(0,u.aB)(c.origin)),_={object:this,propertyName:i,value:t,targetUrl:v,dest:s,targetPropertyName:a,context:c,params:e};null!==c&&void 0!==c&&c.portalItem&&v&&!(0,l.isAbsolute)(v)?f&&null!==e&&void 0!==e&&e.contentAddressed?y(_):f?function(e){var t;const{context:i,targetUrl:s,params:o,value:r,dest:a,targetPropertyName:c}=e;if(!i.portalItem)return;const u=i.portalItem.resourceFromPath(s),d=w(r,s,i),h=(0,p.n)(d),v=(0,l.getPathExtension)(u.path),f=null!==(t=null===o||void 0===o?void 0:o.compress)&&void 0!==t&&t;h===v?(i.resources&&g((0,n.A)((0,n.A)({},e),{},{resource:u,content:d,compress:f,updates:i.resources.toUpdate})),a[c]=s):y(e)}(_):function(e){let{context:t,targetUrl:i,dest:n,targetPropertyName:s}=e;t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(i),compress:!1}),n[s]=i)}(_):null!==c&&void 0!==c&&c.portalItem&&(null==v||null!=(0,h.i)(v)||(0,l.isBlobProtocol)(v)||f)?y(_):s[a]=v}}}}(e,t,i);switch(null!==(s=null===e||void 0===e?void 0:e.type)&&void 0!==s?s:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:e,write:t}=h.b;return{read:e,write:t}}}}(e,t,s);for(const e of i){const i=(0,d.rM)(t,e,s);for(const e in o)i[e]=o[e]}}}function y(e){var t,i,r,c;const{targetUrl:u,params:d,value:v,context:y,dest:f,targetPropertyName:_}=e;if(!y.portalItem)return;const m=(0,h.p)(u),b=w(v,u,y);if(null!==d&&void 0!==d&&d.contentAddressed&&"json"!==b.type)return void(null===(t=y.messages)||void 0===t||t.push(new s.default("persistable:contentAddressingUnsupported",'Property "'.concat(_,'" is trying to serializing a resource with content of type ').concat(b.type," with content addressing. Content addressing is only supported for json resources."),{content:b})));const A=null!==d&&void 0!==d&&d.contentAddressed&&"json"===b.type?(0,o.d)(b.jsonString):null!==(i=null===m||void 0===m?void 0:m.filename)&&void 0!==i?i:(0,a.lk)(),I=(0,l.join)(null!==(r=null===d||void 0===d?void 0:d.prefix)&&void 0!==r?r:null===m||void 0===m?void 0:m.prefix,A),T="".concat(I,".").concat((0,p.n)(b));if(null!==d&&void 0!==d&&d.contentAddressed&&y.resources&&"json"===b.type){var V;const e=null!==(V=y.resources.toKeep.find((e=>{let{resource:t}=e;return t.path===T})))&&void 0!==V?V:y.resources.toAdd.find((e=>{let{resource:t}=e;return t.path===T}));if(e)return void(f[_]=e.resource.itemRelativeUrl)}const M=y.portalItem.resourceFromPath(T);(0,l.isBlobProtocol)(u)&&y.resources&&y.resources.pendingOperations.push((0,l.blobUrlToBlob)(u).then((e=>{M.path="".concat(I,".").concat((0,p.n)({type:"blob",blob:e})),f[_]=M.itemRelativeUrl})).catch((()=>{})));const O=null!==(c=null===d||void 0===d?void 0:d.compress)&&void 0!==c&&c;y.resources&&g((0,n.A)((0,n.A)({},e),{},{resource:M,content:b,compress:O,updates:y.resources.toAdd})),f[_]=M.itemRelativeUrl}function g(e){let{object:t,propertyName:i,updates:n,resource:s,content:o,compress:r}=e;n.push({resource:s,content:o,compress:r,finish:e=>{!function(e,t,i){"string"==typeof e[t]?e[t]=i.url:e[t].url=i.url}(t,i,e)}})}function w(e,t,i){return"string"==typeof e?{type:"url",url:t}:{type:"json",jsonString:JSON.stringify(e.toJSON(i))}}},42251:(e,t,i)=>{i.d(t,{N1:()=>u,uY:()=>d,wY:()=>c,xH:()=>a});var n=i(20664),s=i(9392),o=i(95925),r=i(3112),l=i(30310);function a(e,t){return c(e)===c(t)}function c(e){if(null==e)return null;const t=null!=e.layer?e.layer.id:"";let i=null;return i=null!=e.objectId?e.objectId:null!=e.layer&&"objectIdField"in e.layer&&null!=e.layer.objectIdField&&null!=e.attributes?e.attributes[e.layer.objectIdField]:e.uid,null==i?null:"o-".concat(t,"-").concat(i)}const u={json:{write:{writer:function(e,t){var i;null!=(null===e||void 0===e||null===(i=e.layer)||void 0===i?void 0:i.objectIdField)&&null!=e.attributes&&(t.feature={layerId:e.layer.id,objectId:e.attributes[e.layer.objectIdField]})},target:{"feature.layerId":{type:[Number,String],isRequired:!0},"feature.objectId":{type:[Number,String],isRequired:!0}}},origins:{"web-scene":{read:function(e){if(null!=e.layerId&&null!=e.objectId)return{uid:null,layer:{id:e.layerId,objectIdField:"ObjectId"},attributes:{ObjectId:e.objectId}}}}}}};function d(e,t,i,a){var u,d;const{sceneIntersectionHelper:h}=e,{observer:g,observerFeatureId:w,targetFeatureId:f,target:_}=i;if(null==w&&null==f)return;a||(a=e=>e),(0,n.a)(y,g,_);const m=(0,n.l)(y);(0,n.b)(y,g,y,1/m);const b=(0,o.Cr)(y,_,v);t.options.store=r.oH.ALL,h.intersectToolIntersectorRay(b,t);let A=null,I=null,T=null,V=null;for(const n of t.results.all){const t=(0,l.Gy)(n,e);if(null==t||null==n.distanceInRenderSpace)continue;const i=c(t);null!=i&&(null!=w&&i===w&&(null!==A&&void 0!==A||(A=a(p(n,e,m))),n.distanceInRenderSpace-1<A&&(T=n)),null!=f&&i===f&&(null!==I&&void 0!==I||(I=a(p(n,e,m))),null==V&&n.distanceInRenderSpace-1<m&&m-n.distanceInRenderSpace+1<I&&(V=n)))}const{observerAdjusted:M,targetAdjusted:O}=i;null!==(u=T)&&void 0!==u&&u.getIntersectionPoint(M)?i.observerSurfaceNormal=T.getTransformedNormal((0,s.vt)()):i.observerSurfaceNormal=null,null!==(d=V)&&void 0!==d&&d.getIntersectionPoint(O)?i.targetSurfaceNormal=V.getTransformedNormal((0,s.vt)()):i.targetSurfaceNormal=null}function p(e,t,i){if((0,l.QS)(e)){const n=(0,l.SM)(e,t);if(null!=n)return Math.min(n*h,i)}return 1e-5*i}const h=.05,v=(0,o.vt)(),y=(0,s.vt)()},60664:(e,t,i)=>{i.r(t),i.d(t,{default:()=>v});var n=i(35143),s=i(42251),o=i(69098),r=i(42553),l=i(30726),a=i(46053),c=(i(81806),i(76460),i(47249),i(85842)),u=i(37546),d=i(19247),p=i(731);let h=class extends(r.A.JSONSupportMixin(o.A)){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return(0,l.CM)(this.position,e.position)&&(0,l.CM)(this.elevationInfo,e.elevationInfo)&&(0,s.xH)(this.feature,e.feature)}};(0,n._)([(0,a.MZ)({type:d.default,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),(0,u.P)()],h.prototype,"position",void 0),(0,n._)([(0,a.MZ)({type:p.A}),(0,u.P)()],h.prototype,"elevationInfo",void 0),(0,n._)([(0,a.MZ)(s.N1)],h.prototype,"feature",void 0),h=(0,n._)([(0,c.$)("esri.analysis.LineOfSightAnalysisTarget")],h);const v=h},73093:(e,t,i)=>{i.d(t,{n:()=>s});var n=i(90534);function s(e){return o[function(e){return"json"===e.type?"application/json":"blob"===e.type?e.blob.type:function(e){const t=(0,n.getPathExtension)(e);return a[t]||r}(e.url)}(e)]||l}const o={},r="text/plain",l=o[r],a={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const c in a)o[a[c]]=c},78059:(e,t,i)=>{i.r(t),i.d(t,{default:()=>y});var n=i(35143),s=i(42251),o=i(91967),r=i(69098),l=i(42553),a=i(30726),c=i(46053),u=(i(81806),i(76460),i(47249),i(85842)),d=i(37546),p=i(19247),h=i(731);let v=class extends(l.A.JSONSupportMixin(r.A.ClonableMixin(o.default))){constructor(e){super(e),this.position=null,this.elevationInfo=null,this.feature=null}equals(e){return(0,a.CM)(this.position,e.position)&&(0,a.CM)(this.elevationInfo,e.elevationInfo)&&(0,s.xH)(this.feature,e.feature)}};(0,n._)([(0,c.MZ)({type:p.default,json:{write:{isRequired:!0}}})],v.prototype,"position",void 0),(0,n._)([(0,c.MZ)({type:h.A}),(0,d.P)()],v.prototype,"elevationInfo",void 0),(0,n._)([(0,c.MZ)(s.N1)],v.prototype,"feature",void 0),v=(0,n._)([(0,u.$)("esri.analysis.LineOfSightAnalysisObserver")],v);const y=v},87131:(e,t,i)=>{i.r(t),i.d(t,{default:()=>_});var n=i(35143),s=i(12245),o=i(78059),r=i(60664),l=i(19276),a=i(3975),c=i(54901),u=(i(81806),i(68134)),d=i(46053),p=(i(76460),i(47249),i(85842)),h=i(19247),v=i(12482),y=i(27980),g=i(29078);const w=l.default.ofType(y.default);let f=class extends g.D{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="LineOfSightViewModel is only supported in 3D views.",this._vmTargetsToConnection=new Map,this._analysisTargetsToConnection=new Map}initialize(){this.addHandles([this.targets.on("after-add",(e=>this._onViewModelTargetAdded(e.item))),this.targets.on("after-remove",(e=>this._onViewModelTargetRemoved(e.item))),(0,u.watch)((()=>this.analysis),(e=>this._onAnalysisChange(e)),u.syncAndInitial)])}destroy(){this._analysisTargetsToConnection.forEach((e=>e.remove()))}get state(){return this.disabled||!this.ready?"disabled":null==this.tool?"ready":this.tool.state}get observer(){const{observer:e}=this.analysis;return null==(null===e||void 0===e?void 0:e.position)?null:this._convertAnalysisPointToAbsoluteHeight(e.position,e.elevationInfo)}set observer(e){let t=null;e&&(t=e.clone(),t.hasZ||(t.z=0)),this.analysis.observer=new o.default({position:t})}get targets(){return this._get("targets")||new w}set targets(e){this._set("targets",(0,a.V)(e,this.targets,w))}continue(){null!=this.tool&&this.tool.continue()}stop(){null!=this.tool&&this.tool.stop()}get testInfo(){}constructAnalysis(){return new s.default}async onConnectToAnalysisView(e){this.addHandles([e.on("result-changed",(e=>{const t=this._analysisTargetsToConnection.get(e.target);t&&(null!=e.result?(t.viewModelTarget.intersectedGraphic=e.result.intersectedGraphic,t.viewModelTarget.intersectedLocation=e.result.intersectedLocation,t.viewModelTarget.visible=e.result.visible):(t.viewModelTarget.intersectedGraphic=null,t.viewModelTarget.intersectedLocation=null,t.viewModelTarget.visible=void 0))}))],"view")}onDisconnectFromAnalysisView(){this.removeHandles("view")}_onViewModelTargetAdded(e){if(this._vmTargetsToConnection.get(e))return;const t=new r.default({position:e.location});this._connectViewModelWithAnalysisTarget(e,t),this.analysis.targets.add(t)}_onViewModelTargetRemoved(e){const t=this._vmTargetsToConnection.get(e);t&&(t.remove(),this.analysis.targets.remove(t.analysisTarget))}_onAnalysisTargetAdded(e){if(this._analysisTargetsToConnection.get(e))return;const{position:t}=e,i=new y.default({location:t?this._convertAnalysisPointToAbsoluteHeight(t,e.elevationInfo):null});this._connectViewModelWithAnalysisTarget(i,e),this.targets.add(i)}_onAnalysisTargetRemoved(e){const t=this._analysisTargetsToConnection.get(e);t&&(t.remove(),this.targets.remove(t.viewModelTarget))}_connectViewModelWithAnalysisTarget(e,t){let i=!1;const n=(0,c.vE)([(0,u.watch)((()=>({position:t.position,elevationInfo:t.elevationInfo})),(t=>{let{position:n,elevationInfo:s}=t;i||(i=!0,e.location=n?this._convertAnalysisPointToAbsoluteHeight(n,s):null,i=!1)}),u.sync),(0,u.watch)((()=>e.location),(e=>{if(!i){i=!0;let n=null;e&&(n=e.clone(),n.hasZ||(n.z=0)),t.position=n,t.elevationInfo=null,i=!1}}),u.sync)]),s={analysisTarget:t,viewModelTarget:e,remove:()=>{n.remove(),this._vmTargetsToConnection.delete(e),this._analysisTargetsToConnection.delete(t)}};this._vmTargetsToConnection.set(e,s),this._analysisTargetsToConnection.set(t,s)}_onAnalysisChange(e){const t="analysis";this.removeHandles(t),this.addHandles([this.analysis.targets.on("after-add",(e=>this._onAnalysisTargetAdded(e.item))),this.analysis.targets.on("after-remove",(e=>this._onAnalysisTargetRemoved(e.item)))],t),this.targets.removeAll(),e.targets.forEach((e=>{this._onAnalysisTargetAdded(e)}))}_convertAnalysisPointToAbsoluteHeight(e,t){const i=e.clone();if(null!=this.view){const n=(0,v.bK)(e.hasZ,t);i.z=(0,v.wS)(this.view,e,n,v.qt)}return i}};(0,n._)([(0,d.MZ)({type:s.default})],f.prototype,"analysis",void 0),(0,n._)([(0,d.MZ)({readOnly:!0})],f.prototype,"state",null),(0,n._)([(0,d.MZ)({type:h.default})],f.prototype,"observer",null),(0,n._)([(0,d.MZ)({type:w,cast:a.H,nonNullable:!0})],f.prototype,"targets",null),f=(0,n._)([(0,p.$)("esri.widgets.LineOfSight.LineOfSightViewModel")],f);const _=f}}]);
//# sourceMappingURL=87131.b47288bd.chunk.js.map