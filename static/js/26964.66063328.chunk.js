"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[26964],{4583:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var i=a(35143),d=a(91967),o=a(19276),n=a(67993),s=a(46053),l=(a(81806),a(76460),a(47249),a(85842)),r=a(99464),c=a(33377);let h=class extends((0,c.U)(d.default)){constructor(e){super(e),this.savedGraphics=new o.default,this.type="data-capture",this.pendingGraphics=new n.A}get collectionId(){return this.viewModel.collectionId}handleCreate(e){var t,a,i;const{state:d,graphic:n,tool:s}=e,l=null===n||void 0===n?void 0:n.geometry;if("complete"!==d||!n||!l)return;const{collectionId:c,viewModel:{dataCaptureLayer:h,currentBestFeature:p,imageGeometryField:u,oiObjectIdField:v,activeViewer:y,mode:w},pendingGraphics:g}=this,M=null===y||void 0===y?void 0:y.imageSize;p&&u&&c&&v&&h&&M&&"none"!==w&&(function(e,t,a,i,d,n,s,l,c,h){var p;e.sourceLayer=h,e.attributes=null!==(p=e.attributes)&&void 0!==p?p:{},e.attributes[a]=btoa(JSON.stringify({geometry:(0,r.zT)(t.clone(),c,l).toJSON()})),e.attributes[i]=d.attributes.objectId,n.has(s)||n.set(s,new o.default),n.get(s).add(e)}(n,l,u,v,p,g,c,M,w,h),this.viewModel.emit("after-data-capture-complete",{pendingGraphics:null!==(t=null===(a=g.get(c))||void 0===a?void 0:a.toArray())&&void 0!==t?t:null}),null===(i=this.viewModel.sketch)||void 0===i||i.create(s))}handleDelete(e){var t;const{dataCaptureLayer:a}=this.viewModel;if(!a)return;const{graphics:i}=e;null!==(t=this.pendingGraphics.get(a.id))&&void 0!==t&&t.removeMany(i),this.savedGraphics.removeMany(i),this.viewModel.deleteDataCaptureFeatures(function(e,t){return e.map((e=>{let{attributes:a}=e;return t?a[t]:null})).filter(Boolean)}(i,a.objectIdField))}handleDestroy(){const{dataCaptureLayer:e}=this.viewModel;e&&(this.viewModel.stopDataCapture(),this.savedGraphics.removeAll(),this.pendingGraphics=null)}handleUpdate(e){var t;const{toolEventInfo:a,state:i,graphics:d}=e;if(a)null===(t=this.viewModel.sketch)||void 0===t||t.undo();else switch(i){case"complete":this.viewModel.emit("deselect-data-capture-features",{graphics:d});break;case"start":this.viewModel.emit("select-data-capture-features",{graphics:d})}}};(0,i._)([(0,s.MZ)()],h.prototype,"collectionId",null),(0,i._)([(0,s.MZ)()],h.prototype,"savedGraphics",void 0),(0,i._)([(0,s.MZ)()],h.prototype,"type",void 0),(0,i._)([(0,s.MZ)()],h.prototype,"pendingGraphics",void 0),h=(0,i._)([(0,l.$)("esri.widgets.OrientedImageryViewer.adapters.sketch.DataCaptureAdapter")],h);const p=h},33377:(e,t,a)=>{a.d(t,{U:()=>l});var i=a(35143),d=a(68134),o=a(46053),n=(a(81806),a(76460),a(47249),a(85842));const s="sketch-handles",l=e=>{let t=class extends e{initialize(){this.addHandles((0,d.watch)((()=>{var e;return null===(e=this.viewModel)||void 0===e?void 0:e.sketch}),(e=>{this.removeHandles(s),e&&this.addHandles([e.on("create",(e=>this.handleCreate(e))),e.on("update",(e=>this.handleUpdate(e))),e.on("undo",(e=>this.handleUndo(e))),e.on("redo",(e=>this.handleRedo(e))),e.on("delete",(e=>this.handleDelete(e))),e.on("destroy",(()=>this.handleDestroy())),e.on("duplicate",(e=>this.handleDuplicate(e))),(0,d.watch)((()=>e.activeComponent),(e=>{"draw-2d"!==(null===e||void 0===e?void 0:e.type)&&"draw-3d"!==(null===e||void 0===e?void 0:e.type)||(e.elevationLockOnVertexAddDisabled=!0)}),d.syncAndInitial)],s)}),d.syncAndInitial))}handleCreate(e){}handleUpdate(e){}handleUndo(e){}handleRedo(e){}handleDelete(e){}handleDestroy(){}handleDuplicate(e){}};return(0,i._)([(0,o.MZ)()],t.prototype,"type",void 0),(0,i._)([(0,o.MZ)()],t.prototype,"viewModel",void 0),t=(0,i._)([(0,n.$)("esri.widgets.OrientedImageryViewer.mixins.SketchHandlerMixin")],t),t}}}]);
//# sourceMappingURL=26964.66063328.chunk.js.map