"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[17782,31299,53680,91505,95401],{770:(e,n,t)=>{t.d(n,{bG:()=>l,Ty:()=>o,YJ:()=>u,Fq:()=>d,vt:()=>s});var i=t(53084),a=t(42633);class r{constructor(e){const{name:n,label:t,description:i,schemes:r}=e;this.name=n,this.label=t,this.description=i,this.schemes=r;const l=e.basemapGroups||a.Np;let s=[];Object.keys(l).forEach((e=>{s=s.concat(l[e])})),this.supportedBasemaps=s,this.basemapGroups=l}isBasemapSupported(e){const n=(0,a.T1)(e,this.supportedBasemaps);return!(!n||!this.supportedBasemaps.includes(n))}getRawSchemes(e){const{basemapId:n,basemapTheme:t}=function(e,n,t){let i=null,r=null;if(n&&(i=(0,a.T1)(n,e,!1),i)){const e=(0,a.BV)(i);null!=e&&(r=e)}return!i&&t&&(i="dark"===t?"dark-gray":"gray",r=t),i||r||(i="gray",r="light"),{basemapId:i,basemapTheme:r}}(this.supportedBasemaps,e.basemap,e.basemapTheme);let r=t;if(n){const e=(0,a.BV)(n,this.basemapGroups);null!=e&&(r=e)}let l=e.geometryType;"multipoint"===l?l="point":"mesh"===l&&(l="polygon");const s=this.schemes[l]||this.schemes.default;return{schemesInfo:(0,i.clone)(s[r]),basemapId:n,basemapTheme:t}}}function l(e){const n=e.themeDictionary,t=new Map;for(const i in n){const e=n[i];t.set(i,new r(e))}return t}function s(e,n){const t=[];return e.forEach((e=>{e.isBasemapSupported(n)&&t.push({name:e.name,label:e.label,description:e.description,basemaps:[...e.supportedBasemaps]})})),t}function o(e,n){if(!e)return;if(!n)return;let t=null;const i=[n.primaryScheme,...n.secondarySchemes];for(const r of i){var a;if((null===(a=r.name)||void 0===a?void 0:a.toLowerCase())===e.toLowerCase()){t=r;break}}return t}function u(e,n,t){if(!e&&!n)return[];if(!t)return[];const i=!(null!==e&&void 0!==e&&e.length),a=!(null!==n&&void 0!==n&&n.length),r=[t.primaryScheme,...t.secondarySchemes],l=[];for(const s of r){const t=!!i||e.some((e=>s.tags.includes(e))),r=!a&&n.some((e=>s.tags.includes(e)));t&&!r&&l.push(s)}return l}function d(e){const n=e.theme;if(n)return n.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme})}},17782:(e,n,t)=>{t.r(n),t.d(n,{createRenderer:()=>D,regenerateRenderer:()=>O});var i=t(89379),a=t(59784),r=t(50076),l=t(68002),s=t(47662),o=t(9922),u=t(33766);function d(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,t=Math.round(e);if(t<=1)return 1;const i=t.toString().length;for(let a=i-1>=3?3:i-1;a>=0;a--){const i=10**a,r=Math.floor(e/i)*i,l=Math.ceil(e/i)*i,s=Math.round((r+l)/2),o=Math.abs(e-r)/e*100,u=Math.abs(e-l)/e*100,d=Math.abs(e-s)/e*100,c=Math.min(o,u,d);if(c<=n){if(c===o){t=r;break}if(c===u){t=l;break}if(c===d){t=s;break}}}return t}var c=t(53680),m=t(51006),p=t(16525),f=t(53986),v=t(28383),y=t(90494),h=t(42633),b=t(11563);const g=["layer"],w=["layerAdapter"];async function S(e){const n=await async function(e){if(!(e&&e.layer&&e.attributes))throw new r.default("summary-statistics-for-attributes:missing-parameters","'layer' and 'attributes' parameters are required");if(e.attributes.some((e=>!!e.valueExpression))&&!e.view)throw new r.default("summary-statistics-for-attributes:missing-parameters","View is required when 'valueExpression' is specified in attributes");e.forBinning&&(0,y.p)(e,"summary-statistics-for-attributes");const{layer:n}=e,t=(0,f.A)(e,g),a=[b.mb.CSVLayer,b.mb.FeatureLayer,b.mb.OGCFeatureLayer,b.mb.GeoJSONLayer,b.mb.KnowledgeGraphSublayer,b.mb.ParquetLayer,b.mb.WFSLayer],l=e.forBinning?b.Mi:a,s=(0,b.Jg)(n,l,e.forBinning);if(!s)throw new r.default("summary-statistics-for-attributes:invalid-parameters","'layer' must be one of these types: "+(0,b.Ho)(l).join(", "));const o=(0,i.A)({layerAdapter:s},t);o.includeZeros=null==o.includeZeros||o.includeZeros,o.includeNegatives=null==o.includeNegatives||o.includeNegatives;const u=o.view,d=null!=o.signal?{signal:o.signal}:null;await Promise.all([null===u||void 0===u?void 0:u.when(),s.load(d)]);const c=[];for(const i of o.attributes){const e=await(0,h.EG)({field:i.field,valueExpression:i.valueExpression});Array.prototype.push.apply(c,e)}const m=(0,v.MH)(s,c,"summary-statistics-for-attributes:invalid-parameters");if(m)throw m;return o}(e),{layerAdapter:t}=n,a=(0,f.A)(n,w),l=(0,v.D9)(a.attributes,a.includeZeros,a.includeNegatives);return t.summaryStatistics({valueExpression:l.valueExpression,sqlExpression:l.sqlExpression,sqlWhere:l.sqlWhere,view:a.view,filter:a.filter,outStatisticTypes:h.XR,signal:a.signal})}var x=t(98976);function V(e,n,t){return null!=e&&isFinite(e)&&(null===n||void 0===n||n||0!==e)&&(null===t||void 0===t||t||e>=0)}async function E(e){var n;const{features:t,attributes:i,includeZeros:a,includeNegatives:r,view:l}=e;let s=0,o=0,u=1/0,d=-1/0,c=null;const m=new Map;for(let v=0;v<i.length;v++){const{valueExpression:e}=i[v];if(e){if(!c){const{arcadeUtils:e}=await(0,x.lw)();c=e}m.set(v,c.createFunction(e))}}const p=l?null===(n=c)||void 0===n?void 0:n.getViewInfo({viewingMode:"2d"===l.type?"map":l.viewingMode,scale:l.scale,spatialReference:l.spatialReference}):null;for(const v of t){const e=v.geometry,n=v.attributes;if(e){const t=e.extent;if(t){const e=t.width*t.height;if(e>0){var f;let t=0;const y=null===(f=c)||void 0===f?void 0:f.createExecContext(v,p,null===l||void 0===l?void 0:l.timeZone);for(let e=0;e<i.length;e++){const{field:l,valueExpression:s}=i[e];let o=null;if(l)o=n[l];else if(s){const n=m.get(e);o=c.executeFunction(n,y)}V(o,a,r)&&(t+=o||0)}if(V(t,a,r)){const n=t/e;++s,o+=n,n<u&&(u=n),n>d&&(d=n)}}}}}return{minDensity:u!==1/0?u:null,maxDensity:d!==-1/0?d:null,avgDensity:s?o/s:null}}var z=t(91505);const T=500;async function I(e){var n,t,a;const l=e.view;if(!(null!==e&&void 0!==e&&e.layer&&l&&null!==(n=e.attributes)&&void 0!==n&&n.length))throw new r.default("dot-density-renderer:missing-parameters","'layer', 'view' and 'attributes' parameters are required");if(e.attributes.length>8)throw new r.default("dot-density-renderer:invalid-parameters","Dot density renderer does not support more than 8 attributes");e.forBinning&&(0,y.p)(e,"dot-density-renderer");const s=(0,i.A)((0,i.A)({},e),{},{view:l,layer:e.layer,attributes:e.attributes}),o=[b.mb.FeatureLayer,b.mb.ParquetLayer,b.mb.KnowledgeGraphSublayer,b.mb.OGCFeatureLayer,b.mb.GeoJSONLayer,b.mb.WFSLayer],u=e.forBinning?b.Mi:o,d=(0,b.Jg)(s.layer,u,e.forBinning);if(!d)throw new r.default("dot-density-renderer:invalid-parameters","'layer' must be one of these types: "+(0,b.Ho)(u).join(", "));null!==(t=s.dotBlendingEnabled)&&void 0!==t||(s.dotBlendingEnabled=!0),null!==(a=s.dotValueOptimizationEnabled)&&void 0!==a||(s.dotValueOptimizationEnabled=!0);const c=null!=s.signal?{signal:s.signal}:null;if(await Promise.all([l.when(),d.load(c)]),"polygon"!==d.geometryType)throw new r.default("dot-density-renderer:not-supported","Dot density renderer is supported for polygon layers only");const p=[],f=s.attributes;for(const i of f){const e=await(0,h.EG)({field:i.field,valueExpression:i.valueExpression});p.push(...e)}const v=(0,m.MH)(d,p.filter(Boolean),"dot-density-renderer:invalid-parameters");if(v)throw v;return(0,i.A)((0,i.A)({},s),{},{layer:d})}function B(e){return{dotValue:1,referenceScale:e.scale,minSliderValue:1,maxSliderValue:100}}async function A(e){const{view:n,layer:t,attributes:i,signal:a,filter:r}=e,s=await t.getSampleFeatures({view:n,sampleSize:T,returnGeometry:!0,filter:r,signal:a},"json"),[o,u]=await Promise.all([(0,p.A)({features:s,geometryType:t.geometryType}),S({layer:t,attributes:i,filter:r,includeZeros:!1,includeNegatives:!1,view:n,signal:a})]),c=null!=o&&"avgSize"in o&&o.avgSize,m=u.avg;if(!c||!m)return B(n);const f=(0,l.i1)(n.scale,n.spatialReference);return{dotValue:d(m/(c*c/(f*f)*.1))||1,referenceScale:n.scale,minSliderValue:1,maxSliderValue:d(m)}}async function k(e){const{view:n,layer:t,attributes:i,signal:a,filter:r}=e,s=[];for(const l of i){const e=await(0,h.EG)({field:l.field,valueExpression:l.valueExpression});s.push(...e)}const o=await t.getSampleFeatures({view:n,sampleSize:T,requiredFields:s,filter:r,returnGeometry:!0,signal:a},"json"),{minDensity:u,maxDensity:c,avgDensity:m}=await E({features:o,attributes:i,includeZeros:!1,includeNegatives:!1,view:n});if(!m||!u||!c)return B(n);const p=(0,l.i1)(n.scale,n.spatialReference),f=p*p,v=d(u*f),y=d(c*f);let b=d(m*f*10)||1;return b>y&&(b=y),{dotValue:b,referenceScale:n.scale,minSliderValue:v,maxSliderValue:y}}async function D(e){const n=await I(e),t=n.layer,i=t.geometryType,l=await async function(e){let n=e.dotDensityScheme,t=null,i=null;const a=await(0,m.Ib)(e.basemap,e.view);if(t=null!=a.basemapId?a.basemapId:null,i=null!=a.basemapTheme?a.basemapTheme:null,n)return{scheme:(0,z.cloneScheme)(n),basemapId:t,basemapTheme:i};const r=(0,z.getSchemes)({numColors:e.attributes.length,basemapTheme:i});return r&&(n=r.primaryScheme,t=r.basemapId,i=r.basemapTheme),{scheme:n,basemapId:t,basemapTheme:i}}(n),d=null===l||void 0===l?void 0:l.scheme;if(!d)throw new r.default("dot-density-renderer:insufficient-info","Unable to find dot-density scheme");const c=n.view,p=n.filter,f={layer:t,view:c,filter:p,attributes:n.attributes,signal:n.signal},v={layer:n.layer,view:c,filter:p,signal:n.signal},[y,h]=await Promise.all([n.trueDensity?k(f):A(f),n.outlineOptimizationEnabled?(0,u.A)(v).catch(m.ou):null]),{dotValue:b,referenceScale:g,minSliderValue:w,maxSliderValue:S}=y,x=(0,a.Iy)(d.colors,n.attributes.length),V=n.attributes.map(((e,n)=>({field:e.field,valueExpression:e.valueExpression,label:e.label,valueExpressionTitle:e.valueExpressionTitle,color:x[n]}))),E=new s.default({attributes:V,dotBlendingEnabled:n.dotBlendingEnabled,outline:h?(0,m.qc)(d,i,h.opacity):null,dotValue:b,referenceScale:n.dotValueOptimizationEnabled?g:null,legendOptions:n.legendOptions});return null!==h&&void 0!==h&&h.visualVariables.length&&(E.visualVariables=h.visualVariables.map((e=>e.clone()))),E.authoringInfo=new o.default({type:"dot-density",minSliderValue:w,maxSliderValue:S}),{renderer:E,dotDensityScheme:d,basemapId:l.basemapId,basemapTheme:l.basemapTheme}}async function O(e){const{creatorParameters:n,renderer:t}=await async function(e){const n="regenerate-dot-density-renderer";await(0,c.AC)(e,n);const t=await(0,c.mE)(e);if("dot-density"!==(0,c.UJ)(t))throw new r.default("".concat(n,":invalid-parameters"),"Renderer is invalid");const{layer:a,forBinning:l,filter:s,view:o,signal:u}=e,d=(0,c.DW)(t),m=t.attributes.map((e=>({field:e.field,valueExpression:e.valueExpression,label:e.label,valueExpressionTitle:e.valueExpressionTitle}))),p=await I({layer:a,attributes:m,dotValueOptimizationEnabled:null!=t.referenceScale,outlineOptimizationEnabled:d,forBinning:l,filter:s,view:o,signal:u});return(0,i.A)((0,i.A)({},e),{},{creatorParameters:p,renderer:t})}(e),{layer:a,attributes:l,outlineOptimizationEnabled:s,view:o,signal:d,filter:p}=n,f={layer:a,view:o,filter:p,attributes:l,signal:d},[v,y]=await Promise.all([n.trueDensity?k(f):A(f),s?(0,u.A)({layer:a,view:o,signal:d,filter:p}).catch(m.ou):null]),{dotValue:h,referenceScale:b,minSliderValue:g,maxSliderValue:w}=v;return t.dotValue=h,t.referenceScale=n.dotValueOptimizationEnabled?b:null,t.authoringInfo&&(t.authoringInfo.minSliderValue=g,t.authoringInfo.maxSliderValue=w),(0,c.ke)(t,null===y||void 0===y?void 0:y.visualVariables,c._i),{renderer:t}}},53680:(e,n,t)=>{t.d(n,{AC:()=>a,DW:()=>o,Hj:()=>S,Ih:()=>v,Jy:()=>c,OW:()=>h,Rv:()=>u,UJ:()=>s,_i:()=>d,d8:()=>p,fs:()=>m,kc:()=>f,ke:()=>w,mE:()=>r,wx:()=>l});var i=t(50076);async function a(e,n){const{layer:t,view:a,forBinning:r,filter:l}=e;if(!t||!a)throw new i.default("".concat(n,":missing-parameters"),"'layer' and 'view' parameters are required");await t.load();const s="featureReduction"in t?t.featureReduction:null;if(r){if("binning"!==(null===s||void 0===s?void 0:s.type))throw new i.default("".concat(n,":invalid-parameters"),"'layer' must have 'featureReduction' property defined with 'binning' type when 'forBinning' parameter is true");if(l)throw new i.default("".concat(n,":invalid-parameters"),"'filter' parameter is not supported when 'forBinning' parameter is true")}return e}async function r(e){var n,t,a;const{layer:r,forBinning:l,renderer:s}=e;await r.load();const o="featureReduction"in r?r.featureReduction:null,u=null!==(n=null===s||void 0===s?void 0:s.clone())&&void 0!==n?n:l&&"binning"===(null===o||void 0===o?void 0:o.type)?null===o||void 0===o||null===(t=o.renderer)||void 0===t?void 0:t.clone():"renderer"in r?null===(a=r.renderer)||void 0===a?void 0:a.clone():null;if(!u)throw new i.default("get-renderer-to-update:invalid-parameters","renderer not available");return u}function l(e,n,t){var i;const a=null===e||void 0===e||null===(i=e.authoringInfo)||void 0===i?void 0:i.visualVariables;return null===a||void 0===a?void 0:a.find((e=>"reference-size"===t?e.type===n&&"reference-size"===e.theme:e.type===n))}function s(e){if(!e)return null;const n=e.type,t="visualVariables"in e?e.visualVariables:null,i=null===t||void 0===t?void 0:t.find(v),a=null===t||void 0===t?void 0:t.find(h),r=e.authoringInfo,s=l(e,"color"),o=l(e,"size"),u=l(e,"size","reference-size");if("class-breaks"===n){if("univariate-color-size"===(null===r||void 0===r?void 0:r.type))return"univariate-color-size";if(i)return a?null!==o&&void 0!==o&&o.units?"color-size-age":null!==s&&void 0!==s&&s.units?"color-age-size":"color-size":null!==s&&void 0!==s&&s.units?"color-age":u?"color-size":"color-continuous";if(a)return null!==o&&void 0!==o&&o.units?"size-age":"size-continuous";if(e.classBreakInfos.length>1)return"class-breaks-color"===(null===r||void 0===r?void 0:r.type)?"color-class-breaks":"class-breaks-size"===(null===r||void 0===r?void 0:r.type)?"size-class-breaks":null;if(u)return"size-continuous"}return"unique-value"===n?e.valueExpression?"predominance"===(null===r||void 0===r?void 0:r.type)?"predominance":"relationship"===(null===r||void 0===r?void 0:r.type)?a||u?"relationship-size":"relationship":a||u?"type-size":"type":a?null!==o&&void 0!==o&&o.units?"type-size-age":"type-size":u?"type-size":"type":"pie-chart"===n?"pie-chart":"dot-density"===n?"dot-density":null}function o(e){var n;return!(null===(n=e.visualVariables)||void 0===n||!n.some(b))}function u(e){var n;return!(null===(n=e.visualVariables)||void 0===n||!n.some(g))}function d(e){var n;return null!==(n=null===e||void 0===e?void 0:e.findIndex(b))&&void 0!==n?n:-1}function c(e){var n;return null!==(n=null===e||void 0===e?void 0:e.findIndex(h))&&void 0!==n?n:-1}function m(e){var n;return null!==(n=null===e||void 0===e?void 0:e.findIndex(v))&&void 0!==n?n:-1}function p(e){var n;return null!==(n=null===e||void 0===e?void 0:e.findIndex(y))&&void 0!==n?n:-1}function f(e){var n;return null!==(n=null===e||void 0===e?void 0:e.findIndex(g))&&void 0!==n?n:-1}function v(e){return"color"===e.type}function y(e){return"opacity"===e.type}function h(e){return"size"===e.type&&"outline"!==e.target&&"$view.scale"!==e.valueExpression}function b(e){return"size"===e.type&&"outline"===e.target}function g(e){return"size"===e.type&&"$view.scale"===e.valueExpression&&"outline"!==e.target&&Array.isArray(e.stops)}function w(e,n,t){const i=e.visualVariables,a=t(i);if(!n||Array.isArray(n)&&!n.length)return;Array.isArray(n)||(n=[n]);const r=n.map((e=>e.clone()));i?a>-1?i.splice(a,1,...r):i.push(...r):e.visualVariables=r}function S(e,n,t){var i;const a=null===n||void 0===n?void 0:n.visualVariables.find((e=>e.type===t)),r=l(e,t);r&&a&&(r.minSliderValue=a.minSliderValue,r.maxSliderValue=a.maxSliderValue,"size"===t&&"reference-size"===r.theme&&(r.sizeStops=null===(i=a.sizeStops)||void 0===i?void 0:i.map((e=>e.clone())),r.referenceSizeScale=a.referenceSizeScale))}},91505:(e,n,t)=>{t.r(n),t.d(n,{cloneScheme:()=>y,getSchemeByName:()=>f,getSchemes:()=>p,getSchemesByTag:()=>v,getThemes:()=>m});var i=t(89379),a=t(69539),r=t(18690),l=t(59784),s=t(89132),o=t(770);const u={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"}},d=["vibrant-rainbow","cat-dark","predominant-v2","predominant-v1","predominance-race","desert-blooms","tropical-bliss","under-the-sea","ocean-bay","cat-light","predominant-v4","predominance-money","predominant-v3","predominance-race-ethnic","pastel-chalk","predominance-rainbow","predominance-sequence","cat-popup-olympic-sunset"],c=(0,o.bG)({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for visualizing features using the density of randomly placed dots.",schemes:{default:{light:{primary:"predominant-v5",secondary:d,common:{outline:u.light,fillOpacity:.8}},dark:{primary:"predominant-v5",secondary:d,common:{outline:u.dark,fillOpacity:.8}}}}}}});function m(e){return(0,o.vt)(c,e)}function p(e){const n=(0,o.Fq)({basemap:e.basemap,basemapTheme:e.basemapTheme,theme:c.get("default")});if(!n)return;const{schemesInfo:t,basemapId:i,basemapTheme:a}=n,l=t.common,s=e.numColors;return{primaryScheme:h(t.primary,l,s),secondarySchemes:t.secondary.map((e=>h(e,l,s))).filter(r.Ru),basemapId:i,basemapTheme:a}}function f(e){return(0,o.Ty)(e.name,p(e))}function v(e){return(0,o.YJ)(e.includedTags,e.excludedTags,p(e))}function y(e){if(!e)return;const n=(0,i.A)({},e);return n.tags=[...n.tags],n.colors&&(n.colors=n.colors.map((e=>new a.default(e)))),n.outline&&(n.outline={color:n.outline.color&&new a.default(n.outline.color),width:n.outline.width}),n}function h(e,n,t){const i=s.A[e];if(i)return function(e){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new a.default(e))),outline:{color:new a.default(e.outline.color),width:e.outline.width},opacity:e.opacity}}({name:i.name,tags:i.tags,colors:i[t]||(0,l.Iy)(i.stops,t),opacity:n.fillOpacity,outline:n.outline})}}}]);
//# sourceMappingURL=17782.df844edb.chunk.js.map