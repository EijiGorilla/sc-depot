"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[63720],{63720:(e,n,t)=>{t.r(n),t.d(n,{getTemplates:()=>R});var r=t(50076),i=t(73204),a=t(63860),o=t(97336);async function s(e){const{layer:n,renderer:t}=e;await n.load();const i=null!==t&&void 0!==t?t:"renderer"in n?n.renderer:void 0;if("class-breaks"!==(null===i||void 0===i?void 0:i.type))throw new r.default("class-breaks-popup:invalid-parameters","renderer.type must be 'class-breaks'");return{layer:n,renderer:i}}async function l(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"divide";const{fieldInfos:r,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n,normFieldExpressionTemplate:t});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:r,expressionInfos:a}),fieldInfos:r,expressionInfos:a})}var d=t(81779),f=t(40585),p=t(76106);async function u(e){const{layer:n,renderer:t}=e;await n.load();const i=null!==t&&void 0!==t?t:"renderer"in n?n.renderer:void 0;if("dot-density"!==(null===i||void 0===i?void 0:i.type))throw new r.default("dot-density-popup:invalid-parameters","renderer.type must be 'dot-density'");return{layer:n,renderer:i}}async function c(e,n){const{fieldInfos:t,expressionInfos:r}=await(0,o.Xj)({renderer:e,layer:n});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:t,expressionInfos:r}),expressionInfos:r,fieldInfos:t})}async function m(e,n,t){const{fieldInfos:r,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n}),s=r.filter((e=>{var n;return!(null!==(n=e.fieldName)&&void 0!==n&&n.includes(o.bF))})),l={fieldInfo:new f.default({fieldName:"expression/dot-density-categories-list"}),expressionInfo:new d.default({name:"dot-density-categories-list",title:t.listOfCategories,expression:(0,p.getArcadeForOrderedFields)(s,a)})},u=new i.default({expressionInfos:[l.expressionInfo],fieldInfos:[l.fieldInfo],title:t.competingFields,content:"{".concat(l.fieldInfo.fieldName,"}")});return{name:"dot-density-categories-list",title:t.orderedListOfValues,value:u}}async function y(e,n,t){const{fieldInfos:r,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n}),s=r.filter((e=>{var n;return!(null!==(n=e.fieldName)&&void 0!==n&&n.includes(o.bF))})),l={fieldInfo:new f.default({fieldName:"expression/dot-density-category"}),expressionInfo:new d.default({name:"dot-density-category",title:t.predominantCategory,expression:(0,p.getArcadeForPredominantCategoryAlias)(s,a)})},u=new i.default({expressionInfos:[l.expressionInfo,...a],fieldInfos:[l.fieldInfo,...r],content:[{type:"text",text:'<div><b><font size="3">{'.concat(l.fieldInfo.fieldName,"}</font></b></div>")},{type:"media",mediaInfos:{type:"pie-chart",title:t.competingFields,value:{fields:r.map((e=>e.fieldName))}}}]});return{name:"dot-density-category-chart",title:t.predominantCategoryWithChart,value:u}}async function I(e){const[{renderer:n,layer:t},r]=await Promise.all([u(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]);return{primaryTemplate:{name:"dot-density",title:r.dotDensity,value:await c(n,t)},secondaryTemplates:[await m(n,t,r),await y(n,t,r)]}}async function g(e){const{layer:n,renderer:t}=e;await n.load();const i=null!==t&&void 0!==t?t:"renderer"in n?n.renderer:void 0;if("heatmap"!==(null===i||void 0===i?void 0:i.type))throw new r.default("heatmap-popup:invalid-parameters","renderer.type must be 'heatmap'");return{layer:n,renderer:i}}var v=t(39348),x=t(17542);function w(e,n){var t,r;return null!==(t=null===(r=e.legendOptions)||void 0===r?void 0:r.title)&&void 0!==t?t:n.competingFields}function b(e,n){return{fieldInfo:new f.default({fieldName:"expression/predominant-category"}),expressionInfo:new d.default({name:"predominant-category",title:n.predominantCategory,expression:(0,p.getArcadeForPredominantCategoryAlias)(e)})}}function h(e,n){const t=(0,p.fieldNamesFromFieldInfos)(e);return{fieldInfo:new f.default({fieldName:"expression/predominant-value",format:new x.default({digitSeparator:!0,places:1})}),expressionInfo:new d.default({name:"predominant-value",title:n.predominantCategoryValue,expression:(0,p.getArcadeForPredominantCategoryValue)(t),returnType:"number"})}}function F(e,n){const t=(0,p.fieldNamesFromFieldInfos)(e);return{fieldInfo:new f.default({fieldName:"expression/predominant-strength",format:new x.default({digitSeparator:!0,places:0})}),expressionInfo:new d.default({name:"predominant-strength",title:n.strengthOfPredominance,expression:(0,p.getArcadeForStrengthOfPredominance)(t),returnType:"number"})}}function N(e,n){const t=b(e.fieldInfos,n),r=new i.default({expressionInfos:[t.expressionInfo],fieldInfos:[t.fieldInfo],content:(0,v.V)(n.predominantCategoryContent,{expression:"<b>{".concat(t.fieldInfo.fieldName,"}</b>")})});return{name:"predominant-category",title:n.predominantCategory,value:r}}function T(e,n){const{fieldInfos:t}=e,r=b(t,n),a=h(t,n),o=new i.default({expressionInfos:[a.expressionInfo,r.expressionInfo],fieldInfos:[a.fieldInfo,r.fieldInfo],content:(0,v.V)(n.predominantCategoryValueContent,{expression1:"<b>{".concat(r.fieldInfo.fieldName,"}</b>"),expression2:"<b>{".concat(a.fieldInfo.fieldName,"}</b>")})});return{name:"predominant-category-value",title:n.predominantCategoryValue,value:o}}function C(e,n){const{fieldInfos:t}=e,r=b(t,n),a=h(t,n),o=function(e,n){const t=(0,p.fieldNamesFromFieldInfos)(e);return{fieldInfo:new f.default({fieldName:"expression/predominant-margin",format:new x.default({digitSeparator:!0,places:0})}),expressionInfo:new d.default({name:"predominant-margin",title:n.marginOfVictory,expression:(0,p.getArcadeForPredominanceMargin)(t),returnType:"number"})}}(t,n),s=new i.default({expressionInfos:[a.expressionInfo,r.expressionInfo,o.expressionInfo],fieldInfos:[a.fieldInfo,r.fieldInfo,o.fieldInfo],title:(0,v.V)(n.mostCommon,{expression:"{expression/predominant-category}"}),content:(0,v.V)(n.predominantCategoryValueMarginContent,{expression1:"<b>{".concat(r.fieldInfo.fieldName,"}</b>"),expression2:"<b>{".concat(a.fieldInfo.fieldName,"}</b>"),expression3:"<b>{".concat(o.fieldInfo.fieldName,"}</b>")})});return{name:"predominant-category-value-margin",title:n.marginOfVictory,value:s}}function V(e,n){const{fieldInfos:t}=e,r=b(t,n),a=h(t,n),o=F(t,n),s=new i.default({expressionInfos:[a.expressionInfo,r.expressionInfo,o.expressionInfo],fieldInfos:[a.fieldInfo,r.fieldInfo,o.fieldInfo],content:(0,v.V)(n.predominantCategoryStrengthContent,{expression1:"{".concat(a.fieldInfo.fieldName,"}"),expression2:"<b>{".concat(r.fieldInfo.fieldName,"}</b>"),expression3:"<b>{".concat(o.fieldInfo.fieldName,"}%</b>")})});return{name:"predominant-category-strength",title:n.strengthOfPredominance,value:s}}function M(e,n){const{renderer:t,fieldInfos:r}=e,a=b(r,n),o=h(r,n),s=F(r,n),l=function(e,n){return{fieldInfo:new f.default({fieldName:"expression/predominant-categories-list"}),expressionInfo:new d.default({name:"predominant-categories-list",title:n.listOfCategories,expression:(0,p.getArcadeForOrderedFields)(e)})}}(r,n),u=new i.default({expressionInfos:[a.expressionInfo,o.expressionInfo,s.expressionInfo,l.expressionInfo],fieldInfos:[a.fieldInfo,o.fieldInfo,s.fieldInfo,l.fieldInfo],title:w(t,n),content:[{type:"text",text:(0,v.V)(n.predominantCategoryStrengthContent,{expression1:"{".concat(o.fieldInfo.fieldName,"}"),expression2:"<b>{".concat(a.fieldInfo.fieldName,"}</b>"),expression3:"<b>{".concat(s.fieldInfo.fieldName,"}%</b>")})},{type:"text",text:"{".concat(l.fieldInfo.fieldName,"}")}]});return{name:"predominant-categories-list",title:n.orderedListOfValues,value:u}}function P(e,n){const{fieldInfos:t}=e,r=b(t,n),a=h(t,n),o=F(t,n),s=function(e,n){const t=(0,p.fieldNamesFromFieldInfos)(e);return{fieldInfo:new f.default({fieldName:"expression/predominant-total",format:new x.default({digitSeparator:!0,places:0})}),expressionInfo:new d.default({name:"predominant-total",title:n.sumOfCategories,expression:(0,p.getArcadeForSumOfFields)(t),returnType:"number"})}}(t,n),l=new i.default({expressionInfos:[a.expressionInfo,r.expressionInfo,s.expressionInfo,o.expressionInfo],fieldInfos:[a.fieldInfo,r.fieldInfo,s.fieldInfo,o.fieldInfo],content:(0,v.V)(n.predominantCategoryTotalStrengthContent,{expression1:"{".concat(a.fieldInfo.fieldName,"}"),expression2:"<b>{".concat(r.fieldInfo.fieldName,"}</b>"),expression3:"<b>{".concat(o.fieldInfo.fieldName,"}%</b>"),expression4:"{".concat(s.fieldInfo.fieldName,"}")})});return{name:"predominant-category-total-strength",title:n.predominantCategoryWithTotalAndStrength,value:l}}function A(e,n){const{renderer:t,fieldInfos:r}=e,a=b(r,n),o=h(r,n),s=F(r,n),l=new i.default({expressionInfos:[o.expressionInfo,a.expressionInfo,s.expressionInfo],fieldInfos:[o.fieldInfo,a.fieldInfo,s.fieldInfo],title:w(t,n),content:[{type:"text",text:(0,v.V)(n.predominantCategoryStrengthContent,{expression1:"{".concat(o.fieldInfo.fieldName,"}"),expression2:"<b>{".concat(a.fieldInfo.fieldName,"}</b>"),expression3:"<b>{".concat(s.fieldInfo.fieldName,"}%</b>")})},{type:"media",mediaInfos:{type:"pie-chart",value:{fields:r.map((e=>e.fieldName))}}}]});return{name:"predominant-category-chart",title:n.predominantCategoryWithChart,value:l}}function S(e,n){const t=e.authoringInfo,i="predominance"===(null===t||void 0===t?void 0:t.type)?t.fields:[];if(null===i||void 0===i||!i.length)throw new r.default("predominance-popup:insufficient-info","unable to find input fields in authoringInfo");return i.map((e=>(0,o.lm)(n,e)))}async function L(e){const{layer:n,renderer:t}=e;await n.load();const i=null!==t&&void 0!==t?t:"renderer"in n?n.renderer:void 0;if("unique-value"!==(null===i||void 0===i?void 0:i.type))throw new r.default("predominance-popup:invalid-parameters","renderer.type must be 'unique-value'");return{renderer:i,fieldInfos:S(i,n)}}async function O(e){const[n,t]=await Promise.all([L(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),r=M(n,t),i=await async function(e){const[n,t]=await Promise.all([L(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]);return[N(n,t),T(n,t),C(n,t),P(n,t),M(n,t),V(n,t),A(n,t)]}(e);return{primaryTemplate:r,secondaryTemplates:i.filter((e=>e.name!==r.name))}}async function k(e){var n,t;const{layer:i,renderer:a}=e;await i.load();const o=null!==a&&void 0!==a?a:"renderer"in i?i.renderer:void 0;if("unique-value"!==(null===o||void 0===o?void 0:o.type))throw new r.default("relationship-popup:invalid-parameters","renderer.type must be 'unique-value'");const s=o.authoringInfo;if(!s||"relationship"!==s.type)throw new r.default("relationship-popup:invalid-parameters","renderer.authoringInfo.type must be 'relationship'");if(null===(n=s.field1)||void 0===n||!n.field||null===(t=s.field2)||void 0===t||!t.field)throw new r.default("relationship-popup:invalid-parameters","'field1' and/or 'field2' properties are missing in renderer.authoringInfo");return{layer:i,renderer:o}}async function q(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"divide";const{fieldInfos:r,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n,normFieldExpressionTemplate:t});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:r,expressionInfos:a}),fieldInfos:r,expressionInfos:a})}var z=t(30973);async function j(e){const{layer:n,renderer:t}=e;await n.load();const i=null!==t&&void 0!==t?t:"renderer"in n?n.renderer:void 0;if("simple"!==(null===i||void 0===i?void 0:i.type))throw new r.default("simple-popup:invalid-parameters","renderer.type must be 'simple'");return{layer:n,renderer:i}}async function X(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"divide";const{fieldInfos:r,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n,normFieldExpressionTemplate:t});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:r,expressionInfos:a}),expressionInfos:a,fieldInfos:r})}async function E(e){const{layer:n,renderer:t}=e;await n.load();const i=null!==t&&void 0!==t?t:"renderer"in n?n.renderer:void 0;if("unique-value"!==(null===i||void 0===i?void 0:i.type))throw new r.default("unique-values-popup:invalid-parameters","renderer.type must be 'unique-value'");return{layer:n,renderer:i}}async function $(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"divide";const{fieldInfos:r,expressionInfos:a}=await(0,o.Xj)({renderer:e,layer:n,normFieldExpressionTemplate:t});return new i.default({content:await(0,o.Lb)(n,{fieldInfos:r,expressionInfos:a}),fieldInfos:r,expressionInfos:a})}async function R(e){const{renderer:n,layer:t}=function(e){var n;const{layer:t}=e,i=null!==(n=e.renderer)&&void 0!==n?n:"renderer"in t?t.renderer:void 0;if(!i)throw new r.default("getTemplates:invalid-parameters","'renderer' or 'layer.renderer' must be provided");return{layer:t,renderer:i}}(e);if(!n)return null;if("simple"===n.type)return async function(e){const[{renderer:n,layer:t},r]=await Promise.all([j(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),i=[];if(!(0,o.G2)(n).length){const e=(0,z.createPopupTemplate)(t);return e?{primaryTemplate:{name:"simple",title:r.simple,value:e},secondaryTemplates:i}:null}const s={name:"simple",title:r.simple,value:await X(n,t)};return(0,o.gS)(n)&&i.push({name:"simple-percent",title:r.simpleNormFieldAsPercent,value:await X(n,t,"percentage")}),{primaryTemplate:s,secondaryTemplates:i}}({renderer:n,layer:t});if("class-breaks"===n.type)return async function(e){const[{renderer:n,layer:t},r]=await Promise.all([s(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),i={name:"class-breaks",title:r.classBreaks,value:await l(n,t)},d=[];return(0,o.gS)(n)&&d.push({name:"class-breaks-percent",title:r.classBreaksNormFieldAsPercent,value:await l(n,t,"percentage")}),{primaryTemplate:i,secondaryTemplates:d}}({renderer:n,layer:t});if("dot-density"===n.type)return I({renderer:n,layer:t});if("heatmap"===n.type)return async function(e){const[{renderer:n,layer:t},r]=await Promise.all([g(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]);if(!n.field)return null;const{fieldInfos:s}=await(0,o.Xj)({renderer:n,layer:t}),l=new i.default({content:await(0,o.Lb)(t,{fieldInfos:s}),fieldInfos:s});return{primaryTemplate:{name:"heatmap",title:r.heatmap,value:l},secondaryTemplates:[]}}({renderer:n,layer:t});if("unique-value"===n.type){var d;const e=null===(d=n.authoringInfo)||void 0===d?void 0:d.type;return"predominance"===e?O({renderer:n,layer:t}):"relationship"===e?async function(e){const[{renderer:n,layer:t},r]=await Promise.all([k(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),i={name:"relationship",title:r.relationshipPopupTitle,value:await q(n,t)},o=[];return function(e){var n,t;const r=e.authoringInfo;return!((null===r||void 0===r||null===(n=r.field1)||void 0===n||!n.normalizationField)&&(null===r||void 0===r||null===(t=r.field2)||void 0===t||!t.normalizationField))}(n)&&o.push({name:"relationship-percent",title:r.relationshipNormFieldAsPercent,value:await q(n,t,"percentage")}),{primaryTemplate:i,secondaryTemplates:o}}({renderer:n,layer:t}):async function(e){const[{renderer:n,layer:t},r]=await Promise.all([E(e),(0,a.ud)("esri/smartMapping/t9n/smartMapping")]),i={name:"unique-values",title:r.uniqueValues,value:await $(n,t)},s=[];return(0,o.gS)(n)&&s.push({name:"unique-values-percent",title:r.uniqueValuesNormFieldAsPercent,value:await $(n,t,"percentage")}),{primaryTemplate:i,secondaryTemplates:s}}({renderer:n,layer:t})}return null}},97336:(e,n,t)=>{t.d(n,{G2:()=>g,Lb:()=>F,Xj:()=>h,bF:()=>I,gS:()=>N,lm:()=>x});var r=t(18690),i=(t(81806),t(63860)),a=t(39348),o=t(53430),s=(t(75900),t(56362),t(87015),t(81940),t(6929)),l=(t(7198),t(93616),t(53539)),d=(t(91904),t(81779)),f=t(40585),p=t(17542),u=t(23994),c=t(15492),m=t(90704);let y=0;const I="expression/";function g(e){return"hasVisualVariables"in e&&e.hasVisualVariables()?e.visualVariables.filter((e=>!c.viewScaleRE.test(e.valueExpression)&&(!("target"in e)||"outline"!==e.target))):[]}function v(e,n){if(!n)return null;const t=(0,m.Rm)(e);return null===t||void 0===t?void 0:t.find((e=>e.name.toLowerCase()===n.toLowerCase()))}function x(e,n,t){let r=null;if(t&&"featureReduction"in e){const n=e.featureReduction;n&&"popupTemplate"in n&&n.popupTemplate&&(r=n.popupTemplate.fieldInfos)}else"popupTemplate"in e&&e.popupTemplate&&(r=e.popupTemplate.fieldInfos);const i=t?v(e,n):e.getField(n);let a=null;if(r&&r.some((e=>{var n;return!(!e||(null===(n=e.fieldName)||void 0===n?void 0:n.toLowerCase())!==(null===i||void 0===i?void 0:i.name.toLowerCase()))&&(a=e.clone(),!0)})),!a){const e=o.numericTypes.includes(i.type),n="integer"===i.type||"small-integer"===i.type;a=new f.default({fieldName:i.name,isEditable:i.editable,visible:!0,format:e?new p.default({places:n?0:2,digitSeparator:!0}):void 0})}return a.label||(a.label=i.alias),a}function w(e){const{expression:n,title:t,returnType:r}=e;return new d.default({name:"expr"+y++,expression:n,title:t,returnType:r})}function b(e){const n="number"===e.returnType?new p.default({places:2,digitSeparator:!0}):void 0;return new f.default({fieldName:"".concat(I).concat(e.name),visible:!0,format:n})}async function h(e){const n=await(0,i.ud)("esri/smartMapping/t9n/smartMapping"),{renderer:t,layer:o,normFieldExpressionTemplate:s,isFeatureReduction:l}=e,d=[],f=[],p=(0,u.getAttributes)(t,g);for(const r of p)if("field"===r.type)d.push(x(o,r.field,l));else if("normalized-field"===r.type){const e=l?v(o,r.field):o.getField(r.field),t=l?v(o,r.normalizationField):o.getField(r.normalizationField),i=w({type:"expression",expression:'\n      $feature["'.concat(e.name,'"];\n      $feature["').concat(t.name,'"];\n      ').concat("percentage"===s?'($feature["'.concat(e.name,'"] / $feature["').concat(t.name,'"]) * 100;'):'$feature["'.concat(e.name,'"] / $feature["').concat(t.name,'"];'),"\n      "),title:(0,a.V)("percentage"===s?n.normFieldLabelAsPercent:n.normFieldLabel,{expression1:e.alias,expression2:t.alias}),returnType:"number"});d.push(b(i),x(o,r.field,l),x(o,r.normalizationField,l)),f.push(i)}else if("expression"===r.type){const e=w(r);d.push(b(e)),f.push(e)}return{fieldInfos:(0,r.Am)(d,((e,n)=>e.fieldName===n.fieldName)),expressionInfos:(0,r.Am)(f,((e,n)=>e.expression===n.expression))}}async function F(e,n,t){const{fieldInfos:r,expressionInfos:o}=n,d=await(0,i.ud)("esri/smartMapping/t9n/smartMapping");if(r.length>2)return[new s.default({fieldInfos:r})];const f=[];for(const i of r){const n=i.fieldName||"";let r=i.label;if(!r){const i=t?v(e,n):e.getField(n);if(i)r=i.alias||n;else if(o){const e=n.split(I)[1],t=o[o.findIndex((n=>n.name===e))];t&&(r=t.title||t.name)}}f.push(new l.default({text:(0,a.V)(d.fieldInfo,{fieldLabel:r,fieldValue:"{".concat(n,"}")})}))}return f}function N(e){return!(!("normalizationField"in e)||!e.normalizationField)||"hasVisualVariables"in e&&e.hasVisualVariables()&&e.visualVariables.some((e=>!(!("normalizationField"in e)||!e.normalizationField)))}}}]);
//# sourceMappingURL=63720.c2abac63.chunk.js.map