"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[5828,70655],{8429:(e,t,a)=>{a.r(t),a.d(t,{createRenderer:()=>i});var r=a(50076),n=a(78937),s=a(29310);async function i(e){e=await async function(e){const t=(e=await(0,s.processRasterRendererParameters)(e)).layer.supportsMultidirectionalHillshade();if("multi-directional"===e.hillshadeType&&!t)throw new r.default("raster-shaded-relief-renderer:not-supported","multi-directional hillshade type is only supported on 10.8.1+ servers");return t&&null!=e.hillshadeType||(e.hillshadeType="traditional"),e}(e);const t=(0,n.sp)(e.layer.serviceRasterInfo,e.hillshadeType);if(null==t)throw new r.default("raster-shaded-relief-renderer:not-supported","Only elevation raster data is supported");return function(e,t){const{scalingType:a,colorRamp:r}=t;null!=a&&(e.scalingType=a),void 0!==r&&(e.colorRamp=r)}(t,e),{renderer:t}}},15498:(e,t,a)=>{a.d(t,{_:()=>i,t:()=>l});var r=a(76460);const n=()=>r.A.getLogger("esri.rest.support.generateRendererUtils");function s(e,t){return Number(e.toFixed(t))}function i(e){const t=d(e),a=[],r=t.uniqueValues.length;for(let n=0;n<r;n++){const e=t.uniqueValues[n],r=t.valueFrequency[n],s=e.toString();a.push({value:e,count:r,label:s})}return{uniqueValues:a}}function l(e,t){const{normalizationTotal:a}=e;return{classBreaks:o(e,t),normalizationTotal:a}}function o(e,t){var a;const r=e.definition,{classificationMethod:n,normalizationType:i,definedInterval:l}=r,o=null!==(a=r.breakCount)&&void 0!==a?a:1,p=[];let f=e.values;if(0===f.length)return[];f=f.sort(((e,t)=>e-t));const[h,m]=null!==t&&void 0!==t?t:[f.at(0),f.at(-1)];if("equal-interval"===n)if(f.length>=o){const e=(m-h)/o;let t=h;for(let a=1;a<o;a++){const r=s(h+a*e,6);p.push({minValue:t,maxValue:r,label:u(t,r,i)}),t=r}p.push({minValue:t,maxValue:m,label:u(t,m,i)})}else f.forEach((e=>{p.push({minValue:e,maxValue:e,label:u(e,e,i)})}));else if("natural-breaks"===n){const t=d(f),a=e.valueFrequency||t.valueFrequency,r=c(t.uniqueValues,a,o);let n=h;for(let e=1;e<o;e++)if(t.uniqueValues.length>e){const a=s(t.uniqueValues[r[e]],6);p.push({minValue:n,maxValue:a,label:u(n,a,i)}),n=a}p.push({minValue:n,maxValue:m,label:u(n,m,i)})}else if("quantile"===n)if(f.length>=o&&h!==m){let e=h,t=Math.ceil(f.length/o),a=0;for(let r=1;r<o;r++){let n=t+a-1;n>f.length&&(n=f.length-1),n<0&&(n=0),p.push({minValue:e,maxValue:f[n],label:u(e,f[n],i)}),e=f[n],a+=t,t=Math.ceil((f.length-a)/(o-r))}p.push({minValue:e,maxValue:m,label:u(e,m,i)})}else{let e=-1;for(let t=0;t<f.length;t++){const a=f[t];a!==e&&(e=a,p.push({minValue:e,maxValue:a,label:u(e,a,i)}),e=a)}}else if("standard-deviation"===n){const e=function(e){let t=0;for(let a=0;a<e.length;a++)t+=e[a];return t/=e.length,t}(f),t=function(e,t){let a=0;for(let r=0;r<e.length;r++){const n=e[r];a+=(n-t)*(n-t)}return a/=e.length,Math.sqrt(a)}(f,e);if(0===t)p.push({minValue:f[0],maxValue:f[0],label:u(f[0],f[0],i)});else{const a=function(e,t,a,r,n){let s=Math.max(r-e,t-r)/n/a;return s=s>=1?1:s>=.5?.5:.25,s}(h,m,o,e,t)*t;let r=0,n=h;for(let t=o;t>=1;t--){const l=s(e-(t-.5)*a,6);p.push({minValue:n,maxValue:l,label:u(n,l,i)}),n=l,r++}let l=s(e+.5*a,6);p.push({minValue:n,maxValue:l,label:u(n,l,i)}),n=l,r++;for(let t=1;t<=o;t++)l=r===2*o?m:s(e+(t+.5)*a,6),p.push({minValue:n,maxValue:l,label:u(n,l,i)}),n=l,r++}}else if("defined-interval"===n){if(!l)return p;const[e,a]=null!==t&&void 0!==t?t:[f.at(0),f.at(-1)],r=Math.ceil((a-e)/l);let n=e;for(let t=1;t<r;t++){const a=s(e+t*l,6);p.push({minValue:n,maxValue:a,label:u(n,a,i)}),n=a}p.push({minValue:n,maxValue:a,label:u(n,a,i)})}return p}function u(e,t,a){let r=null;return r=e===t?a&&"percent-of-total"===a?e+"%":e.toString():a&&"percent-of-total"===a?e+"% - "+t+"%":e+" - "+t,r}function d(e){const t=[],a=[];let r=Number.MIN_VALUE,n=1,s=-1;for(let i=0;i<e.length;i++){const l=e[i];l===r?(n++,a[s]=n):null!==l&&(t.push(l),r=l,n=1,a.push(n),s++)}return{uniqueValues:t,valueFrequency:a}}function c(e,t,a){const r=e.length,n=[];a>r&&(a=r);for(let i=0;i<a;i++)n.push(Math.round(i*r/a-1));n.push(r-1);let s=p(n,e,t,a);return function(e,t,a,r,n,s){let i=0,l=0,o=0,u=0,d=!0;for(let c=0;c<2&&d;c++){0===c&&(d=!1);for(let c=0;c<s-1;c++)for(;a[c+1]+1!==a[c+2];){a[c+1]=a[c+1]+1;const s=f(c,a,r,n);o=s.sbMean,i=s.sbSdcm;const p=f(c+1,a,r,n);if(u=p.sbMean,l=p.sbSdcm,!(i+l<t[c]+t[c+1])){a[c+1]=a[c+1]-1;break}t[c]=i,t[c+1]=l,e[c]=o,e[c+1]=u,d=!0}for(let c=s-1;c>0;c--)for(;a[c]!==a[c-1]+1;){a[c]=a[c]-1;const s=f(c-1,a,r,n);o=s.sbMean,i=s.sbSdcm;const p=f(c,a,r,n);if(u=p.sbMean,l=p.sbSdcm,!(i+l<t[c-1]+t[c])){a[c]=a[c]+1;break}t[c-1]=i,t[c]=l,e[c-1]=o,e[c]=u,d=!0}}return d}(s.mean,s.sdcm,n,e,t,a)&&(s=p(n,e,t,a)),n}function p(e,t,a,r){let n=[],s=[],i=[],l=0;const o=[],u=[];for(let h=0;h<r;h++){const r=f(h,e,t,a);o.push(r.sbMean),u.push(r.sbSdcm),l+=u[h]}let d,c=l,p=!0;for(;p||l<c;){p=!1,n=[];for(let t=0;t<r;t++)n.push(e[t]);for(let a=0;a<r;a++)for(let n=e[a]+1;n<=e[a+1];n++)if(d=t[n],a>0&&n!==e[a+1]&&Math.abs(d-o[a])>Math.abs(d-o[a-1]))e[a]=n;else if(a<r-1&&e[a]!==n-1&&Math.abs(d-o[a])>Math.abs(d-o[a+1])){e[a+1]=n-1;break}c=l,l=0,s=[],i=[];for(let n=0;n<r;n++){s.push(o[n]),i.push(u[n]);const r=f(n,e,t,a);o[n]=r.sbMean,u[n]=r.sbSdcm,l+=u[n]}}if(l>c){for(let t=0;t<r;t++)e[t]=n[t],o[t]=s[t],u[t]=i[t];l=c}return{mean:o,sdcm:u}}function f(e,t,a,r){let s=0,i=0;for(let n=t[e]+1;n<=t[e+1];n++){const e=r[n];s+=a[n]*e,i+=e}i<=0&&n().warn("Exception in Natural Breaks calculation");const l=s/i;let o=0;for(let n=t[e]+1;n<=t[e+1];n++)o+=r[n]*(a[n]-l)**2;return{sbMean:l,sbSdcm:o}}},29310:(e,t,a)=>{a.r(t),a.d(t,{createRasterLayerAdapter:()=>I,getDefaultBandCombination:()=>V,getSupportedRendererInfo:()=>R,processRasterRendererParameters:()=>F});var r=a(89379),n=a(50076),s=a(78937),i=a(35143),l=a(46053),o=(a(81806),a(76460),a(47249),a(85842)),u=a(19247),d=a(86866),c=a(46570),p=a(49304),f=a(53521);let h=class extends p.A{constructor(){super(...arguments),this.type="raster-layer-adapter",this._statsCache=new f.q(20)}get serviceRasterInfo(){return this.rasterInfo}async updateRasterInfo(e){this.rasterInfo=await this.generateRasterInfo(e),this.rasterFunction=null===e||void 0===e?void 0:e.rasterFunction}async updateRasterInfoWithEstimatedStats(e,t){const a=await this.estimateStatisticsHistograms(t);null!==a&&void 0!==a&&a.statistics&&(e.statistics=a.statistics),(null===a||void 0===a?void 0:a.histograms)&&(e.histograms=a.histograms)}};(0,i._)([(0,l.MZ)()],h.prototype,"layer",void 0),(0,i._)([(0,l.MZ)()],h.prototype,"serviceRasterInfo",null),(0,i._)([(0,l.MZ)()],h.prototype,"rasterInfo",void 0),(0,i._)([(0,l.MZ)()],h.prototype,"rasterFunction",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],h.prototype,"type",void 0),(0,i._)([(0,l.MZ)()],h.prototype,"version",void 0),h=(0,i._)([(0,o.$)("esri.smartMapping.raster.support.adapters.RasterLayerAdapter")],h);const m=h;let v=class extends m{generateRasterInfo(e){const t=null===e||void 0===e?void 0:e.rasterFunction;try{return this.layer.generateRasterInfo(t,{signal:null===e||void 0===e?void 0:e.signal})}catch(a){return Promise.resolve(this.layer.serviceRasterInfo)}}async estimateStatisticsHistograms(e){var t,a,r,n,s;const{layer:i}=this,l=null!==(t=null===(a=i.mosaicRule)||void 0===a||null===(a=a.multidimensionalDefinition)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.variableName)&&void 0!==t?t:"",o="".concat(null!==(r=null===e||void 0===e||null===(n=e.rasterFunction)||void 0===n?void 0:n.functionName)&&void 0!==r?r:"default").concat(l),p=this._statsCache.get(o);if(p)return p;let{width:f,height:h,pixelSize:m}=i.rasterInfo,v=1;for(;f>2e3||h>2e3;)f/=2,h/=2,v*=2;const y=null!==(s=null===e||void 0===e?void 0:e.rasterFunction)&&void 0!==s?s:i.rasterFunction,{fullExtent:g,mosaicRule:b}=i;m=new u.default(m.x*v,m.y*v,g.spatialReference);const M=new c.default({geometry:g,pixelSize:m,renderingRule:y,mosaicRule:b});let w;if(i.capabilities.operations.supportsComputeStatisticsHistograms)w=await i.computeStatisticsHistograms(M,e);else{const{histograms:t}=await i.computeHistograms(M,e);w={statistics:(0,d.Pg)(t),histograms:t}}return w&&this._statsCache.put(o,w),w}supportsMultidirectionalHillshade(){return this.layer.version>=10.81}load(e){return this.addResolvingPromise(this.layer.load(e).then((()=>{this.generateRasterInfo({rasterFunction:this.rasterFunction,signal:null===e||void 0===e?void 0:e.signal}).then((e=>this.rasterInfo=e))}))),Promise.resolve(this)}};(0,i._)([(0,l.MZ)()],v.prototype,"layer",void 0),v=(0,i._)([(0,o.$)("esri.smartMapping.raster.support.adapters.ImageryLayerAdapter")],v);const y=v;var g=a(76797);let b=class extends m{async generateRasterInfo(e){const{layer:t}=this,a=null===e||void 0===e?void 0:e.rasterFunction;if("imagery-tile"===t.type&&a)try{return await t.generateRasterInfo(a,{signal:null===e||void 0===e?void 0:e.signal})}catch(r){return t.serviceRasterInfo}return this.rasterInfo}async estimateStatisticsHistograms(e){var t,a,r,s;const{layer:i}=this,l=null!==(t=null===(a=i.multidimensionalDefinition)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.variableName)&&void 0!==t?t:"",o="".concat(null!==(r=null===(s=i.rasterFunction)||void 0===s?void 0:s.functionName)&&void 0!==r?r:"default").concat(l),u=this._statsCache.get(o);if(u)return u;const{raster:c}=i,{extent:p,width:f,height:h}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;const{pyramidScalingFactor:a,maximumPyramidLevel:r}=e.storageInfo;let{extent:n,width:s,height:i,pixelSize:l}=e,o=Math.max(0,Math.ceil(Math.log(Math.max(s,i)/t)/Math.log(a))-1),u=0,d=0;if(o<=r){const e=a**o;s=Math.floor(s/e),i=Math.floor(i/e)}else o=0,s=Math.min(s,t),i=Math.min(i,t),u=Math.max(Math.floor(s/2-500),0),d=Math.max(Math.floor(i/2-500),0),n=new g.default({xmin:n.xmin+u*l.x,xmax:Math.min(n.xmax,n.xmin+u*l.x*t),ymin:n.ymin+d*l.y,ymax:Math.min(n.ymax,n.ymin+d*l.y*t)});return{extent:n,width:s,height:i,origin:{x:u,y:d}}}(c.rasterInfo),{pixelBlock:m}=await i.fetchPixels(p,f,h,e);if(null==m)throw new n.default("raster-layer-adapter","Unable to estimate histograms");const v=(0,d.f4)(m);return v&&this._statsCache.put(o,v),v}supportsMultidirectionalHillshade(){return!0}load(e){return this.addResolvingPromise(this.layer.load(e).then((()=>this.rasterInfo=this.layer.raster.rasterInfo))),Promise.resolve(this)}};(0,i._)([(0,l.MZ)()],b.prototype,"layer",void 0),b=(0,i._)([(0,o.$)("esri.smartMapping.raster.support.adapters.ImageryTileLayerAdapter")],b);const M={imagery:{adapter:y,label:"ImageryLayer"},"imagery-tile":{adapter:b,label:"ImageryTileLayer"},wcs:{adapter:b,label:"WCSLayer"}},w={"raster-stretch":"raster-stretch","unique-value":"raster-unique-value","raster-rgb":"raster-rgb","class-breaks":"raster-class-breaks","raster-colormap":"raster-colormap","raster-shaded-relief":"raster-shaded-relief","vector-field":"raster-vector-field",flow:"raster-flow"},x=Object.keys(M).map((e=>M[e].label));function I(e){var t;if("raster-layer-adapter"===e.type)return e;const a=null===(t=M[e.type])||void 0===t?void 0:t.adapter;return null==a?null:new a({layer:e})}async function R(e){var t,a,r;const n=I((e=await F(e)).layer),i=await n.generateRasterInfo(e),l=(0,s.fp)(i,!0).map((e=>w[e])),o=n.layer,u="imagery-tile"===o.type?(0,s.Mm)(o.raster):void 0,d="wcs"!==o.type?o.presetRenderers:void 0,c=(0,s.I8)({variableName:e.variableName,rasterFunctionName:null===(t=e.rasterFunction)||void 0===t?void 0:t.functionName,presetRenderers:d}),p=null!==(a=null===c||void 0===c?void 0:c.renderer)&&void 0!==a?a:(0,s.PD)(i,{rasterFunctionColorRamp:u,variableName:e.variableName}),{bandCount:f}=i;return f>1&&l.push("raster-rgb"),!l.includes("raster-class-breaks")&&1===f&&+(null===(r=n.layer)||void 0===r?void 0:r.version)>=10.3&&l.push("raster-class-breaks"),{supportedTypes:l,defaultRenderer:p}}async function V(e){var t;const a=I((e=await F(e)).layer),r=await a.generateRasterInfo(e),{layer:n}=a;if("wcs"!==n.type&&null!==(t=n.presetRenderers)&&void 0!==t&&t.length){var i,l;const t=(0,s.I8)({variableName:e.variableName,rasterFunctionName:null===(i=e.rasterFunction)||void 0===i?void 0:i.functionName,presetRenderers:n.presetRenderers});if(null!==t&&void 0!==t&&null!==(l=t.bandIds)&&void 0!==l&&l.length)return t.bandIds}return(0,s.ci)(r)}async function F(e){var t,a;const{layer:s}=e;if(!s)throw new n.default("raster-renderer-creator:missing-parameters","'layer' parameter is required");const i=I(s);if(null==i)throw new n.default("raster-renderer-creator:invalid-parameters","'layer' must be one of these types: "+x.join(", "));await i.load();const l=null!==(t=null!==(a=e.rasterFunction)&&void 0!==a?a:e.renderingRule)&&void 0!==t?t:s.rasterFunction;return await i.updateRasterInfo({rasterFunction:l,signal:e.signal}),(0,r.A)((0,r.A)({},e),{},{layer:i,rasterFunction:l})}},30674:(e,t,a)=>{a.d(t,{A:()=>p});var r=a(35143),n=a(45802),s=a(42553),i=a(46053),l=(a(81806),a(76460),a(47249),a(6409)),o=a(85842);const u=new n.J({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),d=new n.J({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let c=class extends s.A{constructor(e){super(e),this.type="class-breaks-definition",this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null}set standardDeviationInterval(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}set definedInterval(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}};(0,r._)([(0,l.e)({classBreaksDef:"class-breaks-definition"})],c.prototype,"type",void 0),(0,r._)([(0,i.MZ)({json:{write:!0}})],c.prototype,"breakCount",void 0),(0,r._)([(0,i.MZ)({json:{write:!0}})],c.prototype,"classificationField",void 0),(0,r._)([(0,i.MZ)({type:String,json:{read:u.read,write:u.write}})],c.prototype,"classificationMethod",void 0),(0,r._)([(0,i.MZ)({json:{write:!0}})],c.prototype,"normalizationField",void 0),(0,r._)([(0,i.MZ)({json:{read:d.read,write:d.write}})],c.prototype,"normalizationType",void 0),(0,r._)([(0,i.MZ)({value:null,json:{write:!0}})],c.prototype,"standardDeviationInterval",null),(0,r._)([(0,i.MZ)({value:null,json:{write:!0}})],c.prototype,"definedInterval",null),c=(0,r._)([(0,o.$)("esri.rest.support.ClassBreaksDefinition")],c);const p=c}}]);
//# sourceMappingURL=70655.f6e5aaa4.chunk.js.map