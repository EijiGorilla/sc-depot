"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[83716],{2948:(e,t,i)=>{i.d(t,{MY:()=>g,Td:()=>f,UT:()=>m,e$:()=>v,iW:()=>_,qN:()=>p});var n=i(89379),o=i(69539),r=i(95114),s=i(57491),a=i(34781),l=i(89465),d=i(86659);const u={initializeLayersFromClientData:async(e,t,i)=>{var n;if(t||(t=[...e.layers,...e.tables].map((e=>e.graphTypeName))),0===(null===(n=t)||void 0===n?void 0:n.length))return;const o=new Map;for(const s of t)o.set(s,h(e,s));const r=await(0,a.fetchClientDataAtKeys)(e.dataManager.knowledgeGraph,Array.from(o.values()),{requestOptions:{signal:null===i||void 0===i?void 0:i.signal}});for(const s of[...e.layers,...e.tables]){const t=s.objectType.name;if(null==t)continue;const i=r.get(h(e,t));if(i){const e=JSON.parse(i);null===e||"object"!=typeof e||e.hasOwnProperty("showLabels")||(e.showLabels=!1),s.read(e,{origin:"service"})}}}},h=(e,t)=>"knowledge-graph"===e.type?"".concat(t,"/Map"):"".concat(t,"/LinkChart/LinkChartSubLayer");async function p(e,t,i){return u.initializeLayersFromClientData(e,t,i)}const c=["#4a0932","#b31515","#18382e","#a64f1b","#102432","#8c213f","#ed9310","#2c6954","#144d59","#ffc730","#75351e","#454f4b","#78b1c2","#191921","#8f8f82","#9be0c0","#dbb658","#87b051","#11495c","#c43541","#9c5596","#44498b","#ad9d63","#86afb3","#5c98ca","#b0bfa2","#73241f","#b86b53","#d9d78c","#3e756d","#f260a1","#a0d17d","#c27c30","#eb82eb","#ffdf3c","#ffb259","#ab52b3","#3cccb4","#0095ba","#d92b30"],y="#8f8f82";function f(e){return e<0||e>=c.length?new o.default(y):new o.default(c[e])}function m(e){const t=e.toArray();return new l.default({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,style:"solid",width:.75,color:t},{type:"CIMVectorMarker",enable:!0,size:6,markerPlacement:{type:"CIMMarkerPlacementOnLine",angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-10,ymin:-5,xmax:0,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[-12,-3.47],[-12,3.6],[1.96,-.03],[-12,-3.47]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:t}]}}]}]}}})}function g(e){let t="ESRI__ID",i=4;for(const n of e)if(n.name){if("name"===n.name.toLowerCase()){t=n.name;break}n.name.toLowerCase().includes("name")?(t=n.name,i=2):"esriFieldTypeString"===n.fieldType&&i>3&&(t=n.name,i=3)}return t}function _(e,t,i){const o={color:[80,80,80],haloColor:[255,255,255],haloSize:.7,font:{size:10,weight:"normal"}},a=new r.default({labelExpressionInfo:new s.A({expression:"ESRI__ID"===i?"".concat(t):"$feature.".concat(i)}),labelPlacement:"above-center",symbol:new d.default(o)}),l=new r.default({labelExpressionInfo:new s.A({expression:"'".concat(t,"' + IIf($feature.ESRI__AggregationCount>1, ' (' + $feature.ESRI__AggregationCount + ')', '')")}),labelPlacement:"center-along",labelPosition:"parallel",repeatLabel:!1,symbol:new d.default((0,n.A)((0,n.A)({},o),{},{yoffset:"12px"}))});return"entity"===e?[a]:[l]}function v(e,t,i){const n={color:[255,255,255],haloColor:[0,0,0],haloSize:.7,font:{size:10,weight:"bold"}},o="ESRI__ID"===i?"".concat(e):"$feature.".concat(i);return"point"===t?[new r.default({labelExpressionInfo:new s.A({expression:o}),labelPlacement:"above-center",symbol:new d.default(n)})]:"polyline"===t?[new r.default({labelExpressionInfo:new s.A({expression:o}),labelPlacement:"center-along",repeatLabel:!0,symbol:new d.default(n)})]:"polygon"===t?[new r.default({labelExpressionInfo:new s.A({expression:o}),labelPlacement:"always-horizontal",symbol:new d.default(n)})]:null}},10947:(e,t,i)=>{i.d(t,{F:()=>l});var n=i(81806),o=i(70373),r=i(2413);const s={minX:0,minY:0,maxX:0,maxY:0};function a(e,t,i){(function(e){s.minX=e[0],s.minY=e[1],s.maxX=e[2],s.maxY=e[3]})(t),e.search(s,i)}class l{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new o.w(9,(0,n.A)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((i,n)=>{e[t++]=n})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,r.Ie)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),a(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},33376:(e,t,i)=>{i.d(t,{T:()=>o});var n=i(20176);const o={getObjectId:e=>e.objectId,getAttributes:e=>e.attributes,getAttribute:(e,t)=>e.attributes[t],cloneWithGeometry:(e,t)=>new n.Om(t,e.attributes,null,e.objectId),getGeometry:e=>e.geometry,getCentroid:(e,t)=>e.ensureCentroid(t)}},40296:(e,t,i)=>{i.d(t,{F0:()=>l,Vx:()=>h,e2:()=>c,f:()=>y});var n=i(89379),o=i(81806),r=i(53084),s=i(8298),a=i(44460);function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?a.Cb:"esriGeometryPolyline"===e?a.yM:a.WR}}}const d=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let u=1;function h(e,t){if((0,o.A)("esri-csp-restrictions"))return()=>(0,n.A)({[t]:null},e);try{let i="this".concat(p(t)," = null;");for(const t in e)i+="this".concat(p(t)," = ").concat(JSON.stringify(e[t]),";");const n=new Function("\n      return class AttributesClass$".concat(u++," {\n        constructor() {\n          ").concat(i,";\n        }\n      }\n    "))();return()=>new n}catch(i){return()=>(0,n.A)({[t]:null},e)}}function p(e){return d.test(e)?".".concat(e):'["'.concat(e,'"]')}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[{name:"New Feature",description:"",prototype:{attributes:(0,r.clone)(e)}}]}function y(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:s.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:s.P,editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},70373:(e,t,i)=>{i.d(t,{E:()=>B,w:()=>a});var n=i(18690),o=i(4212),r=(i(81806),i(30015)),s=i(61196);class a{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,t=arguments.length>1?arguments[1]:void 0;this._compareMinX=p,this._compareMinY=c,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),x.prune(),M.prune(),I.prune(),w.prune()}all(e){l(this._data,e)}search(e,t){let i=this._data;const n=this._toBBox;if(v(e,i))for(x.clear();i;){for(let o=0,r=i.children.length;o<r;o++){const r=i.children[o],s=i.leaf?n(r):r;v(e,s)&&(i.leaf?t(r):_(e,s)?l(r,t):x.push(r))}i=x.pop()}}collides(e){let t=this._data;const i=this._toBBox;if(!v(e,t))return!1;for(x.clear();t;){for(let n=0,o=t.children.length;n<o;n++){const o=t.children[n],r=t.leaf?i(o):o;if(v(e,r)){if(t.leaf||_(e,r))return!0;x.push(o)}}t=x.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new S([]),this}remove(e){if(!e)return this;let t,i=this._data,r=null,s=0,a=!1;const l=this._toBBox(e);for(I.clear(),w.clear();i||I.length>0;){var d;if(i||(i=I.pop(),r=I.data[I.length-1],s=null!==(d=w.pop())&&void 0!==d?d:0,a=!0),i.leaf&&(t=(0,n.qh)(i.children,(0,o.zI)(e),i.children.length,i.indexHint),-1!==t))return i.children.splice(t,1),I.push(i),this._condense(I),this;a||i.leaf||!_(i,l)?r?(s++,i=r.children[s],a=!1):i=null:(I.push(i),w.push(s),s=0,r=i,i=i.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,i,n){const o=i-t+1;let r=this._maxEntries;if(o<=r){const n=new S(e.slice(t,i+1));return d(n,this._toBBox),n}n||(n=Math.ceil(Math.log(o)/Math.log(r)),r=Math.ceil(o/r**(n-1)));const s=new E([]);s.height=n;const a=Math.ceil(o/r),l=a*Math.ceil(Math.sqrt(r));b(e,t,i,l,this._compareMinX);for(let d=t;d<=i;d+=l){const t=Math.min(d+l-1,i);b(e,d,t,a,this._compareMinY);for(let i=d;i<=t;i+=a){const o=Math.min(i+a-1,t);s.children.push(this._build(e,i,o,n-1))}}return d(s,this._toBBox),s}_insert(e,t,i){const n=this._toBBox,o=i?e:n(e);I.clear();const r=function(e,t,i,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==i;){let i,n=1/0,o=1/0;for(let r=0,s=t.children.length;r<s;r++){const s=t.children[r],a=y(s),l=m(e,s)-a;l<o?(o=l,n=a<n?a:n,i=s):l===o&&a<n&&(n=a,i=s)}t=i||t.children[0]}return t}(o,this._data,t,I);for(r.children.push(e),h(r,o);t>=0&&I.data[t].children.length>this._maxEntries;)this._split(I,t),t--;!function(e,t,i){for(let n=i;n>=0;n--)h(t.data[n],e)}(o,I,t)}_split(e,t){const i=e.data[t],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);const r=this._chooseSplitIndex(i,o,n);if(!r)return;const s=i.children.splice(r,i.children.length-r),a=i.leaf?new S(s):new E(s);a.height=i.height,d(i,this._toBBox),d(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this._data=new E([e,t]),this._data.height=e.height+1,d(this._data,this._toBBox)}_chooseSplitIndex(e,t,i){let n,o,r;n=o=1/0;for(let s=t;s<=i-t;s++){const t=u(e,0,s,this._toBBox),a=u(e,s,i,this._toBBox),l=g(t,a),d=y(t)+y(a);l<n?(n=l,r=s,o=d<o?d:o):l===n&&d<o&&(o=d,r=s)}return r}_chooseSplitAxis(e,t,i){const n=e.leaf?this._compareMinX:p,o=e.leaf?this._compareMinY:c;this._allDistMargin(e,t,i,n)<this._allDistMargin(e,t,i,o)&&e.children.sort(n)}_allDistMargin(e,t,i,n){e.children.sort(n);const o=this._toBBox,r=u(e,0,t,o),s=u(e,i-t,i,o);let a=f(r)+f(s);for(let l=t;l<i-t;l++){const t=e.children[l];h(r,e.leaf?o(t):t),a+=f(r)}for(let l=i-t-1;l>=t;l--){const t=e.children[l];h(s,e.leaf?o(t):t),a+=f(s)}return a}_condense(e){for(let t=e.length-1;t>=0;t--){const i=e.data[t];if(0===i.children.length)if(t>0){const o=e.data[t-1],r=o.children;r.splice((0,n.qh)(r,i,r.length,o.indexHint),1)}else this.clear();else d(i,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function l(e,t){let i=e;for(M.clear();i;){var n;if(!0===i.leaf)for(const e of i.children)t((0,o.zI)(e));else M.pushArray(i.children);i=null!==(n=M.pop())&&void 0!==n?n:null}}function d(e,t){u(e,0,e.children.length,t,e)}function u(e,t,i,n,o){o||(o=new S([])),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(let r,s=t;s<i;s++)r=e.children[s],h(o,e.leaf?n(r):r);return o}function h(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function p(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function y(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function m(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function g(e,t){const i=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),r=Math.min(e.maxY,t.maxY);return Math.max(0,o-i)*Math.max(0,r-n)}function _(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function v(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function b(e,t,i,n,o){const r=[t,i];for(;r.length;){const t=r.pop(),i=r.pop();if(t-i<=n)continue;const a=i+Math.ceil((t-i)/n/2)*n;(0,s.q)(e,a,i,t,o),r.push(i,a,a,t)}}const x=new r.A,M=new r.A,I=new r.A,w=new r.A({deallocator:void 0});class B{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class T extends B{constructor(){super(...arguments),this.height=1,this.indexHint=new n.vW}}class S extends T{constructor(e){super(),this.children=e,this.leaf=!0}}class E extends T{constructor(e){super(),this.children=e,this.leaf=!1}}},72547:(e,t,i)=>{i.d(t,{A:()=>y});var n=i(18690),o=i(50076),r=i(54099),s=i(76460),a=i(42294),l=i(2413),d=i(98618),u=i(10947),h=i(55167),p=i(33376);const c=(0,a.vt)();class y{constructor(e){this.geometryInfo=e,this._boundsStore=new u.F,this._featuresById=new Map,this._usedMemory=0,this.events=new r.A,this.featureAdapter=p.T}get usedMemory(){return this._usedMemory}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,i,n,o]=this.fullBounds;return{xmin:t,ymin:i,xmax:n,ymax:o,spatialReference:(0,h.ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}upsertMany(e){const t=e.map((e=>this._upsert(e)));return this._emitChanged(),t.filter(n.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged(),this._usedMemory=0}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const i of e){const e=this._boundsStore.get(i.objectId);e&&t((0,a.Jt)(c,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}_emitChanged(){this.events.emit("changed",void 0)}_add(e){var t,i,n,r,a;if(!e)return;const u=e.objectId;if(null==u)return void s.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new o.default("featurestore:invalid-feature","feature id is missing",{feature:e}));const h=this._featuresById.get(u);let p;if(h?(e.displayId=h.displayId,p=this._boundsStore.get(u),this._boundsStore.delete(u),this._usedMemory-=null!==(t=null===(i=this.estimateFeatureUsedMemory)||void 0===i?void 0:i.call(this,h))&&void 0!==t?t:0):null!=this.onFeatureAdd&&this.onFeatureAdd(e),null===(n=e.geometry)||void 0===n||null===(n=n.coords)||void 0===n||!n.length)return this._boundsStore.set(u,null),void this._featuresById.set(u,e);p=(0,d.jQ)(null!=p?p:(0,l.vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=p&&this._boundsStore.set(u,p),this._featuresById.set(u,e),this._usedMemory+=null!==(r=null===(a=this.estimateFeatureUsedMemory)||void 0===a?void 0:a.call(this,e))&&void 0!==r?r:0}_upsert(e){var t,i,n,r,a;const u=null===e||void 0===e?void 0:e.objectId;if(null==u)return s.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new o.default("featurestore:invalid-feature","feature id is missing",{feature:e})),null;const h=this._featuresById.get(u);if(!h)return this._add(e),e;this._usedMemory-=null!==(t=null===(i=this.estimateFeatureUsedMemory)||void 0===i?void 0:i.call(this,h))&&void 0!==t?t:0;const{geometry:p,attributes:c}=e;for(const o in c)h.attributes[o]=c[o];return p&&(h.geometry=p,this._boundsStore.set(u,null!==(n=(0,d.jQ)((0,l.vt)(),p,this.geometryInfo.hasZ,this.geometryInfo.hasM))&&void 0!==n?n:null)),this._usedMemory+=null!==(r=null===(a=this.estimateFeatureUsedMemory)||void 0===a?void 0:a.call(this,h))&&void 0!==r?r:0,h}_remove(e){var t,i;null!=this.onFeatureRemove&&this.onFeatureRemove(e);const n=e.objectId;return this._boundsStore.delete(n),this._featuresById.delete(n),this._usedMemory-=null!==(t=null===(i=this.estimateFeatureUsedMemory)||void 0===i?void 0:i.call(this,e))&&void 0!==t?t:0,e}}},83716:(e,t,i)=>{i.r(t),i.d(t,{default:()=>se});var n=i(89379),o=i(53986),r=i(35143),s=i(73204),a=i(53084),l=i(76460),d=i(77717),u=(i(16783),i(46053)),h=(i(81806),i(85842)),p=i(17707),c=i(49140),y=i(76797),f=i(19247),m=i(65215),g=i(23701),_=i(9624),v=i(13312),b=i(80963),x=i(31608),M=i(25515),I=i(72547),w=i(48094),B=i(40296),T=i(21009);i(47249);const S=(0,i(76350).p)(),E=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,r._)([(0,u.MZ)(S.fields)],t.prototype,"fields",void 0),(0,r._)([(0,u.MZ)(S.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,r._)([(0,h.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};var F=i(2948),A=i(65624),C=i(58822),O=i(74440),L=i(88266),j=i(37534),Z=i(21617),N=i(5682),Y=i(78817),R=i(95363),X=i(91687),k=i(44135),Q=i(53430),D=i(95114),J=i(27937),P=i(83982),G=i(5766),q=i(86616),z=i(91538),U=i(77725),V=i(68295),K=i(30973),$=i(94439),W=i(59989);const H=["target","writer","overridePolicy"];function ee(e){if(!e.json)return e;e.json.write=te(e.json.write);const t=e.json.origins;if(!t)return e;let i;for(i in t){const e=t[i];e&&(e.write=te(e.write))}return e}function te(e){return"object"==typeof e&&e?(!1!==e.enabled&&(e.overridePolicy=function(e){const{target:t,writer:i,overridePolicy:r}=e,s=(0,o.A)(e,H);return function(e,t){const i=ne.call(this,e,t);return i.enabled?(0,n.A)((0,n.A)({},s),i):i}}(e)),e):!0===e?ie():e}function ie(){return{overridePolicy:ne}}function ne(e,t){const i=!!this.geometryType;let o={enabled:i};return i&&(o=(0,n.A)((0,n.A)({},o),oe.call(this,e,t))),o}function oe(e,t){return{ignoreOrigin:this.originIdOf(t)>c.Gr.DEFAULTS}}let re=class extends(E((0,C.FJ)((0,L.J)((0,O.F)((0,A.dM)((0,j.fY)((0,Y.e)((0,N.j)((0,Z.J)((0,d.P)(M.default))))))))))){constructor(e){var t;super(e),t=this,this.blendMode="normal",this.capabilities=(0,B.f)(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.displayFilterEnabled=!0,this.displayFilterInfo=null,this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=T.dr,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new W.A(e.port1,{channel:e,client:{queryFeatures:function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=V.default.fromJSON(e);return t.queryFeaturesJSON(n,i)}}}),[e.port2]}))},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){var e;const t=[];return null!==(e=this.objectType)&&void 0!==e&&null!==(e=e.properties)&&void 0!==e&&e.forEach((e=>{const i="esriFieldTypeOID"===e.fieldType?"esriFieldTypeInteger":e.fieldType;t.push(k.default.fromJSON({name:e.name,type:i,alias:e.alias,defaultValue:e.defaultValue,editable:e.editable,nullable:e.nullable}))})),t.push(k.default.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),k.default.fromJSON({name:T.M1,type:"esriFieldTypeInteger",alias:T.M1,editable:!1}),k.default.fromJSON({name:T.BL,type:"esriFieldTypeInteger",alias:T.BL,editable:!1})),t}get geometryType(){var e,t,i;if("link-chart"===(null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.type))return"relationship"===this.graphType?"polyline":"point";const n=null===(t=this.parentCompositeLayer)||void 0===t?void 0:t.dataManager.geographicLookup.get(null===(i=this.objectType)||void 0===i?void 0:i.name),o=null===n||void 0===n?void 0:n.geometryType;return o&&"esriGeometryNull"!==o?x.gy.fromJSON(o):null}get geometryFieldName(){var e,t,i,n;if("link-chart"===(null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.type))return T.T1;const o=null===(t=this.parentCompositeLayer)||void 0===t?void 0:t.dataManager.geographicLookup.get(null===(i=this.objectType)||void 0===i?void 0:i.name);return null!==(n=null===o||void 0===o?void 0:o.name)&&void 0!==n?n:null}get graphTypeName(){var e;return null===(e=this.objectType)||void 0===e?void 0:e.name}get hasM(){var e,t,i,n;const o=null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.dataManager.geographicLookup.get(null===(t=this.objectType)||void 0===t?void 0:t.name),r=null===o||void 0===o?void 0:o.name,s=r?null===(i=this.objectType)||void 0===i||null===(i=i.properties)||void 0===i?void 0:i[r]:null;return null!==(n=null===s||void 0===s?void 0:s.hasM)&&void 0!==n&&n}get hasZ(){var e,t,i,n;const o=null===(e=this.parentCompositeLayer)||void 0===e?void 0:e.dataManager.geographicLookup.get(null===(t=this.objectType)||void 0===t?void 0:t.name),r=null===o||void 0===o?void 0:o.name,s=r?null===(i=this.objectType)||void 0===i||null===(i=i.properties)||void 0===i?void 0:i[r]:null;return null!==(n=null===s||void 0===s?void 0:s.hasZ)&&void 0!==n&&n}set labelingInfo(e){this._set("labelingInfo",e)}get labelingInfo(){if(this._isOverridden("labelingInfo"))return this._get("labelingInfo");const e=this.objectType.properties?(0,F.MY)(this.objectType.properties):"ESRI__ID";return"link-chart"===this.parentCompositeLayer.type?(0,F.iW)(this.graphType,this.graphTypeName,e):(0,F.e$)(this.graphTypeName,this.geometryType,e)}set renderer(e){(0,Q.fixRendererFields)(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){var e,t,i,n;if(this._isOverridden("renderer"))return this._get("renderer");const o=null===(e=this.parentCompositeLayer)||void 0===e||null===(e=e.dataManager)||void 0===e||null===(e=e.knowledgeGraph)||void 0===e?void 0:e.dataModel,r=[...null!==(t=null===o||void 0===o?void 0:o.entityTypes)&&void 0!==t?t:[],...null!==(i=null===o||void 0===o?void 0:o.relationshipTypes)&&void 0!==i?i:[]].map((e=>e.name)).indexOf(this.graphTypeName),s=(0,F.Td)(r);if("link-chart"===(null===(n=this.parentCompositeLayer)||void 0===n?void 0:n.type)){if("relationship"===this.graphType)return new G.default({type:"simple",symbol:(0,F.UT)(s)});const e=(0,q.fromJSON)((0,B.F0)(x.gy.toJSON("point")).renderer);return(0,$.dt)(e.symbol,s),e}const a=(0,q.fromJSON)((0,B.F0)(x.gy.toJSON(this.geometryType)).renderer);return(0,$.dt)(a.symbol,s),a}get spatialReference(){var e,t;return null!==(e=null===(t=this.parentCompositeLayer)||void 0===t||null===(t=t.dataManager)||void 0===t||null===(t=t.knowledgeGraph)||void 0===t||null===(t=t.dataModel)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:v.default.WGS84}set timeInfo(e){this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=null!==e&&void 0!==e?e:"Layer"}createPopupTemplate(e){return(0,K.createPopupTemplate)(this,e)}createQuery(){return new V.default({where:"1=1",outFields:["*"]})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){return null}async queryFeatures(e,t){await this.load();const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e),o=U.default.fromJSON(await n.executeQuery(i.toJSON(),null===t||void 0===t?void 0:t.signal));return o.features.forEach((e=>{e.sourceLayer=this})),o}async queryFeaturesJSON(e,t){await this.load();const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return await n.executeQuery(i.toJSON(),null===t||void 0===t?void 0:t.signal)}async queryFeatureCount(e,t){await this.load();const{resolvedQuery:i,queryEngine:n}=await this._setupQueryObjects(e);return n.executeQueryForCount(i.toJSON(),null===t||void 0===t?void 0:t.signal)}async queryExtent(){var e,t,i,o;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;await this.load();const a=(0,n.A)((0,n.A)({},r),{},{returnGeometry:!0}),{resolvedQuery:l,queryEngine:d}=await this._setupQueryObjects(a),u=await d.executeQueryForExtent(l.toJSON(),null===s||void 0===s?void 0:s.signal);let h;return h=null!=(null===(e=u.extent)||void 0===e?void 0:e.xmin)&&null!=(null===(t=u.extent)||void 0===t?void 0:t.xmax)&&null!=(null===(i=u.extent)||void 0===i?void 0:i.ymin)&&null!=(null===(o=u.extent)||void 0===o?void 0:o.ymax)?new y.default(u.extent):new y.default,{count:u.count,extent:h}}async queryObjectIds(e,t){await this.load();const i=V.default.from(e);let n;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)n=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(i,this,t);n=this.loadQueryEngine(e)}return await n.executeQueryForIds(i.toJSON(),null===t||void 0===t?void 0:t.signal)}loadQueryEngine(e){var t;const i=new I.A({geometryType:x.gy.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),n=new w.do({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:x.gy.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null===(t=this.timeInfo)||void 0===t?void 0:t.toJSON(),featureStore:i});return n.featureStore.addMany(e),n}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new V.default({where:"1=1",outFields:[T.dr]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}load(e){return this.addResolvingPromise(this.parent.load(e).then((()=>(0,Q.fixTimeInfoFields)(this.timeInfo,this.fieldsIndex)))),Promise.resolve(this)}async _setupQueryObjects(e,t){var i;const n=V.default.from(e),o=n.geometry;if(o&&!(null!==(i=o.spatialReference)&&void 0!==i&&i.isWGS84)&&(await(0,_.initializeProjection)(o.spatialReference,b.KK),n.geometry=(0,_.project)(o instanceof m.default||o instanceof g.default||o instanceof f.default?o:o.extent,b.KK)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)return{resolvedQuery:n,queryEngine:this._cachedQueryEngine};const r=await this.parentCompositeLayer.dataManager.getData(n,this,t);return{resolvedQuery:n,queryEngine:this.loadQueryEngine(r)}}};(0,r._)([(0,u.MZ)(ee((0,a.clone)(A.sU)))],re.prototype,"blendMode",void 0),(0,r._)([(0,u.MZ)()],re.prototype,"capabilities",void 0),(0,r._)([(0,u.MZ)({json:{origins:{"web-scene":{write:!1}},write:ie()}})],re.prototype,"charts",void 0),(0,r._)([(0,u.MZ)({readOnly:!0})],re.prototype,"defaultPopupTemplate",null),(0,r._)([(0,u.MZ)({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],re.prototype,"definitionExpression",void 0),(0,r._)([(0,u.MZ)()],re.prototype,"displayField",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(C.Dp)))],re.prototype,"displayFilterEnabled",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(C.KV)))],re.prototype,"displayFilterInfo",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(A.LF)))],re.prototype,"effect",void 0),(0,r._)([(0,u.MZ)()],re.prototype,"elevationInfo",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(O.Y)))],re.prototype,"featureEffect",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(X.d)))],re.prototype,"featureReduction",null),(0,r._)([(0,u.MZ)()],re.prototype,"fields",null),(0,r._)([(0,u.MZ)()],re.prototype,"geometryType",null),(0,r._)([(0,u.MZ)()],re.prototype,"geometryFieldName",null),(0,r._)([(0,u.MZ)({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],re.prototype,"graphType",void 0),(0,r._)([(0,u.MZ)({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],re.prototype,"graphTypeName",null),(0,r._)([(0,u.MZ)()],re.prototype,"hasM",null),(0,r._)([(0,u.MZ)()],re.prototype,"hasZ",null),(0,r._)([(0,u.MZ)({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],re.prototype,"id",void 0),(0,r._)([(0,u.MZ)({type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",default:!1,write:{overridePolicy(){return{enabled:!!this.geometryType,alwaysWriteDefaults:!0,ignoreOrigin:!0}}}}})],re.prototype,"labelsVisible",void 0),(0,r._)([(0,u.MZ)({type:[D.default],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:function(e,t,i){const n=[["ESRI__AGGREGATION_COUNT",T.M1],["ESRI__ORIGIN_ID",T.Cz],["ESRI__DESTINATION_ID",T.KQ],["ESRI__LAYOUT_GEOMETRY",T.T1]];try{for(const t of e)for(const[e,i]of n){var o,r;t.labelExpression=null===(o=t.labelExpression)||void 0===o?void 0:o.replaceAll(e,i),(null===(r=t.labelExpressionInfo)||void 0===r?void 0:r.expression)&&(t.labelExpressionInfo.expression=t.labelExpressionInfo.expression.replaceAll(e,i))}}catch(s){l.A.getLogger(this).warn("Error updating labelingInfo",s)}return(0,J.w)(e,t,i)},write:ie()}})],re.prototype,"labelingInfo",null),(0,r._)([(0,u.MZ)({readOnly:!0,json:{read:!1,write:{writer(e,t){var i;switch(null===(i=this.parentCompositeLayer)||void 0===i?void 0:i.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],re.prototype,"layerType",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(R.fV)))],re.prototype,"legendEnabled",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(R.hG)))],re.prototype,"maxScale",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(R.hn)))],re.prototype,"minScale",void 0),(0,r._)([(0,u.MZ)()],re.prototype,"objectIdField",void 0),(0,r._)([(0,u.MZ)()],re.prototype,"objectType",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(R.ke)))],re.prototype,"opacity",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(j.ne)))],re.prototype,"orderBy",void 0),(0,r._)([(0,u.MZ)({clonable:!1})],re.prototype,"parent",void 0),(0,r._)([(0,u.MZ)()],re.prototype,"parentCompositeLayer",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(R.M6)))],re.prototype,"popupEnabled",void 0),(0,r._)([(0,u.MZ)({type:s.default,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],re.prototype,"popupTemplate",void 0),(0,r._)([(0,u.MZ)({type:Number,json:{write:{overridePolicy:oe}}})],re.prototype,"refreshInterval",void 0),(0,r._)([(0,u.MZ)({types:z.Hg,json:{name:"layerDefinition.drawingInfo.renderer",write:ie()}})],re.prototype,"renderer",null),(0,r._)([(0,u.MZ)()],re.prototype,"source",void 0),(0,r._)([(0,u.MZ)()],re.prototype,"spatialReference",null),(0,r._)([(0,u.MZ)({type:P.default,json:{name:"layerDefinition.timeInfo",write:!0,origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:!0},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:!0}}}})],re.prototype,"timeInfo",null),(0,r._)([(0,u.MZ)({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],re.prototype,"title",null),(0,r._)([(0,p.K)("title")],re.prototype,"writeTitle",null),(0,r._)([(0,u.MZ)({json:{read:!1}})],re.prototype,"type",void 0),(0,r._)([(0,u.MZ)(ee((0,a.clone)(Y.B)))],re.prototype,"useViewTime",void 0),(0,r._)([(0,u.MZ)({type:Boolean,json:{name:"visibility",write:ie()}})],re.prototype,"visible",void 0),re=(0,r._)([(0,h.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],re);const se=re}}]);
//# sourceMappingURL=83716.0e887671.chunk.js.map