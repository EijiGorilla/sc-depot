"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[36201,75166,89040],{770:(e,t,a)=>{a.d(t,{bG:()=>i,Ty:()=>l,YJ:()=>c,Fq:()=>u,vt:()=>o});var r=a(53084),n=a(42633);class s{constructor(e){const{name:t,label:a,description:r,schemes:s}=e;this.name=t,this.label=a,this.description=r,this.schemes=s;const i=e.basemapGroups||n.Np;let o=[];Object.keys(i).forEach((e=>{o=o.concat(i[e])})),this.supportedBasemaps=o,this.basemapGroups=i}isBasemapSupported(e){const t=(0,n.T1)(e,this.supportedBasemaps);return!(!t||!this.supportedBasemaps.includes(t))}getRawSchemes(e){const{basemapId:t,basemapTheme:a}=function(e,t,a){let r=null,s=null;if(t&&(r=(0,n.T1)(t,e,!1),r)){const e=(0,n.BV)(r);null!=e&&(s=e)}return!r&&a&&(r="dark"===a?"dark-gray":"gray",s=a),r||s||(r="gray",s="light"),{basemapId:r,basemapTheme:s}}(this.supportedBasemaps,e.basemap,e.basemapTheme);let s=a;if(t){const e=(0,n.BV)(t,this.basemapGroups);null!=e&&(s=e)}let i=e.geometryType;"multipoint"===i?i="point":"mesh"===i&&(i="polygon");const o=this.schemes[i]||this.schemes.default;return{schemesInfo:(0,r.clone)(o[s]),basemapId:t,basemapTheme:a}}}function i(e){const t=e.themeDictionary,a=new Map;for(const r in t){const e=t[r];a.set(r,new s(e))}return a}function o(e,t){const a=[];return e.forEach((e=>{e.isBasemapSupported(t)&&a.push({name:e.name,label:e.label,description:e.description,basemaps:[...e.supportedBasemaps]})})),a}function l(e,t){if(!e)return;if(!t)return;let a=null;const r=[t.primaryScheme,...t.secondarySchemes];for(const s of r){var n;if((null===(n=s.name)||void 0===n?void 0:n.toLowerCase())===e.toLowerCase()){a=s;break}}return a}function c(e,t,a){if(!e&&!t)return[];if(!a)return[];const r=!(null!==e&&void 0!==e&&e.length),n=!(null!==t&&void 0!==t&&t.length),s=[a.primaryScheme,...a.secondarySchemes],i=[];for(const o of s){const a=!!r||e.some((e=>o.tags.includes(e))),s=!n&&t.some((e=>o.tags.includes(e)));a&&!s&&i.push(o)}return i}function u(e){const t=e.theme;if(t)return t.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme})}},29310:(e,t,a)=>{a.r(t),a.d(t,{createRasterLayerAdapter:()=>I,getDefaultBandCombination:()=>T,getSupportedRendererInfo:()=>R,processRasterRendererParameters:()=>M});var r=a(89379),n=a(50076),s=a(78937),i=a(35143),o=a(46053),l=(a(81806),a(76460),a(47249),a(85842)),c=a(19247),u=a(86866),m=a(46570),d=a(49304),p=a(53521);let h=class extends d.A{constructor(){super(...arguments),this.type="raster-layer-adapter",this._statsCache=new p.q(20)}get serviceRasterInfo(){return this.rasterInfo}async updateRasterInfo(e){this.rasterInfo=await this.generateRasterInfo(e),this.rasterFunction=null===e||void 0===e?void 0:e.rasterFunction}async updateRasterInfoWithEstimatedStats(e,t){const a=await this.estimateStatisticsHistograms(t);null!==a&&void 0!==a&&a.statistics&&(e.statistics=a.statistics),(null===a||void 0===a?void 0:a.histograms)&&(e.histograms=a.histograms)}};(0,i._)([(0,o.MZ)()],h.prototype,"layer",void 0),(0,i._)([(0,o.MZ)()],h.prototype,"serviceRasterInfo",null),(0,i._)([(0,o.MZ)()],h.prototype,"rasterInfo",void 0),(0,i._)([(0,o.MZ)()],h.prototype,"rasterFunction",void 0),(0,i._)([(0,o.MZ)({readOnly:!0})],h.prototype,"type",void 0),(0,i._)([(0,o.MZ)()],h.prototype,"version",void 0),h=(0,i._)([(0,l.$)("esri.smartMapping.raster.support.adapters.RasterLayerAdapter")],h);const f=h;let y=class extends f{generateRasterInfo(e){const t=null===e||void 0===e?void 0:e.rasterFunction;try{return this.layer.generateRasterInfo(t,{signal:null===e||void 0===e?void 0:e.signal})}catch(a){return Promise.resolve(this.layer.serviceRasterInfo)}}async estimateStatisticsHistograms(e){var t,a,r,n,s;const{layer:i}=this,o=null!==(t=null===(a=i.mosaicRule)||void 0===a||null===(a=a.multidimensionalDefinition)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.variableName)&&void 0!==t?t:"",l="".concat(null!==(r=null===e||void 0===e||null===(n=e.rasterFunction)||void 0===n?void 0:n.functionName)&&void 0!==r?r:"default").concat(o),d=this._statsCache.get(l);if(d)return d;let{width:p,height:h,pixelSize:f}=i.rasterInfo,y=1;for(;p>2e3||h>2e3;)p/=2,h/=2,y*=2;const v=null!==(s=null===e||void 0===e?void 0:e.rasterFunction)&&void 0!==s?s:i.rasterFunction,{fullExtent:g,mosaicRule:b}=i;f=new c.default(f.x*y,f.y*y,g.spatialReference);const w=new m.default({geometry:g,pixelSize:f,renderingRule:v,mosaicRule:b});let S;if(i.capabilities.operations.supportsComputeStatisticsHistograms)S=await i.computeStatisticsHistograms(w,e);else{const{histograms:t}=await i.computeHistograms(w,e);S={statistics:(0,u.Pg)(t),histograms:t}}return S&&this._statsCache.put(l,S),S}supportsMultidirectionalHillshade(){return this.layer.version>=10.81}load(e){return this.addResolvingPromise(this.layer.load(e).then((()=>{this.generateRasterInfo({rasterFunction:this.rasterFunction,signal:null===e||void 0===e?void 0:e.signal}).then((e=>this.rasterInfo=e))}))),Promise.resolve(this)}};(0,i._)([(0,o.MZ)()],y.prototype,"layer",void 0),y=(0,i._)([(0,l.$)("esri.smartMapping.raster.support.adapters.ImageryLayerAdapter")],y);const v=y;var g=a(76797);let b=class extends f{async generateRasterInfo(e){const{layer:t}=this,a=null===e||void 0===e?void 0:e.rasterFunction;if("imagery-tile"===t.type&&a)try{return await t.generateRasterInfo(a,{signal:null===e||void 0===e?void 0:e.signal})}catch(r){return t.serviceRasterInfo}return this.rasterInfo}async estimateStatisticsHistograms(e){var t,a,r,s;const{layer:i}=this,o=null!==(t=null===(a=i.multidimensionalDefinition)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.variableName)&&void 0!==t?t:"",l="".concat(null!==(r=null===(s=i.rasterFunction)||void 0===s?void 0:s.functionName)&&void 0!==r?r:"default").concat(o),c=this._statsCache.get(l);if(c)return c;const{raster:m}=i,{extent:d,width:p,height:h}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;const{pyramidScalingFactor:a,maximumPyramidLevel:r}=e.storageInfo;let{extent:n,width:s,height:i,pixelSize:o}=e,l=Math.max(0,Math.ceil(Math.log(Math.max(s,i)/t)/Math.log(a))-1),c=0,u=0;if(l<=r){const e=a**l;s=Math.floor(s/e),i=Math.floor(i/e)}else l=0,s=Math.min(s,t),i=Math.min(i,t),c=Math.max(Math.floor(s/2-500),0),u=Math.max(Math.floor(i/2-500),0),n=new g.default({xmin:n.xmin+c*o.x,xmax:Math.min(n.xmax,n.xmin+c*o.x*t),ymin:n.ymin+u*o.y,ymax:Math.min(n.ymax,n.ymin+u*o.y*t)});return{extent:n,width:s,height:i,origin:{x:c,y:u}}}(m.rasterInfo),{pixelBlock:f}=await i.fetchPixels(d,p,h,e);if(null==f)throw new n.default("raster-layer-adapter","Unable to estimate histograms");const y=(0,u.f4)(f);return y&&this._statsCache.put(l,y),y}supportsMultidirectionalHillshade(){return!0}load(e){return this.addResolvingPromise(this.layer.load(e).then((()=>this.rasterInfo=this.layer.raster.rasterInfo))),Promise.resolve(this)}};(0,i._)([(0,o.MZ)()],b.prototype,"layer",void 0),b=(0,i._)([(0,l.$)("esri.smartMapping.raster.support.adapters.ImageryTileLayerAdapter")],b);const w={imagery:{adapter:v,label:"ImageryLayer"},"imagery-tile":{adapter:b,label:"ImageryTileLayer"},wcs:{adapter:b,label:"WCSLayer"}},S={"raster-stretch":"raster-stretch","unique-value":"raster-unique-value","raster-rgb":"raster-rgb","class-breaks":"raster-class-breaks","raster-colormap":"raster-colormap","raster-shaded-relief":"raster-shaded-relief","vector-field":"raster-vector-field",flow:"raster-flow"},x=Object.keys(w).map((e=>w[e].label));function I(e){var t;if("raster-layer-adapter"===e.type)return e;const a=null===(t=w[e.type])||void 0===t?void 0:t.adapter;return null==a?null:new a({layer:e})}async function R(e){var t,a,r;const n=I((e=await M(e)).layer),i=await n.generateRasterInfo(e),o=(0,s.fp)(i,!0).map((e=>S[e])),l=n.layer,c="imagery-tile"===l.type?(0,s.Mm)(l.raster):void 0,u="wcs"!==l.type?l.presetRenderers:void 0,m=(0,s.I8)({variableName:e.variableName,rasterFunctionName:null===(t=e.rasterFunction)||void 0===t?void 0:t.functionName,presetRenderers:u}),d=null!==(a=null===m||void 0===m?void 0:m.renderer)&&void 0!==a?a:(0,s.PD)(i,{rasterFunctionColorRamp:c,variableName:e.variableName}),{bandCount:p}=i;return p>1&&o.push("raster-rgb"),!o.includes("raster-class-breaks")&&1===p&&+(null===(r=n.layer)||void 0===r?void 0:r.version)>=10.3&&o.push("raster-class-breaks"),{supportedTypes:o,defaultRenderer:d}}async function T(e){var t;const a=I((e=await M(e)).layer),r=await a.generateRasterInfo(e),{layer:n}=a;if("wcs"!==n.type&&null!==(t=n.presetRenderers)&&void 0!==t&&t.length){var i,o;const t=(0,s.I8)({variableName:e.variableName,rasterFunctionName:null===(i=e.rasterFunction)||void 0===i?void 0:i.functionName,presetRenderers:n.presetRenderers});if(null!==t&&void 0!==t&&null!==(o=t.bandIds)&&void 0!==o&&o.length)return t.bandIds}return(0,s.ci)(r)}async function M(e){var t,a;const{layer:s}=e;if(!s)throw new n.default("raster-renderer-creator:missing-parameters","'layer' parameter is required");const i=I(s);if(null==i)throw new n.default("raster-renderer-creator:invalid-parameters","'layer' must be one of these types: "+x.join(", "));await i.load();const o=null!==(t=null!==(a=e.rasterFunction)&&void 0!==a?a:e.renderingRule)&&void 0!==t?t:s.rasterFunction;return await i.updateRasterInfo({rasterFunction:o,signal:e.signal}),(0,r.A)((0,r.A)({},e),{},{layer:i,rasterFunction:o})}},80791:(e,t,a)=>{a.d(t,{_J:()=>c,_t:()=>l});var r=a(76931),n=a(42633);const s=n.Np.light,i=n.Np.dark;function o(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b}function l(e,t){let a=0;if(e.length===t.length){let r=e.every(((e,a)=>o(e,t[a])));r?a=1:(r=e.slice().reverse().every(((e,a)=>o(e,t[a]))),r&&(a=-1))}return a}function c(e,t){return Math.ceil(function(e){const t=e.width,a=e.height;let n=e.pixelSizeAt(e.toMap((0,r.tc)(.5*t,.5*a),{exclude:[]}));if(n<=0&&(n=e.pixelSizeAt(e.toMap((0,r.tc)(.5*t,.95*a),{exclude:[]})),n<=0&&"camera"in e)){const t=e.camera.position.clone();t.z=0,n=2*e.pixelSizeAt(t)}return n}(t)*(0,r.Lz)((0,r.cr)(e)))}},90127:(e,t,a)=>{a.r(t),a.d(t,{createRenderer:()=>S});var r=a(89379),n=a(59784),s=a(50076),i=a(9922),o=a(45430),l=a(78937),c=a(84563),u=a(64694),m=a(48548),d=a(43996),p=a(77718),h=a(14776),f=a(63040),y=a(29310),v=a(51006),g=a(95248);const b=5;async function w(e,t){t.flowRepresentation&&(e.flowRepresentation=t.flowRepresentation);const a=await async function(e){let t=e.flowScheme,a=null,r=null;const n=await(0,v.Ib)(null,e.view);if(a=null!=n.basemapId?n.basemapId:null,r=null!=n.basemapTheme?n.basemapTheme:null,t)return{scheme:(0,g.cloneScheme)(t),basemapId:a,basemapTheme:r};const s=(0,g.getSchemes)({basemapTheme:r,theme:e.theme,hasSizeVariable:e.hasSizeVariable});return s&&(t=s.primaryScheme,a=s.basemapId,r=s.basemapTheme),{scheme:t,basemapId:a,basemapTheme:r}}({theme:t.theme,flowScheme:t.flowScheme,view:t.view,hasSizeVariable:t.includeSizeVariable}),r=a.scheme;if(!r)throw new s.default("flow-renderer:insufficient-info","Unable to find flow scheme");e.flowSpeed=r.flowSpeed,e.density=r.density,e.trailLength=r.trailLength,e.trailWidth=r.trailWidth,e.trailCap=r.trailCap,e.color=r.color;const y=[],w=[],S="Magnitude",x=t.layer.serviceRasterInfo,I=null==(null===x||void 0===x?void 0:x.statistics)||"vector-magdir"!==x.dataType&&"vector-uv"!==x.dataType?{minMagnitude:0,maxMagnitude:10}:(0,l.iG)(x.dataType,x.statistics);if(null==(null===I||void 0===I?void 0:I.minMagnitude)||null==I.maxMagnitude)throw new s.default("flow-renderer:insufficient-info","stats not available");const R={min:I.minMagnitude,max:I.maxMagnitude},T={min:R.min,max:null!=R.max?R.max/2:null},M=(0,v.Gc)(T,null,null),z=(0,v.TQ)(M,T,null);if(t.includeColorVariable){const e=(0,n.Iy)(r.colors,b);if(e.length<b)throw new s.default("flow-renderer:insufficient-info","Flow scheme does not have enough colors");const t=new u.default({field:S,stops:z.map(((t,a)=>new p.default({value:t,color:e[a]})))});y.push(t);const a=new o.default({type:"color",minSliderValue:R.min,maxSliderValue:R.max,theme:"high-to-low"});w.push(a)}if(t.includeOpacityVariable){const e=new m.default({field:S,stops:[new h.default({value:z[0],opacity:r.minOpacity}),new h.default({value:z[4],opacity:r.maxOpacity})]});y.push(e);const t=new o.default({type:"opacity",minSliderValue:R.min,maxSliderValue:R.max});w.push(t)}if(t.includeSizeVariable){const e=new d.default({field:S,stops:[new f.default({value:R.min,size:r.minSize}),new f.default({value:R.max,size:r.maxSize})]});y.push(e);const t=new o.default({type:"size",minSliderValue:R.min,maxSliderValue:R.max,theme:"high-to-low"});w.push(t)}const A=new i.default({type:"flow",visualVariables:w.length?w:void 0,flowTheme:r.theme});return e.visualVariables=y,e.authoringInfo=A,e.legendOptions=c.A.from(t.legendOptions),{renderer:e,visualVariables:y.map((e=>e.clone())),flowScheme:(0,g.cloneScheme)(r),basemapId:a.basemapId,basemapTheme:a.basemapTheme,layerEffect:r.layerEffect,statistics:R}}async function S(e){e=await async function(e){const t=(0,r.A)({},e);return t.theme||(t.theme="flow-line"),(0,y.processRasterRendererParameters)(t)}(e);const t=(0,l.un)(e.layer.serviceRasterInfo);if(null==t)throw new s.default("flow-renderer:not-supported","Only vector data is supported");return w(t,e)}},95248:(e,t,a)=>{a.r(t),a.d(t,{cloneScheme:()=>g,getSchemeByName:()=>y,getSchemes:()=>f,getSchemesByTag:()=>v,getThemes:()=>h});var r=a(89379),n=a(69539),s=a(18690),i=a(39289),o=a(89132),l=a(770);const c={color:"#4c64c9",density:.8,layerEffect:"drop-shadow(1px, 1px, 3px, rgba(0,0,0,0.75))"},u={color:"#00ffff",density:.8,layerEffect:"bloom(1.4, 0.6px, 0)"},m={flowSpeed:10,trailLength:100,trailWidth:1,trailCap:"butt",minSize:1,maxSize:4},d={flowSpeed:3,trailLength:.7,trailWidth:8,trailCap:"butt",minSize:4,maxSize:16},p=(0,l.bG)({themeDictionary:{"flow-line":{name:"flow-line",label:"TODO",description:"TODO",schemes:{default:{light:{common:(0,r.A)((0,r.A)({},m),c),primary:"seq-lines-purple-brown",secondary:[...i.sequentialLightSchemes,...i.sequentialDarkSchemes].filter((e=>"seq-lines-purple-brown"!==e))},dark:{common:(0,r.A)((0,r.A)({},m),u),primary:"seq-mentone-beach",secondary:[...i.sequentialDarkSchemes,...i.sequentialLightSchemes].filter((e=>"seq-mentone-beach"!==e))}}}},"wave-front":{name:"wave-front",label:"TODO",description:"TODO",schemes:{default:{light:{common:(0,r.A)((0,r.A)({},d),c),primary:"seq-lines-purple-brown",secondary:[...i.sequentialLightSchemes,...i.sequentialDarkSchemes].filter((e=>"seq-lines-purple-brown"!==e))},dark:{common:(0,r.A)((0,r.A)({},d),u),primary:"seq-mentone-beach",secondary:[...i.sequentialDarkSchemes,...i.sequentialLightSchemes].filter((e=>"seq-mentone-beach"!==e))}}}}}});function h(e){return(0,l.vt)(p,e)}function f(e){const t=e.theme||"flow-line",a=(0,l.Fq)({basemap:e.basemap,basemapTheme:e.basemapTheme,theme:p.get(t)});if(!a)return;const{schemesInfo:n,basemapId:i,basemapTheme:o}=a,c=n.common,u=(0,r.A)((0,r.A)({},e),{},{basemap:i});return{primaryScheme:b(u,n.primary,c),secondarySchemes:n.secondary.map((e=>b(u,e,c))).filter(s.Ru),basemapId:i,basemapTheme:o}}function y(e){return(0,l.Ty)(e.name,f(e))}function v(e){return(0,l.YJ)(e.includedTags,e.excludedTags,f(e))}function g(e){if(!e)return;const t=(0,r.A)({},e);return t.colors=t.colors.map((e=>new n.default(e))),t.tags=[...t.tags],t.color&&(t.color=new n.default(t.color)),t}function b(e,t,a){const r=e.theme||"flow-line",s=o.A[t];if(!s)return;const i=s.stops;return{id:"".concat(r,"/").concat(e.basemap,"/").concat(t),name:s.name,tags:[...s.tags],theme:r,color:new n.default(a.color),colors:i.map((e=>new n.default(e))),density:a.density,flowSpeed:a.flowSpeed,trailLength:"wave-front"===r&&e.hasSizeVariable?2*a.trailLength:a.trailLength,trailWidth:a.trailWidth,trailCap:a.trailCap,layerEffect:a.layerEffect,minSize:a.minSize,maxSize:a.maxSize,minOpacity:.25,maxOpacity:1}}}}]);
//# sourceMappingURL=36201.507b2145.chunk.js.map