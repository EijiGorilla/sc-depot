"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[84841],{84841:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var i=s(35143),a=s(19276),l=s(54099),r=s(68134),n=s(46053),o=(s(81806),s(76460),s(47249),s(85842)),d=s(30545),c=s(50912);const m="view",h="basemap",v="base-layers",u="reference-layers",p="reference-layers-list-mode",y="base-layers-list-mode",b="base-layer-views",_="reference-layer-views",I="children",L=a.default.ofType(d.default);let f=class extends l.A.EventedAccessor{constructor(e){super(e),this.baseItems=new L,this.baseListItemCreatedFunction=null,this.checkPublishStatusEnabled=!1,this.listModeDisabled=!1,this.referenceListItemCreatedFunction=null,this.referenceItems=new L,this.view=null,this._compileBaseList=this._compileBaseList.bind(this),this._compileReferenceList=this._compileReferenceList.bind(this)}initialize(){this.addHandles([(0,r.watch)((()=>{var e,t,s;return[null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e?void 0:e.basemap,!0===(null===(t=this.view)||void 0===t?void 0:t.ready),null===(s=this.view)||void 0===s?void 0:s.basemapView]}),(()=>this._watchBasemapLayers()),r.initial),(0,r.watch)((()=>[this.baseListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._baseListItemCreatedFunctionChanged())),(0,r.watch)((()=>[this.referenceListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._referenceListItemCreatedFunctionChanged()))],m)}destroy(){this.view=null,this._removeAllBaseItems(),this._removeAllReferenceItems()}get basemapTitle(){var e,t;return null!==(e=null===(t=this.view)||void 0===t||null===(t=t.map)||void 0===t||null===(t=t.basemap)||void 0===t?void 0:t.title)&&void 0!==e?e:null}set basemapTitle(e){this._override("basemapTitle",e)}get state(){var e;return null!==(e=this.view)&&void 0!==e&&e.ready?"ready":this.view?"loading":"disabled"}get totalBaseItems(){return this.baseItems.flatten((e=>e.children)).length}get totalReferenceItems(){return this.referenceItems.flatten((e=>e.children)).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e){var t;let{targetItem:s,fromParentItem:i,toParentItem:a,from:l,to:r,newIndex:n}=e;const o=null===s||void 0===s?void 0:s.layer;if(!o||"subtype-sublayer"===o.type||"sublayer"===o.type)return;const d=null===(t=this.view)||void 0===t||null===(t=t.map)||void 0===t?void 0:t.basemap,m=null===d||void 0===d?void 0:d.baseLayers,h=null===d||void 0===d?void 0:d.referenceLayers,v=i?(0,c.ES)(i):"base"===l?m:h,u=a?(0,c.ES)(a):"base"===r?m:h;if(!v||!u)return;const{baseItems:p,referenceItems:y}=this,b="base"===l?p:y,_="base"===r?p:y,I=(null===i||void 0===i?void 0:i.children)||b,L=(null===a||void 0===a?void 0:a.children)||_,f=u.length-n;s.parent=a||null,I.remove(s),v.remove(o),L.includes(s)||L.add(s,f),u.includes(o)||u.add(o,f),this._compileLists()}_createItemChangeHandles(e){let{items:t,key:s,callback:i}=e;this.removeHandles(s),i(),t&&this.addHandles(t.on("change",(()=>i())),s)}_createListItem(e){let{layer:t,type:s}=e;const{view:i,baseListItemCreatedFunction:a,referenceListItemCreatedFunction:l,checkPublishStatusEnabled:r,listModeDisabled:n}=this;return new d.default({layer:t,checkPublishStatusEnabled:r,listItemCreatedFunction:"base"===s?a:l,listModeDisabled:n,view:i})}_watchLayersListMode(e){let{layers:t,key:s,callback:i}=e;this.removeHandles(s),t&&!this.listModeDisabled&&this.addHandles((0,r.watch)((()=>t.filter((e=>"listMode"in e)).map((e=>e.listMode)).toArray()),(()=>i())),s)}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter((e=>"hide"!==(0,c.Qv)(e))):void 0}_compileListItems(e){let{layers:t,items:s,key:i,type:a,callback:l}=e;this._watchLayersListMode({layers:t,key:i,callback:l});const r=this._getViewableLayers(t);null!==r&&void 0!==r&&r.length?(this._createNewItems({type:a,items:s,layers:r}),this._removeItems({items:s,layers:r}),this._sortItems(s,r)):"base"===a?this._removeAllBaseItems():this._removeAllReferenceItems()}_compileReferenceList(){var e;const{referenceItems:t}=this,s=null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.referenceLayers;this._compileListItems({type:"reference",layers:s,items:t,key:y,callback:this._compileReferenceList})}_compileBaseList(){var e;const{baseItems:t}=this,s=null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.baseLayers;this._compileListItems({type:"base",layers:s,items:t,key:p,callback:this._compileBaseList})}_compileLists(){this._compileReferenceList(),this._compileBaseList()}_createNewItems(e){let{items:t,layers:s,type:i}=e;null===s||void 0===s||s.forEach((e=>{t.some((t=>t.layer===e))||t.add(this._createListItem({type:i,layer:e}))}))}_removeItems(e){let{items:t,layers:s}=e;t&&t.forEach((e=>{if(!e)return;const i=null===s||void 0===s?void 0:s.some((t=>e.layer===t));i||(this.removeHandles("".concat(I,"-").concat(e.uid)),t.remove(e),e.destroy())}))}_sortItems(e,t){e&&t&&e.sort(((e,s)=>{const i=t.indexOf(e.layer),a=t.indexOf(s.layer);return i>a?-1:i<a?1:0}))}_removeAllBaseItems(){this.baseItems.drain((e=>{this.removeHandles("".concat(I,"-").concat(e.uid)),e.destroy()}))}_removeAllReferenceItems(){this.referenceItems.drain((e=>{this.removeHandles("".concat(I,"-").concat(e.uid)),e.destroy()}))}_baseListItemCreatedFunctionChanged(){this._removeAllBaseItems(),this._compileLists()}_referenceListItemCreatedFunctionChanged(){this._removeAllReferenceItems(),this._compileLists()}_watchBasemapLayers(){const{view:e}=this;if(this.removeHandles([v,u,h,b,_]),null===e||void 0===e||!e.ready)return this._removeAllBaseItems(),void this._removeAllReferenceItems();this._compileLists(),this.addHandles([(0,r.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.baseLayers}),(e=>this._createItemChangeHandles({items:e,key:v,callback:this._compileBaseList})),r.initial),(0,r.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.referenceLayers}),(e=>this._createItemChangeHandles({items:e,key:u,callback:this._compileReferenceList})),r.initial),(0,r.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.basemapView)||void 0===e?void 0:e.baseLayerViews}),(e=>this._createItemChangeHandles({items:e,key:b,callback:this._compileBaseList})),r.initial),(0,r.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.basemapView)||void 0===e?void 0:e.referenceLayerViews}),(e=>this._createItemChangeHandles({items:e,key:_,callback:this._compileReferenceList})),r.initial)],h)}};(0,i._)([(0,n.MZ)({type:L,readOnly:!0})],f.prototype,"baseItems",void 0),(0,i._)([(0,n.MZ)()],f.prototype,"basemapTitle",null),(0,i._)([(0,n.MZ)()],f.prototype,"baseListItemCreatedFunction",void 0),(0,i._)([(0,n.MZ)()],f.prototype,"checkPublishStatusEnabled",void 0),(0,i._)([(0,n.MZ)({nonNullable:!0})],f.prototype,"listModeDisabled",void 0),(0,i._)([(0,n.MZ)()],f.prototype,"referenceListItemCreatedFunction",void 0),(0,i._)([(0,n.MZ)({type:L,readOnly:!0})],f.prototype,"referenceItems",void 0),(0,i._)([(0,n.MZ)({readOnly:!0})],f.prototype,"state",null),(0,i._)([(0,n.MZ)()],f.prototype,"totalBaseItems",null),(0,i._)([(0,n.MZ)()],f.prototype,"totalReferenceItems",null),(0,i._)([(0,n.MZ)()],f.prototype,"view",void 0),f=(0,i._)([(0,o.$)("esri.widgets.BasemapLayerList.BasemapLayerListViewModel")],f);const w=f}}]);
//# sourceMappingURL=84841.a4489051.chunk.js.map