"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[21964,26417,40998,63733,64826,89646,91329,95327],{2504:(e,t,r)=>{r.r(t),r.d(t,{default:()=>X});var i=r(89379),l=r(35143),a=r(55171),s=r(19276),o=r(63241),n=r(50076),u=r(54099),c=r(76460),d=r(68134),h=r(46053),p=(r(81806),r(47249),r(85842)),y=r(19902),g=r(63860),v=r(30907),f=r(63733),m=r(72599),w=r(31933),b=r(14147),_=r(78715),A=r(24883),k=r(96422),R=r(40998),I=r(91329),G=r(64826),S=r(69120),L=r(63391),T=r(23701),F=r(9624),M=r(13312);function N(e){return"polygon"===e.type||"polyline"===e.type}class O{createBuffer(e,t,r,i){if(Array.isArray(e)){if(e.length>0){const l=M.default.fromJSON(e[0].spatialReference);return l.isWGS84||l.isWebMercator?(0,L.geodesicBuffer)(e,t,r,i):(0,L.buffer)(e,t,r,i)}return}const l=M.default.fromJSON(e.spatialReference);return l.isWGS84||l.isWebMercator?(0,L.geodesicBuffer)(e,t[0],r):(0,L.buffer)(e,t[0],r)}createConvexHull(e){if(Array.isArray(e)){if(1===e.length&&function(e){return function(e){return e.hasOwnProperty("points")}(e)&&2===e.points.length}(e[0])){const t=(0,L.convexHull)(e[0]);if(N(t))return t}return(0,L.convexHull)(e,!0).filter(N)}const t=(0,L.convexHull)(e);if(N(t))return t}calculateArea(e,t){const r=new M.default({wkid:e.spatialReference.wkid});return r.isWGS84||r.isWebMercator?parseFloat((0,L.geodesicArea)(e,t).toFixed(2)):parseFloat((0,L.planarArea)(e,t).toFixed(2))}mergeAggregatedToGeometries(e){const t=[],{line:r,multipoint:i,polygon:l}=e;return r&&t.push(r),i&&t.push(i),l&&t.push(l),t}getPercentageAlong(e,t,r){let i=e;const l=this._createPolyline(e.paths,r.wkid);if("point"===t.type){const e=t.x-.5,a=t.x+.5,s=[[[e,t.y-.5],[a,t.y+.5]]];i=this._createPolyline(s,t.spatialReference.wkid),i=(0,F.project)(i,r);const o=(0,L.cut)(l,i);if(o.length>0){const e=(0,L.planarLength)(l,"feet");let t;return t=o[0].paths[0][0][0]===l.paths[0][0][0]?(0,L.planarLength)(o[0],"feet"):(0,L.planarLength)(o[1],"feet"),[t/e]}return[.5]}i=(0,F.project)(t,r);const a=(0,L.cut)(l,i);if(a.length>0){const e=(0,L.planarLength)(l,"feet");return[(0,L.planarLength)(a[0],"feet")/e]}return[.5]}async projectGeometry(e,t){return await(0,F.load)(),(0,F.project)(e,t)}_createPolyline(e,t){return new T.default({hasZ:!1,hasM:!0,paths:e,spatialReference:new M.default({wkid:t})})}}var C=r(94560),P=r(39356),B=r(73204),H=r(40585),U=r(86875);const V="utility-network-trace-result-area-".concat(Date.now());function E(e){return"graphics"===e.type}class Z{constructor(){this.traceInformation={},this._geometryHandler=new O}addResultAreaToMap(e,t){const r=this.createGraphicLayer(t);r&&E(r)&&r.add(e)}changeResultAreaColor(e,t,r){const i=new U.default({color:t.color,style:"solid",outline:{color:t.color,width:1}}),l=this._findGraphicsByTraceId(e,r);return l&&l.forEach((e=>{e.symbol=i})),i}createBuffer(e,t,r,i){return this._geometryHandler.createBuffer(e,t,r,i)}createConvexHull(e,t,r){const i=this._geometryHandler.createConvexHull(e);return t>0&&i?this.createBuffer(i,[t],r,!1):i}createResultAreaGraphic(e,t,r,i,l,a){const s=new U.default({color:a.color,style:"solid",outline:{color:a.color,width:1}}),o=[];for(const u in t){var n;o.push(new H.default({fieldName:u,label:"areaStatistic"===u?i.attributeStrings[u]+" ("+(null===(n=l.units[r])||void 0===n?void 0:n.abbr)+")":i.attributeStrings[u]}))}return new P.default({geometry:e,symbol:s,attributes:t,popupTemplate:new B.default({title:t.traceName,content:[{type:"fields",fieldInfos:o}]})})}removeResultArea(e,t){const r=t.findLayerById(V);if(r&&E(r)){const i=this._findGraphicsByTraceId(e,t);return i&&r.removeMany(i),i}return null}removeAllResultAreaGraphics(e){if(e){const t=e.findLayerById(V);t&&E(t)&&t.removeAll()}}createGraphicLayer(e,t){const r=e.findLayerById(V);if(r&&E(r))return r;const i=new f.default({title:null!==t&&void 0!==t?t:V,listMode:"hide",id:V});return e.add(i),i}_findGraphicsByTraceId(e,t){const r=t.findLayerById(V);if(r&&E(r)){const t=r.graphics.filter((t=>t.attributes.traceId===e));return t.length>0?t.toArray():null}return null}}function x(e){return"feature"===e.type}function D(e,t){return e.url.includes(t)}function j(e,t){var r;return((null===(r=e.dataElement)||void 0===r?void 0:r.domainNetworks)||[]).some((e=>e.subnetworkLayerId===t.layerId))}class q{getValidUtilityNetworkLayers(e,t){const r=[];return null!==e&&void 0!==e&&e.allLayers.forEach((e=>{"group"===e.type?r.push(...e.layers.filter(w.yZ).filter((e=>x(e)&&t.isUtilityLayer(e)&&!j(t,e))).filter((e=>D(e,t.featureServiceUrl))).toArray()):"subtype-group"===e.type?r.push(...e.sublayers.filter((e=>D(e,t.featureServiceUrl))).toArray()):(0,w.yZ)(e)&&x(e)&&t.isUtilityLayer(e)&&!j(t,e)&&D(e,t.featureServiceUrl)&&r.push(e)})),r}}const J="utility-network-trace-flags-".concat(Date.now()),z="utility-network-trace-results-".concat(Date.now()),W="utility-network-trace-sketch-".concat(Date.now());function $(e){return void 0!==e.layerViews}function K(e){return"feature"===e.type||"subtype-group"===e.type||"group"===e.type}let Y=class extends u.A.EventedAccessor{constructor(e){super(e),this._activeProgress=!1,this._clickHandler=null,this._flags=[],this._flagId=0,this._geometryHandler=null,this._highlightHandler=[],this._resultAreaHandler=null,this._sketchViewModel=null,this._traceTimeout=6e5,this._utilityHelper=new q,this._validUNLayers=[],this._watchHandler=null,this.traces=[],this.graphicHandler=null,this.defaultGraphicColor={color:[255,255,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#FFFF00"},this.enableResultArea=!1,this.flags=[],this.gdbVersion="sde.DEFAULT",this.messages=null,this.messagesUnits=null,this.defaultResultAreaProperties={type:"convexhull",distance:10,unit:"meters",areaUnit:"square-meters",color:{color:[255,165,0,.5],haloOpacity:.9,fillOpacity:.2,hex:"#ffa500"},show:!1},this.selectedTraces=[],this.selectOnComplete=!0,this.showGraphicsOnComplete=!0,this.showSelectionAttributes=!0,this.traceResults=[],this.utilityNetwork=null}initialize(){(0,o.eO)(c.A.getLogger(this),"gdbVersion will be removed and the gdbVersion of the UtilityNetwork will be consumed directly.",{replacement:"UtilityNetwork.gdbVersion",version:"4.31"}),this._geometryHandler=new O,this.graphicHandler=new C.pC,this._resultAreaHandler=new Z,(async()=>{const[e,t]=await Promise.all([(0,g.ud)("esri/widgets/UtilityNetworkTrace/t9n/UtilityNetworkTrace"),(0,g.ud)("esri/core/t9n/Units")]);this.set({messages:e,messagesUnits:t})})()}destroy(){this.view=null}get resultAreaProperties(){return this.defaultResultAreaProperties}set resultAreaProperties(e){this._set("resultAreaProperties",(0,i.A)((0,i.A)({},this.defaultResultAreaProperties),e)),this.graphicHandler.addCustomColor(this.resultAreaProperties.color),this.traceResults.forEach((t=>{var r;const l=null===(r=t.resultArea)||void 0===r?void 0:r.show;t.resultArea=(0,i.A)((0,i.A)({},this.defaultResultAreaProperties),e),this.removeResultAreaFromMap(t),this.enableResultArea&&this.createResultAreaGraphic(t).then((r=>{if(r){var i;t.resultAreaGraphic=r;const a=null!==(i=null===e||void 0===e?void 0:e.show)&&void 0!==i?i:l;t.resultArea&&(t.resultArea.show=a),a&&this.addResultAreaToMap(t,r)}}))}))}get state(){var e;return null!==(e=this.view)&&void 0!==e&&e.ready?"ready":"loading"}get view(){return this._get("view")}set view(e){e&&"2d"!==e.type&&c.A.getLogger(this).error(new n.default("view:invalid-view","SceneView is not supported",{view:e})),this._set("view",e),this.utilityNetwork&&this.reset(),this.utilityNetwork=null,this.loadUtilityNetwork().then((e=>{e&&this.selectTracesOnLoad()}))}addFlagByHit(e,t){const r=!!this.view&&this.view.popupEnabled,i=e=>{var t;(null===(t=this.view)||void 0===t?void 0:t.popup)&&(this.view.popupEnabled=e)};return new Promise(((l,a)=>{var s;r&&i(!1),null!==(s=this._clickHandler)&&void 0!==s&&s.remove(),this._clickHandler=this._sketchViewModel.on("create",(s=>{if("complete"===s.state){const o=this._getGraphicLayer(W);o&&s.graphic&&o.remove(s.graphic),this.queryFlagByHitTest(s,e,t).then((r=>{this.emit("add-flag-complete",{type:e,symbol:t}),l(r)})).catch((r=>{this.emit("add-flag-error",{type:e,symbol:t}),a(r)})).finally((()=>{var e;r&&i(!0),null===(e=this._clickHandler)||void 0===e||e.remove()}))}})),this._sketchViewModel.create("point"),this.emit("add-flag",{type:e})}))}addNonspatialTraceLocation(e,t){var r;const l=this._getDisplayField(e),a=null===(r=this.utilityNetwork)||void 0===r?void 0:r.getTerminalConfiguration(e),s={terminalId:null,isFilterBarrier:!1,allTerminals:a,selectedTerminals:[a?a.terminals[0].id||null:1],displayValue:l};e.attributes=(0,i.A)((0,i.A)({},e.attributes),s);const o=e.attributes.hasOwnProperty("GLOBALID")?e.attributes.GLOBALID:e.attributes.globalid;if(!this._flags.some((e=>e.globalId===o&&e.type===t))){const r=this._createFlagProperty(e,t,null);this._flags.push(r),this.emit("add-flag-complete",{type:t})}this.emit("add-flag",{type:t})}async addFlagsOnLoad(){return this._flags.length>0?[]:(await(0,d.whenOnce)((()=>null!=this.view&&!this.view.updating)),(await Promise.all(this.flags.map((async e=>{if(!e.mapPoint)return null;const{type:t}=e,r=e.mapPoint.clone(),i="barrier"===t?C.XU:C.KM,l={graphic:this.graphicHandler.makeGraphic(r,i),state:"complete",tool:"point",toolEventInfo:null,type:"create"};try{return await this.queryFlagByHitTest(l,e.type,null),this.emit("add-flag-complete",{type:t}),null}catch(j){return this.emit("add-flag-error",{type:t}),"barrier"===t?"barrier":"starting-point"}})))).filter((e=>!e)))}async addResultAreaToMap(e,t){var r;if(this.view)if(e.resultArea.show=!0,t)null!==(r=this._resultAreaHandler)&&void 0!==r&&r.addResultAreaToMap(t,this.view.map),this.emit("add-result-area",{graphic:t});else if(e.results){var i;const t=await this.createResultAreaGraphic(e);t&&(e.resultAreaGraphic=t,null!==(i=this._resultAreaHandler)&&void 0!==i&&i.addResultAreaToMap(t,this.view.map),this.emit("add-result-area",{graphic:t}))}}async addResultGraphicToView(e,t){const{view:r}=this,{results:i}=e;if(r&&i&&this.utilityNetwork)for(const a in i.aggregatedGeometry)if("line,multipoint,polygon".includes(a)){const s=a,o=i.aggregatedGeometry[s];if(null!=o){o.spatialReference=this.utilityNetwork.spatialReference,e.graphicEnabled=!0;const i=await this._geometryHandler.projectGeometry(o,r.spatialReference),a={globalid:e.trace.globalId};if(null!==i){var l;const e=this.graphicHandler.makeGraphic(i,t.color,a,r.spatialReference);null===(l=this._getGraphicLayer(z))||void 0===l||l.add(e)}}}}addTerminal(e,t){const r=[...this._flags];r.forEach((r=>{var i,l;r.globalId===t.globalId&&((null===(i=t.selectedTerminals)||void 0===i?void 0:i.includes(parseInt(e,10)))||null===(l=r.selectedTerminals)||void 0===l||l.push(parseInt(e,10)))})),this._flags=r}async callTrace(){const e=this.traces.filter((e=>e.selected));return!!e.length&&(this.traceResults.length>0&&this.traceResults.forEach((e=>{this.removeResultGraphicFromView(e)})),this.traceResults=[],this.removeSelection(),await Promise.all(e.map((async(e,t)=>{var r,l,a;const s=e,o=new G.default({gdbVersion:null===(r=this.utilityNetwork)||void 0===r?void 0:r.gdbVersion,moment:null===(l=this.utilityNetwork)||void 0===l?void 0:l.historicMoment,namedTraceConfigurationGlobalId:s.globalId,outSpatialReference:null,resultTypes:null,traceType:s.traceType,traceLocations:this._flags,traceConfiguration:null});await this.executeTrace(s,null===(a=this.utilityNetwork)||void 0===a?void 0:a.networkServiceUrl,o).then((e=>{if(e.hasOwnProperty("results")){const r=(0,i.A)({},e);if(null!==r.results){r.resultArea=(0,i.A)({},this.resultAreaProperties);const e=[...r.results.elements];r.results.elements.length=0;const l=new Map;for(const t of e)l.has(t.globalId)||(l.set(t.globalId,!0),r.results.elements.push(t));const a=[...this.traceResults];a.splice(t,0,r),this.traceResults=a,null!==r.results&&(this.selectOnComplete&&this.mergeSelection(!0,r.trace),this.showGraphicsOnComplete&&this.addResultGraphicToView(r,r.graphicColor),this.enableResultArea&&this.createResultAreaGraphic(r).then((e=>{var t;e&&(r.resultAreaGraphic=e,(null===(t=r.resultArea)||void 0===t?void 0:t.show)&&this.addResultAreaToMap(r,r.resultAreaGraphic))})))}else{const r=[...this.traceResults];r.splice(t,0,e),this.traceResults=r}this._activeProgress=!1}else{this._activeProgress=!1;const r=[...this.traceResults];r.splice(t,0,e),this.traceResults=r}})).catch((e=>{throw this._activeProgress=!1,e}))}))),!0)}cancelAddFlagByHit(){this._sketchViewModel.cancel()}changeResultAreaColor(e,t){var r;if(!e.resultArea)return;e.resultArea.color=t;const i=null===(r=this._resultAreaHandler)||void 0===r?void 0:r.changeResultAreaColor(e.trace.globalId,t,this.view.map);e.resultAreaGraphic&&(e.resultAreaGraphic.symbol=i)}changeResultGraphicColor(e,t){const r=[...this.traceResults];r.length>0&&r.forEach((r=>{r.trace.globalId===t.trace.globalId&&(r.graphicColor=e,r.graphicEnabled=!0)})),this.traceResults=r,this.removeResultGraphicFromView(t),this.addResultGraphicToView(t,e)}changeFlagSymbol(e,t){this._flags.length>0&&this._flags.forEach((r=>{r.type===e&&t&&r.mapGraphic&&(r.mapGraphic.symbol=t)}))}checkCanTrace(){const e={status:!0,issues:[]},t=this.traces.filter((e=>e.selected));return t.length||(e.status=!1,e.issues.push("noTracesSelected")),this._flags.some((e=>"starting-point"===e.type))||(e.status=!1,e.issues.push("noStartingPoints")),this._flags.filter((e=>null!==e.allTerminals)).some((e=>!e.selectedTerminals.length))&&(e.status=!1,e.issues.push("noTerminalSelected")),e}checkSelectionExist(){return this._highlightHandler.some((e=>e))}clearResult(e){if(!this.view)return;let t=this.traceResults;if(t.length>0){const r=t.filter((t=>t.trace.globalId===e.globalId));r.length>0&&(this.removeResultGraphicFromView(r[0]),this.removeResultAreaFromMap(r[0])),t=t.filter((t=>t.trace.globalId!==e.globalId))}this.traceResults=t,0===t.length?(this.removeAllResultAreaGraphics(),this.removeSelection(),this.emit("clear-selection",{resultSet:[]})):this.mergeSelection(!1,e)}createResultAreaGeometries(e,t,r){var i,l,a,s,o,n,u,c,d,h,p;if(!this.view||!this.resultAreaProperties)return;let g;if(g="convexhull"===(null===(i=this.resultAreaProperties)||void 0===i?void 0:i.type)?1===t.length&&((0,y.isPoint)(t[0])||(0,y.isMultipoint)(t[0])&&1===t[0].points.length)?null===(l=this._resultAreaHandler)||void 0===l?void 0:l.createBuffer(t,r,null===(a=e.resultArea)||void 0===a?void 0:a.unit,!0):null===(s=this._resultAreaHandler)||void 0===s?void 0:s.createConvexHull(t,null===(o=e.resultArea)||void 0===o?void 0:o.distance,null===(n=e.resultArea)||void 0===n?void 0:n.unit):null===(u=this._resultAreaHandler)||void 0===u?void 0:u.createBuffer(t,r,null===(c=e.resultArea)||void 0===c?void 0:c.unit,!0),!g)return;if(Array.isArray(g)){for(const t of g){var v,f,m;const r=this.getResultAreaAttributes(e,t),i=null===(v=this._resultAreaHandler)||void 0===v?void 0:v.createResultAreaGraphic(t,r,null===(f=e.resultArea)||void 0===f?void 0:f.areaUnit,this.messages,this.messagesUnits,null===(m=e.resultArea)||void 0===m?void 0:m.color);if(i)return i}return}const w=this.getResultAreaAttributes(e,g);return null===(d=this._resultAreaHandler)||void 0===d?void 0:d.createResultAreaGraphic(g,w,null===(h=e.resultArea)||void 0===h?void 0:h.areaUnit,this.messages,this.messagesUnits,null===(p=e.resultArea)||void 0===p?void 0:p.color)}async createResultAreaGraphic(e){if(e.results){const r=await this._createResultAreaInputGeometry(e.results);if(r.length>0){var t;const i=Array(r.length).fill(null===(t=e.resultArea)||void 0===t?void 0:t.distance),l=this.createResultAreaGeometries(e,r,i);return this.emit("create-result-area",{graphic:l}),l}}}executeTrace(e,t,r){const i=this._processFlags(r.traceLocations);return r.traceLocations=i,(0,R.trace)(t,r,{timeout:this._traceTimeout}).then((t=>({trace:e,results:t,selectionEnabled:!1,graphicEnabled:!1,graphicColor:this.defaultGraphicColor,status:"success",date:new Date}))).catch((t=>({trace:e,results:null,selectionEnabled:!1,graphicEnabled:!1,graphicColor:this.defaultGraphicColor,status:t.message,date:new Date})))}async getNonspatialTraceLocationInitialFeature(){return new Promise(((e,t)=>{var r;null!==(r=this._clickHandler)&&void 0!==r&&r.remove(),this._clickHandler=this._sketchViewModel.on("create",(async r=>{var i,l,a;if("complete"!==r.state)return;const s=this._getGraphicLayer(W);s&&r.graphic&&s.remove(r.graphic);const o=null===(i=this.view)||void 0===i?void 0:i.toScreen(null===(l=r.graphic)||void 0===l?void 0:l.geometry);if(!o)return;const n=await(null===(a=this.view)||void 0===a?void 0:a.hitTest(o));if(null!==n&&void 0!==n&&n.results.length){const r=n.results.find((e=>{var t;return"graphic"===e.type&&(null===(t=this.utilityNetwork)||void 0===t?void 0:t.isUtilityLayer(e.layer))}));r?e(r):t(null)}})),this._sketchViewModel.create("point")}))}getResultAreaAttributes(e,t){var r,i,l,s;const{messages:o}=this,n=[],u=[];this._flags.forEach((e=>{var t,r,i,l;const a=(null===(t=e.displayValue)||void 0===t?void 0:t.field)+":"+(null===(r=e.displayValue)||void 0===r?void 0:r.value)+";"+o.attributeStrings.globalid+":"+e.globalId+";"+o.attributeStrings.terminalid+":"+e.terminalId+";"+o.attributeStrings.x+":"+(null===(i=e.mapPoint)||void 0===i?void 0:i.x)+";"+o.attributeStrings.y+":"+(null===(l=e.mapPoint)||void 0===l?void 0:l.y);"starting-point"===e.type?n.push(a):u.push(a)}));const c=this.utilityNetwork?this.utilityNetwork.gdbVersion:this.gdbVersion;return{traceId:e.trace.globalId,traceName:e.trace.title,traceDescription:null!==(r=e.trace.description)&&void 0!==r?r:"",startingPoints:n.toString(),barriers:u.toString(),version:null!==c&&void 0!==c?c:void 0,username:a.id.credentials[0].userId,date:e.date,elementCount:null===(i=e.results)||void 0===i?void 0:i.elements.length,functionResult:JSON.stringify(null===(l=e.results)||void 0===l?void 0:l.globalFunctionResults),areaStatistic:t?this._geometryHandler.calculateArea(t,null===(s=e.resultArea)||void 0===s?void 0:s.areaUnit):0}}getValidSources(){var e,t;let r=[];const i=null!==(e=null===(t=this.utilityNetwork)||void 0===t||null===(t=t.dataElement)||void 0===t?void 0:t.domainNetworks)&&void 0!==e?e:[];for(const l of i)r=r.concat(l.junctionSources),r=r.concat(l.edgeSources);return r}groupResultsByNetworkSource(e){return 0===e.length?[]:this._groupBy(e,"networkSourceId")}async loadUtilityNetwork(){var e;const{view:t}=this;if(!t)return null;if(await t.when(),this.utilityNetwork){if(this.utilityNetwork.loaded||await this.utilityNetwork.load(),this.utilityNetwork instanceof b.default){try{const e=t.map;await e.loadAll()}catch(Z){if("layer:unsupported-layer-type"!==Z.name)throw Z}finally{this._loadUNSupportItems()}return this.utilityNetwork}return null}const r=t.map,i=null===(e=r.utilityNetworks)||void 0===e?void 0:e.at(0);if(i){if(await i.load(),this.utilityNetwork=i,!await async function(e){const t=new v.default({url:e.networkSystemLayers.dirtyAreasLayerUrl});await t.load();const r=t.version;if(Number(r)<=11.1){var i;const t=await(0,w.wI)(e.layerUrl),r=new A.default({url:t});await r.load();const l=null===r||void 0===r||null===(i=r.user)||void 0===i?void 0:i.username;return!!l&&(0,k.RE)(r,l,"utilityNetwork")}return!0}(i))throw new n.default("utility-network:no-user-type-extension","User type extension not found");try{await r.loadAll()}catch(Z){if("layer:unsupported-layer-type"!==Z.name)throw Z}finally{this._loadUNSupportItems()}return i}return null}manageFilterBarrier(e,t){const r=[...this._flags];r.forEach((r=>{r.globalId===t.globalId&&"barrier"===t.type&&r.id===t.id&&(r.isFilterBarrier=e)})),this._flags=r}mergeSelection(e,t){let r=[];const i=[...this.traceResults],l=t.globalId;i.forEach((t=>{var i,a,s;l===t.trace.globalId&&(t.selectionEnabled=e),t.selectionEnabled&&null!==(null===(i=t.results)||void 0===i?void 0:i.elements)&&(r=[...r,...null!==(a=null===(s=t.results)||void 0===s?void 0:s.elements)&&void 0!==a?a:[]])})),this.selectResults([...new Set(r)])}async queryFeaturesById(e){var t,r;const{view:i}=this;if(!i||!this.utilityNetwork)return null;const l=this.utilityNetwork.getObjectIdsFromElements(e),a={layerUrl:l[0].layerUrl,objectIds:l[0].objectIds,outFields:["*"]},o=null!==(t=null===(r=i.map)||void 0===r?void 0:r.allTables.toArray().filter((e=>{var t;return(null===e||void 0===e||null===(t=e.parsedUrl)||void 0===t?void 0:t.path)===l[0].layerUrl})).filter(w.yZ))&&void 0!==t?t:[];this._getUniqueMapLayerViews(i).filter((e=>{var t;let{layer:r}=e;return(null===r||void 0===r||null===(t=r.parsedUrl)||void 0===t?void 0:t.path)===l[0].layerUrl})).forEach((e=>{let{layer:t}=e;"feature"!==t.type&&"subtype-group"!==t.type||o.push(t)}));const n=(await Promise.all(o.map((async e=>{const t={layers:new s.default([e]),layerInfos:[a],returnGeometry:!0,outSpatialReference:i.spatialReference},[r]=await(0,_.s)(t,!1);return r})))).filter((e=>{let{featureSet:t}=e;return t.features.length>0}));return n.length>0?n:null}queryFlagByHitTest(e,t,r){return this._lookupFlagByHit(e).then((e=>{const{view:i}=this;if(!i)return!1;if(e.length>0){const i=[...this._flags],l=r;return e.forEach((e=>{const r=e.graphic,a=r.attributes.hasOwnProperty("GLOBALID")?r.attributes.GLOBALID:r.attributes.globalid;if(i.filter((e=>e.globalId===a)).length<=0){var s;const e=this.graphicHandler.getFlagGraphic(r.attributes.mapPoint,t,r,l);null===(s=this._getGraphicLayer(J))||void 0===s||s.add(e);const a=this._createFlagProperty(r,t,e);i.push(a)}else if(null!==r.attributes.percentAlong){var o;const e=this.graphicHandler.getFlagGraphic(r.attributes.mapPoint,t,r,l);null===(o=this._getGraphicLayer(J))||void 0===o||o.add(e);const a=this._createFlagProperty(r,t,e);i.push(a)}})),this._flags=i,!0}return!1}))}removeResultGraphicFromView(e){var t;const{view:r}=this;if(!r)return;const i=null===(t=this._getGraphicLayer(z))||void 0===t?void 0:t.graphics;e.graphicEnabled=!1;const l=null===i||void 0===i?void 0:i.filter((t=>t.attributes[t.attributes.hasOwnProperty("GLOBALID")?"GLOBALID":"globalid"]===e.trace.globalId));null===l||void 0===l||l.forEach((e=>{var t;null===(t=this._getGraphicLayer(z))||void 0===t||t.remove(e)}))}removeFlag(e){const t=this._flags.filter((t=>{if(t.id!==e.id)return t}));this._removeGraphic(e),this._flags=t}removeAllResultAreaGraphics(){var e;null===(e=this._resultAreaHandler)||void 0===e||e.removeAllResultAreaGraphics(this.view.map)}removeResultAreaFromMap(e){if(e.resultArea){var t,r;e.resultArea.show=!1;const i=null===(t=this._resultAreaHandler)||void 0===t?void 0:t.removeResultArea(e.trace.globalId,null===(r=this.view)||void 0===r?void 0:r.map);i&&this.emit("remove-result-area",{graphic:i})}}removeSelection(){this._highlightHandler.forEach((e=>{e&&e.remove()})),this._highlightHandler=[]}removeTerminal(e,t){const r=[...this._flags];r.forEach((r=>{var i;if(r.globalId===t.globalId&&null!==(i=t.selectedTerminals)&&void 0!==i&&i.includes(parseInt(e,10))){var l;const i=t.selectedTerminals.indexOf(parseInt(e,10));null===(l=r.selectedTerminals)||void 0===l||l.splice(i,1)}})),this._flags=r}removeFlagsOnLoadWatcher(){this._watchHandler&&null!==this._watchHandler&&this._watchHandler.remove()}removeClickHandler(){this._clickHandler&&(this._sketchViewModel.cancel(),this._clickHandler.remove())}reset(){var e,t,r;this._flags=[],this.traceResults=[];const i=[...this.traces];i.forEach((e=>{e.selected=!1})),this.traces=i,this.view&&(null!==(e=this._getGraphicLayer(W))&&void 0!==e&&e.removeAll(),null!==(t=this._getGraphicLayer(J))&&void 0!==t&&t.removeAll(),null!==(r=this._getGraphicLayer(z))&&void 0!==r&&r.removeAll(),this.removeAllResultAreaGraphics(),this.removeSelection(),this.emit("clear-selection",{resultSet:[]}),this.emit("reset"))}selectFeaturesById(e){const{view:t}=this;if(!t||!this.utilityNetwork)return;const r=this.utilityNetwork.getObjectIdsFromElements(e);this._getUniqueMapLayerViews(t).forEach((e=>{var t;(function(e){return"layer"in e})(e)&&(null===(t=e.layer)||void 0===t||null===(t=t.parsedUrl)||void 0===t?void 0:t.path)===r[0].layerUrl&&function(e){return"feature"===e.layer.type||"subtype-group"===e.layer.type}(e)&&this._highlightHandler.push(e.highlight(r[0].objectIds))}))}selectResults(e){if(e.length>0){this.removeSelection();const t=this.groupResultsByNetworkSource(e),r=[];for(const e in t)this.selectFeaturesById(t[e]),r.push(this.queryFeaturesById(t[e]));Promise.all(r).then((e=>{this.emit("select-features",{resultSet:e})}))}else this.removeSelection(),this.emit("clear-selection",{resultSet:[]})}selectTraces(e,t){const r=[...this.traces];r.forEach((r=>{t===r.globalId&&(r.selected=e)})),this.traces=r}selectTracesOnLoad(){var e;(null===(e=this.utilityNetwork)||void 0===e?void 0:e.hasOwnProperty("sharedNamedTraceConfigurations"))&&(this.traces=[...this.utilityNetwork.sharedNamedTraceConfigurations],this.traces.forEach((e=>{e.selected=!1,this.selectedTraces.includes(e.globalId)&&(e.selected=!0)})))}zoomToAsset(e){var t;null===(t=this.view)||void 0===t||t.goTo(e).catch((e=>console.error(e)))}async _createResultAreaInputGeometry(e){if(null!=e.aggregatedGeometry)return this._geometryHandler.mergeAggregatedToGeometries(e.aggregatedGeometry);const t=this.groupResultsByNetworkSource(e.elements),r=[];for(const l in t)r.push(this.queryFeaturesById(t[l]));try{const e=await Promise.all(r),t=[];for(const r of e)if(r)for(const e of r)for(const r of e.featureSet.features)r.geometry&&t.push(r.geometry);return t}catch(i){return[]}}_loadUNSupportItems(){var e;if(!this.utilityNetwork)return;const{map:t}=this.view,{messages:r}=this;this._populateOutfields(),this._createGraphicLayer(W),this._createGraphicLayer(J),this._createGraphicLayer(z),null!==(e=this._resultAreaHandler)&&void 0!==e&&e.createGraphicLayer(t,null===r||void 0===r?void 0:r.alertsStrings.genericResultHeader),this._validUNLayers=this._utilityHelper.getValidUtilityNetworkLayers(t,this.utilityNetwork),this._sketchViewModel=this.graphicHandler.initializeSketch(this.view,this._getGraphicLayer(W),this._validUNLayers)}_getUniqueMapLayerViews(e){const t=[],r=e.layerViews.filter((e=>{let{layer:{type:t}}=e;return"feature"===t||"group"===t||"subtype-group"===t})).toArray(),i=e=>{for(const r of e.layerViews)$(r)?i(r):t.push(r)};return r.forEach((e=>{switch(e.layer.type){case"group":$(e)&&i(e);break;case"subtype-group":t.push(e);break;default:t.some((t=>t.layer.id===e.layer.id))||t.push(e)}})),t}_processFlags(e){const t=[];return e.forEach((e=>{if(null!==e.selectedTerminals&&e.selectedTerminals.length>0)e.selectedTerminals.forEach((r=>{const i=new I.default({globalId:e.globalId,percentAlong:e.percentAlong,terminalId:r,type:e.type,isFilterBarrier:e.isFilterBarrier});t.push(i)}));else{const r=new I.default({globalId:e.globalId,percentAlong:e.percentAlong,type:e.type,isFilterBarrier:e.isFilterBarrier});t.push(r)}})),t}_getDisplayField(e){var t;return"subtype-sublayer"===(null===e||void 0===e||null===(t=e.layer)||void 0===t?void 0:t.type)?this._getDisplayFieldBySublayer(e):this._getDisplayFieldByFeatureLayer(e)}_getDisplayFieldBySublayer(e){let t="",r="";const i=e.layer;t=this._checkParentForData(i,"displayField");for(const a in e.attributes){var l;const s=a.toLowerCase();s===(null===(l=t)||void 0===l?void 0:l.toLowerCase())?(r=e.attributes[a],"assetgroup"===s||"assettype"===s?r=this._checkSubtype(i,i.subtypeCode):(r=this._checkDomain(i.fields,a,r),"string"==typeof r&&(r=this._defaultDisplayField(r,i)))):(r=this._checkDomain(i.fields,a,r),"string"==typeof r&&(r=this._defaultDisplayField(r,i)))}return{field:t,value:r.toString()}}_getDisplayFieldByFeatureLayer(e){const t=e.layer;let r=t.displayField,i="";for(const o in e.attributes){var l;const n=o.toLowerCase();if(n===(null===(l=r)||void 0===l?void 0:l.toLowerCase()))if(i=e.attributes[o],"assetgroup"===n||"assettype"===n){var a,s;let l=e.attributes[t.typeIdField.toUpperCase()];l||(l=e.attributes[t.typeIdField.toLowerCase()]),r=t.typeIdField,i=this._checkSubtype(t,l),""===r&&(t.templates&&t.templates.length>0?(r=null===(a=t.templates[0])||void 0===a?void 0:a.name,i=null===(s=t.templates[0])||void 0===s?void 0:s.name):(r=t.displayField,i=e.attributes[o]))}else i=this._checkDomain(t.fields,o,i),"string"==typeof i&&(i=this._defaultDisplayField(i,t));else i=this._checkDomain(t.fields,o,i),"string"==typeof i&&(i=this._defaultDisplayField(i,t))}return{field:r,value:i?i.toString():""}}_checkSubtype(e,t){let r=t;if("subtype-sublayer"===e.type){const i=this._checkParentForData(e,"subtypes");(null===i||void 0===i?void 0:i.length)>0&&i.forEach((e=>{e.code===t&&(r=e.name)}))}else if(null!=e.types&&e.types.length>0){const i=e.types.filter((e=>e.id===t));i.length>0&&(r=i[0].name)}return r}_checkDomain(e,t,r){var i;let l=r;const a=e.filter((e=>e.name.toLowerCase()===t.toLowerCase()));if(a.length>0&&function(e){return e instanceof m.default}(a[0].domain)&&null!==(i=a[0].domain)&&void 0!==i&&i.codedValues){const e=a[0].domain.codedValues.filter((e=>{let{code:t}=e;return t===r}));e.length>0&&(l=e[0].name)}return l}_checkParentForData(e,t){var r,i;return null!==(r=null===(i=e.parent)||void 0===i?void 0:i[t])&&void 0!==r?r:null}_defaultDisplayField(e,t){var r;return e.trim()?e:t.templates&&(null===(r=t.templates)||void 0===r?void 0:r.length)>0?t.templates[0].name:t.title}get _uniqueFlagId(){return this._flagId++}_groupBy(e,t){return e.reduce(((e,r)=>((e[r[t]]=e[r[t]]||[]).push(r),e)),{})}async _lookupFlagByHit(e){var t;const r=null===(t=e.graphic)||void 0===t?void 0:t.geometry,l=[];if(r&&(0,y.isPoint)(r)&&this.view){const t=this.view.toScreen(r);if(t){const r=await this.view.hitTest(t,{include:this._validUNLayers});if(null!==r&&void 0!==r&&r.results.length){var a;const t=r.results.find((e=>null!==e.layer));if(null!==(a=t.graphic)&&void 0!==a&&a.geometry)if("polyline"===t.graphic.geometry.type){var s;const r={terminalId:null,isFilterBarrier:!1,allTerminals:null,selectedTerminals:null,percentAlong:this._geometryHandler.getPercentageAlong(t.graphic.geometry,null===(s=e.graphic)||void 0===s?void 0:s.geometry,t.graphic.geometry.spatialReference),displayValue:this._getDisplayField(t.graphic),mapPoint:t.mapPoint};t.graphic.attributes=(0,i.A)((0,i.A)({},t.graphic.attributes),r),l.push(t)}else if(("point"===t.graphic.geometry.type||"polygon"===t.graphic.geometry.type)&&this.utilityNetwork){const e=this.utilityNetwork.getTerminalConfiguration(t.graphic),r=this._getDisplayField(t.graphic),a={terminalId:e?e.terminals[0].id||null:1,isFilterBarrier:!1,allTerminals:null!==e&&void 0!==e?e:null,selectedTerminals:[e?e.terminals[0].id||null:1],percentAlong:null,displayValue:r,mapPoint:t.mapPoint};t.graphic.attributes=(0,i.A)((0,i.A)({},t.graphic.attributes),a),l.push(t)}}}}return l}_createFlagProperty(e,t,r){const i=new I.default;i.terminalId=e.attributes.terminalId,i.isFilterBarrier=e.attributes.isFilterBarrier,i.percentAlong=e.attributes.percentAlong,i.globalId=e.attributes.globalid||e.attributes.GLOBALID,i.type=t;const l=i;return l.details=e,l.mapGraphic=r,l.id=this._uniqueFlagId,l.allTerminals=e.attributes.allTerminals,l.selectedTerminals=e.attributes.selectedTerminals,l.displayValue=e.attributes.displayValue,l.mapPoint=e.attributes.mapPoint,l}async _populateOutfields(){if(!this.view)return;const{map:e}=this.view,t=this.getValidSources(),r=e=>{"group"===e.type?e.layers.forEach((e=>{K(e)&&r(e)})):t.some((t=>t.layerId===e.layerId))&&e.fields.some((e=>"assetgroup"===e.name.toLowerCase()))&&(e.outFields=["assetgroup","assettype","globalid","objectid"])};for(const i of e.layers)K(i)&&r(i)}_removeGraphic(e){var t;null===(t=this._getGraphicLayer(J))||void 0===t||t.remove(e.mapGraphic)}_createGraphicLayer(e){const{map:t}=this.view;if(!t.findLayerById(e)){const t=new f.default({id:e,internal:!0,listMode:"hide",title:e});(0,S.Y)(this.view,t)}}_getGraphicLayer(e){const{map:t}=this.view;if(t){const r=t.findLayerById(e);if(r&&function(e){return"graphics"===e.type}(r))return r}return null}};(0,l._)([(0,h.MZ)()],Y.prototype,"_activeProgress",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"_flags",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"traces",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"defaultGraphicColor",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"enableResultArea",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"flags",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"gdbVersion",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"messages",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"messagesUnits",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"resultAreaProperties",null),(0,l._)([(0,h.MZ)()],Y.prototype,"selectedTraces",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"selectOnComplete",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"showGraphicsOnComplete",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"showSelectionAttributes",void 0),(0,l._)([(0,h.MZ)({readOnly:!0})],Y.prototype,"state",null),(0,l._)([(0,h.MZ)()],Y.prototype,"traceResults",void 0),(0,l._)([(0,h.MZ)()],Y.prototype,"utilityNetwork",void 0),(0,l._)([(0,h.MZ)({value:null})],Y.prototype,"view",null),Y=(0,l._)([(0,p.$)("esri.widgets.UtilityNetworkTrace.UtilityNetworkTraceViewModel")],Y);const X=Y},40998:(e,t,r)=>{r.r(t),r.d(t,{submitTraceJob:()=>n,trace:()=>o});var i=r(89379),l=r(3825),a=r(54994),s=r(74819);async function o(e,t,r){const o=(0,a.Dl)(e),n=t.toJSON();n.traceLocations=JSON.stringify(t.traceLocations),t.resultTypes&&(n.resultTypes=JSON.stringify(t.resultTypes));const u=(0,a.jV)(o.query,(0,i.A)({query:(0,a.lF)((0,i.A)((0,i.A)({},n),{},{f:"json"}))},r)),c="".concat(o.path,"/trace");return(0,l.default)(c,u).then((e=>function(e){const{data:t}=e;return s.default.fromJSON(t.traceResults)}(e)))}async function n(e,t,r){const s=(0,a.Dl)(e),o=t.toJSON();o.traceLocations=JSON.stringify(t.traceLocations),t.resultTypes&&(o.resultTypes=JSON.stringify(t.resultTypes));const n=(0,a.jV)(s.query,(0,i.A)({query:(0,a.lF)((0,i.A)((0,i.A)({},o),{},{async:!0,f:"json"}))},r)),u="".concat(s.path,"/trace"),{data:c}=await(0,l.default)(u,n);return c.statusUrl}},63733:(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var i=r(35143),l=r(46053),a=(r(81806),r(76460),r(47249),r(85842)),s=r(5364),o=r(25515),n=r(65624),u=r(5682),c=r(64519),d=r(731);let h=class extends((0,n.dM)((0,u.j)(o.default))){constructor(e){super(e),this.elevationInfo=null,this.graphics=new c.Y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,t){return super.on(e,t)}graphicChanged(e){this.emit("graphic-update",e)}};(0,i._)([(0,l.MZ)({type:d.A})],h.prototype,"elevationInfo",void 0),(0,i._)([(0,l.MZ)((0,s.C)(c.Y,"graphics"))],h.prototype,"graphics",void 0),(0,i._)([(0,l.MZ)({type:["show","hide"]})],h.prototype,"listMode",void 0),(0,i._)([(0,l.MZ)()],h.prototype,"screenSizePerspectiveEnabled",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],h.prototype,"type",void 0),(0,i._)([(0,l.MZ)({constructOnly:!0})],h.prototype,"internal",void 0),h=(0,i._)([(0,a.$)("esri.layers.GraphicsLayer")],h);const p=h},64826:(e,t,r)=>{r.r(t),r.d(t,{default:()=>g});var i,l=r(35143),a=r(42553),s=r(46053),o=r(40565),n=(r(81806),r(47249),r(85842)),u=r(17707),c=r(13312),d=r(12899),h=r(64154),p=r(91329);let y=i=class extends a.A{static from(e){return(0,o.PZ)(i,e)}constructor(e){super(e),this.namedTraceConfigurationGlobalId=null,this.gdbVersion=null,this.traceLocations=[],this.moment=null,this.outSpatialReference=null,this.traceConfiguration=null,this.resultTypes=null,this.traceType=null}writeOutSR(e,t,r){if(null!=e){const{wkid:i,latestWkid:l,wkt:a,wkt2:s}=e;t[r]=JSON.stringify({wkid:null!==i&&void 0!==i?i:void 0,latestWkid:null!==l&&void 0!==l?l:void 0,wkt:null!==a&&void 0!==a?a:void 0,wkt2:null!==s&&void 0!==s?s:void 0})}}};(0,l._)([(0,s.MZ)({type:String,json:{read:{source:"traceConfigurationGlobalId"},write:{target:"traceConfigurationGlobalId"}}})],y.prototype,"namedTraceConfigurationGlobalId",void 0),(0,l._)([(0,s.MZ)({type:String,json:{write:!0}})],y.prototype,"gdbVersion",void 0),(0,l._)([(0,s.MZ)({type:[p.default],json:{write:!0}})],y.prototype,"traceLocations",void 0),(0,l._)([(0,s.MZ)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.moment=e?e.getTime():null}}}})],y.prototype,"moment",void 0),(0,l._)([(0,s.MZ)({type:c.default,json:{write:{allowNull:!0,target:"outSR"}}})],y.prototype,"outSpatialReference",void 0),(0,l._)([(0,u.K)("outSpatialReference")],y.prototype,"writeOutSR",null),(0,l._)([(0,s.MZ)({type:h.default,json:{write:!0}})],y.prototype,"traceConfiguration",void 0),(0,l._)([(0,s.MZ)({type:[Object],json:{write:!0}})],y.prototype,"resultTypes",void 0),(0,l._)([(0,s.MZ)({type:d.fO.apiValues,json:{type:d.fO.jsonValues,read:d.fO.read,write:d.fO.write}})],y.prototype,"traceType",void 0),y=i=(0,l._)([(0,n.$)("esri.rest.networks.support.TraceParameters")],y);const g=y},89646:(e,t,r)=>{r.d(t,{$h:()=>g,Ef:()=>R,IP:()=>f,P1:()=>_,hF:()=>k,jQ:()=>b,rT:()=>A,rZ:()=>i,uR:()=>m});var i,l,a=r(73582),s=r(24648),o=r(31633),n=r(19555),u=r(72745),c=r(20664),d=r(9392),h=r(14487),p=r(7137),y=r(80963);function g(e,t){if(null==e||null==t)return;const r=v(e,t);return null!=r?(0,s.Wq)(r,"radians","geographic"):void 0}(l=i||(i={})).Absolute="absolute",l.Relative="relative",l.RelativeBilateral="relative-bilateral";const v=(()=>{const e=(0,d.vt)(),t=(0,d.vt)();return(r,i)=>{var l,a;return(0,c.i)(e,r.x,r.y,null!==(l=r.z)&&void 0!==l?l:0),(0,c.i)(t,i.x,i.y,null!==(a=i.z)&&void 0!==a?a:0),f(e,t,r.spatialReference,i.spatialReference)}})(),f=(()=>{const e=(0,u.vt)(),t=(0,d.vt)(),r=(0,d.vt)();return(i,l,a,s)=>{if((0,c.p)(i,l))return;const d=(0,p.geodesicCompatibleSpatialReference)(a),g=(0,p.geodesicCompatibleSpatialReference)(s);if(d&&g&&(0,y.aI)(d,g)&&(0,h.F)(i,a,t,d)&&(0,h.F)(l,s,r,g)){const{azimuth:e}=(0,p.inverseGeodeticSolver)(G,t,r,d);return null!=e?(0,o.oU)(e,"degrees","radians"):void 0}e[0]=l[0]-i[0],e[1]=l[1]-i[1];let v=(0,n.g7)(u.JP,e);return e[0]<0&&(v=S-v),v}})();function m(e,t,r){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.Absolute;if(t&&r)switch(l){case i.Absolute:return g(t,r);case i.Relative:return b(w(e,t,r),i.Relative);case i.RelativeBilateral:return b(w(e,t,r),i.RelativeBilateral)}}function w(e,t,r){if(!e||!t||!r)return;const i=v(e,t),l=v(t,r);return null!=i&&null!=l?(0,s.Wq)(l-i,"radians","geographic"):void 0}function b(e,t){if(null!=e)switch(t){case i.Absolute:return _(e);case i.Relative:{const t=k(e);let r=T.normalize(t,0,!0);return-180===r&&(r=180),(0,s.Wq)(r,"degrees","geographic")}case i.RelativeBilateral:{const t=k(e),r=Math.abs(T.normalize(t,0,!0));return(0,s.Wq)(r,"degrees","geographic")}}}function _(e){const t=k(e),r=L.normalize(t,0,!0);return(0,s.Wq)(r,"degrees","geographic")}const A=(()=>{const e=(0,d.vt)();return function(t,r,i,l,a){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"geodesic";(0,c.c)(e,r);const u=k(a);if("geodesic"===n){const a=(0,p.geodesicCompatibleSpatialReference)(i);if(a&&(0,h.F)(e,i,e,a))return(0,p.directGeodeticSolver)(t,e,u,l,a),t[2]=r[2],!!(0,h.F)(t,a,t,i)}const d=(0,s.g2)(u,"geographic","arithmetic"),y=(0,o.oU)(d,"degrees","radians"),g=r[0]+l*Math.cos(y),v=r[1]+l*Math.sin(y),f=r[2];return(0,c.i)(t,g,v,f),!0}})();function k(e){if(null!=e)return(0,s.g2)(I(e),e.rotationType,"geographic")}function R(e){if(null!=e)return(0,s.g2)(I(e),e.rotationType,"arithmetic")}function I(e){return(0,o.oU)(e.value,e.unit,"degrees")}const G=new p.InverseGeodeticSolverResult,S=2*Math.PI,L=a.ie,T=new a.hr(-180,180)},91329:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var i=r(35143),l=r(45802),a=r(42553),s=r(46053),o=(r(81806),r(76460),r(47249),r(85842));const n=new l.J({startingPoint:"starting-point",barrier:"barrier"});let u=class extends a.A{constructor(e){super(e),this.globalId=null,this.isFilterBarrier=!1,this.percentAlong=null,this.terminalId=null,this.type=null}};(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],u.prototype,"globalId",void 0),(0,i._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],u.prototype,"isFilterBarrier",void 0),(0,i._)([(0,s.MZ)({type:Number,json:{write:!0}})],u.prototype,"percentAlong",void 0),(0,i._)([(0,s.MZ)({type:Number,json:{write:!0}})],u.prototype,"terminalId",void 0),(0,i._)([(0,s.MZ)({type:n.apiValues,json:{type:n.jsonValues,read:{reader:n.read,source:"traceLocationType"},write:{writer:n.write,target:"traceLocationType"}}})],u.prototype,"type",void 0),u=(0,i._)([(0,o.$)("esri.rest.networks.support.TraceLocation")],u);const c=u},94560:(e,t,r)=>{r.d(t,{K9:()=>p,KM:()=>h,XU:()=>d,pC:()=>y});var i=r(39356),l=r(19276),a=r(86875),s=r(38996),o=r(76940),n=r(3589),u=r(83973),c=r(81257);const d=[227,27,21,.6],h=[21,244,21,.6],p=[{color:[255,0,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#ff0000"},{color:[255,0,255,.6],haloOpacity:.9,fillOpacity:.2,hex:"#ff00ff"},{color:[217,188,255,.6],haloOpacity:.9,fillOpacity:.2,hex:"#D9BCFF"},{color:[0,255,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#00ff00"},{color:[255,255,0,.6],haloOpacity:.9,fillOpacity:.2,hex:"#ffff00"},{color:[0,0,255,.6],haloOpacity:.9,fillOpacity:.2,hex:"#0000ff"},{color:[255,165,0,.5],haloOpacity:.9,fillOpacity:.2,hex:"#ffa500"},{color:[0,0,0,.5],haloOpacity:.9,fillOpacity:.2,hex:"#000000"}];class y{constructor(){this.highlightColor=[...p]}addCustomColor(e){this.highlightColor=[...p],this.highlightColor.some((t=>t.hex.toLowerCase()===e.hex.toLowerCase()))||this.highlightColor.push(e)}getFlagGraphic(e,t,r,i){const l="starting-point"===t?h:d;if("polygon"===e.type){const t=e;t.centroid&&(e=t.centroid)}return i?this.makeGraphic(e,l,null===r||void 0===r?void 0:r.attributes,null,i):this.makeGraphic(e,l,null===r||void 0===r?void 0:r.attributes)}initializeSketch(e,t,r){const i=new l.default;return r.forEach((e=>i.add(new n.default({layer:e,enabled:!0})))),new c.default({layer:t,view:e,snappingOptions:new u.default({enabled:!0,featureEnabled:!0,featureSources:i})})}makeGraphic(e,t,r,l,n){let u,c=e;switch(e.type){case"multipoint":u=new o.default({color:t,size:12,outline:{color:t,width:0}}),l&&(c=e);break;case"point":u=n||new o.default({color:t,size:12,outline:{color:t,width:0}}),l&&(c=e);break;case"polyline":u=new s.default({color:t,width:12}),l&&(c=e);break;case"polygon":u=new a.default({color:t,outline:{color:t,width:12}}),l&&(c=e)}return new i.default({geometry:c,symbol:u,attributes:null!==r&&void 0!==r?r:null})}}},95327:(e,t,r)=>{r.r(t),r.d(t,{default:()=>n});var i=r(35143),l=r(91967),a=r(46053),s=(r(81806),r(76460),r(47249),r(85842));let o=class extends l.default{constructor(e){super(e),this.enabled=!1}};(0,i._)([(0,a.MZ)({type:Boolean,nonNullable:!0})],o.prototype,"enabled",void 0),o=(0,i._)([(0,s.$)("esri.views.interactive.sketch.SketchLabelOptions")],o);const n=o},96422:(e,t,r)=>{r.d(t,{Kw:()=>a,RE:()=>o,Sl:()=>s});var i=r(55171),l=r(3825);async function a(e,t,r){var a;if(!(null===i.id||void 0===i.id?void 0:i.id.findCredential(e.restUrl)))return null;if("loaded"===e.loadStatus&&""===t&&null!==(a=e.user)&&void 0!==a&&a.sourceJSON&&!1===r)return e.user.sourceJSON;const s={responseType:"json",query:{f:"json"}};if(r&&(s.query.returnUserLicenseTypeExtensions=!0),""===t){const t=await(0,l.default)(e.restUrl+"/community/self",s);if(t.data){const e=t.data;if(null!==e&&void 0!==e&&e.username)return e}return null}const o=await(0,l.default)(e.restUrl+"/community/users/"+t,s);if(o.data){const e=o.data;return e.error?null:e}return null}async function s(e,t,r){var i,l;const s=await a(e,t,!0);return null!==(i=null===s||void 0===s||null===(l=s.privileges)||void 0===l?void 0:l.includes(r))&&void 0!==i&&i}async function o(e,t,r){var i,l;const s=await a(e,t,!0);return null!==(i=null===s||void 0===s||null===(l=s.userLicenseTypeExtensions)||void 0===l?void 0:l.includes(r))&&void 0!==i&&i}}}]);
//# sourceMappingURL=26417.986214de.chunk.js.map