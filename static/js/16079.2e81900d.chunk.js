"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[16079],{15231:(e,a,n)=>{n.r(a),n.d(a,{default:()=>d});var i=n(89379),o=n(53986),r=n(50076),t=n(28383),l=n(90494),s=n(11563);const c=["layer"],m=["layerAdapter"];async function d(e){const a=await async function(e){if(!(e&&e.layer&&e.view&&e.fields))throw new r.default("predominant-categories:missing-parameters","'layer', 'view' and 'fields' parameters are required");e.forBinning&&(0,l.p)(e,"predominant-categories");const{layer:a}=e,n=(0,o.A)(e,c),m=e.forBinning?s.Mi:s.G3,d=(0,s.Jg)(a,m,e.forBinning);if(!d)throw new r.default("predominant-categories:invalid-parameters","'layer' must be one of these types: "+(0,s.Ho)(m).join(", "));const p=(0,i.A)({layerAdapter:d},n);await Promise.all([p.view.when(),d.load({signal:p.signal})]);const u=(0,t.MH)(d,p.fields,"predominant-categories:invalid-parameters");if(u)throw u;return p}(e),{layerAdapter:n}=a,d=(0,o.A)(a,m);return n.predominantCategories(d)}},38460:(e,a,n)=>{n.r(a),n.d(a,{createRenderer:()=>x,regenerateRenderer:()=>I});var i=n(89379),o=n(59784),r=n(50076),t=n(63860),l=n(9922),s=n(45430),c=n(24921),m=n(48548),d=n(14776),p=n(84332),u=n(33766),y=n(87990),f=n(53151),v=n(53680),h=n(51006),g=n(15231),b=n(76106),w=n(90494),z=n(11563),S=n(98019);async function T(e){var a,n,o;if(!(null!==e&&void 0!==e&&e.layer&&e.view&&null!==(a=e.fields)&&void 0!==a&&a.length))throw new r.default("predominance-renderer:missing-parameters","'layer', 'view' and 'fields' parameters are required");if(e.fields.length<2)throw new r.default("predominance-renderer:invalid-parameters","Minimum 2 fields are required");if(e.fields.length>10)throw new r.default("predominance-renderer:invalid-parameters","Maximum 10 fields are supported");e.forBinning&&(0,w.p)(e,"predominance-renderer");const t=(0,i.A)((0,i.A)({},e),{},{layer:e.layer,fields:e.fields});t.symbolType=t.symbolType||"2d",null!==(n=t.defaultSymbolEnabled)&&void 0!==n||(t.defaultSymbolEnabled=!0),t.includeOpacityVariable=e.includeOpacityVariable||!1,t.includeSizeVariable=e.includeSizeVariable||!1,null!==(o=t.sortBy)&&void 0!==o||(t.sortBy="count");const l=e.forBinning?z.Mi:z.J4,s=(0,z.Jg)(t.layer,l,e.forBinning);if(!s)throw new r.default("predominance-renderer:invalid-parameters","'layer' must be one of these types: "+(0,z.Ho)(z.J4).join(", "));const c=null!=t.signal?{signal:t.signal}:null;await s.load(c);const m=s.geometryType,d=t.symbolType.includes("3d");if(t.outlineOptimizationEnabled="polygon"===m&&t.outlineOptimizationEnabled,t.includeSizeVariable||(t.sizeOptimizationEnabled=("point"===m||"multipoint"===m||"polyline"===m)&&t.sizeOptimizationEnabled),"mesh"===m)t.symbolType="3d-volumetric",t.colorMixMode=t.colorMixMode||"replace",t.edgesType=t.edgesType||"none",t.sizeOptimizationEnabled=!1;else{if(d&&("polyline"===m||"polygon"===m))throw new r.default("predominance-renderer:not-supported","3d symbols are not supported for polyline and polygon layers");if(t.symbolType.includes("3d-volumetric")&&(!t.view||"3d"!==t.view.type))throw new r.default("predominance-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or '3d-volumetric-uniform'")}const p=t.fields.map((e=>e.name)),u=(0,h.MH)(s,p,"predominance-renderer:invalid-parameters");if(u)throw u;return(0,i.A)((0,i.A)({},t),{},{layer:s})}async function C(e){let a=e.predominanceScheme,n=null,i=null;const o=await(0,h.Ib)(e.basemap,e.view);if(n=null!=o.basemapId?o.basemapId:null,i=null!=o.basemapTheme?o.basemapTheme:null,a)return{scheme:(0,S.cloneScheme)(a),basemapId:n,basemapTheme:i};const r=(0,S.getSchemes)({basemapTheme:i,geometryType:e.geometryType,numColors:e.numColors,theme:e.theme,worldScale:e.worldScale,view:e.view});return r&&(a=r.primaryScheme,n=r.basemapId,i=r.basemapTheme),{scheme:a,basemapId:n,basemapTheme:i}}async function V(e,a,n){var i;const o=await(0,t.ud)("esri/smartMapping/t9n/smartMapping");return(0,y.createVisualVariables)({layer:e.layer,basemap:e.basemap,valueExpression:a.valueExpression,sqlExpression:a.statisticsQuery.sqlExpression,sqlWhere:a.statisticsQuery.sqlWhere,sizeScheme:n,sizeOptimizationEnabled:e.sizeOptimizationEnabled,worldScale:!(null===(i=e.symbolType)||void 0===i||!i.includes("3d-volumetric")),legendOptions:{title:o.sumOfCategories},filter:e.filter,view:e.view,signal:e.signal})}async function E(e,a){const n=await(0,t.ud)("esri/smartMapping/t9n/smartMapping"),i=await(0,h.g2)({layer:e.layer,valueExpression:a.valueExpression,sqlExpression:a.statisticsQuery.sqlExpression,sqlWhere:a.statisticsQuery.sqlWhere,filter:e.filter,view:e.view,signal:e.signal}),{avg:o,stddev:r}=i,u=null==o||null==r,y=1/e.fields.length*100;let f=u?100:o+1.285*r;f>100&&(f=100);const v=(0,c.LI)([y,f],{strictBounds:!0}),g=new m.default({valueExpression:a.valueExpression,stops:[new d.default({value:v[0],opacity:.15}),new d.default({value:v[1],opacity:1})],legendOptions:new p.A({title:n.strengthOfPredominance})}),b=new s.default({type:"opacity",minSliderValue:i.min,maxSliderValue:i.max});return{visualVariable:g,statistics:i,defaultValuesUsed:u,authoringInfo:new l.default({visualVariables:[b]})}}async function x(e){var a;const n=await T(e),i=n.layer,r=(await C({basemap:n.basemap,geometryType:i.geometryType,numColors:n.fields.length,predominanceScheme:n.predominanceScheme,worldScale:!(null===(a=n.symbolType)||void 0===a||!a.includes("3d-volumetric")),view:n.view})).scheme,s=n.fields.map((e=>e.name)),c=(0,b.getPredominanceExpressions)(i,s),m=async function(e,a,n,i){var r;const s=await(0,t.ud)("esri/smartMapping/t9n/smartMapping"),c=e.layer,{view:m,filter:d,signal:p}=e,[y,v]=await Promise.all([(0,g.default)({layer:c,fields:i,view:m,filter:d,signal:p}),e.outlineOptimizationEnabled?(0,u.A)({layer:c,view:m,filter:d,signal:p}).catch(h.ou):null]);let b=y;(null===y||void 0===y?void 0:y.predominantCategoryInfos)||(b={predominantCategoryInfos:i.map((e=>({value:e,count:0})))});const w=null===v||void 0===v?void 0:v.opacity,z=await(0,f.createRenderer)({layer:c,basemap:e.basemap,valueExpression:a.valueExpression,valueExpressionTitle:s.predominantCategory,numTypes:-1,defaultSymbolEnabled:e.defaultSymbolEnabled,sortBy:e.sortBy,typeScheme:n,statistics:{uniqueValueInfos:b.predominantCategoryInfos},legendOptions:e.legendOptions,outlineOptimizationEnabled:!1,sizeOptimizationEnabled:(!e.includeSizeVariable||!e.sizeOptimizationEnabled)&&e.sizeOptimizationEnabled,symbolType:e.symbolType,colorMixMode:e.colorMixMode,edgesType:e.edgesType,filter:e.filter,view:e.view,signal:e.signal}),{renderer:S,basemapId:T,basemapTheme:C,uniqueValueInfos:V,excludedUniqueValueInfos:E}=z,x=null!==(r=S.uniqueValueInfos)&&void 0!==r?r:[],I={};for(const o of e.fields){const e=c.getField(o.name);I[e.name]=o.label||e&&e.alias||o.name}if(x.forEach(((e,a)=>{const n=I[e.value];e.label=n,V[a].label=n})),e.includeSizeVariable){let a=c.geometryType,i=null;if("polygon"===a){const o=n.sizeScheme,r=o.background;S.backgroundFillSymbol=(0,h.v5)(a,{type:e.symbolType,color:r.color,outline:(0,h.qc)(r,a,w)}),i=o.marker.size,a="point"}else i="polyline"===a?n.width:n.size;const r=(0,o.Iy)(n.colors,x.length);x.forEach(((o,t)=>{const l=(0,h.v5)(a,{type:e.symbolType,color:r[t],size:i,outline:(0,h.qc)(n,a,w),meshInfo:{colorMixMode:e.colorMixMode,edgesType:e.edgesType}});o.symbol=l,V[t].symbol=l.clone()}))}return null!==v&&void 0!==v&&v.visualVariables.length&&(S.visualVariables=v.visualVariables.map((e=>e.clone()))),S.authoringInfo=new l.default({type:"predominance",fields:[...i]}),{renderer:S,predominantCategoryInfos:V,excludedCategoryInfos:E,predominanceScheme:n,basemapId:T,basemapTheme:C}}(n,c.predominantCategory,r,s),d=n.includeSizeVariable?V(n,c.size,r.sizeScheme):null,p=n.includeOpacityVariable?E(n,c.opacity):null,[y,v,w]=await Promise.all([m,d,p]),z=[],S=[];if(v&&(Array.prototype.push.apply(z,v.visualVariables.map((e=>e.clone()))),delete v.sizeScheme,y.size=v,Array.prototype.push.apply(S,v.authoringInfo.visualVariables.map((e=>e.clone())))),w&&(z.push(w.visualVariable.clone()),y.opacity=w,Array.prototype.push.apply(S,w.authoringInfo.visualVariables.map((e=>e.clone())))),z.length){var x,I;const e=y.renderer.visualVariables||[];Array.prototype.push.apply(e,z),y.renderer.visualVariables=e,null!==(I=(x=y.renderer).authoringInfo)&&void 0!==I||(x.authoringInfo=new l.default),y.renderer.authoringInfo.visualVariables=S}return y}async function I(e){const{creatorParameters:a,view:n,signal:o,filter:t,renderer:l}=await async function(e){var a;const n="regenerate-predominance-renderer";await(0,v.AC)(e,n);const o=await(0,v.mE)(e);if("predominance"!==(0,v.UJ)(o))throw new r.default("".concat(n,":invalid-parameters"),"Renderer is invalid");const{visualVariables:t}=o,{layer:l,forBinning:s,filter:c,view:m,signal:d}=e,p=(0,v.DW)(o),u=(0,v.Rv)(o),y=null===t||void 0===t?void 0:t.some(v.OW),f=null===t||void 0===t?void 0:t.some((e=>"opacity"===e.type)),h=o.authoringInfo,g=null===h||void 0===h||null===(a=h.fields)||void 0===a?void 0:a.map((e=>({name:e})));if(null===g||void 0===g||!g.length)throw new r.default("".concat(n,":invalid-parameters"),"Fields are required");const b=await T({layer:l,fields:g,outlineOptimizationEnabled:p,sizeOptimizationEnabled:u,includeSizeVariable:y,includeOpacityVariable:f,forBinning:s,filter:c,view:m,signal:d});return(0,i.A)((0,i.A)({},e),{},{creatorParameters:b,renderer:o})}(e),{layer:s,fields:c,outlineOptimizationEnabled:m,includeSizeVariable:d,includeOpacityVariable:p}=a,y=c.map((e=>e.name)),f=(0,b.getPredominanceExpressions)(s,y),g=(await C({geometryType:s.geometryType,numColors:a.fields.length,view:a.view})).scheme,w=g&&"sizeScheme"in g?g.sizeScheme:null,[z,S,x]=await Promise.all([m?(0,u.A)({layer:s,view:n,signal:o,filter:t}).catch(h.ou):null,d?V(a,f.size,w):null,p?E(a,f.opacity):null]);return(0,v.ke)(l,null===z||void 0===z?void 0:z.visualVariables,v._i),(0,v.ke)(l,null===S||void 0===S?void 0:S.visualVariables,v.Jy),(0,v.ke)(l,null===x||void 0===x?void 0:x.visualVariable,v.d8),(0,v.Hj)(l,null===S||void 0===S?void 0:S.authoringInfo,"size"),(0,v.Hj)(l,null===x||void 0===x?void 0:x.authoringInfo,"opacity"),{renderer:l}}},98019:(e,a,n)=>{n.r(a),n.d(a,{cloneScheme:()=>w,getSchemeByName:()=>g,getSchemes:()=>h,getSchemesByTag:()=>b,getThemes:()=>v});var i=n(89379),o=n(69539),r=n(18690),t=n(59784),l=n(76281),s=n(89132),c=n(770),m=n(80791);const d={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"},darker:{color:[26,26,26,.25],width:"1px"}},p="#aaaaaa",u=["tropical-bliss","desert-blooms","under-the-sea","vibrant-rainbow","ocean-bay","prairie-summer","pastel-chalk"],y=["cat-symbols-strong","cat-symbols-autumnal","cat-symbols-bright","cat-symbols-midrange","cat-symbols-subdued","cat-symbols-pastel","cat-symbols-red","cat-symbols-blue","cat-symbols-green","cat-symbols-gray"],f=(0,c.bG)({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for visualizing features by their predominant category.",schemes:{point:{light:{common:{noDataColor:p,outline:d.light,size:"8px"},primary:"predominant-v1",secondary:["predominant-v2","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(y).concat(u)},dark:{common:{noDataColor:p,outline:d.darker,size:"8px"},primary:"predominant-v2",secondary:["predominant-v1","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(y).concat(u)}},polyline:{light:{common:{noDataColor:p,width:"2px"},primary:"predominant-v1",secondary:["predominant-v2","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(y).concat(u)},dark:{common:{noDataColor:p,width:"2px"},primary:"predominant-v2",secondary:["predominant-v1","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(y).concat(u)}},polygon:{light:{common:{noDataColor:p,outline:d.light,fillOpacity:.8,markerSize:"8px"},primary:"predominant-v1",secondary:["predominant-v2","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(y).concat(u)},dark:{common:{noDataColor:p,outline:d.dark,fillOpacity:.8,markerSize:"8px"},primary:"predominant-v2",secondary:["predominant-v1","predominant-v3","predominant-v4","predominant-v5","predominance-race","predominance-money","predominance-race-ethnic","predominance-rainbow","predominance-sequence"].concat(y).concat(u)}}}}}});function v(e){return(0,c.vt)(f,e)}function h(e){const a=(0,c.Fq)({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme,theme:f.get("default")});if(!a)return;const{schemesInfo:n,basemapId:i,basemapTheme:o}=a,t=n.common,s=(0,l.getSchemes)({basemap:e.basemap,geometryType:e.geometryType,worldScale:e.worldScale,view:e.view}),m=null===s||void 0===s?void 0:s.primaryScheme;return{primaryScheme:z(e,n.primary,t,m),secondarySchemes:n.secondary.map((a=>z(e,a,t,m))).filter(r.Ru),basemapId:i,basemapTheme:o}}function g(e){return(0,c.Ty)(e.name,h(e))}function b(e){return(0,c.YJ)(e.includedTags,e.excludedTags,h(e))}function w(e){if(!e)return;const a=(0,i.A)({},e);return a.colors=a.colors.map((e=>new o.default(e))),a.tags=[...a.tags],a.noDataColor&&(a.noDataColor=new o.default(a.noDataColor)),"outline"in a&&a.outline&&(a.outline={color:a.outline.color&&new o.default(a.outline.color),width:a.outline.width}),"sizeScheme"in a&&a.sizeScheme&&(a.sizeScheme=(0,l.cloneScheme)(a.sizeScheme)),a}function z(e,a,n,i){var r;const l=s.A[a];if(!l)return;const{numColors:c}=e,d=c?null!==(r=l[c])&&void 0!==r?r:(0,t.Iy)(l.stops,c):l.stops,p="mesh"!==e.geometryType&&e.worldScale?e.view:null;switch(e.geometryType){case"point":case"multipoint":{const e=n;return function(e,a){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new o.default(e))),noDataColor:new o.default(e.noDataColor),outline:{color:new o.default(e.outline.color),width:e.outline.width},size:a?(0,m._J)(e.size,a):e.size,sizeScheme:e.sizeScheme,opacity:e.opacity}}({name:l.name,tags:l.tags,colors:d,noDataColor:e.noDataColor,opacity:1,sizeScheme:i,outline:e.outline,size:e.size},p)}case"polyline":{const e=n;return function(e,a){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new o.default(e))),noDataColor:new o.default(e.noDataColor),width:a?(0,m._J)(e.width,a):e.width,sizeScheme:e.sizeScheme,opacity:e.opacity}}({name:l.name,tags:l.tags,colors:d,noDataColor:e.noDataColor,opacity:1,sizeScheme:i,width:e.width},p)}case"polygon":{const e=n,a=i;return a&&a.marker&&null!=e.markerSize&&(a.marker.size=e.markerSize),function(e,a){const{sizeScheme:n}=e;return n.marker.size=a?(0,m._J)(n.marker.size,a):n.marker.size,{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new o.default(e))),noDataColor:new o.default(e.noDataColor),outline:{color:new o.default(e.outline.color),width:e.outline.width},sizeScheme:n,opacity:e.opacity}}({name:l.name,tags:l.tags,colors:d,noDataColor:e.noDataColor,opacity:e.fillOpacity,outline:e.outline,sizeScheme:a},p)}case"mesh":{const e=n;return function(e){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new o.default(e))),noDataColor:new o.default(e.noDataColor),opacity:e.opacity}}({name:l.name,tags:l.tags,colors:d,noDataColor:e.noDataColor,opacity:e.fillOpacity})}default:return}}}}]);
//# sourceMappingURL=16079.2e81900d.chunk.js.map