"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[60540],{60540:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var i=n(89379),o=n(35143),a=n(73204),s=n(69098),r=n(50076),l=n(77717),c=n(50346),d=n(68134),u=n(46053),p=(n(81806),n(76460)),h=(n(47249),n(85842)),f=n(25515),g=n(65624),v=n(31362),m=n(24709),y=n(11270),w=n(94729),b=n(21617),I=n(5682),C=n(78817),x=n(95363),S=n(44135),A=n(51939),_=n(76797),T=n(65660),M=n(36164),P=n(15359),L=n(10410),D=n(68347);function E(e){const t=function(e){var t,n;const i=null===(t=e.getHeader)||void 0===t||null===(t=t.call(e,"Content-Type"))||void 0===t?void 0:t.split(";");if(!i)return null;if(!(null!==(n=i[0].trim())&&void 0!==n?n:"").startsWith("multipart/"))return null;const o={boundary:"",start:"",type:""};for(let a=1;a<i.length;a++){const e=i[a].indexOf("=");if(e>0){const t=i[a].slice(0,e).trim(),n=i[a].slice(e+1).trim();o[t]=n.startsWith('"')?n.slice(1,-1):n}}return o}(e);return t?{isMultipart:!0,data:t.boundary?O(e.data,t,0):null}:{isMultipart:!1,data:null}}function O(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const i="--"+t.boundary,o=[];for(let v=0;v<i.length;v++)o.push(i.charCodeAt(v));const a=[],s="\n--"+t.boundary+"--";for(let v=0;v<s.length;v++)a.push(s.charCodeAt(v));const r=[10],l=[13,10],c=[],d=o.length,u=new Uint8Array(e,n),p=u.length-d;let h=0,f=0;for(let v=0;v<p;v++){for(f=0;f<d&&u[v+f]===o[f];f++);if(f!==d)continue;let e=!1;if(h){const n=R(u.subarray(h,v),t);c.push(n),e=!!n.isValidImage}if(v+=d-1,u[v+1]===r[0]?v+=1:u[v+1]===l[0]&&u[v+2]===l[1]&&(v+=2),h=v+1,e)break}const g=a.length;for(let v=u.length-g-10;v<u.length-g;v++){for(f=0;f<g&&u[v+f]===a[f];f++);if(f===g){c.push(R(u.subarray(h,v),t));break}}return c}function R(e,t){const n=String.fromCharCode.apply(null,e.subarray(0,Math.min(300,e.length))).split("\n"),i=Math.min(n.length,7),o={contentDisposition:"inline"};let a=0;for(let r=0;r<i;r++)if(n[r].length<4)a=a+n[r].length+1;else if("content"===n[r].slice(0,7).toLowerCase()){a=a+n[r].length+1;const e=n[r].indexOf(":");if(-1===e)continue;const t=n[r].slice(0,e).trim(),i=n[r].slice(e+1).trim();switch(t.toLowerCase()){case"content-type":o.contentType=i;break;case"content-description":o.contentDescription=i;break;case"content-transfer-encoding":o.contentTransferEncoding=i;break;case"content-id":o.contentID=i;break;case"content-disposition":o.contentDisposition=i;break;case"content-location":o.contentLocation=i}}else{var s;if(o.contentDisposition.toLowerCase().includes("inline")&&n[r].length>=4&&(null===(s=o.contentType)||void 0===s?void 0:s.toLowerCase().indexOf("image"))>-1){let t=!0,n=e.subarray(a,e.length);if(o.contentType.toLowerCase().indexOf("tif")>0){if("base64"===o.contentTransferEncoding){let e="";const t=n;for(let n=0;n<t.length;n+=65535){const i=t.subarray(n,n+65535>t.length-1?t.length-1:n+65535);e+=String.fromCharCode.apply(null,i)}const i=atob(e);n=new Uint8Array(i.length);for(let o=0;o<n.length;o++)n[o]=i.charCodeAt(o)}t=73===n[0]&&73===n[1]||77===n[0]&&77===n[1]}if(t){let t=n.buffer;"base64"!==o.contentTransferEncoding&&(t=new ArrayBuffer(e.length-a),n=new Uint8Array(t),n.set(e.subarray(a,e.length))),o.contentData=t,o.isValidImage=!0}break}if((""===t.start||o.contentID===t.start)&&o.contentType){if(o.contentType.includes("text")||o.contentType.includes("xml")){o.contentData=String.fromCharCode.apply(null,e.subarray(a,e.length));break}o.contentData=e.subarray(a,e.length)}}return o}var k=n(55222),j=n(59648),Z=n(52494);const V=["nearest neighbor","bilinear","bicubic"],F=["nearest","linear","cubic"],W="response is not a supported multipart/related mediaType with inline tiff,  switching to compatibility mode",G=new Set(["1.0.0","1.1.0","1.1.1","1.1.2","2.0.1"]);let N=class extends L.A{constructor(){super(...arguments),this.datasetFormat="WCSServer",this.tileType="Raster"}get rasterId(){return"".concat(this.url,"-").concat(this.coverageId,"-").concat(this.version)}async fetchRawTile(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(this.isBlockOutside(e,t,n))return null;const{nativePixelSize:o,spatialReference:a}=this.rasterInfo,s=2**e,l=o.x*s,c=o.y*s,{blockWidth:d,blockHeight:u}=this.getBlockWidthHeight(e),{origin:p}=this.rasterInfo.storageInfo.tileInfo,h=this.getTileExtent({x:l,y:c},t,n,p,a,[d,u]),f=this.rasterInfo.extent,g=h.xmax>f.xmax,v=h.ymin<f.ymin,m=g||v;let y=h,w=d,b=u;if(m&&(y=h.clone().intersection(f),null!=y&&(g&&(w=Math.floor((y.xmax-y.xmin)/l),y.xmax=y.xmin+l*w),v&&(b=Math.floor((y.ymax-y.ymin)/c),y.ymin=y.ymax-c*b))),null==y||w<=1||b<=1)return null;const I=await this._getCoverage(y,w,b,s,i);if(!I)return null;const{coverageDescription:C}=this.coverageInfo,{noDataValue:x,multidimensionalInfo:S}=this.rasterInfo,{multidimensionalDefinition:A}=i;let _;if(null!=S&&null!=A&&A.length){const e=A[0].variableName;if("2.0"===C.version){const t=C.rangeType[0].find((t=>t.name===e));_=null===t||void 0===t?void 0:t.nilValue}else if("1.1"===C.version){const t=C.range.find((t=>t.identifier===e));_=null===t||void 0===t?void 0:t.nullValues}}const T=null!==_&&void 0!==_?_:x,M=await this.decodePixelBlock(I,{width:w,height:b,planes:null,pixelType:null,tiffNoDataValue:Array.isArray(T)?T[0]:T,matchAllNoData:!0});if(null==M)return null;if(M&&(M.width!==w||M.height!==b))throw new r.default("wcsraster-fetch","the response has unexpected dimension width: ".concat(M.width,", height: {pixelBlock.height}"));return m?(0,Z.$Q)(M,{x:0,y:0},{width:u,height:u}):M}async _open(e){var t,n;const{customFetchParameters:i}=this.ioConfig,o=null===e||void 0===e?void 0:e.signal,a=await(0,M.getCapabilities)(this.url,{version:null!==(t=null===i||void 0===i?void 0:i.version)&&void 0!==t?t:this.version,customParameters:i,signal:o});if(this.capabilities=a,!this.version){let e=a.version.slice(0,3);"2.0"===e||"1.1"===e||"1.0"===e?this.version=a.version:(e=a.supportedVersions.find((e=>"2.0.1"===e))||a.supportedVersions.find((e=>"2.0"===e.slice(0,3)))||a.supportedVersions.find((e=>"1.1"===e.slice(0,3)))||a.supportedVersions.find((e=>"1.0"===e.slice(0,3)))||"1.0.0",this.version=e)}const{version:s}=this;if(!G.has(s))throw new r.default("wcsraster-open","unsupported WCS version ".concat(s));const{gridCoverages:l}=a;if(!l.length)throw new r.default("wcsraster-open","cannot find rectified grid coverages");null!==(n=this.coverageId)&&void 0!==n||(this.coverageId=l[0].id);const{coverageId:c}=this,d=l.find((e=>e.id===c));if(null==d)throw new r.default("wcsraster-open","the coverageId ".concat(c," does not exist in capabilities"));const u=await(0,M.describeCoverage)(this.url,{coverageIds:[c],version:s,customParameters:i,signal:o});if(this.coverageInfo=u[0],"2.0"===s.slice(0,3)){const{coverageInfo:e}=this;e.lonLatEnvelope=d.lonLatEnvelope,e.supportedInterpolations=(0,k.$)(a.supportedInterpolations),this._patchDimensionValues201(c,o)}this.datasetName=this.coverageInfo.title;const{rasterInfo:p}=this.coverageInfo;if(this.createRemoteDatasetStorageInfo(p,512,512),this._set("rasterInfo",p),null==p.spatialReference)throw new r.default("wcsraster-open","coverage without spatial reference is not supported: ".concat(c));const{pixelType:h,bandCount:f}=await this._getPixelTypeAndBandCount(o);p.pixelType=h,1===p.bandCount&&f>1&&(p.bandCount=f),this.updateTileInfo()}async _patchDimensionValues201(e,t){var n;const{coverageInfo:o}=this,a=null===(n=o.rasterInfo.multidimensionalInfo)||void 0===n?void 0:n.variables,s=G.has("1.1.2")?"1.1.2":G.has("1.1.1")?"1.1.1":G.has("1.1.0")?"1.1.0":null,{customFetchParameters:r}=this.ioConfig;if(a&&s)try{var l;const n=this.url.includes("/ImageServer/"),o=e.length>8&&e.startsWith("Coverage")&&n?e.slice(8):e,p=await(0,M.describeCoverage)(this.url,{coverageIds:[null!==o&&void 0!==o?o:e],version:s,customParameters:r,signal:t}).catch((()=>{if(o)return(0,M.describeCoverage)(this.url,{coverageIds:[e],version:s,customParameters:r,signal:t})})),h=null===p||void 0===p||null===(l=p[0].rasterInfo.multidimensionalInfo)||void 0===l?void 0:l.variables;if(h)for(const e of a){var c;const t=h.find((t=>{let{name:n}=t;return n===e.name}));if(null!==t&&void 0!==t&&null!==(c=t.dimensions)&&void 0!==c&&c.length)for(let o=e.dimensions.length-1;o>=0;o--){var d,u;const a=e.dimensions[o],s=t.dimensions.find((e=>{let{name:t}=e;return t===a.name}));s?s.values&&(null===(d=s.extent)||void 0===d?void 0:d.join(","))===(null===(u=a.extent)||void 0===u?void 0:u.join(","))&&(e.dimensions[o]=(0,i.A)((0,i.A)({},a),{},{values:s.values})):n&&e.dimensions.splice(o,1)}}}catch(p){}}async _getPixelTypeAndBandCount(e){var t;const{pixelSize:n,extent:i,multidimensionalInfo:o}=this.rasterInfo,a=i.center,s=new _.default({xmin:a.x-n.x,xmax:a.x+n.x,ymin:a.y-n.y,ymax:a.y+n.y,spatialReference:i.spatialReference});let l=[];if(null!=o){const e=o.variables[0];l=[],e.dimensions.forEach((t=>{var n,i;l.push(new P.default({variableName:e.name,dimensionName:t.name,values:t.hasRegularIntervals?null===(n=t.extent)||void 0===n?void 0:n[0]:null===(i=t.values)||void 0===i?void 0:i[0],isSlice:!0}))}))}const{coverageDescription:c}=this.coverageInfo,d={interpolation:"nearest",multidimensionalDefinition:l,signal:e},{version:u}=c,{ioConfig:h}=this,f="2.0"===u&&null==h.allowAnyMediaType||"1.1"===u&&null==h.use2GridOffsets;let g;try{g=await this._getCoverage(s,2,2,1,d,!0)}catch(y){if(!f)throw y;if("1.1"===u){var v;if(null===(v=y.details)||void 0===v||!v.isResolutionMismatch)throw y;h.use2GridOffsets=!0}}if(!g&&f&&("2.0"===u&&(h.allowAnyMediaType=!0),g=await this._getCoverage(s,2,2,1,d),g&&p.A.getLogger(this).warn("wcsraster:getcoverage",W)),!g)throw new r.default("wcsraster-open","unable to determine pixel type");const m=await this.decodePixelBlock(g,{width:2,height:2,planes:null,pixelType:null});if(null==m)throw new r.default("wcsraster-open","unable to determine pixel type");return{pixelType:m.pixelType,bandCount:null!==(t=m.getPlaneCount())&&void 0!==t?t:0}}async _getCoverage(e,t,n,i,o){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const{coverageDescription:s}=this.coverageInfo,{version:l}=s,c="2.0"===l?this._getCoverage201Parameters(e,t,n,i,o,s):"1.1"===l?this._getCoverage110Parameters(e,t,n,o,s):this._getCoverage100Parameters(e,t,n,o),d="2.0"===l?await this.request(this._constructWCS201Url(c),{signal:o.signal,responseType:"array-buffer"}):await this.request(this.url,{query:c,signal:o.signal,responseType:"array-buffer"});if("1.0"===l)return d.data;if("2.0"===l&&!1!==this.ioConfig.allowAnyMediaType&&"tiff"===(0,j.g)(d.data))return a&&(this.ioConfig.allowAnyMediaType=!0,p.A.getLogger(this).warn("wcsraster:getcoverage",W)),d.data;const u=E(d);if(u.isMultipart&&u.data){const e=u.data.find((e=>e.isValidImage));return a&&"base64"===(null===e||void 0===e?void 0:e.contentTransferEncoding)&&p.A.getLogger(this).warn("wcsraster:getcoverage","response is base64 encoded which may impact layer display performance"),null===e||void 0===e?void 0:e.contentData}const h=new Uint8Array(d.data,0,Math.min(d.data.byteLength,2e3)),f=String.fromCharCode.apply(null,h).toLowerCase().includes("exception"),g=f&&String.fromCharCode.apply(null,h).includes("A non-zero RESX/RESY or WIDTH/HEIGHT is required but neither was provided");if(f)throw new r.default("wcsraster:getcoverage","server returns an exception",{isResolutionMismatch:g});throw new r.default("wcsraster:getcoverage","response is not a supported multipart mediaType with inline tiff")}_getInterpolationIndex(e){var t;return e&&null!==(t=this.coverageInfo.supportedInterpolations)&&void 0!==t&&t.includes(e)?"nearest"===e?0:"bilinear"===e?1:"cubic"===e?2:0:0}_getCoverage100Parameters(e,t,n,i){const o="".concat(e.xmin,",").concat(e.ymin,",").concat(e.xmax,",").concat(e.ymax),a=e.spatialReference.wkid,s=(this.coverageInfo.supportedFormats||[]).find((e=>e.toLowerCase().includes("tiff")))||"GEOTIFF",{bandIds:r,interpolation:l}=i,c=this._getInterpolationIndex(l),d=r?r.map((e=>this.coverageInfo.bandNames[e])):null,u=V[c],{multidimensionalDefinition:p}=i;let h;if(null!=p&&null!=this.rasterInfo.multidimensionalInfo){const e=p.find((e=>"StdTime"===e.dimensionName));let t=null===e||void 0===e?void 0:e.values;t&&t.length>0&&(Array.isArray(t[0])&&(t=t[0]),h=t.map((e=>q(e))).join(","))}return{service:"WCS",request:"GetCoverage",version:this.version,coverage:this.coverageId,format:s,crs:"EPSG:".concat(a),bbox:o,width:t,height:n,time:h,interpolation:u,band:null===d||void 0===d?void 0:d.join(",")}}_getCoverage110Parameters(e,t,n,i,o){var a;const{multidimensionalDefinition:s,bandIds:r,interpolation:l}=i,c=e.spatialReference.wkid,d="urn:ogc:def:crs:EPSG::".concat(c),u=(this.coverageInfo.supportedFormats||[]).find((e=>e.toLowerCase().includes("tiff")))||"image/tiff",p=this._getInterpolationIndex(l),h=F[p],f=null==l||0===(null===(a=this.coverageInfo.supportedInterpolations)||void 0===a?void 0:a.indexOf(l)),g=o.domain.spatialDomain,v=g.origin.x<=g.envelope.xmin&&g.origin.y<=g.envelope.ymin,m=e.width/t,y=e.height/n*(v?1:-1),w=v?[e.xmin,e.ymin]:[e.xmin,e.ymax],b=g.useEPSGAxis&&(0,T.m)(c),I=b?"".concat(w[1],",").concat(w[0]):"".concat(w[0],",").concat(w[1]),C=this.ioConfig.use2GridOffsets,x=b?C?"".concat(y,",").concat(m):"".concat(y,",0,0,").concat(m):C?"".concat(m,",").concat(y):"".concat(m,",0,0,").concat(y),S=m/2,A=e.xmin+S,_=e.xmax-S,M=Math.abs(y)/2,P=e.ymin+M,L=e.ymax-M,D=b?"".concat(P,",").concat(A,",").concat(L,",").concat(_,",").concat(d):"".concat(A,",").concat(P,",").concat(_,",").concat(L,",").concat(d),E=o.range.find((e=>e.axis.some((e=>e.identifier.toLowerCase().includes("band")))));let O,R=E&&h&&r?f?"".concat(E.identifier,"[").concat(E.axis[0].identifier,"[").concat(r.join(","),"]]"):"".concat(E.identifier,":").concat(h,"[").concat(E.axis[0].identifier,"[").concat(r.join(","),"]]"):null;if(null!=s&&s.length)for(let T=0;T<s.length;T++){var k,j;let e=s[T].values;const t=null===(k=s[T].dimensionName)||void 0===k?void 0:k.toLowerCase(),n=null===(j=s[T].variableName)||void 0===j?void 0:j.toLowerCase(),i=o.range.find((e=>e.identifier.toLowerCase()===n));if(e.length>0)if(Array.isArray(e[0])&&(e=e[0]),"stdtime"===t)O=e.map((e=>q(e))).join(",");else if(i){const n=i.axis.find((e=>e.identifier.toLowerCase()===t));n&&(R=f?i.identifier+"["+n.identifier+"["+e.join(",")+"]]":i.identifier+":"+h+"["+n.identifier+"["+e.join(",")+"]]")}T===s.length-1&&i&&!R&&(R=f?i.identifier:i.identifier+":"+h)}return{service:"WCS",request:"GetCoverage",version:this.version,identifier:this.coverageId,format:u,crs:"EPSG:".concat(c),boundingbox:D,gridCS:"urn:ogc:def:cs:OGC:0.0:Grid2dSquareCS",gridType:"urn:ogc:def:method:WCS:1.1:2dGridIn2dCrs",gridOrigin:I,gridOffsets:x,gridBaseCRS:d,timeSequence:O,rangeSubset:R}}_getCoverage201Parameters(e,t,n,i,o,a){const{multidimensionalDefinition:s,interpolation:r}=o,l=this._getInterpolationIndex(r);let c=null;const{supportedInterpolations:d}=this.capabilities;if(null!==d&&void 0!==d&&d.length)switch(l){case 0:c=d.find((e=>e.toLowerCase().includes("nearest")));break;case 1:c=d.find((e=>e.toLowerCase().includes("linear")));break;case 2:c=d.find((e=>e.toLowerCase().includes("cubic")||e.toLowerCase().includes("quadratic")))}const u=(this.coverageInfo.supportedFormats||[]).find((e=>e.toLowerCase().includes("tiff")))||"image/tiff",{bandNames:p}=this.coverageInfo,{boundedBy:h,domainSet:f,rangeType:g}=a,v=h.isEastFirst?0:1,m=1-v,{axisLabels:y}=h,w=y[v],b=y[m],I="http://www.opengis.net/def/crs/EPSG/0/".concat(e.spatialReference.wkid),C=I,x=[];x.push("".concat(w,"(").concat(e.xmin,",").concat(e.xmax,")")),x.push("".concat(b,"(").concat(e.ymin,",").concat(e.ymax,")"));const S=[];if(y.length>2)for(let D=2;D<y.length;D++){const e=f.origin[D];if(y[D].toLowerCase().includes("time")){var A;let t=e.toString();null!==(A=h.uomLabels)&&void 0!==A&&A[D].toLowerCase().includes("ole")&&(S.push(y[D]),t=q(e,!0)),x.push(y[D]+",http://www.opengis.net("+t+")")}else x.push(y[D]+",http://www.opengis.net("+e+")")}let _=null;if(null!=s&&s.length){const e=[];g.forEach((t=>t.forEach((t=>e.push(t.name)))));const t=[];for(let n=0;n<s.length;n++){const i=y.find((e=>e===s[n].dimensionName)),o=e.find((e=>e===s[n].variableName));if(t.includes(o)||t.push(o),i){let e=s[n].values;if(e.length>0){Array.isArray(e[0])&&(e=e[0]);let t="";t=i.toLowerCase().includes("time")?e.map((e=>q(e))).join(","):e.join(",");const n=x.findIndex((e=>0===e.indexOf(i+",http://www.opengis.net")));-1===n&&x.push(i+",http://www.opengis.net("+t+")"),-1===n||x[n].includes("("+t+")")||x.splice(n,1,i+",http://www.opengis.net("+t+")")}}}t.length&&(_=t.join(","))}else(null===p||void 0===p?void 0:p.length)>=2&&(_=(o.bandIds?o.bandIds.map((e=>p[e])):p).join(","));const T=x.join("&subset="),M=!a.domainSet.hasSameAxisLabelsAsBoundedBy&&!1!==this.ioConfig.allowScaleFactor,P=M?null:"".concat(w,"(").concat(t,"),").concat(b,"(").concat(n,")"),L=M?1/i:null;return{service:"WCS",request:"GetCoverage",version:this.version,coverageId:this.coverageId,rangesubset:_,interpolation:c,scaleSize:P,scaleFactor:L,subset:T,format:u,mediaType:this.ioConfig.allowAnyMediaType?null:"multipart/related",outputcrs:I,subsettingcrs:C}}_constructWCS201Url(e){const t=(0,i.A)((0,i.A)({},this.ioConfig.customFetchParameters),e),n=[];return Object.keys(t).forEach((e=>{const i=t[e];null!=i&&("subset"===e?"string"==typeof i&&i.split("&subset=").forEach((e=>{e&&n.push("subset=".concat(encodeURIComponent(e)))})):n.push("".concat(e,"=").concat(encodeURIComponent(i))))})),"".concat(encodeURI(this.url),"?").concat(n.join("&"))}};function q(e){return(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?new Date((0,D.$E)(e)):new Date(e)).toISOString()}(0,o._)([(0,u.MZ)({type:String,json:{write:!0}})],N.prototype,"datasetFormat",void 0),(0,o._)([(0,u.MZ)({readOnly:!0})],N.prototype,"tileType",void 0),(0,o._)([(0,u.MZ)({type:String,json:{write:!0}})],N.prototype,"version",void 0),(0,o._)([(0,u.MZ)({type:String,json:{write:!0}})],N.prototype,"coverageId",void 0),(0,o._)([(0,u.MZ)({readOnly:!0})],N.prototype,"rasterId",null),N=(0,o._)([(0,h.$)("esri.layers.support.rasterDatasets.WCSRaster")],N);const B=N;var U=n(30973),H=n(61701);const z=new Set(["milliseconds","seconds","minutes","hours","days","weeks","months","years","decades","centuries"]);let X=class extends((0,g.dM)((0,I.j)((0,y.q)((0,w.A)((0,v.d)((0,m.o)((0,C.e)((0,b.J)((0,l.P)(s.A.ClonableMixin(f.default))))))))))){constructor(){super(...arguments),this.coverageId=null,this.version=null,this.isReference=null,this.legendEnabled=!0,this.noData=0,this.operationalLayerType="WCS",this.type="wcs",this.popupEnabled=!0,this.popupTemplate=null,this.fields=null,this._debouncedSaveOperations=(0,c.debounce)((async(e,t,i)=>{const{save:o,saveAs:a}=await n.e(20964).then(n.bind(n,20964));switch(e){case H.X.SAVE:return o(this,t);case H.X.SAVE_AS:return a(this,i,t)}}))}normalizeCtorArgs(e,t){return"string"==typeof e?(0,i.A)({url:e},t):e}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WCS"]},e).catch(c.throwIfAbortError).then((()=>this._openRaster(t)))),Promise.resolve(this)}get coverageInfo(){return this.raster.coverageInfo}get defaultPopupTemplate(){return this.createPopupTemplate()}get rasterFields(){return[(0,A.rZ)("Pixel Value")]}createPopupTemplate(e){return(0,U.createPopupTemplate)({fields:this.rasterFields,title:this.title},e)}async save(e){return this._debouncedSaveOperations(H.X.SAVE,e)}async saveAs(e,t){return this._debouncedSaveOperations(H.X.SAVE_AS,t,e)}async _openRaster(e){const t=new B({url:this.url,version:this.version,coverageId:this.coverageId,ioConfig:(0,i.A)((0,i.A)({sampling:"closest"},this.ioConfig),{},{customFetchParameters:this.customParameters})});if(await t.open({signal:e}),!t.rasterInfo)throw t.destroy(),new r.default("wcs-layer:load","cannot load resources on "+this.url);const{rasterInfo:n}=t;null==n.noDataValue&&(n.noDataValue=this.noData),this._set("serviceRasterInfo",n),this._set("spatialReference",n.spatialReference),null==this.title&&this.setAtOrigin("title",t.datasetName,"service"),null==this.coverageId&&this.setAtOrigin("coverageId",t.coverageInfo.id,"service"),null==this.version&&t.version&&this.setAtOrigin("version",t.version,"service"),this.setAtOrigin("tileInfo",t.rasterInfo.storageInfo.tileInfo,"service");const{multidimensionalInfo:o}=n;if(null!=o){const e=o.variables[0].dimensions.find((e=>{let{name:t}=e;return"StdTime"===t}));if(e){var a,s,l,c,u,p;let t=null!==(a=null===(s=e.extent)||void 0===s?void 0:s[0])&&void 0!==a?a:e.values[0];Array.isArray(t)&&(t=t[0]);let n=null!==(l=null===(c=e.extent)||void 0===c?void 0:c[1])&&void 0!==l?l:e.values[e.values.length-1];Array.isArray(n)&&(n=n[1]);const i=z.has(null===(u=e.intervalUnit)||void 0===u?void 0:u.toLowerCase())?null===(p=e.intervalUnit)||void 0===p?void 0:p.toLowerCase():null;this.set("timeInfo",{startField:"StdTime",fullTimeExtent:{start:t,end:n},timeZone:null,interval:i?{value:e.interval,unit:i}:null})}}this.raster=t,this._configDefaultSettings(),this.addHandles((0,d.watch)((()=>this.customParameters),(e=>this.raster.ioConfig.customFetchParameters=e)))}};(0,o._)([(0,u.MZ)({type:String,nonNullable:!0,json:{name:"wcsInfo.coverageId",write:{isRequired:!0,ignoreOrigin:!0}}})],X.prototype,"coverageId",void 0),(0,o._)([(0,u.MZ)()],X.prototype,"coverageInfo",null),(0,o._)([(0,u.MZ)({type:["1.0.0","1.1.0","1.1.1","1.1.2","2.0.1"],nonNullable:!0,json:{name:"wcsInfo.version",write:{isRequired:!0,ignoreOrigin:!0}}})],X.prototype,"version",void 0),(0,o._)([(0,u.MZ)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],X.prototype,"isReference",void 0),(0,o._)([(0,u.MZ)({json:{read:!0,write:!0}})],X.prototype,"blendMode",void 0),(0,o._)([(0,u.MZ)(x.fV)],X.prototype,"legendEnabled",void 0),(0,o._)([(0,u.MZ)({type:["show","hide"]})],X.prototype,"listMode",void 0),(0,o._)([(0,u.MZ)()],X.prototype,"noData",void 0),(0,o._)([(0,u.MZ)({type:["WCS"]})],X.prototype,"operationalLayerType",void 0),(0,o._)([(0,u.MZ)()],X.prototype,"raster",void 0),(0,o._)([(0,u.MZ)({readOnly:!0})],X.prototype,"type",void 0),(0,o._)([(0,u.MZ)(x.M6)],X.prototype,"popupEnabled",void 0),(0,o._)([(0,u.MZ)({type:a.default,json:{name:"popupInfo",write:!0}})],X.prototype,"popupTemplate",void 0),(0,o._)([(0,u.MZ)({readOnly:!0})],X.prototype,"defaultPopupTemplate",null),(0,o._)([(0,u.MZ)({readOnly:!0,type:[S.default]})],X.prototype,"fields",void 0),(0,o._)([(0,u.MZ)({readOnly:!0,type:[S.default]})],X.prototype,"rasterFields",null),X=(0,o._)([(0,h.$)("esri.layers.WCSLayer")],X);const $=X}}]);
//# sourceMappingURL=60540.2e8f2a81.chunk.js.map