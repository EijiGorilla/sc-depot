"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[91043],{90806:(e,t,i)=>{i.d(t,{M:()=>p,b:()=>_});var n,s,a,r=i(57528),o=i(3799),l=i(58350),d=i(21390),c=i(86955),u=i(66470),h=i(2687),g=i(75569);function _(e){const t=new h.N5,{vertex:i,fragment:_}=t;(0,o.NB)(i,e),i.uniforms.add(new d.m("width",(e=>e.width))),t.attributes.add(u.r.POSITION,"vec3"),t.attributes.add(u.r.NORMAL,"vec3"),t.attributes.add(u.r.UV0,"vec2"),t.attributes.add(u.r.LENGTH,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.main.add((0,c.H)(n||(n=(0,r.A)(["vec3 bitangent = normal;\nvtc = uv0;\nvlength = length;\nvradius = 0.5 * width;\nvec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);\ngl_Position = proj * pos;"])))),_.uniforms.add(new d.m("outlineSize",(e=>e.outlineSize)),new l.E("outlineColor",(e=>e.outlineColor)),new d.m("stripeLength",(e=>e.stripeLength)),new l.E("stripeEvenColor",(e=>e.stripeEvenColor)),new l.E("stripeOddColor",(e=>e.stripeOddColor)));const p=1/Math.sqrt(2);return _.code.add((0,c.H)(s||(s=(0,r.A)(["\n    const float INV_SQRT2 = ",";\n\n    vec4 arrowColor(vec2 tc, float len) {\n      float d = INV_SQRT2 * (tc.x - abs(tc.y));\n      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n      d = min(d, 1.0 - abs(tc.y));\n\n      if (d < 0.0) {\n        return vec4(0.0);\n      }\n      if (d < outlineSize) {\n        return outlineColor;\n      }\n      return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;\n    }"])),c.H.float(p))),_.main.add((0,c.H)(a||(a=(0,r.A)(["\n    vec2 ntc = vec2(vtc.x / vradius, vtc.y);\n    vec4 color = arrowColor(ntc, vlength / vradius);\n    if (color.a < ",") {\n      discard;\n    }\n    fragColor = color;"])),c.H.float(g.Q))),t}const p=Object.freeze(Object.defineProperty({__proto__:null,build:_},Symbol.toStringTag,{value:"Module"}))},91043:(e,t,i)=>{i.r(t),i.d(t,{default:()=>ze});var n=i(35143),s=i(91967),a=(i(81806),i(30726)),r=i(46053),o=i(76460),l=(i(47249),i(85842)),d=i(16159),c=i(2522),u=i(87562),h=i(24648),g=i(68134),_=i(31633),p=i(17430),v=i(29772),m=i(23739);let w=class extends s.default{constructor(e){super(e)}initialize(){this.addHandles([(0,g.watch)((()=>({viewData:this.viewData,startPoint:this.analysis.startPoint})),(e=>{let{viewData:t,startPoint:i}=e;t.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(i)}),g.syncAndInitial),(0,g.watch)((()=>({viewData:this.viewData,endPoint:this.analysis.endPoint})),(e=>{let{viewData:t,endPoint:i}=e;t.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(i)}),g.syncAndInitial),(0,g.watch)((()=>({result:this._computedResult,viewData:this.viewData})),(e=>{let{result:t,viewData:i}=e;i.result=t}),g.syncAndInitial)])}_applyProjectionAndElevationAlignment(e){if(null==e)return e;const{spatialReference:t,elevationProvider:i}=this.view,n=(0,p.B)(e,t,i);return null!==n&&void 0!==n?n:((0,p.V)(this.analysis,e.spatialReference,o.A.getLogger(this)),null)}get _computedResult(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,measurementMode:i,unit:n}=this.viewData;if(null==e||null==t)return null;const s=(0,v.NH)(e,t),a=(0,m.Og)(e,t);if(null==s)return null;let r,o;switch(i){case u.G.Auto:o=null!=a?"geodesic":"euclidean",r=null!==a&&void 0!==a?a:s.horizontal;break;case u.G.Geodesic:if(null==a)return null;o="geodesic",r=a;break;case u.G.Euclidean:o="euclidean",r=s.horizontal}let l=s.direct,d=s.vertical;const c=(0,_.Vs)(l.value,l.unit,n),g=(0,_.Vs)(r.value,r.unit,n),p=(0,_.jE)(d.value,d.unit,n);return l=(0,h.kM)(l,c),r=(0,h.kM)(r,g),d=(0,h.kM)(d,p),{mode:o,directDistance:l,horizontalDistance:r,verticalDistance:d}}};(0,n._)([(0,r.MZ)()],w.prototype,"view",void 0),(0,n._)([(0,r.MZ)()],w.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)()],w.prototype,"viewData",void 0),(0,n._)([(0,r.MZ)()],w.prototype,"_computedResult",null),w=(0,n._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],w);var y=i(89379),b=(i(11265),i(59784)),A=i(15941),L=i(11113),M=i(76931),f=i(19555),C=i(20664),E=i(9392),O=i(57612),P=i(4244),S=i(66747),V=i(7256),z=i(88321),T=i(13191),D=i(43047),x=i(55855),R=i(75762),G=i(32314),Z=i(81923),H=i(71372),k=i(62577),N=i(45463),j=i(48549),I=i(34981),Q=i(59696),W=i(77730),U=i(66470),q=i(16506),B=i(59246),F=i(60322),$=i(90806),J=i(93345),X=i(57162);class Y extends B.w{constructor(e,t){super(e,t,new q.$($.M,(()=>i.e(59492).then(i.bind(i,59492)))),K),this.primitiveType=J.WR.TRIANGLE_STRIP}initializePipeline(e){return(0,X.Ey)({blending:e.transparent?(0,F.Yf)(e.oitPass):null,polygonOffset:e.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:J.MT.LESS},depthWrite:X.Uy,colorWrite:X.kn})}}const K=new Map([[U.r.POSITION,0],[U.r.NORMAL,1],[U.r.UV0,2],[U.r.LENGTH,3]]);var ee=i(6485),te=i(94570);class ie extends te.E{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1}}(0,n._)([(0,ee.W)()],ie.prototype,"polygonOffsetEnabled",void 0),(0,n._)([(0,ee.W)()],ie.prototype,"transparent",void 0);var ne=i(75569);class se extends N.im{constructor(e){super(e,re),this._configuration=new ie,this.vertexAttributeLocations=K,this.produces=new Map([[W.N.OPAQUE_MATERIAL,e=>!this._transparent&&(0,I.RN)(e)],[W.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>this._transparent&&(0,I.RN)(e)]])}getConfiguration(e,t){return this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this._transparent,this._configuration.oitPass=t.oitPass,this._configuration}get visible(){const{outlineColor:e,stripeEvenColor:t,stripeOddColor:i}=this.parameters;return e[3]>=ne.Q||t[3]>=ne.Q||i[3]>=ne.Q}intersect(){}createGLMaterial(e){return new ae(e)}createBufferWriter(){return new ge}get _transparent(){const{parameters:e}=this;return e.outlineColor[3]<1||e.stripeEvenColor[3]<1||e.stripeOddColor[3]<1}}class ae extends Q.A{beginSlot(e){return this.getTechnique(Y,e)}}class re extends N.qA{constructor(){super(...arguments),this.width=32,this.outlineSize=.2,this.outlineColor=(0,x.fA)(1,.5,0,1),this.stripeEvenColor=(0,x.fA)(1,1,1,1),this.stripeOddColor=(0,x.fA)(1,.5,0,1),this.stripeLength=1,this.polygonOffset=!1}}const oe=(0,j.BP)().vec3f(U.r.POSITION).vec3f(U.r.NORMAL).vec2f(U.r.UV0).f32(U.r.LENGTH),le=(0,E.vt)(),de=(0,E.vt)(),ce=(0,E.vt)(),ue=(0,E.vt)(),he=(0,E.vt)();class ge{constructor(){this.vertexBufferLayout=oe}elementCount(e){return 2*(e.get(U.r.POSITION).indices.length/2+1)}write(e,t,i,n,s,a){const{data:r,indices:o}=i.get(U.r.POSITION),l=i.get(U.r.NORMAL).data,d=r.length/3;o&&o.length!==2*(d-1)&&console.warn("MeasurementArrowMaterial does not support indices");const c=le,u=de,h=ce,g=ue,_=he,p=s.position,v=s.normal,m=s.uv0;let w=0;for(let b=0;b<d;++b){const i=3*b;if((0,C.i)(c,r[i],r[i+1],r[i+2]),b<d-1){const e=3*(b+1);(0,C.i)(u,r[e],r[e+1],r[e+2]),(0,C.i)(_,l[e],l[e+1],l[e+2]),(0,C.n)(_,_),(0,C.d)(h,u,c),(0,C.n)(h,h),(0,C.e)(g,_,h),(0,C.n)(g,g)}const n=(0,C.j)(c,u);e&&t&&((0,C.t)(c,c,e),(0,C.t)(u,u,e),(0,C.t)(g,g,t));const s=a+2*b,o=s+1;p.setVec(s,c),p.setVec(o,c),v.setVec(s,g),v.setVec(o,g),m.set(s,0,w),m.set(s,1,-1),m.set(o,0,w),m.set(o,1,1),b<d-1&&(w+=n)}const y=s.length;for(let b=0;b<2*d;++b)y.set(a+b,w)}}class _e extends G.X{constructor(e){super(e),this._arrowWidth=16,this._arrowSubdivisions=128,this._origin=(0,E.vt)(),this._originTransform=(0,T.vt)(),this._arrowCenter=(0,E.vt)(),this._renderOccluded=N.m$.OccludeAndTransparent,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._color=(0,x.vt)(),this._contrastColor=(0,x.vt)(),this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){var t;e!==this._renderOccluded&&(this._renderOccluded=e,null===(t=this._arrowMaterial)||void 0===t||t.setParameters({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this._stripesEnabled?this._contrastColor:this._color;this._arrowMaterial.setParameters({stripeEvenColor:e})}}get color(){return this._color}set color(e){(0,b.we)(e,this._color)||((0,D.c)(this._color,e),this._updateArrowColor())}get contrastColor(){return this._contrastColor}set contrastColor(e){(0,b.we)(e,this._color)||((0,D.c)(this._contrastColor,e),this._updateArrowColor())}createExternalResources(){const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e;this._arrowMaterial=new se({outlineColor:e,stripeEvenColor:i,stripeOddColor:e,renderOccluded:this.renderOccluded,polygonOffset:!0,isDecoration:this.isDecoration}),this._handles=new z.default,this._handles.add((0,g.watch)((()=>this.view.state.camera),(()=>{this._viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles=(0,a.pR)(this._handles)}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){var t;if(null==(null===(t=this._geometry)||void 0===t?void 0:t.startRenderSpace)||null==this._geometry.endRenderSpace)return;const i=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);i.transformation=this._originTransform,e.addGeometry(i),this._viewChanged()}_createArrowGeometry(e,t,i,n){const s=this.view,a=s.renderCoordsHelper,r=[],o=[],l=(e,t)=>{const n=R.rq.get();(0,C.d)(n,e,i),r.push(n),o.push(t)};if("euclidean"===n.type){n.eval(.5,this._arrowCenter);const i=R.rq.get();if(a.worldUpAtPosition(this._arrowCenter,i),function(e,t,i){const n=(0,C.a)(pe,t,e),s=(0,C.e)(pe,n,i);return 0===(0,C.H)(s)}(e,t,i)){const{heading:t,tilt:n}=s.camera,{direction:a}=(0,Z.ZC)(s,e,t,n,ve);(0,C.c)(i,a)}l(e,i),l(t,i)}else{n.eval(.5,this._arrowCenter);const e=this._arrowSubdivisions+1&-2;for(let t=0;t<e;++t){const i=t/(e-1),s=R.rq.get(),r=R.rq.get();n.eval(i,s),a.worldUpAtPosition(s,r),l(s,r)}}return(0,k.Z8)(this._arrowMaterial,r,o)}_geometryChanged(){this.recreateGeometry()}_viewChanged(){if(this.view.ready&&this.attached&&null!=this._geometry){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._arrowWidth*e})}}_updateArrowColor(){if(!this.attached)return;const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e,n=e,s=e;this._arrowMaterial.setParameters({stripeEvenColor:i,outlineColor:n,stripeOddColor:s})}}const pe=(0,E.vt)(),ve=(0,H.NP)();var me=i(47996),we=i(25191),ye=i(35925),be=i(90659),Ae=i(38042),Le=i(63860);let Me=class extends s.default{get _parameters(){const e=this.view.effectiveTheme,{accentColor:t,textColor:i}=e,n=(0,b.QP)(t),s=(0,b.f6)(t,.75),a=(0,b.QP)((0,b.bJ)(t)),r=(0,b.bJ)(i,b.pW.Low);return{accentColor:n,contrastColor:a,translucentAccentColor:s,triangleLineWidth:3,geodesicProjectionLineWidth:2,guideLineWidth:2,guideStippleLengthPixels:3,directLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12,textColor:i,textBackgroundColor:(0,b._L)(r,.6),textCalloutColor:(0,b._L)(r,.5)}}get visible(){return this.analysisView.visible}get viewMode(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView;if(null==e||null==t||e.equals(t))return O.n.None;const i=this.analysisView.result;if(null==i)return O.n.Direct;if("geodesic"===this.actualVisualizedMeasurement)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?O.n.ProjectedGeodesic:O.n.Direct;const{verticalDistance:n,horizontalDistance:s}=i,a=(0,h.kM)(n,"meters").value,r=(0,h.kM)(s,"meters").value;return Math.min(a/r,r/a)<this.triangleCollapseRatioThreshold?O.n.Direct:O.n.Triangle}get actualVisualizedMeasurement(){const{measurementMode:e,result:t}=this.analysisView;switch(e){case u.G.Auto:return null!=t&&(0,h.kM)(t.horizontalDistance,"meters").value>be.U7?"geodesic":"euclidean";case u.G.Euclidean:return"euclidean";case u.G.Geodesic:return"geodesic"}}get allowVisualElementsOrientationChange(){return null==this._triangleOrientationOverride}set allowVisualElementsOrientationChange(e){null==this._triangleOrientationOverride!==e&&(null==this._triangleOrientationOverride?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}get labels(){return"geodesic"===this.actualVisualizedMeasurement?{direct:null,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}constructor(e){super(e),this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=(0,E.vt)(),this._endPosition=(0,E.vt)(),this._cornerPosition=(0,E.vt)(),this._startPositionAtSeaLevel=(0,E.vt)(),this._endPositionAtSeaLevel=(0,E.vt)(),this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.visualElementOrientation=O.f.Auto,this.triangleCollapseRatioThreshold=.03}initialize(){const e=this._parameters,t={attached:!0,view:this.view,isDecoration:!0},{guideLineWidth:i,guideStippleLengthPixels:n,triangleLineWidth:s,geodesicProjectionLineWidth:a,directLabelFontSize:r,verticalLabelFontSize:o,horizontalLabelFontSize:l}=e;this._segmentVisualElement=new _e((0,y.A)((0,y.A)({},t),{},{geometry:null,renderOccluded:N.m$.OccludeAndTransparent})),this._triangleVisualElement=new V.t((0,y.A)((0,y.A)({},t),{},{width:s,renderOccluded:N.m$.OccludeAndTransparent})),this._rightAngleQuad=new me.n((0,y.A)((0,y.A)({},t),{},{renderOccluded:N.m$.OccludeAndTransparent}));const d=(0,y.A)((0,y.A)({},t),{},{polygonOffset:!0,renderOccluded:N.m$.OccludeAndTransparent});this._projectedGeodesicLine=new V.t((0,y.A)((0,y.A)({},d),{},{width:a,stipplePattern:(0,ye.wk)(n)})),this._geodesicStartHint=new V.t((0,y.A)((0,y.A)({},d),{},{width:i,stipplePattern:(0,ye.wk)(n)})),this._geodesicEndHint=new V.t((0,y.A)((0,y.A)({},d),{},{width:i,stipplePattern:(0,ye.wk)(n)})),this._segmentLabel=new S.N((0,y.A)((0,y.A)({},t),{},{fontSize:r})),this._verticalLabel=new S.N((0,y.A)((0,y.A)({},t),{},{fontSize:o})),this._horizontalLabel=new S.N((0,y.A)((0,y.A)({},t),{},{fontSize:l})),this.addHandles([(0,g.watch)((()=>{const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView,i=this.view;return{view:i,camera:i.state.camera,viewMode:this.viewMode,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,orientation:this._actualVisualElementsOrientation,visualizedMeasurement:this.actualVisualizedMeasurement,stripeLength:this._measurementArrowStripeLength}}),(e=>this._updateGeometryAndViewMode(e)),g.syncAndInitial),(0,g.watch)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateVisualElementVisibility(e)),g.syncAndInitial),(0,g.watch)((()=>({text:this._labelsText,visualizedMeasurement:this.actualVisualizedMeasurement})),(e=>this._updateLabelText(e)),g.syncAndInitial),(0,g.watch)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateLabelVisibility(e)),g.syncAndInitial),(0,g.watch)((()=>this._measurementArrowStripeLength),(e=>this._updateSegmentStripeLength(e)),g.syncAndInitial),(0,Ae.oQ)((async()=>this._updateMessageBundle())),(0,g.watch)((()=>this._parameters),(e=>{let{textBackgroundColor:t,textCalloutColor:i,textColor:n,translucentAccentColor:s,accentColor:a,contrastColor:r}=e;const{_segmentLabel:o,_verticalLabel:l,_horizontalLabel:d,_triangleVisualElement:c,_rightAngleQuad:u,_projectedGeodesicLine:h,_geodesicStartHint:g,_geodesicEndHint:_,_segmentVisualElement:p}=this;o.backgroundColor=t,o.calloutColor=i,o.textColor=n,l.backgroundColor=t,l.calloutColor=i,l.textColor=n,d.backgroundColor=t,d.calloutColor=i,d.textColor=n,c.color=s,u.color=s,h.color=s,g.color=s,_.color=s,p.color=a,p.contrastColor=r}),g.initial)]),this._updateMessageBundle()}destroy(){this._segmentVisualElement=(0,a.pR)(this._segmentVisualElement),this._triangleVisualElement=(0,a.pR)(this._triangleVisualElement),this._rightAngleQuad=(0,a.pR)(this._rightAngleQuad),this._projectedGeodesicLine=(0,a.pR)(this._projectedGeodesicLine),this._geodesicStartHint=(0,a.pR)(this._geodesicStartHint),this._geodesicEndHint=(0,a.pR)(this._geodesicEndHint),this._segmentLabel=(0,a.pR)(this._segmentLabel),this._verticalLabel=(0,a.pR)(this._verticalLabel),this._horizontalLabel=(0,a.pR)(this._horizontalLabel),this.set("view",null)}_updateVisualElementVisibility(e){let{visible:t,viewMode:i}=e;if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,t)switch(i){case O.n.None:break;case O.n.Direct:this._segmentVisualElement.visible=!0;break;case O.n.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case O.n.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode(e){let{view:t,camera:i,viewMode:n,elevationAlignedStartPoint:s,elevationAlignedEndPoint:a,orientation:r,visualizedMeasurement:o,stripeLength:l}=e;const d=t.renderCoordsHelper;if(null==d||null==s||null==a||s.equals(a))return;let c=this._startPosition,u=this._endPosition;d.toRenderCoords(s,c),d.toRenderCoords(a,u);const h=r===O.f.AboveSegment?1:-1,g=h*(d.getAltitude(u)-d.getAltitude(c));g<0&&(c=this._endPosition,u=this._startPosition);const _="geodesic"===o?new we.J(this._startPosition,this._endPosition,d.spatialReference):new we.C(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=_,this._updateSegmentStripeLength(l),n){case O.n.Direct:this._updateSegment(_,r);break;case O.n.Triangle:this._updateSegmentAndTriangle({view:t,camera:i,segment:_,orientation:r,startPosition:c,endPosition:u,deltaSign:h,altitudeDelta:g});break;case O.n.ProjectedGeodesic:this._updateSegmentAndProjection({view:t,orientation:r,startPosition:c,endPosition:u})}}_updateSegment(e,t){this._segmentLabel.anchor=t===O.f.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}_updateSegmentAndTriangle(e){let{view:{renderCoordsHelper:t},camera:i,segment:n,orientation:s,startPosition:a,endPosition:r,deltaSign:o,altitudeDelta:l}=e;const d=this._cornerPosition;t.worldUpAtPosition(a,d),(0,C.h)(d,d,o*Math.abs(l)),(0,C.g)(d,d,a),this._triangleVisualElement.geometry=[[[a[0],a[1],a[2]],[d[0],d[1],d[2]],[r[0],r[1],r[2]]]],this._rightAngleQuad.geometry={previous:a,center:d,next:r};const c=new we.C(a,d),u=new we.C(d,r),h=function(e,t,i,n,s){const a=Ce,r=Ee;s.projectToRenderScreen(i,a),s.projectToRenderScreen(t,r);const o={segment:"bottom",horizontal:"top",vertical:a[0]<r[0]?"left":"right"};{const n=Oe,a=Pe;if((0,P.Q)(e,i,s,n),(0,P.Q)(e,t,s,a),(0,f.Om)(n,a)>=fe){const e=Math.sign(n[1])===Math.sign(a[1]);o.segment=e?(0,S.R)(o.vertical):o.vertical}else{const e=Se;(0,P.Q)(i,t,s,e),(0,f.Om)(e,a)>=fe&&(o.segment=Math.sign(e[0])===Math.sign(a[0])?(0,S.R)(o.horizontal):o.horizontal)}}if(n===O.f.BelowSegment){const e=e=>"top"===e?"bottom":"top";o.segment=e(o.segment),o.horizontal=e(o.horizontal),o.vertical=e(o.vertical)}return o}(a,r,d,s,i);this._segmentLabel.anchor=h.segment,this._segmentLabel.geometry={type:"segment",segment:n,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:c,sampleLocation:"center"},this._verticalLabel.anchor=h.vertical,this._horizontalLabel.geometry={type:"segment",segment:u,sampleLocation:"center"},this._horizontalLabel.anchor=h.horizontal}_updateSegmentAndProjection(e){let{view:{renderCoordsHelper:t},orientation:i,startPosition:n,endPosition:s}=e;t.setAltitude(this._startPositionAtSeaLevel,0,n),t.setAltitude(this._endPositionAtSeaLevel,0,s);const a=new we.J(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(a),this._geodesicStartHint.setGeometryFromSegment(new we.C(this._startPositionAtSeaLevel,n)),this._geodesicEndHint.setGeometryFromSegment(new we.C(this._endPositionAtSeaLevel,s)),this._segmentLabel.geometry={type:"segment",segment:a,sampleLocation:"center"},this._segmentLabel.anchor=i===O.f.AboveSegment?"top":"bottom"}_updateLabelText(e){let{text:t,visualizedMeasurement:i}=e;null!=t?(this._segmentLabel.text="euclidean"===i?t.directDistance:t.horizontalDistance,this._horizontalLabel.text=t.horizontalDistance,this._verticalLabel.text=t.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}_updateLabelVisibility(e){let{visible:t,viewMode:i}=e;const n=this._segmentLabel,s=this._horizontalLabel,a=this._verticalLabel;if(n.visible=!1,s.visible=!1,a.visible=!1,t)switch(i){case O.n.Direct:n.visible=!0;break;case O.n.Triangle:n.visible=!0,s.visible=!0,a.visible=!0;break;case O.n.ProjectedGeodesic:n.visible=!0;case O.n.None:}}get _labelsText(){if(this.destroyed)return null;const e=this.messages,t=this.analysisView.result;if(null==t||null==e)return null;const{directDistance:i,horizontalDistance:n,verticalDistance:s}=t,a=this.analysisView.unit,r=e=>(0,y.A)({directDistance:"",horizontalDistance:"",verticalDistance:""},e);switch(a){case"metric":return r({directDistance:i&&(0,L.Ee)(e,i),horizontalDistance:n&&(0,L.Ee)(e,n),verticalDistance:s&&(0,L.W4)(e,s)});case"imperial":return r({directDistance:i&&(0,L.tr)(e,i),horizontalDistance:n&&(0,L.tr)(e,n),verticalDistance:s&&(0,L.t_)(e,s)});default:return r({directDistance:i&&(0,L.zJ)(e,i,a),horizontalDistance:n&&(0,L.zJ)(e,n,a),verticalDistance:s&&(0,L.zJ)(e,s,a)})}}_updateSegmentStripeLength(e){const t=this._segmentVisualElement;null!=e?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}get _actualVisualElementsOrientation(){if(null!=this._triangleOrientationOverride)return this._triangleOrientationOverride;const e=this.visualElementOrientation;return e===O.f.Auto?this.view.state.camera.aboveGround?O.f.AboveSegment:O.f.BelowSegment:e}_requiresGeodesicGuideAt(e){const t=this.view;if(null===t||void 0===t||!t.state)return!1;const i=t.state.camera,n=t.renderCoordsHelper;if(!n)return!1;const s=i.computeScreenPixelSizeAt(e);return n.getAltitude(e)/s>=10}get _measurementArrowStripeLength(){const{result:e,unit:t}=this.analysisView;if(null==e)return null;let i=null;const n=e.directDistance;switch(t){case"metric":i=n&&(0,h.kM)(n,"meters");break;case"imperial":i=n&&(0,h.kM)(n,(0,_.OU)(n.value,n.unit));break;default:i=n&&(0,h.kM)(n,t)}return null==i?null:(0,A.Vr)(i.value/30)*(0,_.oU)(1,i.unit,"meters")}_updateMessageBundle(){this.loadingMessages=!0,(0,Le.ud)("esri/core/t9n/Units").then((e=>{this.messages=e})).finally((()=>{this.loadingMessages=!1}))}get testData(){}};(0,n._)([(0,r.MZ)()],Me.prototype,"_parameters",null),(0,n._)([(0,r.MZ)()],Me.prototype,"_triangleOrientationOverride",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"messages",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"view",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"analysisView",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"loadingMessages",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"visible",null),(0,n._)([(0,r.MZ)()],Me.prototype,"viewMode",null),(0,n._)([(0,r.MZ)()],Me.prototype,"actualVisualizedMeasurement",null),(0,n._)([(0,r.MZ)()],Me.prototype,"visualElementOrientation",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"triangleCollapseRatioThreshold",void 0),(0,n._)([(0,r.MZ)()],Me.prototype,"allowVisualElementsOrientationChange",null),(0,n._)([(0,r.MZ)()],Me.prototype,"labels",null),(0,n._)([(0,r.MZ)()],Me.prototype,"_labelsText",null),(0,n._)([(0,r.MZ)()],Me.prototype,"_actualVisualElementsOrientation",null),(0,n._)([(0,r.MZ)()],Me.prototype,"_measurementArrowStripeLength",null),Me=(0,n._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Me);const fe=Math.cos((0,A.kU)(12)),Ce=(0,M.r_)(),Ee=(0,M.r_)(),Oe=(0,M.QG)(),Pe=(0,M.QG)(),Se=(0,M.QG)();let Ve=class extends((0,c.P)(s.default)){constructor(e){super(e),this.type="direct-line-measurement-view-3d",this.analysis=null,this.result=null,this.measurementMode=u.G.Auto,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}initialize(){const e=this.view,t=this.analysis;this._analysisVisualization=new Me({view:e,analysis:t,analysisView:this}),this._analysisController=new w({view:e,analysis:t,viewData:this})}destroy(){this._analysisController=(0,a.pR)(this._analysisController),this._analysisVisualization=(0,a.pR)(this._analysisVisualization)}get updating(){var e;return!(null===(e=this._analysisVisualization)||void 0===e||!e.loadingMessages)}get viewMode(){return this._analysisVisualization.viewMode}get actualVisualizedMeasurement(){return this._analysisVisualization.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisVisualization.visualElementOrientation}set visualElementOrientation(e){this._analysisVisualization.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisVisualization.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisVisualization.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}get directLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.direct)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get horizontalLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.horizontal)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get verticalLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.vertical)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get unit(){var e;return null!==(e=this.analysis.unit)&&void 0!==e?e:this._defaultUnit}get testData(){}};(0,n._)([(0,r.MZ)()],Ve.prototype,"updating",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Ve.prototype,"type",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0,nonNullable:!0})],Ve.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)()],Ve.prototype,"result",void 0),(0,n._)([(0,r.MZ)()],Ve.prototype,"measurementMode",void 0),(0,n._)([(0,r.MZ)()],Ve.prototype,"elevationAlignedStartPoint",void 0),(0,n._)([(0,r.MZ)()],Ve.prototype,"elevationAlignedEndPoint",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],Ve.prototype,"viewMode",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Ve.prototype,"actualVisualizedMeasurement",null),(0,n._)([(0,r.MZ)()],Ve.prototype,"visualElementOrientation",null),(0,n._)([(0,r.MZ)()],Ve.prototype,"allowVisualElementsOrientationChange",null),(0,n._)([(0,r.MZ)()],Ve.prototype,"triangleCollapseRatioThreshold",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Ve.prototype,"directLabelText",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Ve.prototype,"horizontalLabelText",null),(0,n._)([(0,r.MZ)({readOnly:!0})],Ve.prototype,"verticalLabelText",null),(0,n._)([(0,r.MZ)()],Ve.prototype,"_analysisVisualization",void 0),(0,n._)([(0,r.MZ)()],Ve.prototype,"_analysisController",void 0),(0,n._)([(0,r.MZ)()],Ve.prototype,"unit",null),(0,n._)([(0,r.MZ)(d.q)],Ve.prototype,"_defaultUnit",void 0),Ve=(0,n._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],Ve);const ze=Ve}}]);
//# sourceMappingURL=91043.e8d96732.chunk.js.map