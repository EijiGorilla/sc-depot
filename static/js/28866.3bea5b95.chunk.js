"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[28866,98156],{28866:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var i=n(35143),l=n(39356),a=n(50076),r=n(46053),o=(n(81806),n(76460),n(47249),n(85842)),u=n(51939),s=n(43543),c=n(59844),d=n(2257);const m=e=>{let t=class extends e{constructor(){super(...arguments),this.layer=null,this.tileInfo=null}get fullExtent(){try{return this.layer.loaded?this._getFullExtent():null}catch(e){return null}}get timeExtent(){var e;return(0,s.F)(this.layer,null===(e=this.view)||void 0===e?void 0:e.timeExtent,this._get("timeExtent"))}get hasTilingEffects(){return!!(this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment)}get datumTransformation(){try{return this.layer.loaded?(0,c.vI)(this.layer.fullExtent,this.view.spatialReference,!0):null}catch(e){return null}}supportsSpatialReference(e){try{return!this.layer.loaded||!!(0,c.eh)(this.layer.serviceRasterInfo,e)}catch(t){return!1}}async fetchPopupFeaturesAtLocation(e,t){const{layer:n}=this;if(!e)throw new a.default("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:n});const{popupEnabled:i}=n,r=(0,d.D8)(n,t);if(!i||null==r)return[];const o=[],{value:s,magdirValue:c,processedValue:m}=await n.identify(e,{timeExtent:this.timeExtent,signal:null===t||void 0===t?void 0:t.signal});let f="";if(null!==s&&void 0!==s&&s.length){var v,y,p;f="imagery-tile"===n.type&&n.hasStandardTime()&&null!=s[0]?s.map((e=>n.getStandardTimeValue(e))).join(", "):s.join(", ");const e={ObjectId:0};e[u.F_.servicePixelValue]="imagery-tile"===n.type&&"Function"===n.raster.datasetFormat?null===m||void 0===m?void 0:m.join(", "):f,e[u.F_.rawServicePixelValue]=f;const t=null!==(v=null===(y=n.raster)||void 0===y?void 0:y.rasterInfo)&&void 0!==v?v:n.serviceRasterInfo,i=null===t||void 0===t?void 0:t.attributeTable;if(null!=i){const{fields:t,features:n}=i,l=t.find((e=>{let{name:t}=e;return"value"===t.toLowerCase()})),a=e[u.F_.servicePixelValue],r=l?n.find((e=>String(e.attributes[l.name])===a)):null;if(r)for(const i in r.attributes)r.attributes.hasOwnProperty(i)&&(e[u.ER+i]=r.attributes[i])}const a=null===t||void 0===t?void 0:t.dataType;if("vector-magdir"!==a&&"vector-uv"!==a||(e[u.F_.magnitude]=null===c||void 0===c?void 0:c[0],e[u.F_.direction]=null===c||void 0===c?void 0:c[1]),"imagery-tile"===n.type){const{multidimensionalDefinition:t}=this.layer.normalizeRasterFetchOptions({timeExtent:this.timeExtent});(0,u.eS)(n.rasterFields,e,t)}const r=new l.default({geometry:null===(p=this.fullExtent)||void 0===p?void 0:p.clone(),attributes:e,layer:n,sourceLayer:n});o.push(r)}return o}async getSourceScale(){return await this.layer.load(),(0,c.OO)(this.layer.serviceRasterInfo,this.view.spatialReference)}_getFullExtent(){return(0,c.eh)(this.layer.serviceRasterInfo,this.view.spatialReference)}};return(0,i._)([(0,r.MZ)()],t.prototype,"fullExtent",null),(0,i._)([(0,r.MZ)()],t.prototype,"layer",void 0),(0,i._)([(0,r.MZ)({readOnly:!0})],t.prototype,"timeExtent",null),(0,i._)([(0,r.MZ)()],t.prototype,"tileInfo",void 0),(0,i._)([(0,r.MZ)({readOnly:!0})],t.prototype,"hasTilingEffects",null),(0,i._)([(0,r.MZ)()],t.prototype,"datumTransformation",null),t=(0,i._)([(0,o.$)("esri.views.layers.ImageryTileLayerView")],t),t}},43543:(e,t,n)=>{n.d(t,{F:()=>l});var i=n(98156);function l(e,t,n){if(null==(null===e||void 0===e?void 0:e.timeInfo))return null;const{datesInUnknownTimezone:l=!1,timeOffset:a,useViewTime:r}=e;let o=e.timeExtent;l&&(o=(0,i.toLocalTimeExtent)(o));let u=r?t&&o?t.intersection(o):t||o:o;return!u||u.isEmpty||u.isAllTime?u:(a&&(u=u.offset(-a.value,a.unit)),l&&(u=(0,i.toUTCTimeExtent)(u)),u.equals(n)?n:u)}},51939:(e,t,n)=>{n.d(t,{AL:()=>g,DV:()=>y,ER:()=>l,F_:()=>o,Nd:()=>f,Oo:()=>a,dy:()=>m,eS:()=>E,h4:()=>S,jC:()=>h,nq:()=>v,rZ:()=>d,y6:()=>p});var i=n(44135);const l="Raster.",a="Raster.Dim.",r=".Max",o={servicePixelValue:"Raster.ServicePixelValue",rawServicePixelValue:"Raster.ServicePixelValue.Raw",itemPixelValue:"Raster.ItemPixelValue",magnitude:"Raster.Magnitude",direction:"Raster.Direction",variable:"Raster.Variable"},u=new Map([["quarters","Quarter"],["months","Month"],["weeks","Week of the year"],["days","Day of the year"]]);function s(e,t){return new i.default({name:e,alias:t,domain:null,editable:!1,length:50,type:"string"})}function c(e,t){return new i.default({name:e,alias:t,domain:null,editable:!1,type:"double"})}function d(e){return s(o.servicePixelValue,null!==e&&void 0!==e?e:"Service Pixel Value")}function m(e){return s(o.rawServicePixelValue,null!==e&&void 0!==e?e:"Raw Service Pixel Value")}function f(){return s(o.itemPixelValue,"Item Pixel Value")}function v(e){return s("".concat(o.servicePixelValue,".").concat(e),e)}function y(e){return c("".concat(o.magnitude),"Magnitude"+(e?" (".concat(e,")"):""))}function p(){return c("".concat(o.direction),"Direction (\xb0)")}function h(e){return e.fields.filter((e=>"oid"!==e.type&&"value"!==e.name.toLowerCase())).map((e=>{const t=e.clone();return t.name="".concat(l).concat(e.name),t}))}function g(e){const t=new Set,n=new Set,l=new Map;return e.variables.forEach((e=>{let{dimensions:i}=e;i.forEach((e=>{if(e.recurring)l.set(e.name,e.unit);else{var i;const l="ISO8601"===(null===(i=e.unit)||void 0===i?void 0:i.trim())?t:n;l.add(e.name),e.hasRanges&&l.add("".concat(e.name).concat(r))}}))})),[s(o.variable,"Variable"),...[...t].map((e=>function(e,t){return new i.default({name:e,alias:t,domain:null,editable:!1,type:"date"})}("".concat(a).concat(e),x(e)))),...[...n].map((e=>c("".concat(a).concat(e),x(e)))),...[...l].map((e=>{let[t,n]=e;return c("".concat(a).concat(t),w(t,n))}))]}function w(e,t){var n;return(t=null===(n=t)||void 0===n?void 0:n.toLowerCase())&&u.has(t)?u.get(t):x(e)}function x(e){const t=e.endsWith(r),n=t?e.slice(0,-4):e,i="StdTime"===n?"Standard Time":"StdZ"===n?"Standard Z":n;return t?"".concat(i," Max"):i}function T(e,t){return t?new Date(e):e}function E(e,t,n){(null===n||void 0===n?void 0:n.length)&&(t[o.variable]=n[0].variableName,n.forEach((n=>{let{dimensionName:i,values:l}=n;if(i&&null!==l&&void 0!==l&&l.length){const n="".concat(a).concat(i),o=e.find((e=>{let{name:t}=e;return t===n}));if(!o)return;const u="date"===o.type,s=l[0];if(Array.isArray(s)){if(t["".concat(a).concat(i)]=T(s[0],u),null!=s[1]){const n="".concat(a).concat(i).concat(r);if(e.some((e=>{let{name:t}=e;return t===n}))){const e=T(s[1],u);t[n]=e}}}else t["".concat(a).concat(i)]=T(s,u)}})))}function S(e,t){if(t.pixelType.startsWith("f")&&e.forEach((e=>{let{format:t,fieldName:n}=e;t&&n&&/^raster\.(item|service)pixelvalue/i.test(n)&&(t.places=2)})),t.multidimensionalInfo){const n=t.multidimensionalInfo.variables.flatMap((e=>{let{dimensions:t}=e;return t}));e.forEach((e=>{let{format:t,fieldName:i}=e;if(t&&null!==i&&void 0!==i&&i.startsWith(a)){var l;const e=i.slice(a.length),o="".concat(e).concat(r),u=n.find((t=>{let{name:n}=t;return n===e||n===o}));(null===u||void 0===u||null===(l=u.values)||void 0===l?void 0:l.every((e=>Number.isInteger(e))))&&(t.places=0)}}))}}},98156:(e,t,n)=>{n.r(t),n.d(t,{getTimeExtentFromLayers:()=>m,getTimeSliderSettingsFromWebDocument:()=>v,toLocalTimeExtent:()=>p,toUTCTimeExtent:()=>y});var i=n(18690),l=n(53084),a=n(18288),r=n(59187),o=n(42052),u=n(72027);function s(e){return void 0!==e.timeInfo}async function c(e,t){var n,i;return null!==(n=null===(i=e.widgets)||void 0===i||null===(i=i.timeSlider)||void 0===i?void 0:i.fullTimeExtent)&&void 0!==n?n:m(e.allLayers,t)}function d(e){const{numStops:t,stopInterval:n,stops:i}=e;return i?{dates:(0,l.clone)(i)}:n?{interval:n.clone()}:{count:null!==t&&void 0!==t?t:5}}async function m(e,t){if(0===e.length)return r.default.allTime;await Promise.all(e.map((e=>e.load({signal:t}))));const n=e.filter(s),l=e.filter((e=>!s(e)&&null!=e.visibilityTimeExtent));if(0===n.length&&0===l.length)return r.default.allTime;const a=[],o=[];for(const i of n){var u;"feature"!==(null===i||void 0===i?void 0:i.type)&&"map-image"!==(null===i||void 0===i?void 0:i.type)||null===(u=i.timeInfo)||void 0===u||!u.hasLiveData?o.push(i):a.push(i)}const c=e=>null==e||e.isAllTime,d=[...o.map((e=>{var t,n;const i=null===(t=e.timeInfo)||void 0===t?void 0:t.fullTimeExtent,{visibilityTimeExtent:l}=e;return null!==(n=null===i||void 0===i?void 0:i.intersection(l))&&void 0!==n?n:l})),...l.map((e=>e.visibilityTimeExtent))];if(d.some(c))return r.default.allTime;const m=a.map((async e=>{var n,i,l,a;const r=null!==(n=null===(i=await e.fetchRecomputedExtents({signal:t}))||void 0===i?void 0:i.timeExtent)&&void 0!==n?n:null===(l=e.timeInfo)||void 0===l?void 0:l.fullTimeExtent,{visibilityTimeExtent:o}=e;return null!==(a=null===r||void 0===r?void 0:r.intersection(o))&&void 0!==a?a:o})),f=(await Promise.allSettled(m)).map((e=>"fulfilled"===e.status?e.value:null));if(f.some(c))return r.default.allTime;const v=[...f,...d].filter(i.Ru);return 0===v.length?r.default.allTime:v.reduce(((e,t)=>e.union(t)))}function f(e,t){var n;const i=e.currentTimeExtent;if(!i)return null;const{start:l,end:a}=i,o=null!==(n=null!==l&&void 0!==l?l:a)&&void 0!==n?n:null;switch(t){case"time-window":return new r.default({start:l,end:a});case"cumulative-from-start":return new r.default({start:null,end:o});case"cumulative-from-end":return new r.default({start:o,end:null});case"instant":return new r.default({start:o,end:o})}}async function v(e,t){var n,i;if(!(0,o.r)(e)&&!function(e){return null!=e&&"object"==typeof e&&u.X in e}(e))return null;await e.load({signal:t});const l=null===e||void 0===e||null===(n=e.widgets)||void 0===n?void 0:n.timeSlider;if(!l)return null;const a=await c(e,t),r=l.loop,s=function(e){var t;const n=null!==(t=e.numThumbs)&&void 0!==t?t:2,i=e.currentTimeExtent;if(i){const{start:e,end:t}=i;return null!=e&&null!=t&&e.getTime()===t.getTime()?"instant":2===n?"time-window":null==e||0===e.getTime()?"cumulative-from-start":"cumulative-from-end"}return 2===n?"time-window":"cumulative-from-start"}(l);return{fullTimeExtent:a,loop:r,mode:s,playRate:null!==(i=l.stopDelay)&&void 0!==i?i:2e3,stops:d(l),timeExtent:f(l,s)}}function y(e){if(!e)return e;const{start:t,end:n}=e;return new r.default({start:null!=t?(0,a.S1)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,a.S1)(n,-n.getTimezoneOffset(),"minutes"):n})}function p(e){if(!e)return e;const{start:t,end:n}=e;return new r.default({start:null!=t?(0,a.S1)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,a.S1)(n,n.getTimezoneOffset(),"minutes"):n})}}}]);
//# sourceMappingURL=28866.3bea5b95.chunk.js.map