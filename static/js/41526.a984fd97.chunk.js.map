{"version":3,"file":"static/js/41526.a984fd97.chunk.js","mappings":"oMAI4X,MAAMA,EAAiB,iBAAkBC,EAAEA,IAAI,IAAIC,EAAE,cAAcD,EAAEE,UAAAA,GAAaC,KAAKC,YAAWC,EAAAA,EAAAA,QAAG,SAAAC,EAAA,OAAkB,QAAlBA,EAAIH,KAAKI,iBAAS,IAAAD,OAAA,EAAdA,EAAgBE,UAASC,IAAIN,KAAKO,cAAcX,GAAiBU,GAAGN,KAAKC,WAAW,CAACK,EAAEE,GAAG,UAAUF,GAAGN,KAAKS,aAAaH,KAAKA,EAAEE,GAAG,UAAUF,GAAGN,KAAKU,aAAaJ,KAAKA,EAAEE,GAAG,QAAQF,GAAGN,KAAKW,WAAWL,KAAKA,EAAEE,GAAG,QAAQF,GAAGN,KAAKY,WAAWN,KAAKA,EAAEE,GAAG,UAAUF,GAAGN,KAAKa,aAAaP,KAAKA,EAAEE,GAAG,WAAW,IAAIR,KAAKc,kBAAkBR,EAAEE,GAAG,aAAaF,GAAGN,KAAKe,gBAAgBT,MAAKJ,EAAAA,EAAAA,QAAG,IAAII,EAAEU,kBAAkBV,IAAI,aAAa,OAADA,QAAC,IAADA,OAAC,EAADA,EAAGW,OAAM,aAAa,OAADX,QAAC,IAADA,OAAC,EAADA,EAAGW,QAAOX,EAAEY,kCAAiC,KAAMC,EAAAA,iBAAIvB,KAAmBuB,EAAAA,gBAAG,CAACV,YAAAA,CAAaH,GAAG,CAACI,YAAAA,CAAaJ,GAAG,CAACK,UAAAA,CAAWL,GAAG,CAACM,UAAAA,CAAWN,GAAG,CAACO,YAAAA,CAAaP,GAAG,CAACQ,aAAAA,GAAgB,CAACC,eAAAA,CAAgBT,GAAG,GAAG,OAAOA,EAAAA,EAAAA,GAAE,EAACc,EAAAA,EAAAA,OAAKtB,EAAEuB,UAAU,YAAO,IAAQf,EAAAA,EAAAA,GAAE,EAACc,EAAAA,EAAAA,OAAKtB,EAAEuB,UAAU,iBAAY,GAAQvB,GAAEQ,EAAAA,EAAAA,GAAE,EAACgB,EAAAA,EAAAA,GAAE,iEAAiExB,GAAGA,E,mLCA7hB,IAAIyB,EAAE,GAAGC,EAAE,GAAGC,EAAE,EAAEC,EAAE,eAAcC,EAAAA,EAAAA,GAAE/B,EAAAA,IAAIgC,WAAAA,CAAYtB,GAAGuB,MAAMvB,GAAGN,KAAKiB,KAAK,cAAcjB,KAAK8B,iBAAiB,GAAG9B,KAAK+B,iBAAiB,EAAE/B,KAAKgC,qBAAqB,EAAEhC,KAAKiC,gBAAgB,GAAGjC,KAAKkC,iBAAiB,KAAKlC,KAAKmC,qBAAqB,EAAEnC,KAAKoC,iBAAiB,IAAI,CAACrC,UAAAA,GAAaC,KAAKqC,qBAAoBlB,EAAAA,EAAAA,QAAI,CAAC,kBAAMV,CAAaH,GAAG,MAAMJ,EAAEI,EAAEgC,cAAc,OAAOhC,EAAEiC,MAAM,IAAI,WAAWvC,KAAKwC,qBAAqBlC,EAAEJ,GAAG,MAAM,IAAI,UAAUF,KAAKyC,oBAAoBnC,EAAEJ,GAAG,CAACW,YAAAA,CAAaP,GAAGN,KAAK0C,4BAA4B1C,KAAK2C,uBAAuB,CAAC7B,aAAAA,GAAgBd,KAAK0C,4BAA4B1C,KAAK2C,uBAAuB,CAACC,2BAAAA,CAA4BtC,GAAG,MAAMuC,KAAK3C,EAAE4C,aAAalD,GAAGI,KAAKI,UAAU,GAAG,SAASF,GAAK,OAADN,QAAC,IAADA,IAAAA,EAAGmD,UAAU,OAAO,GAAG,YAAY7C,EAAEF,KAAK8B,iBAAiBkB,KAAK1C,EAAE2C,iBAAiB,CAAC,MAAM/C,EAAE,CAACgD,EAAE5C,EAAE2C,YAAY,GAAGE,EAAE7C,EAAE2C,YAAY,GAAGG,EAAE9C,EAAE2C,YAAY,IAAI7B,GAAEtB,EAAAA,EAAAA,IAAEI,EAAEN,EAAEmD,UAAU,GAAGnD,EAAEmD,UAAU,IAAI/C,KAAK8B,iBAAiBkB,KAAK,CAAC5B,EAAE8B,EAAE9B,EAAE+B,GAAG,CAAC,MAAM/B,EAAEI,EAAE6B,QAAQ,CAAC/C,EAAEJ,IAAII,EAAEJ,GAAG,GAAGF,KAAK+B,iBAAiB/B,KAAKI,UAAUkD,0BAA0BlC,CAAC,CAAC,gCAAMmC,CAA2BjD,GAAE,IAAAkD,EAAC,MAAMX,KAAK3C,EAAE4C,aAAalD,GAAGI,KAAKI,UAAU,GAAG,SAASF,GAAK,OAADN,QAAC,IAADA,IAAAA,EAAGmD,UAAU,OAAO,MAAM3B,EAAEd,EAAE2C,YAAY,GAAG1B,EAAE,IAAIvB,KAAKiC,iBAAiB,YAAY/B,EAAEqB,EAAEyB,KAAK5B,OAAO,CAAC,MAAMd,EAAE,CAAC4C,EAAE9B,EAAE,GAAG+B,EAAE/B,EAAE,GAAGgC,EAAEhC,EAAE,IAAIlB,GAAEJ,EAAAA,EAAAA,IAAEQ,EAAG,OAADV,QAAC,IAADA,OAAC,EAADA,EAAGmD,UAAU,GAAI,OAADnD,QAAC,IAADA,OAAC,EAADA,EAAGmD,UAAU,IAAIxB,EAAEyB,KAAK,CAAC9C,EAAEgD,EAAEhD,EAAEiD,GAAG,CAAC,GAAG5B,EAAEkC,OAAO,IAAIzD,KAAKI,UAAUsD,oBAAgD,QAA5BF,EAACxD,KAAKI,UAAU0C,oBAAY,IAAAU,IAA3BA,EAA6BT,UAAU,OAAO,MAAMY,EAAEpC,EAAE,GAAGA,EAAEA,EAAEqC,QAAQ,CAACtD,EAAEJ,IAAI,IAAIA,GAAGA,IAAIqB,EAAEkC,OAAO,GAAGI,KAAKC,UAAUxD,KAAKuD,KAAKC,UAAUH,KAAK,MAAM9D,QAAQG,KAAK+D,iBAAiBxC,IAAI,OAAD1B,QAAC,IAADA,OAAC,EAADA,EAAGmE,QAAO,OAADnE,QAAC,IAADA,OAAC,EAADA,EAAGoE,aAAYxC,EAAE5B,EAAEmE,KAAK,CAAC,0BAAMxB,CAAqBlC,EAAEJ,GAAE,IAAAgE,EAAC,MAAMtE,GAAGI,KAAKI,UAAU+D,0BAA0B,GAAG,WAAW7D,EAAE8D,MAAM,OAAOpE,KAAK0C,4BAA4B1C,KAAKI,UAAUkD,0BAA0B,EAAEtD,KAAKI,UAAUiE,sBAAsB,QAAQrE,KAAKI,UAAUkE,6BAA4B,GAAI,GAAG,aAAahE,EAAE8D,OAAO9D,EAAEiE,QAAQ,OAAkC,QAA3BL,EAAAlE,KAAKI,UAAU0C,oBAAY,IAAAoB,GAA3BA,EAA6BM,WAAWlE,EAAEiE,SAASvE,KAAKI,UAAUqE,mBAAmBnE,EAAEiE,aAAavE,KAAK0C,4BAA4B,OAAQ,OAADxC,QAAC,IAADA,OAAC,EAADA,EAAGe,MAAM,IAAI,gBAAgBjB,KAAK4C,4BAA4B1C,GAAG,MAAM,IAAI,aAAa,GAAGF,KAAK8B,iBAAiB2B,QAAQ7D,EAAE,CAAC,MAAMU,QAAQN,KAAK0E,uBAAuBpE,GAAGN,KAAKI,UAAUiE,sBAAsBrB,KAAK1C,EAAE,CAACN,KAAK2E,8BAA8B,MAAMvD,QAAQpB,KAAK4E,uBAAuB5E,KAAK+B,iBAAkB,OAADX,QAAC,IAADA,EAAAA,EAAGpB,KAAK+B,gBAAgB,CAAC,yBAAMU,CAAoBnC,EAAEJ,GAAG,MAAMN,GAAGI,KAAKI,UAAU+D,0BAA0B,GAAG,WAAW7D,EAAE8D,MAAM,OAAOpE,KAAK2C,wBAAwB3C,KAAKI,UAAUyE,sBAAsB,EAAE7E,KAAKI,UAAU0E,wBAAwB,OAAO9E,KAAKI,UAAUkE,6BAA4B,GAAI,GAAG,aAAahE,EAAE8D,OAAO9D,EAAEiE,QAAQ,KAAAQ,EAAC,GAA8B,QAA3BA,EAAA/E,KAAKI,UAAU0C,oBAAY,IAAAiC,GAA3BA,EAA6BP,WAAWlE,EAAEiE,SAAS3E,EAAE,CAAC,MAAMU,QAAQN,KAAKgF,yBAAyBhF,KAAKiC,iBAAiBjC,KAAKI,UAAU0E,wBAAwBxE,GAAGA,EAAEN,KAAKI,UAAU0E,wBAAwBxE,EAAEN,KAAKI,UAAU0E,uBAAuB,CAAC,OAAO9E,KAAKI,UAAUqE,mBAAmBnE,EAAEiE,aAAavE,KAAK2C,uBAAuB,CAAC,OAAQ,OAADzC,QAAC,IAADA,OAAC,EAADA,EAAGe,MAAM,IAAI,mBAAmBjB,KAAKiF,wBAAwB/E,GAAG,MAAM,IAAI,sBAAsBF,KAAKuD,2BAA2BrD,GAAGF,KAAKI,UAAUyE,sBAAsBpD,EAAE,EAAEA,EAAEzB,KAAKgC,oBAAoB,CAAC,6BAAMiD,CAAwB3E,GAAE,IAAA4E,EAAC,MAAMrC,KAAK3C,EAAE4C,aAAalD,GAAGI,KAAKI,UAAUgB,EAAEd,EAAE6E,MAAMxB,EAAEvC,EAAEA,EAAEqC,OAAO,GAAG,IAAI2B,MAAMC,QAAQ1B,IAAI,SAASzD,GAAK,OAADN,QAAC,IAADA,IAAAA,EAAGmD,UAAU,OAAO,GAAG,YAAY7C,EAAEF,KAAKiC,gBAAgBe,KAAKW,OAAO,CAAC,MAAMrD,EAAE,CAAC4C,EAAES,EAAE,GAAGR,EAAEQ,EAAE,GAAGP,EAAEO,EAAE,IAAIzD,GAAEJ,EAAAA,EAAAA,IAAEQ,EAAG,OAADV,QAAC,IAADA,OAAC,EAADA,EAAGmD,UAAU,GAAI,OAADnD,QAAC,IAADA,OAAC,EAADA,EAAGmD,UAAU,IAAI/C,KAAKiC,gBAAgBe,KAAK,CAAC9C,EAAEgD,EAAEhD,EAAEiD,GAAG,CAAC,GAAGnD,KAAKiC,gBAAgBwB,OAAO,IAAIzD,KAAKI,UAAUsD,oBAAgD,QAA5BwB,EAAClF,KAAKI,UAAU0C,oBAAY,IAAAoC,IAA3BA,EAA6BnC,UAAU,OAAO,MAAMlD,EAAEG,KAAKiC,gBAAgB,GAAGjC,KAAKiC,gBAAgBjC,KAAKiC,gBAAgB2B,QAAQ,CAACtD,EAAEJ,IAAI,IAAIA,GAAGA,IAAIF,KAAKiC,gBAAgBwB,OAAO,GAAGI,KAAKC,UAAUxD,KAAKuD,KAAKC,UAAUjE,KAAK,MAAMsB,QAAQnB,KAAK+D,iBAAiB/D,KAAKiC,iBAAiB,GAAK,OAADd,QAAC,IAADA,IAAAA,EAAG6C,MAAQ,OAAD7C,QAAC,IAADA,IAAAA,EAAG8C,UAAU,OAAO,MAAMD,KAAKrC,GAAGR,EAAEnB,KAAKgC,qBAAqBL,CAAC,CAACgD,2BAAAA,GAA8B3E,KAAK8B,iBAAiB9B,KAAK8B,iBAAiBwD,OAAO,GAAG,MAAMhF,EAAEkB,EAAE6B,QAAQ,CAAC/C,EAAEJ,IAAII,EAAEJ,GAAG,GAAGF,KAAK+B,iBAAiB/B,KAAKI,UAAUkD,0BAA0BhD,EAAEN,KAAK+B,iBAAiB,GAAGP,EAAEwB,KAAKhD,KAAK+B,iBAAiB,CAACW,yBAAAA,GAA4B1C,KAAK8B,iBAAiB,GAAG9B,KAAK+B,iBAAiB,EAAEP,EAAE,EAAE,CAACmB,qBAAAA,GAAwB3C,KAAKiC,gBAAgB,GAAGjC,KAAKgC,qBAAqB,EAAEP,EAAE,CAAC,CAAC,sBAAMsC,CAAiBzD,GAAE,IAAAiF,EAAC,MAAM1C,KAAKjD,GAAGI,KAAKI,UAAU,OAA4B,QAArBmF,EAAAvF,KAAKkC,wBAAgB,IAAAqD,GAArBA,EAAuBC,QAAQxF,KAAKkC,kBAAiBhC,EAAAA,EAAAA,KAAGuF,UAAUzF,KAAKoC,iBAAiB,KAAK,MAAMuB,QAAQ3D,KAAKI,UAAUsF,yBAAyBpF,EAAEV,EAAEM,IAAGkB,EAAAA,EAAAA,gBAAElB,GAAGF,KAAKoC,iBAAiBuB,WAAW3D,KAAKkC,iBAAiByD,QAAQ3F,KAAKoC,gBAAgB,CAAC,0BAAMwC,GAAsB,IAAAgB,EAAC,MAAM/C,KAAKvC,GAAGN,KAAKI,UAAU,OAA4B,QAArBwF,EAAA5F,KAAKkC,wBAAgB,IAAA0D,GAArBA,EAAuBJ,QAAQxF,KAAKkC,kBAAiBhC,EAAAA,EAAAA,KAAGuF,UAAUzF,KAAKmC,qBAAqB,EAAE,MAAMvC,QAAQI,KAAKI,UAAUyF,6BAA6B7F,KAAK8B,iBAAiBxB,EAAEJ,IAAGkB,EAAAA,EAAAA,gBAAElB,GAAGF,KAAKmC,qBAAqBvC,WAAWI,KAAKkC,iBAAiByD,QAAQ3F,KAAKmC,oBAAoB,CAAC,0BAAMuC,GAAsB,IAAAoB,EAAC,MAAMjD,KAAKvC,GAAGN,KAAKI,UAAU,MAAM,SAASE,EAAE,MAA2B,QAArBwF,EAAA9F,KAAKkC,wBAAgB,IAAA4D,GAArBA,EAAuBN,QAAQxF,KAAKkC,kBAAiBhC,EAAAA,EAAAA,KAAGuF,UAAUzF,KAAKmC,qBAAqB,EAAE,MAAMvC,EAAE,YAAYU,QAAQN,KAAKI,UAAU2F,kBAAkB/F,KAAK8B,iBAAiB,WAAW5B,SAASF,KAAKI,UAAU4F,2BAA2BhG,KAAK8B,iBAAiB,WAAW5B,IAAGkB,EAAAA,EAAAA,gBAAElB,GAAGF,KAAKmC,qBAAqBvC,WAAWI,KAAKkC,iBAAiByD,QAAQ3F,KAAKmC,qBAAqB,CAAC,8BAAM6C,CAAyB1E,GAAE,IAAA2F,EAAC,MAAMpD,KAAKjD,GAAGI,KAAKI,UAAU,MAAM,SAASR,EAAE,MAA2B,QAArBqG,EAAAjG,KAAKkC,wBAAgB,IAAA+D,GAArBA,EAAuBT,QAAQxF,KAAKkC,kBAAiBhC,EAAAA,EAAAA,KAAGuF,UAAUzF,KAAKmC,qBAAqB,EAAE,MAAMwB,EAAE,YAAY/D,QAAQI,KAAKI,UAAU2F,kBAAkBzF,EAAE,OAAOJ,SAASF,KAAKI,UAAU4F,2BAA2B1F,EAAE,OAAOJ,IAAGkB,EAAAA,EAAAA,gBAAElB,GAAGF,KAAKmC,qBAAqBwB,WAAW3D,KAAKkC,iBAAiByD,QAAQ3F,KAAKmC,qBAAqB,IAAG7B,EAAAA,EAAAA,GAAE,EAACqD,EAAAA,EAAAA,OAAKjC,EAAEL,UAAU,YAAO,IAAQf,EAAAA,EAAAA,GAAE,EAACqD,EAAAA,EAAAA,OAAKjC,EAAEL,UAAU,wBAAmB,IAAQf,EAAAA,EAAAA,GAAE,EAACqD,EAAAA,EAAAA,OAAKjC,EAAEL,UAAU,wBAAmB,IAAQf,EAAAA,EAAAA,GAAE,EAACqD,EAAAA,EAAAA,OAAKjC,EAAEL,UAAU,4BAAuB,IAAQf,EAAAA,EAAAA,GAAE,EAACqD,EAAAA,EAAAA,OAAKjC,EAAEL,UAAU,uBAAkB,GAAQK,GAAEpB,EAAAA,EAAAA,GAAE,EAACT,EAAAA,EAAAA,GAAE,0EAA0E6B,GAAG,MAAMJ,EAAEI,C","sources":["../node_modules/@arcgis/core/widgets/OrientedImageryViewer/mixins/SketchHandlerMixin.js","../node_modules/@arcgis/core/widgets/OrientedImageryViewer/adapters/sketch/MeasurementAdapter.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{watch as t,syncAndInitial as o}from\"../../../core/reactiveUtils.js\";import{property as s}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as d}from\"../../../core/accessorSupport/decorators/subclass.js\";const a={sketchHandles:\"sketch-handles\"},r=r=>{let n=class extends r{initialize(){this.addHandles(t((()=>this.viewModel?.sketch),(e=>{this.removeHandles(a.sketchHandles),e&&this.addHandles([e.on(\"create\",(e=>this.handleCreate(e))),e.on(\"update\",(e=>this.handleUpdate(e))),e.on(\"undo\",(e=>this.handleUndo(e))),e.on(\"redo\",(e=>this.handleRedo(e))),e.on(\"delete\",(e=>this.handleDelete(e))),e.on(\"destroy\",(()=>this.handleDestroy())),e.on(\"duplicate\",(e=>this.handleDuplicate(e))),t((()=>e.activeComponent),(e=>{\"draw-2d\"!==e?.type&&\"draw-3d\"!==e?.type||(e.elevationLockOnVertexAddDisabled=!0)}),o)],a.sketchHandles)}),o))}handleCreate(e){}handleUpdate(e){}handleUndo(e){}handleRedo(e){}handleDelete(e){}handleDestroy(){}handleDuplicate(e){}};return e([s()],n.prototype,\"type\",void 0),e([s()],n.prototype,\"viewModel\",void 0),n=e([d(\"esri.widgets.OrientedImageryViewer.mixins.SketchHandlerMixin\")],n),n};export{r as SketchHandlerMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{createTask as t}from\"../../../../core/asyncUtils.js\";import a from\"../../../../core/Promise.js\";import{throwIfAborted as s}from\"../../../../core/promiseUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{load as o}from\"../../../../geometry/projection.js\";import{convertSphereVertexToPixelLocation as n}from\"../../../../layers/orientedImagery/transformations/utils.js\";import{SketchHandlerMixin as c}from\"../../mixins/SketchHandlerMixin.js\";let l=[],u=[],h=0,m=class extends(c(a)){constructor(e){super(e),this.type=\"measurement\",this.measurementArray=[],this.pixelMeasurement=0,this.pixelAreaMeasurement=0,this.polygonVertices=[],this._calculationTask=null,this._distanceCalculation=0,this._areaCalculation=null}initialize(){this.addResolvingPromise(o())}async handleCreate(e){const t=e.toolEventInfo;switch(e.tool){case\"polyline\":this.handlePolylineEvents(e,t);break;case\"polygon\":this.handlePolygonEvents(e,t)}}handleDelete(e){this.resetDistanceMeasurements(),this.resetAreaMeasurements()}handleDestroy(){this.resetDistanceMeasurements(),this.resetAreaMeasurements()}cursorUpdatePolylineHandler(e){const{mode:t,activeViewer:a}=this.viewModel;if(\"none\"===t||!a?.imageSize)return;if(\"default\"===t)this.measurementArray.push(e.coordinates);else{const t={x:e.coordinates[0],y:e.coordinates[1],z:e.coordinates[2]},s=n(t,a.imageSize[0],a.imageSize[1]);this.measurementArray.push([s.x,s.y])}const s=u.reduce(((e,t)=>e+t),0)+this.pixelMeasurement;this.viewModel.distanceMeasurementResult=s}async cursorUpdatePolygonHandler(e){const{mode:t,activeViewer:a}=this.viewModel;if(\"none\"===t||!a?.imageSize)return;const s=e.coordinates;if(l=[...this.polygonVertices],\"default\"===t)l.push(s);else{const e={x:s[0],y:s[1],z:s[2]},t=n(e,a?.imageSize[0],a?.imageSize[1]);l.push([t.x,t.y])}if(l.length<3||!this.viewModel.currentBestFeature||!this.viewModel.activeViewer?.imageSize)return;const i=l[0];l=l.filter(((e,t)=>0===t||t===l.length-1||JSON.stringify(e)!==JSON.stringify(i)));const r=await this._getAreaFromTask(l);r?.area&&r?.perimeter&&(h=r.area)}async handlePolylineEvents(e,t){const a=!this.viewModel.accuracyParametersMissing;if(\"cancel\"===e.state)return this.resetDistanceMeasurements(),this.viewModel.distanceMeasurementResult=0,this.viewModel.distanceAccuracyArray=[],void(this.viewModel.displayNewMeasurementButton=!0);if(\"complete\"===e.state&&e.graphic)return this.viewModel.activeViewer?.addGraphic(e.graphic),this.viewModel.measurementGraphic=e.graphic,void this.resetDistanceMeasurements();switch(t?.type){case\"cursor-update\":this.cursorUpdatePolylineHandler(t);break;case\"vertex-add\":if(this.measurementArray.length&&a){const e=await this._getAccuracyFromTask();e&&this.viewModel.distanceAccuracyArray.push(e)}this.vertexUpdatePolylineHandler()}const s=await this._getDistanceFromTask();this.pixelMeasurement=s??this.pixelMeasurement}async handlePolygonEvents(e,t){const a=!this.viewModel.accuracyParametersMissing;if(\"cancel\"===e.state)return this.resetAreaMeasurements(),this.viewModel.areaMeasurementResult=0,this.viewModel.areaMeasurementAccuracy=0,void(this.viewModel.displayNewMeasurementButton=!0);if(\"complete\"===e.state&&e.graphic){if(this.viewModel.activeViewer?.addGraphic(e.graphic),a){const e=await this._getAreaAccuracyFromTask(this.polygonVertices);this.viewModel.areaMeasurementAccuracy=e&&e>this.viewModel.areaMeasurementAccuracy?e:this.viewModel.areaMeasurementAccuracy}return this.viewModel.measurementGraphic=e.graphic,void this.resetAreaMeasurements()}switch(t?.type){case\"vertex-add\":await this.vertexAddPolygonHandler(t);break;case\"cursor-update\":await this.cursorUpdatePolygonHandler(t)}this.viewModel.areaMeasurementResult=h>0?h:this.pixelAreaMeasurement}async vertexAddPolygonHandler(e){const{mode:t,activeViewer:a}=this.viewModel,s=e.added,i=s[s.length-1];if(!Array.isArray(i)||\"none\"===t||!a?.imageSize)return;if(\"default\"===t)this.polygonVertices.push(i);else{const e={x:i[0],y:i[1],z:i[2]},t=n(e,a?.imageSize[0],a?.imageSize[1]);this.polygonVertices.push([t.x,t.y])}if(this.polygonVertices.length<3||!this.viewModel.currentBestFeature||!this.viewModel.activeViewer?.imageSize)return;const r=this.polygonVertices[0];this.polygonVertices=this.polygonVertices.filter(((e,t)=>0===t||t===this.polygonVertices.length-1||JSON.stringify(e)!==JSON.stringify(r)));const o=await this._getAreaFromTask(this.polygonVertices);if(!o?.area||!o?.perimeter)return;const{area:c}=o;this.pixelAreaMeasurement=c}vertexUpdatePolylineHandler(){this.measurementArray=this.measurementArray.slice(-1);const e=u.reduce(((e,t)=>e+t),0)+this.pixelMeasurement;this.viewModel.distanceMeasurementResult=e,this.pixelMeasurement>0&&u.push(this.pixelMeasurement)}resetDistanceMeasurements(){this.measurementArray=[],this.pixelMeasurement=0,u=[]}resetAreaMeasurements(){this.polygonVertices=[],this.pixelAreaMeasurement=0,h=0}async _getAreaFromTask(e){const{mode:a}=this.viewModel;return this._calculationTask?.abort(),this._calculationTask=t((async t=>{this._areaCalculation=null;const i=await this.viewModel.calculateAreaMeasurement(e,a,t);s(t),this._areaCalculation=i})),await this._calculationTask.promise,this._areaCalculation}async _getDistanceFromTask(){const{mode:e}=this.viewModel;return this._calculationTask?.abort(),this._calculationTask=t((async t=>{this._distanceCalculation=0;const a=await this.viewModel.calculateDistanceMeasurement(this.measurementArray,e,t);s(t),this._distanceCalculation=a})),await this._calculationTask.promise,this._distanceCalculation}async _getAccuracyFromTask(){const{mode:e}=this.viewModel;return\"none\"===e?null:(this._calculationTask?.abort(),this._calculationTask=t((async t=>{this._distanceCalculation=0;const a=\"default\"===e?await this.viewModel.calculateAccuracy(this.measurementArray,\"distance\",t):await this.viewModel.calculateAccuracyPanoramic(this.measurementArray,\"distance\",t);s(t),this._distanceCalculation=a})),await this._calculationTask.promise,this._distanceCalculation)}async _getAreaAccuracyFromTask(e){const{mode:a}=this.viewModel;return\"none\"===a?null:(this._calculationTask?.abort(),this._calculationTask=t((async t=>{this._distanceCalculation=0;const i=\"default\"===a?await this.viewModel.calculateAccuracy(e,\"area\",t):await this.viewModel.calculateAccuracyPanoramic(e,\"area\",t);s(t),this._distanceCalculation=i})),await this._calculationTask.promise,this._distanceCalculation)}};e([i()],m.prototype,\"type\",void 0),e([i()],m.prototype,\"measurementArray\",void 0),e([i()],m.prototype,\"pixelMeasurement\",void 0),e([i()],m.prototype,\"pixelAreaMeasurement\",void 0),e([i()],m.prototype,\"polygonVertices\",void 0),m=e([r(\"esri.widgets.OrientedImageryViewer.adapters.sketch.MeasurementAdapter\")],m);const d=m;export{d as default};\n"],"names":["a","r","n","initialize","this","addHandles","t","_this$viewModel","viewModel","sketch","e","removeHandles","on","handleCreate","handleUpdate","handleUndo","handleRedo","handleDelete","handleDestroy","handleDuplicate","activeComponent","type","elevationLockOnVertexAddDisabled","o","s","prototype","d","l","u","h","m","c","constructor","super","measurementArray","pixelMeasurement","pixelAreaMeasurement","polygonVertices","_calculationTask","_distanceCalculation","_areaCalculation","addResolvingPromise","toolEventInfo","tool","handlePolylineEvents","handlePolygonEvents","resetDistanceMeasurements","resetAreaMeasurements","cursorUpdatePolylineHandler","mode","activeViewer","imageSize","push","coordinates","x","y","z","reduce","distanceMeasurementResult","cursorUpdatePolygonHandler","_this$viewModel$activ","length","currentBestFeature","i","filter","JSON","stringify","_getAreaFromTask","area","perimeter","_this$viewModel$activ2","accuracyParametersMissing","state","distanceAccuracyArray","displayNewMeasurementButton","graphic","addGraphic","measurementGraphic","_getAccuracyFromTask","vertexUpdatePolylineHandler","_getDistanceFromTask","areaMeasurementResult","areaMeasurementAccuracy","_this$viewModel$activ3","_getAreaAccuracyFromTask","vertexAddPolygonHandler","_this$viewModel$activ4","added","Array","isArray","slice","_this$_calculationTas","abort","async","calculateAreaMeasurement","promise","_this$_calculationTas2","calculateDistanceMeasurement","_this$_calculationTas3","calculateAccuracy","calculateAccuracyPanoramic","_this$_calculationTas4"],"sourceRoot":""}