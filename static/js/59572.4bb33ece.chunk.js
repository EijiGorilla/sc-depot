"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[15062,59572],{15062:(e,t,a)=>{a.d(t,{T:()=>i});const i={close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",locateCircled:"esri-icon-locate-circled",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"}},59572:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var i=a(35143),l=(a(11265),a(19276)),n=a(45802),o=a(68134),s=a(96820),r=a(90534),c=a(46053),d=a(40565),p=(a(81806),a(47249),a(85842)),u=a(13312),h=a(80963),m=a(47437),v=a(54994),b=a(92706),_=a(25329),g=a(91967);a(76460);let y=class extends g.default{constructor(e){super(e),this.state="pending",this.url=""}initialize(){this.addHandles((0,o.watch)((()=>[this.extension,this.name]),(()=>this._setFormattedFileName()),o.initial))}_setFormattedFileName(){this.name&&this.extension&&(this.formattedName=this.count?"".concat(this.name,"(").concat(this.count,").").concat(this.extension):"".concat(this.name,".").concat(this.extension))}};(0,i._)([(0,c.MZ)()],y.prototype,"count",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"error",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"extension",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"formattedName",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"name",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"portalItem",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"state",void 0),(0,i._)([(0,c.MZ)()],y.prototype,"url",void 0),y=(0,i._)([(0,p.$)("esri.widgets.Print.FileLink")],y);const f=y;var w=a(74571),T=a(94126),x=a(98108),k=a(87540),C=a(15062),K=a(76099),O=a(63582),S=a(54761),I=a(50265);const M=l.default.ofType(f),E="map-only";var L,F;(F=L||(L={})).layout="layoutTab",F.mapOnly="mapOnlyTab",F.export="exportTab";const P="esri-print",A="".concat(P,"__advanced-options-button"),N={base:P,headerTitle:"".concat(P,"__header-title"),layoutTabList:"".concat(P,"__layout-tab-list"),layoutTab:"".concat(P,"__layout-tab"),layoutSection:"".concat(P,"__layout-section"),mapOnlySection:"".concat(P,"__map-only-section"),panelItemsCentered:"".concat(P,"__panel-items--centered"),loader:"".concat(P,"__loader"),advancedOptionsButton:A,advancedOptionsButtonContainer:"".concat(A,"-container"),advancedOptionsButtonTitle:"".concat(A,"-title"),advancedOptionsButtonIconOpened:"".concat(A,"-icon--opened"),advancedOptionsButtonIconClosed:"".concat(A,"-icon--closed"),advancedOptionsButtonIconClosed_RTL:"".concat(A,"-icon--closed-rtl"),swapButton:"".concat(P,"__swap-button"),printButton:"".concat(P,"__export-button"),printButtonSection:"".concat(P,"__export-button-section"),printButtonSectionDivider:"".concat(P,"__export-button-section--divider"),templateSelectContainer:"".concat(P,"__template-select-container"),templateSelectBlock:"".concat(P,"__template-select-block"),templateSelectIcon:"".concat(P,"__template-select-icon"),templateSelectError:"".concat(P,"__template-select-error"),templateSelectArrow:"".concat(P,"__template-select-arrow"),formSectionContainer:"".concat(P,"__form-section-container"),formCheckboxLabel:"".concat(P,"__form-checkbox-label"),advancedOptionsSection:"".concat(P,"__advanced-options-section"),advancedOptionsContainer:"".concat(P,"__advanced-options-container"),browseTemplateButtonContainer:"".concat(P,"__browse-template-button-container"),browseTemplateButtonContainerFilter:"".concat(P,"__browse-template-button-container-filter"),exportedFilesContainer:"".concat(P,"__export-panel-container"),exportedFilesTitle:"".concat(P,"__export-title"),exportedFile:"".concat(P,"__exported-file"),exportedFileLink:"".concat(P,"__exported-file-link"),exportedFileLinkTitle:"".concat(P,"__exported-file-link-title"),exportedFileLinkDescription:"".concat(P,"__exported-file-link-description"),exportedFilesEmpty:"".concat(P,"__exported-files-empty"),printWidgetContainer:"".concat(P,"__container"),content:"".concat(P,"__content"),panelContainer:"".concat(P,"__panel-container"),scaleInfoContainer:"".concat(P,"__scale-info-container"),scaleInputContainer:"".concat(P,"__scale-input-container"),scaleInput:"".concat(P,"__scale-input"),sizeContainer:"".concat(P,"__size-container"),panelError:"".concat(P,"__panel--error"),exportedFileError:"".concat(P,"__exported-file--error"),exportedFileLoader:"".concat(P,"__exported-file--loader"),exportSection:"".concat(P,"__export-section"),exportSectionCentered:"".concat(P,"__export-section--centered"),templateButtonContainer:"".concat(P,"__template-button-container"),templateDoneButton:"".concat(P,"__template-done-button"),templateSelectFlowItemContainer:"".concat(P,"__template-select-flow-item-container"),templateSelectFlowItemContent:"".concat(P,"__template-select-flow-item-content"),templateSelectFlowItemListHeading:"".concat(P,"__template-select-flow-item-list-heading"),srLabel:"".concat(P,"__sr-label"),invalidWkidText:"".concat(P,"__invalid-wkid-text")};function B(e){return(null===e||void 0===e?void 0:e.toLowerCase())===E}function Z(e){var t;const{state:a,extension:i}=e;switch(a){case"pending":return"spinner";case"error":return"exclamation-mark-circle";default:return null!==i&&void 0!==i&&null!==(t=i.toLowerCase())&&void 0!==t&&t.includes("pdf")?"file-pdf":"file"}}const D=new n.J({inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"}),V=new Map([["a3-landscape","a3-landscape"],["a3-portrait","a3-portrait"],["a4-landscape","a4-landscape"],["a4-portrait","a4-portrait"],["letter-ansi-a-landscape","ansi-a-landscape"],["letter-ansi-a-portrait","ansi-a-portrait"],["tabloid-ansi-b-landscape","ansi-b-landscape"],["tabloid-ansi-b-portrait","ansi-b-portrait"]]);let R=class extends _.default{constructor(e,t){super(e,t),this._activeTabFocusRequested=!1,this._awaitingServerResponse=!1,this._exportedFileNameMap={},this._selectedTab=L.layout,this._pendingExportScroll=!1,this._rootNode=null,this._selectedTemplate=null,this._formats=[],this._showTemplates=!1,this._isValidSpatialReference=!0,this.allowedFormatsForSaving=null,this.browseTemplateButtonOnClick=null,this.exportedLinks=new M,this.headerVisible=!0,this.headingLevel=3,this.includeOrganizationTemplates=!0,this.messagesCommon=null,this.messagesUnits=null,this.saveExportEnabled=!1,this.saveExportHidden=!0,this.saveAsButtonCallback=null,this.viewModel=new w.default,this._onInput=e=>{this._selectedTab===L.layout?this.templateOptions.title=e.currentTarget.value:this._selectedTab===L.mapOnly&&(this.templateOptions.fileName=e.currentTarget.value)},this._handleLinkClick=e=>{var t;const a=e.currentTarget["data-item"];if(!a||"ready"!==a.state||!a.url)return;const i=(0,v.gf)(this.viewModel.effectivePrintServiceUrl),l=a.url,n=document.createElement("a");if(n.target="_blank",n.href=l,n.rel="noreferrer",n.download=null!==(t=a.formattedName)&&void 0!==t?t:"",!i)return n.click(),void e.stopPropagation();e.preventDefault();const o=new URL(l);o.searchParams.set("token",i),n.href=o.href,n.click(),n.href=l},this._focusOnTabChange=this._focusOnTabChange.bind(this)}initialize(){this.addHandles([(0,o.watch)((()=>{var e;return[this.templateOptions.format,null===(e=this.viewModel.templatesInfo)||void 0===e?void 0:e.format]}),(()=>{const{templatesInfo:e}=this.viewModel;if(!e)return;if(this._formats.length!==e.format.choiceList.length){const t=b.U.apiValues;this._formats=e.format.choiceList.map((e=>{var a;const i=null!==(a=t.find((t=>new RegExp("\\b".concat(t,"\\b"),"i").test(e))))&&void 0!==a?a:e;return{value:i,label:e===i?e.toUpperCase():e}})).sort(((e,t)=>e.label.localeCompare(t.label)))}const t=this._formats.some((e=>{let{value:t}=e;return new RegExp("\\b".concat(t,"\\b"),"i").test(this.templateOptions.format)}));if(!e.format.defaultValue||t);else{var a;const t=null===(a=this._formats.find((t=>{let{value:a}=t;return new RegExp("\\b".concat(a,"\\b"),"i").test(e.format.defaultValue)})))||void 0===a?void 0:a.value;t&&(this.templateOptions.format=t)}})),(0,o.watch)((()=>[this.templateOptions.id,this.viewModel.loaded]),(async()=>{const{layout:e}=this.templateOptions;this._selectedTab=B(e)?L.mapOnly:L.layout,this._selectedTab===L.layout&&this.viewModel.loaded&&(this._selectedTemplate=this.viewModel.getLayoutTemplateById(this.templateOptions.id))})),(0,o.watch)((()=>this.templateOptions.dpi),(e=>{e<=0&&(this.templateOptions.dpi=1)})),(0,o.watch)((()=>{var e;return null===(e=this.viewModel.view)||void 0===e?void 0:e.scale}),(e=>{!e||this.templateOptions.scaleEnabled&&this.templateOptions.scale||(this.templateOptions.scale=e)}))]);for(const{name:i,extension:l}of this.exportedLinks)i&&l&&this._updateExportedFileNameMap("".concat(i).concat(l));const{height:e,width:t}=this.templateOptions;this.templateOptions.width=t||800,this.templateOptions.height=e||1100;const a=setTimeout((()=>{this._awaitingServerResponse=!0,this.scheduleRender()}),500);this.viewModel.load().then((()=>{clearTimeout(a),this._awaitingServerResponse=!1}))}loadDependencies(){return(0,T.W)({action:()=>Promise.resolve().then(a.bind(a,85375)),block:()=>a.e(75502).then(a.bind(a,75502)),button:()=>Promise.resolve().then(a.bind(a,43285)),checkbox:()=>a.e(64990).then(a.bind(a,64990)),combobox:()=>Promise.all([a.e(65641),a.e(64880)]).then(a.bind(a,64880)),"combobox-item":()=>a.e(73438).then(a.bind(a,73438)),flow:()=>a.e(87473).then(a.bind(a,87473)),"flow-item":()=>a.e(68445).then(a.bind(a,68445)),icon:()=>Promise.resolve().then(a.bind(a,16702)),input:()=>Promise.all([a.e(46870),a.e(38841)]).then(a.bind(a,38841)),"input-number":()=>Promise.all([a.e(46870),a.e(41763)]).then(a.bind(a,41763)),label:()=>Promise.resolve().then(a.bind(a,11839)),list:()=>Promise.all([a.e(46870),a.e(38841),a.e(65641),a.e(75802)]).then(a.bind(a,75802)),"list-item":()=>Promise.resolve().then(a.bind(a,70205)),loader:()=>Promise.resolve().then(a.bind(a,35688)),switch:()=>Promise.resolve().then(a.bind(a,8989)),chip:()=>Promise.resolve().then(a.bind(a,10239)),popover:()=>Promise.resolve().then(a.bind(a,51866)),link:()=>a.e(13549).then(a.bind(a,13549))})}destroy(){this.viewModel.destroy()}get allowedFormats(){return this.viewModel.allowedFormats}set allowedFormats(e){this.viewModel.allowedFormats=e}get allowedLayouts(){return this.viewModel.allowedLayouts}set allowedLayouts(e){this.viewModel.allowedLayouts=e}get error(){return this.viewModel.error}get extraParameters(){return this.viewModel.extraParameters}set extraParameters(e){this.viewModel.extraParameters=e}get icon(){return"print"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultTemplates(){return this.viewModel.includeDefaultTemplates}set includeDefaultTemplates(e){this.viewModel.includeDefaultTemplates=e}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get outSpatialReference(){return this.viewModel.outSpatialReference}set outSpatialReference(e){this.viewModel.outSpatialReference=e}get portal(){return this.viewModel.portal}set portal(e){this.viewModel.portal=e}get showPrintAreaEnabled(){return this.viewModel.showPrintAreaEnabled}set showPrintAreaEnabled(e){this.viewModel.showPrintAreaEnabled=e}get printServiceUrl(){return this.viewModel.printServiceUrl}set printServiceUrl(e){this.viewModel.printServiceUrl=e}get templateCustomTextElements(){return this.viewModel.templateCustomTextElements}set templateCustomTextElements(e){this.viewModel.templateCustomTextElements=e}get templateOptions(){return this.viewModel.templateOptions}set templateOptions(e){this.viewModel.templateOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var e,t,a,i,l,n,o,s,r,c,p,m,v,b,_,g;const{messages:y,templateOptions:f,viewModel:w,view:T}=this,{attributionEnabled:O,author:I,copyright:M,dpi:E,format:F,height:P,layout:A,layoutItem:B,legendEnabled:Z,northArrowEnabled:D,scaleBarEnabled:R,scaleEnabled:U,scale:z,width:H}=f,W="ready"!==w.state||this._awaitingServerResponse||!(A||B),q=this._renderTitleOrFileNameSection(),j=(0,S.K)("div",{class:N.formSectionContainer},(0,S.K)("calcite-label",null,y.fileFormatTitle,(0,S.K)("calcite-combobox",{clearDisabled:!0,label:y.formatDefaultOption,maxItems:6,placeholder:y.formatDefaultOption,selectionMode:"single-persist",onCalciteComboboxChange:e=>{var t,a;let{currentTarget:i}=e;this.templateOptions.format=null!==(t=null===(a=i.selectedItems[0])||void 0===a?void 0:a.value)&&void 0!==t?t:"pdf"}},this._formats.map(((e,t)=>{let{value:a,label:i}=e;return(0,S.K)("calcite-combobox-item",{key:"file-format-".concat(t),selected:a===this.templateOptions.format,textLabel:i,value:a})}))))),G=(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-switch",{checked:this.showPrintAreaEnabled,onCalciteSwitchChange:e=>{this.showPrintAreaEnabled=!!e.currentTarget.checked}}),y.printPreview),J=(0,S.K)("div",null,(0,S.K)("div",{class:N.formSectionContainer},(0,S.K)("calcite-label",null,y.template,(0,S.K)("calcite-block",{class:N.templateSelectContainer,collapsible:!1,description:this._getPageSizeLabel(this._selectedTemplate),heading:this._getTemplateLabel(this._selectedTemplate,!0),key:"template-select-block",loading:"loading"===(null===(e=this._selectedTemplate)||void 0===e?void 0:e.state),onclick:()=>this._showTemplates=!0,onkeydown:e=>{"Enter"!==e.key&&" "!==e.key||(this._showTemplates=!0)},tabIndex:0},(0,S.K)("calcite-icon",{class:N.templateSelectIcon,icon:(null!==(t=this._selectedTemplate)&&void 0!==t&&t.layout?V.get(this._selectedTemplate.layout):null)||"custom-print",key:"template-select-icon",scale:"l",slot:"content-start"}),"error"===(null===(a=this._selectedTemplate)||void 0===a?void 0:a.state)?(0,S.K)("calcite-icon",{class:N.templateSelectError,icon:"exclamation-mark-circle",key:"template-select-error",scale:"s",slot:"actions-end"}):null,(0,S.K)("calcite-icon",{class:N.templateSelectArrow,icon:(0,K.V8)()?"chevron-left":"chevron-right",key:"template-select-arrow",scale:"s",slot:"actions-end"})))),G),$=(0,S.K)("div",{class:N.formSectionContainer},(0,S.K)("calcite-label",null,y.dpi,(0,S.K)("calcite-input-number",{bind:this,"data-input-name":"dpi",min:1,value:"".concat(E),onCalciteInputNumberInput:this._handleDPIChange}))),Q=(0,S.K)("div",{class:N.formSectionContainer},(0,S.K)("calcite-label",null,(0,S.K)("div",{class:N.srLabel},y.outSpatialReference,(0,S.K)("calcite-link",{href:"https://developers.arcgis.com/rest/services-reference/enterprise/using-spatial-references/",target:"_blank"},"(WKID)")),(0,S.K)("calcite-input-number",{bind:this,"data-input-name":"outSpatialReference",integer:!0,numberButtonType:"none",value:null!==(i=null===(l=w.outSpatialReference)||void 0===l||null===(l=l.wkid)||void 0===l?void 0:l.toString())&&void 0!==i?i:"",onCalciteInputNumberInput:e=>{let{currentTarget:t}=e;const a=(0,d.Vr)(t.value);w.outSpatialReference=Number.isNaN(a)||null==a?null:new u.default({wkid:a}),this._isValidSpatialReference=!w.outSpatialReference||(0,h.fn)(w.outSpatialReference)}}),this._isValidSpatialReference?null:(0,S.K)("div",{class:N.invalidWkidText,key:"out-sr-".concat(null===(n=w.outSpatialReference)||void 0===n?void 0:n.wkid)},y.invalidWkid))),X=(0,S.K)("div",{class:this.classes(N.scaleInfoContainer,N.formSectionContainer)},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:U,"data-option-name":"scaleEnabled",onCalciteCheckboxChange:this._toggleInputValue}),y.scale),(0,S.K)("div",{class:N.scaleInputContainer},(0,S.K)("calcite-input-number",{"aria-label":y.scaleLabel,"aria-valuenow":"".concat(z),bind:this,class:N.scaleInput,"data-input-name":"scale",disabled:!U,value:"".concat(z),onCalciteInputNumberInput:this._updateNumberInputValue}),(0,S.K)("calcite-button",{appearance:"outline","aria-label":y.reset,bind:this,disabled:!U,iconStart:"refresh",kind:"neutral",onclick:this._resetToCurrentScale}))),Y=(0,S.K)("div",{"aria-labelledby":"".concat(this.id,"__advancedOptionsForLayout"),class:N.advancedOptionsContainer,key:"advanced-section-for-layout"},X,null===(o=null===(s=this._selectedTemplate)||void 0===s||null===(s=s.layoutTemplateInfo)||void 0===s||null===(s=s.layoutOptions)||void 0===s?void 0:s.hasAuthorText)||void 0===o||o?(0,S.K)("div",{class:N.formSectionContainer,key:"author-info"},(0,S.K)("calcite-label",null,y.author,(0,S.K)("calcite-input",{bind:this,"data-input-name":"author",value:null!==I&&void 0!==I?I:"",onCalciteInputInput:this._updateInputValue}))):null,null===(r=null===(c=this._selectedTemplate)||void 0===c||null===(c=c.layoutTemplateInfo)||void 0===c||null===(c=c.layoutOptions)||void 0===c?void 0:c.hasCopyrightText)||void 0===r||r?(0,S.K)("div",{class:N.formSectionContainer,key:"copyright-text"},(0,S.K)("calcite-label",null,y.copyright,(0,S.K)("calcite-input",{bind:this,"data-input-name":"copyright",value:null!==M&&void 0!==M?M:"",onCalciteInputInput:this._updateInputValue}))):null,$,Q,this._renderCustomTextElementSection(),null===(p=null===(m=this._selectedTemplate)||void 0===m||null===(m=m.layoutTemplateInfo)||void 0===m||null===(m=m.layoutOptions)||void 0===m?void 0:m.hasLegend)||void 0===p||p?(0,S.K)("div",{class:N.formSectionContainer,key:"legend-info"},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:!!Z,"data-option-name":"legendEnabled",onCalciteCheckboxChange:this._toggleInputValue}),y.legend)):null,null!==(v=this._selectedTemplate)&&void 0!==v&&null!==(v=v.mapSurroundInfoOptions)&&void 0!==v&&v.northArrow.length?(0,S.K)("div",{class:N.formSectionContainer,key:"north-arrow"},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:!!D,"data-option-name":"northArrowEnabled",onCalciteCheckboxChange:this._toggleInputValue}),y.northArrow)):null,null!==(b=this._selectedTemplate)&&void 0!==b&&null!==(b=b.mapSurroundInfoOptions)&&void 0!==b&&b.scaleBar.length?(0,S.K)("div",{class:N.formSectionContainer,key:"scale-bar"},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:!!R,"data-option-name":"scaleBarEnabled",onCalciteCheckboxChange:this._toggleInputValue}),y.scaleBar)):null),ee=(0,S.K)("div",{"aria-labelledby":"".concat(this.id,"__advancedOptionsForMapOnly"),class:N.advancedOptionsContainer},X,$,Q,(0,S.K)("div",{class:N.formSectionContainer},(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:O,"data-option-name":"attributionEnabled",onCalciteCheckboxChange:this._toggleInputValue}),y.attribution)),this._renderCustomTextElementSection()),te=this.exportedLinks.toArray(),ae=this._renderExportedLinkItems(te),ie={[N.exportSectionCentered]:!te.length},le=this._selectedTab===L.layout?(0,S.K)("section",{"aria-labelledby":"".concat(this.id,"__layoutTab"),class:N.layoutSection,id:"".concat(this.id,"__layoutContent"),key:"esri-print__layoutContent",role:"tabpanel"},(0,S.K)("div",{class:N.panelContainer},null===(_=null===(g=this._selectedTemplate)||void 0===g||null===(g=g.layoutTemplateInfo)||void 0===g||null===(g=g.layoutOptions)||void 0===g?void 0:g.hasTitleText)||void 0===_||_?q:null,J,this._selectedTab===L.layout?j:null,(0,S.K)("calcite-block",{"aria-label":y.advancedOptions,class:this.classes(N.panelContainer,N.advancedOptionsSection),collapsible:!0,disabled:!(A||null!==B&&void 0!==B&&B.id),heading:y.advancedOptions,id:"advancedOptionsForLayout",key:"advanced-options-for-layout"},Y))):this._selectedTab===L.mapOnly?(0,S.K)("section",{"aria-labelledby":"".concat(this.id,"__mapOnlyTab"),class:N.mapOnlySection,id:"".concat(this.id,"__mapOnlyContent"),key:"esri-print__mapOnlyContent",role:"tabpanel"},(0,S.K)("div",{class:N.panelContainer},q,j,(0,S.K)("div",null,(0,S.K)("div",{class:this.classes(N.sizeContainer,N.formSectionContainer)},(0,S.K)("calcite-label",null,y.width,(0,S.K)("calcite-input-number",{bind:this,"data-input-name":"width",value:"".concat(H),onCalciteInputNumberInput:this._updateNumberInputValue})),(0,S.K)("calcite-label",null,y.height,(0,S.K)("calcite-input-number",{bind:this,"data-input-name":"height",value:"".concat(P),onCalciteInputNumberInput:this._updateNumberInputValue})),(0,S.K)("button",{"aria-label":y.swap,bind:this,class:this.classes(x.D.widgetButton,N.swapButton,C.T.swap),onclick:this._switchInput,type:"button"})),G),(0,S.K)("calcite-block",{"aria-label":y.advancedOptions,class:this.classes(N.panelContainer,N.advancedOptionsSection),collapsible:!0,heading:y.advancedOptions,id:"advancedOptionsForMapOnly",key:"advanced-options-for-map-only"},ee))):(0,S.K)("section",{"aria-labelledby":"".concat(this.id,"__exportTab"),class:this.classes(N.exportSection,ie),id:"".concat(this.id,"__exportContent"),key:"esri-print__exportContent",role:"tabpanel"},(0,S.K)("div",{class:N.panelContainer},(0,S.K)("div",{afterUpdate:this._scrollExportIntoView,bind:this,class:N.exportedFilesContainer},0===te.length?(0,S.K)("div",{class:N.exportedFilesEmpty},(0,S.K)("calcite-icon",{icon:"file",scale:"l"}),(0,S.K)("div",null,(0,S.K)(k.D,{class:N.exportedFilesTitle,level:this.headingLevel},y.noExportedFiles),(0,S.K)("div",null,y.exportHint))):ae))),ne="2d"!==(null===T||void 0===T?void 0:T.type),oe=(0,S.K)("div",{class:N.panelError},T?ne?y.sceneViewError:y.serviceError:y.noViewError),se=te.some((e=>{let{state:t}=e;return"pending"===t})),re=(0,S.K)("div",{class:N.content,key:"panel"},(0,S.K)("div",null,(0,S.K)("ul",{bind:this,class:N.layoutTabList,onclick:this._toggleLayoutPanel,onkeydown:this._handleLayoutPanelKeyDown,role:"tablist"},(0,S.K)("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":"".concat(this._selectedTab===L.layout),class:N.layoutTab,"data-tab-id":L.layout,id:"".concat(this.id,"__layoutTab"),role:"tab",tabIndex:0},y.layoutTab),(0,S.K)("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":"".concat(this._selectedTab===L.mapOnly),class:N.layoutTab,"data-tab-id":L.mapOnly,id:"".concat(this.id,"__mapOnlyTab"),role:"tab",tabIndex:0},y.mapOnlyTab),(0,S.K)("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":"".concat(this._selectedTab===L.export),class:N.layoutTab,"data-tab-id":L.export,id:"".concat(this.id,"__exportedFilesTab"),role:"tab",tabIndex:0},se?(0,S.K)("calcite-loader",{inline:!0,label:"loading",scale:"s"}):null,y.exportsTab)),le),this._selectedTab!==L.export?(0,S.K)("div",{class:this.classes(N.printButtonSection,!this.saveExportHidden&&this.portal?N.printButtonSectionDivider:null),key:"export-button-section"},!this.saveExportHidden&&this.portal?(0,S.K)("calcite-label",{layout:"inline"},(0,S.K)("calcite-checkbox",{bind:this,checked:this.saveExportEnabled,onCalciteCheckboxChange:e=>{this.saveExportEnabled=!!e.currentTarget.checked}}),y.saveExportToMyContent):null,(0,S.K)("calcite-button",{"aria-label":y.exportDescription,bind:this,class:this.classes(N.printButton),disabled:W||!(A||null!==B&&void 0!==B&&B.id)&&!F,onclick:this._handlePrintMap,scale:"l",width:"full"},y.export)):null),ce=(0,S.K)("calcite-flow",{key:"root-flow"},(0,S.K)("calcite-flow-item",{bind:this,key:"root-flow-item",selected:!this._showTemplates},(0,S.K)("div",{class:N.printWidgetContainer},this.headerVisible?(0,S.K)("header",{class:N.headerTitle},y.export):null,this.error||ne||!T?oe:re)),this._renderChooseTemplateFlowItem()),de="initializing"===w.state,pe=de?this._renderLoader():ce,ue={[N.panelItemsCentered]:de};return(0,S.K)("div",{bind:this,class:this.classes(N.base,x.D.widget,x.D.panel,ue)},pe)}_getPageSizeLabel(e){if(!e)return;const t=e.layoutTemplateInfo;if(!t)return;const a=D.fromJSON(t.pageUnits.toLowerCase());return"".concat((0,I.ZV)(t.pageSize[0])," \xd7 ").concat((0,I.ZV)(t.pageSize[1])," ").concat((0,s.Cq)(this.messagesUnits,a,"abbr"))}_getTemplateLabel(e){var t,a;if(!e)return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.messages.selectTemplate:this.messages.untitled;const{label:i,layout:l,layoutItem:n,type:o}=e;if("print-service-template"===o&&this.messages[l])return this.messages[l];const s=null!==(t=null!==i&&void 0!==i?i:l)&&void 0!==t?t:null===n||void 0===n?void 0:n.id;return null!==(a=null===s||void 0===s?void 0:s.replaceAll("_"," "))&&void 0!==a?a:this.messages.untitled}_getPortalTemplates(){const{portalTemplateIds:e}=this.viewModel;return this.includeDefaultTemplates&&this.includeOrganizationTemplates?this.viewModel.defaultTemplates.toArray().filter((t=>{let{layout:a,layoutItem:i}=t;return!B(a)&&!(null===i||void 0===i||!i.id)&&e.includes(i.id)})):[]}_getDefaultTemplates(){const{portalTemplateIds:e}=this.viewModel;return this.includeDefaultTemplates?this.viewModel.defaultTemplates.toArray().filter((t=>{let{layout:a,layoutItem:i}=t;return!(B(a)||null!==i&&void 0!==i&&i.id&&e.includes(i.id))})):[]}_getPrintServiceTemplates(){return this.includeDefaultTemplates&&this._getDefaultTemplates().length?[]:this.viewModel.printServiceTemplates.toArray().filter((e=>{let{layout:t}=e;return!B(t)}))}_renderLayoutTemplates(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&e.sort(((e,t)=>{var a,i;return(null!==(a=e.label)&&void 0!==a?a:"")>(null!==(i=t.label)&&void 0!==i?i:"")?1:-1})),e.map((e=>{var a;return(0,S.K)("calcite-list-item",{description:this._getPageSizeLabel(e),key:"template-".concat(e.id,"-").concat(e.id===this.templateOptions.id),label:this._getTemplateLabel(e),selected:e.id===this.templateOptions.id,title:null!==(a=e.description)&&void 0!==a?a:"",value:e},(0,S.K)("calcite-icon",{icon:(e.layout?V.get(e.layout):null)||"custom-print",slot:"content-start"}),"loading"===e.state?(0,S.K)("calcite-loader",{inline:!0,key:"template-loader-".concat(e.id),label:"loading",scale:"s",slot:"content-end"}):null,"error"===(null===e||void 0===e?void 0:e.state)?(0,S.K)("calcite-icon",{class:N.templateSelectError,icon:"exclamation-mark-circle",key:"template-error-".concat(e.id),scale:"s",slot:"content-end"}):null,t?(0,S.K)("calcite-action",{icon:"trash",onclick:()=>this.viewModel.removePortalTemplate(e),slot:"actions-end",text:"delete"}):null)}))}_renderChooseTemplateFlowItem(){var e;if(!this._showTemplates)return null;const{messages:t}=this,a=m.oQ.test(null===(e=this.portal)||void 0===e?void 0:e.url),i=this.viewModel.browseTemplates.toArray(),l=this._getPortalTemplates(),n=this._getDefaultTemplates(),o=this._getPrintServiceTemplates(),s=i.length+l.length+n.length+o.length>15,r=this.browseTemplateButtonOnClick?(0,S.K)("calcite-button",{appearance:"outline",class:s?N.browseTemplateButtonContainerFilter:N.browseTemplateButtonContainer,iconStart:"folder",key:"browse-template-button",onclick:this.browseTemplateButtonOnClick,slot:s?"filter-actions-end":"default"},s?null:t.browseTemplates):null;return(0,S.K)("calcite-flow-item",{bind:this,closable:!1,heading:t.chooseTemplate,key:"template-flow-item",selected:this._showTemplates,onCalciteFlowItemBack:e=>{e.preventDefault(),this._showTemplates=!1}},(0,S.K)("div",{class:N.templateSelectFlowItemContainer},(0,S.K)("div",{class:N.templateSelectFlowItemContent},s?null:r,(0,S.K)("calcite-list",{filterEnabled:s,filterProps:["label"],key:"template-list",label:t.templateList,selectionMode:"single-persist",onCalciteListChange:e=>{var t;let{currentTarget:a}=e;return this.viewModel.applyTemplate(null===(t=a.selectedItems[0])||void 0===t?void 0:t.value)}},s?r:null,i.length?(0,S.K)("div",{key:"my-templates"},(0,S.K)("div",{class:N.templateSelectFlowItemListHeading},t.myTemplates,a?(0,S.K)("calcite-chip",{appearance:"outline",kind:"neutral",label:t.beta,scale:"s"},t.beta):null),this._renderLayoutTemplates(i,!0,!0)):null,l.length?(0,S.K)("div",{key:"org-templates"},(0,S.K)("div",{class:N.templateSelectFlowItemListHeading},t.organizationTemplates,a?(0,S.K)("calcite-chip",{appearance:"outline",kind:"neutral",label:t.beta,scale:"s"},t.beta):null),this._renderLayoutTemplates(l)):null,i.length||l.length?n.length?(0,S.K)("div",{key:"default-templates"},(0,S.K)("div",{class:N.templateSelectFlowItemListHeading},t.defaultTemplates),this._renderLayoutTemplates(n,!0)):null:this._renderLayoutTemplates(n,!0),i.length||l.length?o.length?(0,S.K)("div",{key:"service-templates"},(0,S.K)("div",{class:N.templateSelectFlowItemListHeading},t.defaultTemplates),this._renderLayoutTemplates(o)):null:this._renderLayoutTemplates(o))),(0,S.K)("div",{class:N.templateButtonContainer},(0,S.K)("calcite-button",{class:N.templateDoneButton,onclick:()=>this._showTemplates=!1},this.messagesCommon.done))))}_renderCustomTextElementSection(){const{customTextElements:e}=this.templateOptions;return e?(0,S.K)("div",{class:N.formSectionContainer,key:"custom-text-elements"},e.map(((e,t)=>{const[a,i]=Object.entries(e)[0];return"date"===a?null:(0,S.K)("calcite-label",{key:"custom-text-elements-".concat(a,"-").concat(t)},a,(0,S.K)("calcite-input",{bind:this,"data-input-custom":!0,"data-input-name":a,value:null!==i&&void 0!==i?i:"",onCalciteInputInput:this._updateInputValue}))}))):null}_renderTitleOrFileNameSection(){const{title:e,fileName:t,titlePlaceHolder:a,fileNamePlaceHolder:i}=this.messages,l=this._selectedTab===L.layout?e:t,n=this._selectedTab===L.layout?a:i,o=this._selectedTab===L.layout?this.templateOptions.title:this.templateOptions.fileName;return(0,S.K)("div",{class:N.formSectionContainer,key:l},(0,S.K)("calcite-label",null,l,(0,S.K)("calcite-input",{placeholder:n,value:null!==o&&void 0!==o?o:"",onCalciteInputInput:this._onInput})))}_focusOnTabChange(e){if(!this._activeTabFocusRequested)return;const t=e.getAttribute("data-tab-id");("layoutTab"===t&&this._selectedTab===L.layout||"mapOnlyTab"===t&&this._selectedTab===L.mapOnly||"exportTab"===t&&this._selectedTab===L.export)&&(e.focus(),this._activeTabFocusRequested=!1)}_renderLoader(){const e={[N.loader]:this._awaitingServerResponse};return(0,S.K)("div",{class:this.classes(e),key:"loader"})}_updateExportedFileNameMap(e){void 0!==this._exportedFileNameMap[e]?this._exportedFileNameMap[e]++:this._exportedFileNameMap[e]=0}_createFileLink(e,t){const a=t||this.messages.untitled,i=e.format.toLowerCase(),l=i.includes("png")?"png":i,n=a+l;return this._updateExportedFileNameMap(n),new f({name:a,extension:l,count:this._exportedFileNameMap[n]})}_resetToCurrentScale(){var e;this.templateOptions.scale=null===(e=this.viewModel.view)||void 0===e?void 0:e.scale}_updateCustomTextElementValue(e,t,a){e.find((e=>{const[a]=Object.entries(e)[0];return a===t}))[t]=a}_updateInputValue(e){const t=e.currentTarget,a=t.getAttribute("data-input-name"),i=!!t["data-input-custom"],{templateOptions:l}=this;i?this._updateCustomTextElementValue(l.customTextElements,a,t.value):l[a]=t.value}_updateNumberInputValue(e){const t=e.currentTarget,a=t.getAttribute("data-input-name"),{templateOptions:i}=this,l=Number(t.value);if(function(e){return!isNaN(e)&&e>0}(l))i[a]=l;else{const e=i[a];t.value="".concat(e)}}_handleDPIChange(e){const{templateOptions:t}=this,a=t.dpi;this._updateNumberInputValue(e);const i=t.dpi,{height:l,width:n}=function(e,t,a,i){const l=a/t,n=i/t;return{width:Math.round(e*l),height:Math.round(e*n)}}(i,a,t.width,t.height);t.height=l,t.width=n}_handlePrintMap(){var e;this._pendingExportScroll=!0;const{templateOptions:t,saveExportEnabled:a}=this,i=this.viewModel.toPrintTemplate(t),l=this._selectedTab===L.layout?null===(e=i.layoutOptions)||void 0===e?void 0:e.titleText:t.fileName,n=this._createFileLink(i,l);this.exportedLinks.add(n),this.emit("submit",{link:n,saveExportEnabled:a}),this._selectedTab=L.export,this.viewModel.print(i).then((e=>{n.set({url:e&&e.url,state:"ready"})})).catch((e=>{n.set({error:e,state:"error"})})).then((()=>{this.emit("complete",{link:n,saveExportEnabled:a}),this.scheduleRender()}))}_switchInput(){[this.templateOptions.width,this.templateOptions.height]=[this.templateOptions.height,this.templateOptions.width]}_scrollExportIntoView(){if(!this._pendingExportScroll)return;this._pendingExportScroll=!1;const e=this._rootNode;if(!e)return;const{clientHeight:t,scrollHeight:a}=e,i=a-t;i>0&&(e.scrollTop=i)}_toggleInputValue(e){const t=e.target,a=t.getAttribute("data-option-name");this.templateOptions[a]=t.checked,"scaleEnabled"===a&&this._resetToCurrentScale()}_renderExportedLinkItemPopover(e){var t;const a=this.messages,i=null!==(t=e.formattedName)&&void 0!==t?t:"",{state:l}=e,n=this.saveAsButtonCallback&&"error"!==l&&this._isFormatAllowedForSaving(e.extension);return"pending"!==l&&n?(0,S.K)("calcite-popover",{autoClose:!0,key:"".concat(i,"-popover"),label:"Popover",offsetDistance:1,overlayPositioning:"fixed",pointerDisabled:!0,referenceElement:"".concat(i,"-popover-button"),scale:"s"},(0,S.K)("calcite-list",{label:""},e.portalItem?(0,S.K)("calcite-list-item",{label:a.openItem,onCalciteListItemSelect:()=>{const t=e.portalItem;if(!t||!t.itemPageUrl)return;const a=document.createElement("a");a.target="_blank",a.href=t.itemPageUrl,a.rel="noreferrer",a.click()}},(0,S.K)("calcite-icon",{icon:"launch2",key:"".concat(i,"-launch-icon"),scale:"s",slot:"content-start"})):(0,S.K)("calcite-list-item",{label:a.saveAs,onCalciteListItemSelect:async()=>{this.saveAsButtonCallback&&((0,o.whenOnce)((()=>e.portalItem)).then((e=>{e.itemPageUrl&&this.scheduleRender()})),await this.saveAsButtonCallback(e))}},(0,S.K)("calcite-icon",{icon:"save",key:"".concat(i,"-save-icon"),scale:"s",slot:"content-start"})),(0,S.K)("calcite-list-item",{label:this.messagesCommon.delete,onCalciteListItemSelect:()=>this.exportedLinks.remove(e)},(0,S.K)("calcite-icon",{icon:"trash",key:"".concat(i,"-delete-icon"),scale:"s",slot:"content-start"})))):null}_renderExportedLinkItemContent(e,t){var a;const i=this.messages,{url:l,state:n}=e,o=null!==(a=e.formattedName)&&void 0!==a?a:"";let s=l||null;s&&(s=(0,r.addProxy)(s));const c=(0,r.hasSameOrigin)(s,location.href);return(0,S.K)("div",{class:N.exportedFile,"data-item":e,onclick:this._handleLinkClick,slot:"content"},(0,S.K)("div",null,(0,S.K)("div",{class:N.exportedFileLinkTitle},o),(0,S.K)("div",{class:N.exportedFileLinkDescription},"pending"===n?i.generatingExport:t||(c?i.ready:i.linkReady))),"ready"===n?(0,S.K)("calcite-icon",{"aria-label":"".concat(o,". ").concat(i.linkReady),icon:c?"download-to":"launch",key:"".concat(o,"-end-icon"),scale:"s",slot:"content-end"}):null)}_renderExportedLinkItemIcon(e){var t;const a=null!==(t=e.formattedName)&&void 0!==t?t:"";return"pending"===e.state?(0,S.K)("calcite-loader",{class:N.exportedFileLoader,inline:!0,key:"".concat(a,"-loader"),label:this.messages.generatingExport,scale:"m",slot:"content-start"}):(0,S.K)("calcite-icon",{icon:Z(e),key:"".concat(a,"-start-icon"),scale:"s",slot:"content-start"})}_renderExportedLinkItemAction(e,t){var a;const{state:i}=e,l=null!==(a=e.formattedName)&&void 0!==a?a:"",n=this.saveAsButtonCallback&&"error"!==i&&this._isFormatAllowedForSaving(e.extension);return"pending"!==i?(0,S.K)("calcite-action",{"aria-label":"".concat(t),icon:n?"ellipsis":"x",id:n?"".concat(l,"-popover-button"):void 0,key:"".concat(l,n?"-saveAs-action":"-action"),onclick:n?void 0:()=>{this.exportedLinks.remove(e)},slot:"actions-end",text:"".concat(t)}):null}_renderExportedLinkItem(e){var t;const a=this.messages,{error:i,state:l}=e,n=null!==(t=e.formattedName)&&void 0!==t?t:"";let o;switch(l){case"pending":o=a.pending;break;case"ready":o=a.ready;break;case"error":o=a.errorMessage}const s="error"===l?"print-task:cim-symbol-unsupported"===(null===i||void 0===i?void 0:i.name)?a.exportWebMapCIMError:a.exportWebMapError:"";return(0,S.K)(S.w,null,(0,S.K)("calcite-list-item",{"aria-label":o,key:n,title:s},this._renderExportedLinkItemContent(e,s),this._renderExportedLinkItemIcon(e),this._renderExportedLinkItemAction(e,s)),this._renderExportedLinkItemPopover(e))}_renderExportedLinkItems(e){return(0,S.K)("calcite-list",{filterEnabled:(null===e||void 0===e?void 0:e.length)>10,label:this.messages.exportedLinksList},e.map(this._renderExportedLinkItem.bind(this)))}_isFormatAllowedForSaving(e){return!this.allowedFormatsForSaving||"all"===this.allowedFormatsForSaving||!(!e||!this.allowedFormatsForSaving.includes(e))}_toggleLayoutPanel(e){const t=e.target;this._toggleTab(t.getAttribute("data-tab-id"))}_toggleTab(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._selectedTab=e,this._selectedTab===L.mapOnly)this.templateOptions.reset(),this.templateOptions.layout=E;else if(this._selectedTab===L.layout){var a;const e=null!==(a=this._selectedTemplate)&&void 0!==a?a:this.viewModel.defaultTemplate;e?this.viewModel.applyTemplate(e):this.templateOptions.reset()}t&&(this._activeTabFocusRequested=!0)}_handleLayoutPanelKeyDown(e){const{key:t}=e,a=e.target.getAttribute("data-tab-id");if((0,K.OU)(t))return this._toggleTab(a),e.preventDefault(),void e.stopPropagation();if("ArrowLeft"===t||"ArrowRight"===t){switch(a){case L.layout:this._toggleTab("ArrowLeft"===t?L.export:L.mapOnly);break;case L.mapOnly:this._toggleTab("ArrowLeft"===t?L.layout:L.export);break;case L.export:this._toggleTab("ArrowLeft"===t?L.mapOnly:L.layout)}e.preventDefault(),e.stopPropagation()}}};(0,i._)([(0,c.MZ)()],R.prototype,"_showTemplates",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"_isValidSpatialReference",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"allowedFormats",null),(0,i._)([(0,c.MZ)()],R.prototype,"allowedFormatsForSaving",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"allowedLayouts",null),(0,i._)([(0,c.MZ)()],R.prototype,"browseTemplateButtonOnClick",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"error",null),(0,i._)([(0,c.MZ)({type:M})],R.prototype,"exportedLinks",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"extraParameters",null),(0,i._)([(0,c.MZ)()],R.prototype,"headerVisible",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"headingLevel",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"icon",null),(0,i._)([(0,c.MZ)()],R.prototype,"includeDefaultTemplates",null),(0,i._)([(0,c.MZ)()],R.prototype,"includeOrganizationTemplates",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"label",null),(0,i._)([(0,c.MZ)(),(0,O.G)("esri/widgets/Print/t9n/Print")],R.prototype,"messages",void 0),(0,i._)([(0,c.MZ)(),(0,O.G)("esri/t9n/common")],R.prototype,"messagesCommon",void 0),(0,i._)([(0,c.MZ)(),(0,O.G)("esri/core/t9n/Units")],R.prototype,"messagesUnits",void 0),(0,i._)([(0,c.MZ)({type:u.default})],R.prototype,"outSpatialReference",null),(0,i._)([(0,c.MZ)()],R.prototype,"portal",null),(0,i._)([(0,c.MZ)()],R.prototype,"saveExportEnabled",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"saveExportHidden",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"showPrintAreaEnabled",null),(0,i._)([(0,c.MZ)()],R.prototype,"printServiceUrl",null),(0,i._)([(0,c.MZ)()],R.prototype,"saveAsButtonCallback",void 0),(0,i._)([(0,c.MZ)()],R.prototype,"templateCustomTextElements",null),(0,i._)([(0,c.MZ)()],R.prototype,"templateOptions",null),(0,i._)([(0,c.MZ)()],R.prototype,"view",null),(0,i._)([(0,c.MZ)({type:w.default})],R.prototype,"viewModel",void 0),R=(0,i._)([(0,p.$)("esri.widgets.Print")],R);const U=R}}]);
//# sourceMappingURL=59572.4bb33ece.chunk.js.map