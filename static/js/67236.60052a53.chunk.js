"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[9912,67236,87531],{9912:(e,t,n)=>{n.r(t),n.d(t,{applyTextFormattingHTML:()=>K,createFieldInfoMap:()=>Y,findRelatedLayer:()=>ue,findUtilityNetwork:()=>se,fixTokens:()=>U,formatAttributes:()=>X,formatEditInfo:()=>B,formatValueToFieldInfo:()=>G,getAllFieldInfos:()=>$,getFieldInfo:()=>Q,getFieldInfoLabel:()=>M,getFixedFieldName:()=>N,getFixedFieldNames:()=>C,getHighlightKeyForFeature:()=>fe,getSourceLayer:()=>T,graphicCallback:()=>Z,htmlEntities:()=>J,isAssociatedFeatureSupportedLayer:()=>z,isExpressionField:()=>L,isFeatureSupportedLayer:()=>V,isGraphicForRelatableFeatureSupportedLayer:()=>H,isRelatableFeatureSupportedLayer:()=>S,isRelatableLayer:()=>D,isRelatedField:()=>ne,preLayerQueryCallback:()=>oe,preRequestCallback:()=>ae,querySourceLayer:()=>ee,queryUpdatedFeature:()=>te,shouldOpenInNewTab:()=>A,substituteAttributes:()=>_,substituteFieldsInLinksAndAttributes:()=>k});var i=n(89379),r=n(81806),l=n(76460),o=n(88685),a=n(65256),u=n(50265),s=n(53430),d=n(31933),c=n(42633),f=n(98976),p=n(67478);const y=()=>l.A.getLogger("esri.widgets.Feature.support.featureUtils"),m=/href=(""|'')/gi,b=/(\{([^{\r\n]+)\})/g,v=/'/g,g=/^\s*expression\//i,h=/(\n)/gi,I=/[\u00A0-\u9999<>&]/gim,F=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,E=/^(?:mailto:|tel:)/,x="relationships/",w=(0,a.J2)("short-date-short-time");function T(e){var t;if(null!=e)return null!==(t=e.sourceLayer||e.layer)&&void 0!==t?t:void 0}async function Z(e){let{type:t,value:n,event:i}=e;try{return"function"==typeof n?n(i):await n}catch(r){return void y().error("error",'An error occurred when calling the "'.concat(t,'" function'),{error:r,graphic:i.graphic,value:n})}}function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!E.test(e.trim().toLowerCase())}function L(e){return!!e&&g.test(e)}function M(e,t){const n=function(e,t){if(!t||!L(t)||!e)return;const n=t.replace(g,"").toLowerCase();return e.find((e=>{let{name:t}=e;return t.toLowerCase()===n}))}(t,null===e||void 0===e?void 0:e.fieldName);return n?n.title||null:e?e.label||e.fieldName:null}function N(e,t){const n=q(t,e);return n?n.name:e}function C(e,t){return e&&e.map((e=>N(e,t)))}function q(e,t){var n;return e&&"function"==typeof e.getField&&t&&null!==(n=e.getField(t))&&void 0!==n?n:null}function R(e){return"".concat(e).trim()}function k(e){let{attributes:t,globalAttributes:n,layer:r,text:l,expressionAttributes:o,fieldInfoMap:a}=e;return l?_({formattedAttributes:n,template:O(l,(0,i.A)((0,i.A)((0,i.A)({},n),o),t),r),fieldInfoMap:a}):""}function _(e){let{formattedAttributes:t,template:n,fieldInfoMap:i}=e;return R(function(e){return e.replaceAll(m,"")}((0,o.HC)((0,o.HC)(n,(e=>function(e,t){const n=t.get(e.toLowerCase());return"{".concat((null===n||void 0===n?void 0:n.fieldName)||e,"}")}(e,i))),t)))}function j(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,i.A)({},e);return Object.keys(n).forEach((e=>function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=t[e];if("string"==typeof i){const r="%27",l=(n?encodeURIComponent(i):i).replaceAll(v,r);t[e]=l}}(e,n,t))),n}function U(e,t){return e.replaceAll(b,((e,n,i)=>{const r=q(t,i);return r?"{".concat(r.name,"}"):n}))}function O(e,t,n){const i=U(e,n);return i?i.replaceAll(F,((e,n,i)=>function(e,t,n){const i=(t=R(t))&&"{"!==t[0];return(0,o.HC)(e,j(n,i||!1))}(e,n||i,t))):i}function V(e){return null!=e&&"object"==typeof e&&"fieldsIndex"in e&&"geometryType"in e&&"getField"in e&&"load"in e&&"loaded"in e&&"objectIdField"in e&&"spatialReference"in e&&"type"in e&&("feature"===e.type||"scene"===e.type||"subtype-group"===e.type||"subtype-sublayer"===e.type||"sublayer"===e.type)&&"when"in e}function D(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"queryObjectIds"in e&&"queryRelatedFeatures"in e&&"queryRelatedFeaturesCount"in e&&"relationships"in e}function S(e){return V(e)&&D(e)}function z(e){return!(!(e&&"object"==typeof e&&"createQuery"in e&&"getField"in e&&"queryFeatureCount"in e&&"queryFeatures"in e&&"queryObjectIds"in e&&"capabilities"in e&&"fields"in e&&"fieldsIndex"in e&&"type"in e)||"feature"!==e.type&&"subtype-group"!==e.type&&"subtype-sublayer"!==e.type&&"sublayer"!==e.type||!("when"in e))&&("subtype-sublayer"===e.type&&"parent"in e&&e.parent&&"object"==typeof e.parent?"globalIdField"in e.parent:"globalIdField"in e)}function H(e){return!!e&&"object"==typeof e&&"sourceLayer"in e&&S(e.sourceLayer)}function G(e,t){const{fieldInfos:n,fieldName:r,preventPlacesFormatting:l,layer:o,timeZone:a}=t,d=Q(n,r),f=q(o,r);if(d&&!(0,s.isRasterPixelValueField)(r)){var p;const t=null===f||void 0===f?void 0:f.type,n=null===(p=d.format)||void 0===p?void 0:p.dateFormat;if("date"===t||"date-only"===t||"time-only"===t||"timestamp-offset"===t||n)return(0,c.i0)(e,{format:n,fieldType:t,timeZoneOptions:{layerTimeZone:o&&"preferredTimeZone"in o?o.preferredTimeZone:null,viewTimeZone:a,datesInUnknownTimezone:!(!o||!("datesInUnknownTimezone"in o))&&!!o.datesInUnknownTimezone}})}const y=null===d||void 0===d?void 0:d.format;return"string"==typeof e&&(0,s.isRasterPixelValueField)(r)&&y?function(e,t){return e=e.trim(),/\d{2}-\d{2}/.test(e)?e:e.includes(",")?P(e,",",", ",t):e.includes(";")?P(e,";","; ",t):e.includes(" ")?P(e," "," ",t):(0,u.ZV)(Number(e),(0,u.yx)(t))}(e,y):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,y))||null==e||null==y?K(e):(0,u.ZV)(e,l?(0,i.A)((0,i.A)({},(0,u.yx)(y)),{},{minimumFractionDigits:0,maximumFractionDigits:20}):(0,u.yx)(y))}function P(e,t,n,i){return e.trim().split(t).map((e=>(0,u.ZV)(Number(e),(0,u.yx)(i)))).join(n)}function Q(e,t){if(null!==e&&void 0!==e&&e.length&&t)return e.find((e=>{var n;return(null===(n=e.fieldName)||void 0===n?void 0:n.toLowerCase())===t.toLowerCase()}))}function B(e,t,n,r){const{creatorField:l,creationDateField:o,editorField:u,editDateField:s}=e;if(!t)return;const d=(0,p.hv)(r&&"preferredTimeZone"in r?r.preferredTimeZone:null,!(!r||!("datesInUnknownTimezone"in r))&&!!r.datesInUnknownTimezone,n,w,"date"),c=(0,i.A)((0,i.A)({},w),d),f=t[s];if("number"==typeof f){const e=t[u];return{type:"edit",date:(0,a.Yq)(f,c),user:e}}const y=t[o];if("number"==typeof y){const e=t[l];return{type:"create",date:(0,a.Yq)(y,c),user:e}}return null}function Y(e,t){const n=new Map;if(!e)return n;for(const i of e){if(!i.fieldName)continue;const e=N(i.fieldName,t);i.fieldName=e,n.set(e.toLowerCase(),i)}return n}function $(e){const t=[];if(!e)return t;const{fieldInfos:n,content:i}=e;return n&&t.push(...n),i&&Array.isArray(i)?(i.forEach((e=>{if("fields"===e.type){const n=null===e||void 0===e?void 0:e.fieldInfos;n&&t.push(...n)}})),t):t}function J(e){return e.replaceAll(I,(e=>"&#".concat(e.charCodeAt(0),";")))}function K(e){return"string"==typeof e?e.replaceAll(h,'<br class="esri-text-new-line" />'):e}function W(e){var t;const{value:n,fieldName:i,fieldInfos:l,fieldInfoMap:o,layer:a,graphic:u,timeZone:d}=e;if(null==n)return"";const f=function(e){let{fieldName:t,value:n,graphic:i,layer:l}=e;if(ne(t))return null;if(!l||"function"!=typeof l.getFieldDomain)return null;const o=i&&l.getFieldDomain(t,{feature:i,excludeImpliedDomains:(0,r.A)("esri-widget-legacy-field-domain-calculation")});return o&&"coded-value"===o.type?o.getName(n):null}({fieldName:i,value:n,graphic:u,layer:a});if(f)return f;const p=function(e){let{fieldName:t,graphic:n,layer:i}=e;if(ne(t))return null;if(!i||"function"!=typeof i.getFeatureType)return null;const{typeIdField:r}=i;if(!r||t!==r)return null;const l=i.getFeatureType(n);return l?l.name:null}({fieldName:i,graphic:u,layer:a});if(p)return p;if(o.get(i.toLowerCase()))return G(n,{fieldInfos:l||Array.from(o.values()),fieldName:i,layer:a,timeZone:d});const y=null===a||void 0===a||null===(t=a.fieldsIndex)||void 0===t?void 0:t.get(i);return y&&((0,c.fs)(y)||(0,s.isTimeOnlyField)(y))?(0,c.i0)(n,{fieldType:y.type,timeZoneOptions:{layerTimeZone:a&&"preferredTimeZone"in a?a.preferredTimeZone:null,viewTimeZone:d,datesInUnknownTimezone:!(!a||!("datesInUnknownTimezone"in a))&&!!a.datesInUnknownTimezone}}):K(n)}function X(e){let{fieldInfos:t,attributes:n,layer:i,graphic:r,fieldInfoMap:l,relatedInfos:o,timeZone:a}=e;const u={};return null!==o&&void 0!==o&&o.forEach((e=>function(e){var t,n;let{attributes:i,relatedInfo:r,fieldInfoMap:l,fieldInfos:o,layer:a,timeZone:u}=e;i&&r&&(null!==(t=r.relatedFeatures)&&void 0!==t&&t.forEach((e=>ie({attributes:i,graphic:e,relatedInfo:r,fieldInfoMap:l,fieldInfos:o,layer:a,timeZone:u}))),null===(n=r.relatedStatsFeatures)||void 0===n||n.forEach((e=>ie({attributes:i,graphic:e,relatedInfo:r,fieldInfoMap:l,fieldInfos:o,layer:a,timeZone:u}))))}({attributes:u,relatedInfo:e,fieldInfoMap:l,fieldInfos:t,layer:i,timeZone:a}))),n&&Object.keys(n).forEach((e=>{const o=n[e];u[e]=W({fieldName:e,fieldInfos:t,fieldInfoMap:l,layer:i,value:o,graphic:r,timeZone:a})})),u}async function ee(e,t){var n;const{layer:i,graphic:r,outFields:l,objectIds:o,returnGeometry:a,spatialReference:u}=e,s=o[0];if("number"!=typeof s&&"string"!=typeof s){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:i,graphic:r,objectId:s,requiredFields:l};return y().warn(e,t),null}if(null===(n=(0,d.BR)(i))||void 0===n||null===(n=n.operations)||void 0===n||!n.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:i,graphic:r,requiredFields:l,returnGeometry:a};return y().warn(e,t),null}const c=i.createQuery();return c.objectIds=o,c.outFields=null!==l&&void 0!==l&&l.length?l:[i.objectIdField],c.returnGeometry=!!a,c.returnZ=!!a,c.returnM=!!a,c.outSpatialReference=u,(await i.queryFeatures(c,t)).features[0]}async function te(e,t){let{graphic:n,popupTemplate:r,layer:l,spatialReference:o}=e;if(!l||!r)return;if("function"==typeof l.load&&await l.load(t),!n.attributes)return;const a=l.objectIdField,u=n.attributes[a];if(null==u)return;const d=[u],c=await r.getRequiredFields(l.fieldsIndex),p=(0,s.featureHasFields)(c,n),y=p?[]:c.includes(a)?c:[...c,a],m=r.returnGeometry||await async function(e){var t;if(null===(t=e.expressionInfos)||void 0===t||!t.length)return!1;const n=await(0,f.lw)(),{arcadeUtils:{hasGeometryFunctions:i}}=n;return i(e)}(r);if(p&&!m)return;const b=await ee({layer:l,graphic:n,outFields:y,objectIds:d,returnGeometry:m,spatialReference:o},t);b&&(b.geometry&&(n.geometry=b.geometry),b.attributes&&(n.attributes=(0,i.A)((0,i.A)({},n.attributes),b.attributes)))}function ne(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(x)}function ie(e){let{attributes:t,graphic:n,relatedInfo:i,fieldInfos:r,fieldInfoMap:l,layer:o,timeZone:a}=e;t&&n&&i&&Object.keys(n.attributes).forEach((e=>{const u=function(e){return"".concat(x).concat(e.layerId,"/").concat(e.fieldName)}({layerId:i.relation.id.toString(),fieldName:e}),s=n.attributes[e];t[u]=W({fieldName:u,fieldInfos:r,fieldInfoMap:l,layer:o,value:s,graphic:n,timeZone:a})}))}const re=e=>{if(!e)return!1;const t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},le=e=>{var t;let{layer:n,method:i,query:r,definitionExpression:l}=e;if(null===(t=n.capabilities)||void 0===t||null===(t=t.query)||void 0===t||!t.supportsCacheHint||"attachments"===i)return;const o=null!=r.where?r.where:null,a=null!=r.geometry?r.geometry:null;re(l)||re(o)||"extent"===(null===a||void 0===a?void 0:a.type)||"tile"===r.resultType||(r.cacheHint=!0)},oe=e=>{var t;let{query:n,layer:i,method:r}=e;le({layer:i,method:r,query:n,definitionExpression:"".concat(i.definitionExpression," ").concat(null!==(t=i.serviceDefinitionExpression)&&void 0!==t?t:"")})},ae=e=>{var t;let{queryPayload:n,layer:i,method:r}=e;le({layer:i,method:r,query:n,definitionExpression:"".concat(i.definitionExpression," ").concat(null!==(t=i.serviceDefinitionExpression)&&void 0!==t?t:"")})};function ue(e,t,n){var i,r;return e&&t&&n?"sublayer"===t.type?ce({layers:null===(i=t.layer)||void 0===i?void 0:i.sublayers,map:e,relatedLayer:t,relationship:n})||ce({layers:null===(r=t.layer)||void 0===r?void 0:r.subtables,map:e,relatedLayer:t,relationship:n}):ce({layers:e.allLayers,map:e,relatedLayer:t,relationship:n})||ce({layers:e.allTables,map:e,relatedLayer:t,relationship:n}):null}function se(e,t){var n;return e&&"utilityNetworks"in e&&t?null===(n=e.utilityNetworks)||void 0===n?void 0:n.find((e=>e.isUtilityLayer(t))):null}function de(e,t){return null===e||void 0===e?void 0:e.allTables.find((e=>{var n;return"feature"===e.type&&e.layerId===t.id&&e.url===(null===(n=t.layer)||void 0===n?void 0:n.url)}))}function ce(e){let{map:t,relationship:n,relationship:{relatedTableId:i},relatedLayer:r,layers:l}=e;if(!l)return null;for(const a of l){var o;if("map-image"===a.type){const e=ce({layers:a.sublayers,map:t,relatedLayer:r,relationship:n})||ce({layers:a.subtables,map:t,relatedLayer:r,relationship:n});if(e)return e;continue}if(!S(a))continue;if("sublayer"===r.type){if(a!==r&&a.id===i)return a.isTable?de(t,a):a;continue}const e="scene"===r.type&&r.associatedLayer?r.associatedLayer.url:r.url;if(!e)return null;if("sublayer"!==a.type){if(a!==r&&a.url===e&&a.layerId===i)return a}else if(a!==r&&(null===(o=a.layer)||void 0===o?void 0:o.url)===e&&a.id===i)return a.isTable?de(t,a):a}return null}function fe(e){const t=e.getObjectId();return null!=t?"oid:".concat(t):"uid:".concat(e.uid)}},48397:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(35143),r=n(46053),l=(n(81806),n(76460),n(47249),n(85842)),o=n(31933),a=n(84668),u=n(23301);let s=class extends a.A{constructor(e){super(e),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){var e;return!!this.layerAllowsEdits&&(null===(e=this.evaluatedEditableExpression)||void 0===e||e)}get evaluatedEditableExpression(){const{editableExpressionExecutor:e}=this;return null!=e?!!e.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:e}=this;if(!e)return!1;const t=(0,o.BR)(e),n=null===t||void 0===t?void 0:t.operations.supportsEditing,i=(0,u.of)(t,this.arcadeEditType);return!(!n||!i)}};(0,i._)([(0,r.MZ)()],s.prototype,"arcadeEditType",void 0),(0,i._)([(0,r.MZ)()],s.prototype,"editable",null),(0,i._)([(0,r.MZ)()],s.prototype,"editableExpressionExecutor",void 0),(0,i._)([(0,r.MZ)()],s.prototype,"evaluatedEditableExpression",null),(0,i._)([(0,r.MZ)()],s.prototype,"layerAllowsEdits",null),s=(0,i._)([(0,l.$)("esri.widgets.FeatureForm.EditableInput")],s);const d=s},84668:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(35143),r=n(91967),l=n(46053),o=(n(81806),n(76460),n(47249),n(85842)),a=n(3320);let u=class extends r.default{constructor(e){super(e),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){var e;return this.getFormattedLabel(null===(e=this.element)||void 0===e?void 0:e.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return null!=e?!!e.lastEvaluatedValue:null}get label(){var e;return this.getFormattedLabel(null===(e=this.element)||void 0===e?void 0:e.label)}get updating(){return!1}get visible(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}getFormattedLabel(e){const{feature:t,layer:n,timeZone:i}=this;return null==n||null==e?e:(0,a.LZ)({label:e,attributes:t.attributes,fieldsIndex:n.fieldsIndex,timeZone:i})}};(0,i._)([(0,l.MZ)({readOnly:!0})],u.prototype,"description",null),(0,i._)([(0,l.MZ)({constructOnly:!0})],u.prototype,"element",void 0),(0,i._)([(0,l.MZ)()],u.prototype,"evaluatedVisibilityExpression",null),(0,i._)([(0,l.MZ)()],u.prototype,"feature",void 0),(0,i._)([(0,l.MZ)()],u.prototype,"label",null),(0,i._)([(0,l.MZ)()],u.prototype,"layer",void 0),(0,i._)([(0,l.MZ)()],u.prototype,"timeZone",void 0),(0,i._)([(0,l.MZ)()],u.prototype,"type",void 0),(0,i._)([(0,l.MZ)()],u.prototype,"updating",null),(0,i._)([(0,l.MZ)()],u.prototype,"visible",null),(0,i._)([(0,l.MZ)()],u.prototype,"visibilityExpressionExecutor",void 0),u=(0,i._)([(0,o.$)("esri.widgets.FeatureForm.InputBase")],u);const s=u}}]);
//# sourceMappingURL=67236.60052a53.chunk.js.map