"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[11742],{11742:(t,e,i)=>{i.r(e),i.d(e,{default:()=>_});var s=i(89379),o=i(35143),a=i(5632),l=i(50346),r=i(68134),n=i(46053),u=(i(81806),i(76460),i(47249),i(85842)),d=i(19451),p=i(9912),c=i(48397),y=i(91039),h=i(26547);let v=class extends(a.A.IdentifiableMixin(c.A)){constructor(t){super(t),this.group=null,this.type="utilityNetworkAssociations",this.featureItem=null,this._updatingHandlesSetUp=new d.U,this.addHandles([(0,r.watch)((()=>({feature:this.feature,element:this.element,layer:this.layer})),(t=>this._createAssociationVM(t)),r.initial),(0,r.watch)((()=>this.feature),(()=>this._setFeatureItem())),(0,r.watch)((()=>this.associatedLayer),((t,e)=>this._updateLayerEditHandle(t,e)),r.initial)])}destroy(){var t;null!==(t=this._associationsVM)&&void 0!==t&&t.destroy(),this._updatingHandlesSetUp.destroy()}get activeAssociationType(){var t;return null===(t=this._associationsVM)||void 0===t?void 0:t.activeAssociationType}get associatedFeatures(){const{associatedLayer:t}=this;if(t)return this.associatedFeatureInfos.get(t)}get associatedFeatureInfos(){var t;const{_associationsVM:e}=this;if(null===e||void 0===e||null===(t=e.associationFeatures)||void 0===t||!t.size||null===e||void 0===e||!e.utilityNetwork)return new Map;const{associationFeatures:i}=e,o=new Map;return i.forEach(((t,e)=>{const i=t.map((t=>{if(null==t.title){const e=(0,h.R)(t.feature);return(0,s.A)((0,s.A)({},t),{},{title:e})}return t}));o.set(e,i)})),o}get associatedLayer(){return this._get("associatedLayer")}set associatedLayer(t){this._associationsVM.showAllEnabled=null!=t,this._set("associatedLayer",t)}get associationsViewModel(){return this._associationsVM}get canAddAssociation(){const{editable:t,utilityNetwork:e}=this;return!(!e||!this.loaded)&&t}get editable(){var t;return null===(t=this.evaluatedEditableExpression)||void 0===t||t}get featureCount(){var t,e;return null!==(t=null===(e=this._associationsVM)||void 0===e?void 0:e.featureCount)&&void 0!==t?t:0}get viewModel(){return this._associationsVM}get loaded(){var t;return"loading"!==(null===(t=this._associationsVM)||void 0===t?void 0:t.state)&&!this._updatingHandlesSetUp.updating}get map(){return this._get("map")}set map(t){var e;t&&null!==(e=this._associationsVM)&&void 0!==e&&e.set("map",t),this._set("map",t)}get utilityNetwork(){var t;return null===(t=this._associationsVM)||void 0===t?void 0:t.utilityNetwork}get associationTypes(){var t,e;return null!==(t=null===(e=this._associationsVM)||void 0===e?void 0:e.associationTypes)&&void 0!==t?t:this.element.associationTypes}get visible(){const{utilityNetwork:t}=this;return!!t&&(null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element)}get updating(){var t,e;return"loading"===(null===(t=this._associationsVM)||void 0===t?void 0:t.state)||"querying"===(null===(e=this._associationsVM)||void 0===e?void 0:e.state)}async refresh(){await(0,l.ignoreAbortErrors)(this._associationsVM.refresh())}_updateLayerEditHandle(t,e){e&&"layerId"in e&&this.removeHandles(null===e||void 0===e?void 0:e.layerId),(0,p.isAssociatedFeatureSupportedLayer)(t)&&this.addHandles((0,r.on)((()=>t),"edits",(()=>this.refresh())),t.layerId)}_createAssociationVM(t){var e;const{feature:i,element:s,layer:o}=t;if(null!==(e=this._associationsVM)&&void 0!==e&&e.destroy(),!i||!s||!o)return;const{map:a,associationTypes:l}=this;(0,p.isAssociatedFeatureSupportedLayer)(o)&&(this._associationsVM=new y.A({graphic:i,layer:o,map:a,associationTypes:l,source:"featureForm",title:this.label,description:this.description}))}_setFeatureItem(){this._updatingHandlesSetUp.addPromise((async()=>{const{feature:t,layer:e}=this;t&&e&&"getFeatureTitle"in e&&(this.featureItem={feature:t,label:await e.getFeatureTitle(t)})})())}};(0,o._)([(0,n.MZ)()],v.prototype,"_associationsVM",void 0),(0,o._)([(0,n.MZ)()],v.prototype,"activeAssociationType",null),(0,o._)([(0,n.MZ)()],v.prototype,"associatedFeatures",null),(0,o._)([(0,n.MZ)()],v.prototype,"associatedFeatureInfos",null),(0,o._)([(0,n.MZ)()],v.prototype,"associatedLayer",null),(0,o._)([(0,n.MZ)()],v.prototype,"associationsViewModel",null),(0,o._)([(0,n.MZ)()],v.prototype,"canAddAssociation",null),(0,o._)([(0,n.MZ)()],v.prototype,"editable",null),(0,o._)([(0,n.MZ)()],v.prototype,"featureCount",null),(0,o._)([(0,n.MZ)()],v.prototype,"viewModel",null),(0,o._)([(0,n.MZ)()],v.prototype,"group",void 0),(0,o._)([(0,n.MZ)()],v.prototype,"loaded",null),(0,o._)([(0,n.MZ)()],v.prototype,"map",null),(0,o._)([(0,n.MZ)()],v.prototype,"utilityNetwork",null),(0,o._)([(0,n.MZ)()],v.prototype,"associationTypes",null),(0,o._)([(0,n.MZ)({readOnly:!0})],v.prototype,"type",void 0),(0,o._)([(0,n.MZ)()],v.prototype,"visible",null),(0,o._)([(0,n.MZ)()],v.prototype,"updating",null),(0,o._)([(0,n.MZ)()],v.prototype,"featureItem",void 0),v=(0,o._)([(0,u.$)("esri.widgets.FeatureForm.UtilityNetworkAssociationInput")],v);const _=v},48397:(t,e,i)=>{i.d(e,{A:()=>d});var s=i(35143),o=i(46053),a=(i(81806),i(76460),i(47249),i(85842)),l=i(31933),r=i(84668),n=i(23301);let u=class extends r.A{constructor(t){super(t),this.arcadeEditType="NA",this.editableExpressionExecutor=null}get editable(){var t;return!!this.layerAllowsEdits&&(null===(t=this.evaluatedEditableExpression)||void 0===t||t)}get evaluatedEditableExpression(){const{editableExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get layerAllowsEdits(){const{layer:t}=this;if(!t)return!1;const e=(0,l.BR)(t),i=null===e||void 0===e?void 0:e.operations.supportsEditing,s=(0,n.of)(e,this.arcadeEditType);return!(!i||!s)}};(0,s._)([(0,o.MZ)()],u.prototype,"arcadeEditType",void 0),(0,s._)([(0,o.MZ)()],u.prototype,"editable",null),(0,s._)([(0,o.MZ)()],u.prototype,"editableExpressionExecutor",void 0),(0,s._)([(0,o.MZ)()],u.prototype,"evaluatedEditableExpression",null),(0,s._)([(0,o.MZ)()],u.prototype,"layerAllowsEdits",null),u=(0,s._)([(0,a.$)("esri.widgets.FeatureForm.EditableInput")],u);const d=u},84668:(t,e,i)=>{i.d(e,{A:()=>u});var s=i(35143),o=i(91967),a=i(46053),l=(i(81806),i(76460),i(47249),i(85842)),r=i(3320);let n=class extends o.default{constructor(t){super(t),this.element=null,this.feature=null,this.layer=null,this.timeZone=null,this.type=null,this.visibilityExpressionExecutor=null}get description(){var t;return this.getFormattedLabel(null===(t=this.element)||void 0===t?void 0:t.description)}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:t}=this;return null!=t?!!t.lastEvaluatedValue:null}get label(){var t;return this.getFormattedLabel(null===(t=this.element)||void 0===t?void 0:t.label)}get updating(){return!1}get visible(){return null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element}getFormattedLabel(t){const{feature:e,layer:i,timeZone:s}=this;return null==i||null==t?t:(0,r.LZ)({label:t,attributes:e.attributes,fieldsIndex:i.fieldsIndex,timeZone:s})}};(0,s._)([(0,a.MZ)({readOnly:!0})],n.prototype,"description",null),(0,s._)([(0,a.MZ)({constructOnly:!0})],n.prototype,"element",void 0),(0,s._)([(0,a.MZ)()],n.prototype,"evaluatedVisibilityExpression",null),(0,s._)([(0,a.MZ)()],n.prototype,"feature",void 0),(0,s._)([(0,a.MZ)()],n.prototype,"label",null),(0,s._)([(0,a.MZ)()],n.prototype,"layer",void 0),(0,s._)([(0,a.MZ)()],n.prototype,"timeZone",void 0),(0,s._)([(0,a.MZ)()],n.prototype,"type",void 0),(0,s._)([(0,a.MZ)()],n.prototype,"updating",null),(0,s._)([(0,a.MZ)()],n.prototype,"visible",null),(0,s._)([(0,a.MZ)()],n.prototype,"visibilityExpressionExecutor",void 0),n=(0,s._)([(0,l.$)("esri.widgets.FeatureForm.InputBase")],n);const u=n}}]);
//# sourceMappingURL=11742.7b6ed5d1.chunk.js.map