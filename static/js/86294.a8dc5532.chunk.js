"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[86294],{86294:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var i=n(89379),a=n(35143),o=(n(11265),n(81806),n(54901)),l=n(87663),r=n(68134),s=n(46053),d=(n(76460),n(47249),n(85842)),u=n(53430),p=n(85632),c=n(25329),m=n(33695),h=n(66845);const v="esri-batch-attribute-form",b="".concat(v,"__group"),_="".concat(v,"__input"),f={base:v,form:"".concat(v,"__form"),formHeader:"".concat(v,"__form-header"),noticeError:"".concat(v,"__notice-error"),label:"".concat(v,"__label"),labelTextContent:"".concat(v,"__label-text-content"),fieldInput:"".concat(_),inputRadio:"".concat(_,"--radio"),placeholderRadio:"".concat(_,"--radio-placeholder"),inputRadioGroup:"".concat(_,"--radio-group"),inputRadioLabel:"".concat(_,"--radio-label"),inputDisabled:"".concat(_,"--disabled"),inputSwitch:"".concat(_,"--switch"),centeredButton:"".concat(v,"__centered-button"),description:"".concat(v,"__description-text"),dateInputContainer:"".concat("".concat(v,"__date"),"-input-container"),block:"".concat(v,"__block"),group:b,groupSequential:"".concat(b,"--sequential"),individualElement:"".concat(b,"__individual-element")};var g=n(91967);let C=class extends g.default{constructor(e){super(e),this.errorsForNonVisibleFields=!0,this.featureInfo=!0,this.featureSwitcher=!0}};(0,a._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],C.prototype,"errorsForNonVisibleFields",void 0),(0,a._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],C.prototype,"featureInfo",void 0),(0,a._)([(0,s.MZ)({type:Boolean,nonNullable:!0})],C.prototype,"featureSwitcher",void 0),C=(0,a._)([(0,d.$)("esri.widgets.BatchAttributeForm.VisibleElements")],C);var I=n(86950),y=n(94126),w=n(20639),F=n(98108),M=n(76099),D=n(63582),k=n(12254),T=n(54761),x=n(23301),O=n(39348);const V="data-element-id";let Z=class extends c.default{constructor(e,t){super(e,t),this.headingLevel=2,this.messagesCommon=null,this.messages=null,this.featureFormMessages=null,this.readOnly=!1,this.viewModel=new h.default,this.visibleElements=new C,this.groupDisplay="all",this._attemptFocusOnNextRender=!1,this._dateComponentMap=new Map,this._touchedInputs=new Set,this._focusedFieldInput=null,this._batchSwitchInputInitialValues=new Map,this._saveInput=this._saveInput.bind(this),this._onFormSubmit=this._onFormSubmit.bind(this),this._onComponentFocus=this._onComponentFocus.bind(this),this._onComponentBlur=this._onComponentBlur.bind(this),this._afterComponentCreateOrUpdate=this._afterComponentCreateOrUpdate.bind(this),this._afterDateComponentCreate=this._afterDateComponentCreate.bind(this),this._afterDateComponentUpdate=this._afterDateComponentUpdate.bind(this),this._afterRadioGroupCreateOrUpdate=this._afterRadioGroupCreateOrUpdate.bind(this)}initialize(){this.addHandles([(0,r.watch)((()=>this.features),(()=>{this._dateComponentMap.clear();const e=new AbortController;(0,r.whenOnce)((()=>!this.viewModel.updating),e.signal).then((()=>{this._attemptFocusOnNextRender=!0})),this.addHandles((0,o.rE)(e))})),(0,r.watch)((()=>this.viewModel.activeForm),(()=>{this._batchSwitchInputInitialValues.clear()}))])}loadDependencies(){return(0,y.W)({input:()=>Promise.all([n.e(46870),n.e(38841)]).then(n.bind(n,38841)),block:()=>n.e(75502).then(n.bind(n,75502)),button:()=>Promise.resolve().then(n.bind(n,43285)),combobox:()=>Promise.all([n.e(65641),n.e(64880)]).then(n.bind(n,64880)),"combobox-item":()=>n.e(73438).then(n.bind(n,73438)),"combobox-item-group":()=>n.e(91092).then(n.bind(n,91092)),dropdown:()=>Promise.resolve().then(n.bind(n,24482)),"dropdown-group":()=>Promise.resolve().then(n.bind(n,5368)),"dropdown-item":()=>Promise.resolve().then(n.bind(n,84660)),"input-date-picker":()=>Promise.all([n.e(46870),n.e(79709),n.e(53433)]).then(n.bind(n,40240)),"input-number":()=>Promise.all([n.e(46870),n.e(41763)]).then(n.bind(n,41763)),"input-time-picker":()=>Promise.all([n.e(46870),n.e(5506)]).then(n.bind(n,5506)),"input-time-zone":()=>Promise.all([n.e(65641),n.e(64880),n.e(46152)]).then(n.bind(n,46152)),label:()=>Promise.resolve().then(n.bind(n,11839)),"input-message":()=>n.e(92903).then(n.bind(n,92903)),loader:()=>Promise.resolve().then(n.bind(n,35688)),notice:()=>n.e(12261).then(n.bind(n,12261)),switch:()=>Promise.resolve().then(n.bind(n,8989)),"text-area":()=>Promise.all([n.e(46870),n.e(26264)]).then(n.bind(n,26264)),"radio-button":()=>n.e(2599).then(n.bind(n,2599)),"radio-button-group":()=>n.e(43953).then(n.bind(n,43953))})}get activeFeatureIndex(){return this.viewModel.activeFeatureIndex}set activeFeatureIndex(e){this.viewModel.activeFeatureIndex=e}get disabled(){return this.viewModel.disabled}set disabled(e){this.viewModel.disabled=e}get _effectiveDisabled(){return this.disabled||this.viewModel.updating}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get map(){return this.viewModel.map}set map(e){this.viewModel.map=e}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get timeZone(){return this.viewModel.timeZone}set timeZone(e){this.viewModel.timeZone=e}get icon(){return"edit-attributes"}set icon(e){this._overrideIfSome("icon",e)}goToClosestError(){const e=this.viewModel.getFirstVisibleInvalidFieldInput();if(!e)return;const{groupInput:t}=e;t&&(t.open||(t.open=!0)),setTimeout((()=>{if(!this.domNode)return;const t=this.domNode.querySelector('[data-element-id="'.concat(e.input.template.elementId,'"]'));t&&(0,M.Z6)(t)}),10)}render(){var e;const{status:t}=this.viewModel;return"failed"===t?this._renderErrorNotice(this.messages.formFailedToLoad):this.viewModel.expressionEvaluationFailed?this._renderErrorNotice(this.messages.expressionEvaluationFailed):this.viewModel.hasLayersWithContingentValues?this._renderErrorNotice(this.messages.unsupportedContingentValues):(0,T.K)("div",{class:this.classes(f.base,F.D.widget,F.D.panel)},"loaded"===t?this._renderForm():"loading"===t?(0,T.K)("calcite-loader",{key:"loader",label:null===(e=this.messagesCommon)||void 0===e?void 0:e.loading}):null)}_setDateTimeTimeZoneMap(e){var t;const{datePart:n,elementId:i}=e.dataset,a=this._getCalciteElementFromDateTimeTimeZonePicker(e,n);if(!a)return;const o=(0,l.tE)(this._dateComponentMap,"".concat(i),(()=>({placeholder:{date:"",time:"",timeZone:""}})));switch(o.placeholder[n]=null!==(t=a.placeholder)&&void 0!==t?t:"",n){case"date":o.date=e;break;case"time":o.time=e;break;case"timeZone":o.timeZone=e,o.defaultComboboxItemElements=a.selectedItems}"timeZone"===n&&(o.defaultComboboxItemElements=a.selectedItems)}_getCalciteElementFromDateTimeTimeZonePicker(e,t){const n=e.shadowRoot;return n?"timeZone"===t?n.querySelector("calcite-combobox"):n.querySelector("calcite-input-text"):null}_updateDateTimeOrTimeZoneShadowDom(e,t){var n;const{datePart:i,elementId:a}=e.dataset,o=this._dateComponentMap.get("".concat(a));if(!o)return;const l=this._getCalciteElementFromDateTimeTimeZonePicker(e,i);if(l)switch(i){case"date":case"time":l.placeholder=t?this.messages.differentValues:o.placeholder[i];break;case"timeZone":t?(l.value="",l.placeholder=this.messages.differentValues):(!l.selectedItems.length&&null!==(n=o.defaultComboboxItemElements)&&void 0!==n&&n.length&&(l.selectedItems[0]=o.defaultComboboxItemElements[0]),l.placeholder=o.placeholder[i])}}_renderErrorNotice(e){return(0,T.K)("div",{class:this.classes(f.base,F.D.widget,F.D.panel)},(0,T.K)("calcite-notice",{class:f.noticeError,icon:!0,kind:"warning",open:!0},(0,T.K)("div",{slot:"message"},e)))}_renderForm(){return(0,T.K)("form",{onsubmit:this._onFormSubmit},this._renderInvisibleFieldsError(),this._renderContent())}_renderInvisibleFieldsError(){const{viewModel:e}=this,{hasNonActiveInvalidFeatures:t,activeForm:n}=e;let i;if(!e.submitHasBeenAttempted)return null;if(n.invalidHiddenInputs.length>0)if(i=(0,m.In)(n,e.mode,this.messages),"batch"===this.viewModel.mode){const e=n.invalidHiddenInputs.filter((e=>e.effectiveVisibilityCode===I.qp.HIDDEN_GROUP_VISIBILITY_EXPRESSION_ALL||e.visibilityCode===I.qp.HIDDEN_VISIBILITY_EXPRESSION_ALL));e.length>0?i+=" (".concat(e.map((e=>e.label)).join(", "),")"):i=null}else i+=" (".concat(n.invalidHiddenInputs.map((e=>e.label)).join(", "),")");else if(t)return null;return i?(0,T.K)("calcite-notice",{class:f.noticeError,icon:!0,kind:"danger",open:!0},(0,T.K)("div",{slot:"message"},i)):null}_renderContent(){if(!this.viewModel.hasVisibleInputs)return[(0,T.K)("calcite-notice",{class:f.noticeError,icon:!0,kind:"warning",open:!0},(0,T.K)("div",{slot:"message"},this.messages.noVisibleFields[this.viewModel.noVisibleElementsReason]))];const{inputs:e}=this.viewModel.activeForm;return e.filter((e=>e.visible)).map((e=>this._renderInput(e)))}_renderInput(e){return(0,I.Et)(e)?this._renderGroupInput(e):(0,I.rf)(e)?this._renderLabeledField(e):void 0}_renderGroupInput(e){var t,n;const{inputs:i,template:a,open:o}=e,l=i.filter((e=>e.visible)),r=null!==(t=a.label)&&void 0!==t?t:"";return(0,T.K)("calcite-block",{class:this.classes(f.group,"sequential"===this.groupDisplay?f.groupSequential:null,this.disabled?f.inputDisabled:null),collapsible:!0,description:null!==(n=a.description)&&void 0!==n?n:void 0,disabled:this._effectiveDisabled,heading:r,headingLevel:this.headingLevel,key:"{".concat(a.elementId,"-key}"),label:r,open:o,onCalciteBlockClose:()=>{e.open=!1},onCalciteBlockOpen:()=>{e.open=!0}},l.map((e=>this._renderInput(e))))}_renderLabeledField(e){const{label:t,elementId:n}=e.template,{required:i,dataType:a}=e,o=i?(0,O.V)(this.messages.requiredFieldLabel,{name:t}):t;return(0,T.K)("calcite-label",{"aria-label":o,class:f.label,key:"field--".concat(n)},(0,T.K)("div",{class:f.labelTextContent,key:"labelTextContainer"},t,i?(0,T.K)("span",{"aria-hidden":"true",title:this.messagesCommon.required},"*"):void 0),"unsupported"!==a?this._renderFieldInput(e):this._renderReadOnlyComponent(e),this._renderAuxiliaryText(e))}_renderFieldInput(e){var t;const n=this.getCommonInputProps(e),{dataType:i}=e;return"date"===i?this._renderDateComponents(e,n):"coded-value"===(null===(t=e.domain)||void 0===t?void 0:t.type)?this._renderCodedInputs({input:e,props:n}):"number"===i?this._renderNumberComponent(e,n):this._renderStringComponent(e,n)}_renderAuxiliaryText(e){const{compositeError:t,description:n,submittable:i}=e,a=!i&&t&&(this.viewModel.submitHasBeenAttempted||this._touchedInputs.has(e.template.elementId))?(0,m.HJ)(e,t,this.messages):null;return a?(0,T.K)("calcite-input-message",{icon:!0,status:"invalid"},a):n?(0,T.K)("calcite-input-message",{class:f.description,icon:!1,status:"idle"},n):null}_renderCodedInputs(e){var t,n;let{input:i,props:a}=e;const o=null!==(t=null===(n=i.template.input)||void 0===n?void 0:n.type)&&void 0!==t?t:null,l=i.codedValueOptions;switch(o){case"switch":return this._renderSwitchField({input:i,props:a});case"radio-buttons":return this._renderRadioButtonGroupComponent({input:i,options:l.flat(),props:a});default:return this._renderComboBoxComponent({options:l,props:a,input:i})}}_renderSwitchField(e){let{input:t,props:n}=e;if((this._batchSwitchInputInitialValues.get(t)===I.pg||t.value===I.pg)&&"batch"===this.viewModel.mode){const e={dropdown:{afterCreate:this._afterComponentCreateOrUpdate,afterUpdate:this._afterComponentCreateOrUpdate,disabled:n.readOnly,open:!1,[V]:n[V]},trigger:{appearance:"transparent",iconEnd:"chevron-down",kind:"neutral",slot:"trigger",label:n.label},group:{mode:"single"}};return this._renderDropdownComponent({buttonValue:t.value,dropdownProps:e,options:[{name:this.messages.differentValues,value:I.pg,disabled:!0},...t.codedValueDomainOptions]})}return this._renderSwitchComponent({input:t,props:n})}_renderSwitchComponent(e){let{input:t,props:n}=e;return(0,T.K)("calcite-switch",(0,i.A)((0,i.A)({},n),{},{checked:!!(0,m.ND)(t.template,"switch")&&t.value===t.template.input.onValue,class:f.inputSwitch,disabled:n.readOnly,onblur:()=>{this._focusedFieldInput=null},onCalciteSwitchChange:e=>{let{currentTarget:t}=e;return this._saveInput(t)}}))}_renderDropdownComponent(e){let{buttonValue:t,options:n,dropdownProps:a}=e;const{trigger:o,dropdown:l,group:r}=a;return(0,T.K)("calcite-dropdown",(0,i.A)((0,i.A)({},l),{},{onblur:()=>{this._focusedFieldInput=null},onfocus:this._onComponentFocus,onCalciteDropdownSelect:e=>{let{currentTarget:t}=e;return this._saveInput(t)}}),(0,T.K)("calcite-button",(0,i.A)({},o),t===I.pg?this.messages.differentValues:t),(0,T.K)("calcite-dropdown-group",{selectionMode:r.mode},n.map((e=>(0,T.K)("calcite-dropdown-item",{disabled:e.disabled,label:String(e.name),selected:t===e.value},e.name)))))}_renderComboBoxComponent(e){var t;let{input:n,options:a,props:o}=e;const l="INSERT"===this.viewModel.editType,r=this._touchedInputs.has(null===n||void 0===n||null===(t=n.template)||void 0===t?void 0:t.elementId),s=l&&n.showNoValueOptionEnabled&&!r?()=>{}:o.onblur,d=(0,i.A)((0,i.A)({},o),{},{onblur:s});return(0,T.K)("calcite-combobox",(0,i.A)((0,i.A)({},d),{},{selectionMode:"single",value:o.placeholder===this.messages.differentValues?I.pg:String(o.value),onCalciteComboboxChange:e=>{let{currentTarget:t}=e;t.value!==I.pg&&this._saveInput(t)}}),this.renderComboboxOptionsList({input:n,options:a,props:o}))}renderComboboxOptionsList(e){let{input:t,options:n,props:i}=e;const[a,o]=n.map((e=>e.map((e=>{let{name:t,value:n}=e;return(0,T.K)("calcite-combobox-item",{key:"#".concat(n),selected:i.value===n,textLabel:t,value:"".concat(n)})})))),l=[...a];o.length>0&&l.push((0,T.K)("calcite-combobox-item-group",{key:"unsupported",label:this.featureFormMessages.subtypes.unsupportedDomainGroupTitle},o));const r=i.placeholder===this.messages.differentValues,s=!r&&(0,x.Po)(i.value);return t.showNoValueOptionEnabled&&l.unshift((0,T.K)("calcite-combobox-item",{key:"empty-option",selected:s,textLabel:t.showNoValueLabel||this.messages.empty,value:""})),r&&l.unshift((0,T.K)("calcite-combobox-item",{key:I.pg,selected:!0,textLabel:this.messages.differentValues,value:I.pg})),l}_renderRadioButtonGroupComponent(e){let{input:t,options:n,props:i}=e;const a=n.map((e=>{let{name:n,value:a}=e;return this._renderRadioButtons({label:n,value:a,selected:a===t.value,props:i})}));if(t.showNoValueOptionEnabled){const e="",n=t.showNoValueLabel||this.messages.empty,o=(0,x.Po)(t.value);a.unshift(this._renderRadioButtons({label:n,value:e,selected:o,props:i}))}return(0,T.K)("calcite-radio-button-group",{afterCreate:this._afterRadioGroupCreateOrUpdate,afterUpdate:this._afterRadioGroupCreateOrUpdate,class:f.inputRadioGroup,disabled:i.readOnly,key:"".concat(i.key,"-radio-group"),layout:"vertical",name:i.name,required:i.required},a,i.placeholder===this.messages.differentValues?(0,T.K)("calcite-label",{class:f.placeholderRadio,key:i.label,layout:"inline"},(0,T.K)("calcite-radio-button",{checked:!0,class:f.inputRadio,disabled:!0,name:i.placeholder,value:i.placeholder}),i.placeholder):null)}_renderRadioButtons(e){let{value:t,selected:n,label:a,props:o}=e;return(0,T.K)("calcite-label",{class:f.inputRadioLabel,key:o.label,layout:"inline"},(0,T.K)("calcite-radio-button",(0,i.A)((0,i.A)({},o),{},{afterCreate:void 0,afterUpdate:void 0,checked:n,class:f.inputRadio,disabled:o.readOnly,name:o.label,onblur:()=>{this._focusedFieldInput=null},value:t,onCalciteRadioButtonChange:e=>{let{currentTarget:t}=e;t.checked&&this._saveInput(t)}})),a)}_renderStringComponent(e,t){const{template:n}=e;return n.field.editable?n.input&&"text-area"===n.input.type?(0,T.K)("calcite-text-area",(0,i.A)((0,i.A)({},t),{},{class:this.classes(f.individualElement),resize:"vertical",value:t.value?String(t.value):"",onCalciteTextAreaInput:e=>{let{currentTarget:t}=e;return this._saveInput(t)}})):(0,T.K)("calcite-input",(0,i.A)((0,i.A)({},t),{},{class:this.classes(f.individualElement),type:"text",value:t.value?String(t.value):"",onCalciteInputInput:e=>{let{currentTarget:t}=e;return this._saveInput(t)}})):this._renderReadOnlyComponent(e)}_renderNumberComponent(e,t){const n=(0,u.isIntegerField)(e.field);return(0,T.K)("calcite-input-number",(0,i.A)((0,i.A)({},t),{},{integer:n,type:"number",value:n&&""!==t.value?Math.round(parseFloat(String(t.value))).toString():String(t.value),onCalciteInputNumberInput:e=>{let{currentTarget:t}=e;return this._saveInput(t)}}))}_renderReadOnlyComponent(e,t){var n;const a=this.getCommonInputProps(e);return(0,T.K)("calcite-input",(0,i.A)((0,i.A)({},a),{},{class:this.classes(f.fieldInput,f.inputDisabled,f.individualElement),readOnly:!0,type:"text",value:String(null!==(n=null!==t&&void 0!==t?t:a.value)&&void 0!==n?n:"")}))}_renderDateComponents(e,t){const{type:n}=e.field;switch(n){case"date":return this._renderDateFieldComponents(e,t);case"date-only":return this._renderDateOnlyFieldComponent(e,t);case"time-only":return this._renderTimeOnlyFieldComponent(e,t);case"timestamp-offset":return this._renderTimestampOffsetFieldComponents(e,t);default:return this._renderReadOnlyComponent(e,(0,w.ZP)(e.field,t.value,(0,i.A)({timeZone:e.effectiveTimeZone},(0,w.ZT)(e.template.field))))}}_renderDateOnlyFieldComponent(e,t){const{class:n,key:i,readOnly:a}=t,{rawMax:o,rawMin:l}=e.range;return(0,T.K)("calcite-input-date-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentUpdate,class:n,"data-date-part":"date","data-element-id":t[V],key:"".concat(i,"-date-input"),max:(0,p.Kg)(o)?o:void 0,min:(0,p.Kg)(l)?l:void 0,onblur:()=>{this._focusedFieldInput=null},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:a,value:e.value===I.pg?"":e.value?String(e.value):"",onCalciteInputDatePickerChange:t=>this._saveValueFromDateComponent(e,t.currentTarget)})}_renderTimeOnlyFieldComponent(e,t){const{class:n,key:i,readOnly:a}=t;return(0,T.K)("calcite-input-time-picker",{afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentUpdate,class:n,"data-date-part":"time","data-element-id":t[V],key:"".concat(i,"-time-input"),onblur:()=>{this._focusedFieldInput=null},onfocus:this._onComponentFocus,overlayPositioning:"fixed",readOnly:a,value:e.value===I.pg?"":e.value?String(e.value):"",onCalciteInputTimePickerChange:t=>this._saveValueFromDateComponent(e,t.currentTarget)})}_renderTimestampOffsetFieldComponents(e,t){var n,a,o,l,r;const{class:s,key:d,readOnly:u}=t,{rawMax:p,rawMin:c}=e.range,m=(0,w.T8)(p),h=(0,w.T8)(c),v=(0,w.T8)(e.value===I.pg?"":e.value),b=e.includeTimeOffset,_={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentUpdate,overlayPositioning:"fixed",readOnly:u,[V]:t[V],onfocus:this._onComponentFocus};return(0,T.K)("div",{class:f.dateInputContainer,key:"".concat(d,"-date-time-container")},(0,T.K)("calcite-input-date-picker",(0,i.A)((0,i.A)({},_),{},{class:s,"data-date-part":"date",key:"".concat(d,"-date-input"),max:null!==(n=null===m||void 0===m?void 0:m.date)&&void 0!==n?n:void 0,min:null!==(a=null===h||void 0===h?void 0:h.date)&&void 0!==a?a:void 0,onblur:()=>{this._focusedFieldInput=null},value:null!==(o=v.date)&&void 0!==o?o:"",onCalciteInputDatePickerChange:t=>this._saveValueFromDateComponent(e,t.target)})),(0,T.K)("calcite-input-time-picker",(0,i.A)((0,i.A)({},_),{},{class:s,"data-date-part":"time",key:"".concat(d,"-time-input"),onblur:()=>{this._focusedFieldInput=null},value:null!==(l=v.time)&&void 0!==l?l:"",onCalciteInputTimePickerChange:t=>this._saveValueFromDateComponent(e,t.target)})),b?(0,T.K)("calcite-input-time-zone",(0,i.A)((0,i.A)({},_),{},{class:s,"data-date-part":"timeZone",key:"".concat(d,"-timezone-input"),onblur:()=>{this._focusedFieldInput=null},value:null!==(r=v.timeZoneOffset)&&void 0!==r?r:"0",onCalciteInputTimeZoneChange:t=>this._saveValueFromDateComponent(e,t.target)})):null)}_renderDateFieldComponents(e,t){var n,a,o,l;const{class:r,key:s,readOnly:d,min:u,max:p}=t,c=e.effectiveTimeZone,m=(0,w.Q0)(e.value===I.pg?"":e.value,c),h=(0,w.Q0)(p,c),v=(0,w.Q0)(u,c),b=e.includeTime,_={afterCreate:this._afterDateComponentCreate,afterUpdate:this._afterDateComponentUpdate,overlayPositioning:"fixed",readOnly:d,[V]:t[V],onfocus:this._onComponentFocus};return(0,T.K)("div",{class:f.dateInputContainer,key:"".concat(s,"-date-time-container")},(0,T.K)("calcite-input-date-picker",(0,i.A)((0,i.A)({},_),{},{class:r,"data-date-part":"date",key:"".concat(s,"-date-input"),max:null!==(n=null===h||void 0===h?void 0:h.date)&&void 0!==n?n:void 0,min:null!==(a=null===v||void 0===v?void 0:v.date)&&void 0!==a?a:void 0,onblur:()=>{this._focusedFieldInput=null},value:null!==(o=m.date)&&void 0!==o?o:"",onCalciteInputDatePickerChange:t=>this._saveValueFromDateComponent(e,t.target)})),b?(0,T.K)("calcite-input-time-picker",(0,i.A)((0,i.A)({},_),{},{"data-date-part":"time",key:"".concat(s,"-time-input"),onblur:()=>{this._focusedFieldInput=null},step:1,value:null!==(l=m.time)&&void 0!==l?l:"",onCalciteInputTimePickerChange:t=>{this._saveValueFromDateComponent(e,t.target)}})):null)}getCommonInputProps(e){var t;const{_effectiveDisabled:n}=this,{template:i,valid:a,value:o,minLength:l,maxLength:r,required:s,fieldName:d,editable:u,userHasChangedValue:p,range:{max:c,min:m}}=e,h=!u||n;let v=null!==(t=i.hint)&&void 0!==t?t:void 0,b=!1;return o===I.pg&&(v=this.messages.differentValues,b=!0),{afterCreate:this._afterComponentCreateOrUpdate,afterUpdate:this._afterComponentCreateOrUpdate,"aria-invalid":a?"false":"true",class:this.classes(f.fieldInput,h?f.inputDisabled:null),status:!p&&!this.viewModel.submitHasBeenAttempted||a?"idle":"invalid",maxLength:r&&r>-1?r:void 0,minLength:l&&l>-1?l:void 0,key:i.elementId,label:d,name:d,max:null!=c?c:void 0,min:null!=m?m:void 0,readOnly:h,onblur:this._onComponentBlur,required:s,placeholder:v,value:b?"":null!==o&&void 0!==o?o:"",[V]:i.elementId,onfocus:this._onComponentFocus}}_onFormSubmit(e){e.preventDefault()}_getFieldInputFromHTMLElement(e){return this.viewModel.findFieldInput(e.getAttribute(V))}_afterRadioGroupCreateOrUpdate(e){const t=e.selectedItem,n=e.querySelector("calcite-radio-button"),i=t||n;i&&this._afterComponentCreateOrUpdate(i)}_onComponentFocus(e){const t=e.target,n=this._getFieldInputFromHTMLElement(t);this._touchedInputs.add(n.template.elementId),this._focusedFieldInput=n}_afterComponentCreateOrUpdate(e){const t=this._getFieldInputFromHTMLElement(e),n=this._focusedFieldInput;this._attemptFocusOnNextRender&&n===t&&(this._attemptFocusOnNextRender=!1,(0,M.Z6)(e))}_onComponentBlur(){this._focusedFieldInput=null}_parseValue(e,t){if((0,m.ND)(t.template,"switch")){if("calcite-dropdown"===e.localName&&t.domain)for(const n of t.domain.codedValues)if(n.name===e.selectedItems[0].textContent)return n.code;return e.checked?t.template.input.onValue:t.template.input.offValue}const n=e.value;return null==n||""===n?null:"number"===t.dataType?"-0"===n||"-0."===n||"-0,"===n?n:parseFloat(n):"date"===t.field.type?parseFloat(n):n}_saveInput(e){const t=this._getFieldInputFromHTMLElement(e),{elementId:n}=t.template;if(!t)return;const i=null===t||void 0===t?void 0:t.value;if((0,m.ND)(t.template,"switch")&&"single"!==this.viewModel.mode){const e=(0,l.tE)(this._batchSwitchInputInitialValues,t,(()=>t.value));this._batchSwitchInputInitialValues.set(t,null===e?i:e)}const a=this._parseValue(e,t);a!==i&&this.viewModel.setValue(n,a)}async _afterDateComponentCreate(e){const t=this._getFieldInputFromHTMLElement(e);await e.componentOnReady(),this._setDateTimeTimeZoneMap(e),this._updateDateTimeOrTimeZoneShadowDom(e,t.value===I.pg),this._afterComponentCreateOrUpdate(e)}async _afterDateComponentUpdate(e){const{value:t}=this._getFieldInputFromHTMLElement(e);await e.componentOnReady(),this._updateDateTimeOrTimeZoneShadowDom(e,t===I.pg),this._afterComponentCreateOrUpdate(e)}_saveValueFromDateComponent(e,t){var n;const{elementId:i}=e.template,a=e.field.type,o=this._dateComponentMap.get("".concat(i));if(!o)return;const l=e.effectiveTimeZone;let r=e.value===I.pg?void 0:e.value,s=null;"date-only"===a?s=Array.isArray(t.value)?t.value[0]:t.value:"time-only"===a?(r=(0,w.iP)(r),s=(0,w.iP)(t.value)):s="timestamp-offset"===a?null!=t.value?(0,w.Ng)({dateComponent:o.date,timeComponent:o.time,oldValue:r,timeZoneComponent:o.timeZone,defaultTimeZone:l}):null:null!=t.value?(0,w.oh)({oldValue:r,dateComponent:o.date,timeZone:l,timeComponent:(null===(n=o.time)||void 0===n?void 0:n.value)===I.pg?void 0:o.time}):null,r!==s&&(null!==s&&t.value?this.viewModel.setValue("".concat(i),s):this.viewModel.setValue("".concat(i),null))}};(0,a._)([(0,s.MZ)()],Z.prototype,"activeFeatureIndex",null),(0,a._)([(0,s.MZ)()],Z.prototype,"disabled",null),(0,a._)([(0,s.MZ)()],Z.prototype,"_effectiveDisabled",null),(0,a._)([(0,s.MZ)()],Z.prototype,"features",null),(0,a._)([(0,s.MZ)()],Z.prototype,"map",null),(0,a._)([(0,s.MZ)()],Z.prototype,"spatialReference",null),(0,a._)([(0,s.MZ)()],Z.prototype,"timeZone",null),(0,a._)([(0,s.MZ)()],Z.prototype,"headingLevel",void 0),(0,a._)([(0,s.MZ)()],Z.prototype,"icon",null),(0,a._)([(0,s.MZ)(),(0,D.G)("esri/t9n/common")],Z.prototype,"messagesCommon",void 0),(0,a._)([(0,s.MZ)(),(0,D.G)("esri/widgets/BatchAttributeForm/t9n/BatchAttributeForm")],Z.prototype,"messages",void 0),(0,a._)([(0,s.MZ)(),(0,D.G)("esri/widgets/FeatureForm/t9n/FeatureForm")],Z.prototype,"featureFormMessages",void 0),(0,a._)([(0,s.MZ)()],Z.prototype,"readOnly",void 0),(0,a._)([(0,s.MZ)(),(0,k.U)(["value-change","submit"])],Z.prototype,"viewModel",void 0),(0,a._)([(0,s.MZ)({type:C,nonNullable:!0})],Z.prototype,"visibleElements",void 0),(0,a._)([(0,s.MZ)()],Z.prototype,"groupDisplay",void 0),Z=(0,a._)([(0,d.$)("esri.widgets.BatchAttributeForm")],Z);const E=Z}}]);
//# sourceMappingURL=86294.a8dc5532.chunk.js.map