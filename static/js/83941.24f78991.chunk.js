"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[83941,84841],{83941:(e,t,i)=>{i.r(t),i.d(t,{default:()=>O});var s=i(89379),l=i(35143),o=i(19276),n=i(5632),a=i(67993),r=i(68134),d=i(46053),c=(i(81806),i(76460),i(47249),i(85842)),h=i(25329),m=i(84841),p=i(91967);let u=class extends p.default{constructor(){super(...arguments),this.baseLayers=!0,this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.editTitleButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!0,this.referenceLayers=!0,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"baseLayers",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"catalogLayerList",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"closeButton",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"collapseButton",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"editTitleButton",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"errors",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"filter",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"flow",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"heading",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"referenceLayers",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"statusIndicators",void 0),(0,l._)([(0,d.MZ)({type:Boolean,nonNullable:!0})],u.prototype,"temporaryLayerIndicators",void 0),u=(0,l._)([(0,c.$)("esri.widgets.BasemapLayerList.BasemapLayerListVisibleElements")],u);const v=u,_="esri-basemap-layer-list",y="".concat(_,"__item"),b={base:_,actionMenu:"".concat(_,"__action-menu"),actionGroup:"".concat(_,"__action-group"),filterNoResults:"".concat(_,"__filter-no-results"),item:y,itemActive:"".concat(y,"--active"),itemContentBottom:"".concat(y,"-content-bottom"),itemMessage:"".concat(y,"-message"),itemActionIcon:"".concat(y,"-action-icon"),itemActionImage:"".concat(y,"-action-image"),itemTableIcon:"".concat(y,"-table-icon"),itemTemporaryIcon:"".concat(y,"-temporary-icon"),itemCatalogIcon:"".concat(y,"-catalog-icon"),statusIndicator:"".concat(_,"__status-indicator"),editingForm:"".concat(_,"__editing-form"),publishing:"".concat(_,"__publishing"),updating:"".concat(_,"__updating"),editing:"".concat(_,"__editing"),connectionStatus:"".concat(_,"__connection-status"),connectionStatusConnected:"".concat(_,"__connection-status--connected"),visibleToggle:"".concat(_,"__visible-toggle"),visibleIcon:"".concat(_,"__visible-icon"),section:"".concat(_,"__section")};var f=i(81558),g=i(30545),L=i(50912),I=i(94126),w=i(98108),M=i(87540),F=i(66355),E=i(76099),C=i(63582),T=i(12254),Z=i(54761);const B=o.default.ofType(g.default),A="nested",k="data-basemap-layer-type";let P=class extends(n.A.IdentifiableMixin(h.default)){constructor(e,t){super(e,t),this._baseListEl=null,this._referenceListEl=null,this._activeItem=null,this._tooltipReferenceMap=new Map,this._editTitleInput=null,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusLayerFlowItem=null,this._focusEditingFlowItem=!1,this._layerListMap=new a.A,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid="basemap-".concat(this.uid),this._openedLayersController=null,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.editingTitle=!1,this.filterPlaceholder="",this.baseFilterPredicate=null,this.baseFilterText="",this.referenceFilterPredicate=null,this.referenceFilterText="",this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.headingLevel=2,this.knowledgeGraphOptions=null,this.layerTablesEnabled=new o.default(["knowledge-graph"]),this.mapImageOptions=null,this.messages=null,this.messagesCommon=null,this.minFilterItems=L.dv,this.openedLayers=new o.default,this.openedLayerLists=new o.default,this.tableList=null,this.selectedItems=new B,this.selectionMode="none",this.tileOptions=null,this.viewModel=new m.default,this.visibilityAppearance="default",this.visibleElements=new v,this._canMove=(e,t)=>{var i,s,l,o,n;let{dragEl:a,fromEl:r,toEl:d}=e;const c="pull"===t?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,h=(0,L.Gq)(a);if(null===h||void 0===h||!h.sortable)return!1;const m=(0,L.Gq)(r),p=(0,L.MN)(r),u=(0,L.Gq)(d),v=(0,L.MN)(d),_=!!p&&!!v&&p===v,y={selected:h,from:m,to:u},b=r.group,f=d.group,g=null!==(i=null===m||void 0===m||null===(s=m.layer)||void 0===s?void 0:s.type)&&void 0!==i?i:"",I=null!==(l=null===u||void 0===u||null===(o=u.layer)||void 0===o?void 0:o.type)&&void 0!==l?l:"",w=new Set(["map-image","catalog","knowledge-graph"]);return b&&f&&"function"==typeof c?c.call(null,y):_&&!w.has(g)&&!w.has(I)&&"sublayer"!==(null===h||void 0===h||null===(n=h.layer)||void 0===n?void 0:n.type)},this._onSelectedDragItemLayerUidChange=e=>{this._selectedDragItemLayerUid=e},this._onTriggerAction=(e,t)=>{this.triggerAction(e,t)},this._onTooltipReferenceChange=(e,t)=>{t?this._tooltipReferenceMap.set(e,t):this._tooltipReferenceMap.delete(e)},this._onTablesOpen=e=>{var t;this.openedLayers.push(e.layer),this._focusLayerFlowItem=null===(t=e.layer)||void 0===t?void 0:t.uid},this._onPanelOpen=()=>{this._focusPanelFlowItem=!0},this._onCatalogOpen=e=>{var t,i;this.openedLayers.push(null===(t=e.layer)||void 0===t?void 0:t.parent),this._focusLayerFlowItem=null===(i=e.layer)||void 0===i?void 0:i.uid},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=e=>{if("default"!==this.visibilityAppearance)return;const t=Array.from(e.composedPath()).find((e=>{var t;return null===(t=e.classList)||void 0===t?void 0:t.contains(b.item)}));this._activeItem=(0,L.Gq)(t)},this._onCalciteListOrderChange=e=>{const{_lastDragDetail:t}=this,{toEl:i,fromEl:s,dragEl:l,newIndex:o}=e;if(!s||!i||(null===t||void 0===t?void 0:t.newIndex)===o&&(null===t||void 0===t?void 0:t.dragEl)===l&&(null===t||void 0===t?void 0:t.toEl)===i&&(null===t||void 0===t?void 0:t.fromEl)===s)return;this._lastDragDetail=e,this._selectedDragItemLayerUid=l.value;const n=s,a=i;if(n!==a)this._moveLayerFromChildList({toEl:a,fromEl:n,dragEl:l,newIndex:o});else{const e=Array.from(s.children).filter((e=>null===e||void 0===e?void 0:e.matches("calcite-list-item"))).map((e=>e.value));this._sortLayers(n,e)}}}initialize(){this.addHandles([(0,r.on)((()=>this.openedLayers),"change",(()=>this._handleOpenedLayersChange()),r.initial),(0,r.watch)((()=>[this.viewModel.referenceItems.toArray(),this.viewModel.baseItems.toArray()]),(()=>(0,L.eY)(this.selectedItems)),r.syncAndInitial),(0,r.watch)((()=>[this.baseFilterPredicate,this._baseListEl]),(()=>(0,L._L)(this._baseListEl,this.baseFilterPredicate))),(0,r.watch)((()=>[this.referenceFilterPredicate,this._referenceListEl]),(()=>(0,L._L)(this._referenceListEl,this.referenceFilterPredicate)))])}loadDependencies(){return(0,I.W)({action:()=>Promise.resolve().then(i.bind(i,85375)),block:()=>i.e(75502).then(i.bind(i,75502)),label:()=>Promise.resolve().then(i.bind(i,11839)),input:()=>Promise.all([i.e(46870),i.e(38841)]).then(i.bind(i,38841)),button:()=>Promise.resolve().then(i.bind(i,43285)),flow:()=>i.e(87473).then(i.bind(i,87473)),"flow-item":()=>i.e(68445).then(i.bind(i,68445)),list:()=>Promise.all([i.e(46870),i.e(38841),i.e(65641),i.e(75802)]).then(i.bind(i,75802)),notice:()=>i.e(12261).then(i.bind(i,12261)),tooltip:()=>i.e(31748).then(i.bind(i,31748))})}destroy(){this._tooltipReferenceMap.clear(),this._destroyOpenedLayerLists()}get _visibleBaseItems(){var e;return null===(e=this.baseItems)||void 0===e?void 0:e.filter((e=>!e.hidden&&(this.visibleElements.errors||!e.error)))}get _visibleReferenceItems(){var e;return null===(e=this.referenceItems)||void 0===e?void 0:e.filter((e=>!e.hidden&&(this.visibleElements.errors||!e.error)))}get _openedPanelItems(){return this._visibleReferenceItems.concat(this._visibleBaseItems).flatten((e=>e.children)).filter((e=>{let{hidden:t,panel:i}=e;return!t&&(null===i||void 0===i?void 0:i.open)&&!i.disabled&&i.flowEnabled}))}get _totalBaseItems(){return this.viewModel.baseItems.flatten((e=>e.children.filter((e=>{var t;return"catalog-dynamic-group"!==(null===(t=e.layer)||void 0===t?void 0:t.type)})))).length}get _totalReferenceItems(){return this.viewModel.referenceItems.flatten((e=>e.children.filter((e=>{var t;return"catalog-dynamic-group"!==(null===(t=e.layer)||void 0===t?void 0:t.type)})))).length}get _baseFilterEnabled(){return this._totalBaseItems>=this.minFilterItems&&this.visibleElements.filter}get _referenceFilterEnabled(){return this._totalReferenceItems>=this.minFilterItems&&this.visibleElements.filter}get _renderedOpenLayerFlowItems(){const{openedLayers:e}=this;return e.toArray().map(((t,i)=>this._renderLayerFlowItem(t,i===e.length-1)))}get basemapTitle(){return this.viewModel.basemapTitle}set basemapTitle(e){this.viewModel.basemapTitle=e}get baseListItemCreatedFunction(){return this.viewModel.baseListItemCreatedFunction}set baseListItemCreatedFunction(e){this.viewModel.baseListItemCreatedFunction=e}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get referenceListItemCreatedFunction(){return this.viewModel.referenceListItemCreatedFunction}set referenceListItemCreatedFunction(e){this.viewModel.referenceListItemCreatedFunction=e}get baseItems(){return this.viewModel.baseItems}get referenceItems(){return this.viewModel.referenceItems}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){const{state:e}=this.viewModel,t={[w.D.hidden]:"loading"===e,[w.D.disabled]:"disabled"===e};return(0,Z.K)("div",{class:this.classes(b.base,w.D.widget,w.D.panel,t)},this._renderItems())}async _createCatalogLayerList(e){const{default:t}=await i.e(70018).then(i.bind(i,70018)),{headingLevel:l,catalogOptions:o,view:n,filterPlaceholder:a,minFilterItems:r,selectionMode:d,visibilityAppearance:c,_onCatalogOpen:h,_onTablesOpen:m,layerTablesEnabled:p}=this;return new t((0,s.A)((0,s.A)({headingLevel:l,view:n,filterPlaceholder:a,minFilterItems:r,selectionMode:d,visibilityAppearance:c},o),{},{catalogLayer:e,layerTablesEnabled:p,onCatalogOpen:h,onTablesOpen:m}))}_getTableListParams(e){switch(e.type){case"knowledge-graph":return(0,s.A)((0,s.A)({},this.knowledgeGraphOptions),{},{tables:e.tables});case"map-image":return(0,s.A)((0,s.A)({},this.mapImageOptions),{},{tables:e.subtables});case"tile":return(0,s.A)((0,s.A)({},this.tileOptions),{},{tables:e.subtables});default:return null}}async _createTableList(e){const{default:t}=await i.e(21922).then(i.bind(i,21922)),{headingLevel:l,selectionMode:o,dragEnabled:n}=this;return new t((0,s.A)({headingLevel:l,selectionMode:o,dragEnabled:n},this._getTableListParams(e)))}async _createFlowList(e,t){const{_layerListMap:i}=this,s=i.get(e);if(s)return s;const l="catalog"===e.type?await this._createCatalogLayerList(e):await this._createTableList(e);return t.aborted||i.set(e,l),l}async _handleOpenedLayersChange(){var e;const{_layerListMap:t,openedLayers:i,openedLayerLists:s}=this;null===(e=this._openedLayersController)||void 0===e||e.abort();const l=new AbortController,{signal:o}=l;this._openedLayersController=l,t.forEach(((e,s)=>{i.includes(s)||(e.destroy(),t.delete(s))}));const n=await Promise.all(i.map((e=>this._createFlowList(e,o))));if(o.aborted)return;s.removeAll(),s.addMany(n);const a=s.at(-1);a?"catalogLayer"in a?(this._set("catalogLayerList",a),this._set("tableList",null)):(this._set("catalogLayerList",null),this._set("tableList",a)):(this._set("catalogLayerList",null),this._set("tableList",null))}_destroyOpenedLayerLists(){this.openedLayerLists.destroyAll(),this.openedLayers.removeAll(),this._layerListMap.clear()}_renderItemTooltip(e){var t,i;return e?(0,Z.K)("calcite-tooltip",{key:"tooltip-".concat(null===(t=e.layer)||void 0===t?void 0:t.uid),overlayPositioning:"fixed",referenceElement:this._tooltipReferenceMap.get(null===(i=e.layer)||void 0===i?void 0:i.uid)},this.messages.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){var t;return e.incompatible?this._renderItemTooltip(e):null===(t=e.children)||void 0===t?void 0:t.filter((e=>!e.hidden)).toArray().map((e=>this._renderItemTooltipNodes(e)))}_renderItemTooltips(){var e;return null===(e=this._visibleReferenceItems.concat(this._visibleBaseItems))||void 0===e?void 0:e.toArray().map((e=>this._renderItemTooltipNodes(e)))}_focusLayerFlowItemNode(e){this._focusLayerFlowItem===e.dataset.layerUid&&(this._focusLayerFlowItem=null,(0,E.Z6)(e))}_renderPanelFlowItems(){const{_openedPanelItems:e,openedLayers:t}=this;return e.toArray().map(((i,s)=>{let{title:l,panel:o}=i;const n=()=>this._handlePanelFlowItemBack(o);return(0,Z.K)("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:l,heading:o.title,headingLevel:this.headingLevel,key:"flow-panel-".concat(o.uid),selected:!t.length&&s===e.length-1,onCalciteFlowItemBack:e=>{e.preventDefault(),n()}},o.render(),(0,Z.K)("calcite-button",{appearance:"transparent",onclick:n,slot:"footer-actions",width:"full"},this.messagesCommon.back))}))}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusEditingFlowItemNode(e){this._focusEditingFlowItem&&(this._focusEditingFlowItem=!1,(0,E.Z6)(e))}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,(0,E.Z6)(e))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,(0,E.Z6)(e))}_renderItem(e,t,i,s){var l;return(0,Z.K)(f.A,{activeItem:this._activeItem,canMove:this._canMove,css:b,displayMode:A,dragEnabled:!t&&this.dragEnabled,item:e,key:"layerListItem-".concat(null===(l=e.layer)||void 0===l?void 0:l.uid),layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.viewModel.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:i,parentTitles:s,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onCatalogOpen:this._onCatalogOpen,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange,onTablesOpen:this._onTablesOpen,onTooltipReferenceChange:this._onTooltipReferenceChange})}_moveLayerFromChildList(e){let{toEl:t,fromEl:i,dragEl:s,newIndex:l}=e;const o=(0,L.Gq)(s),n=(0,L.Gq)(t),a=(0,L.Gq)(i),r=R(i),d=R(t);r&&d&&this.viewModel.moveListItem({targetItem:o,fromParentItem:a,toParentItem:n,newIndex:l,from:r,to:d})}_handleCalciteListDragEnd(e){const{fromEl:t,dragEl:i,oldIndex:s}=e;t.insertBefore(i,t.children[s])}_sortLayers(e,t){if(e)if(e===this._referenceListEl||e===this._baseListEl){var i,s;const l=e===this._referenceListEl?"reference":"base",o="base"===l?null===(i=this.view)||void 0===i||null===(i=i.map)||void 0===i||null===(i=i.basemap)||void 0===i?void 0:i.baseLayers:"reference"===l?null===(s=this.view)||void 0===s||null===(s=s.map)||void 0===s||null===(s=s.basemap)||void 0===s?void 0:s.referenceLayers:null;(0,L.mk)(o,t)}else{const i=(0,L.Gq)(e);if(!i)return;(0,L.kL)(i,t)}}_handleCalciteListChange(e){const{selectionMode:t,selectedItems:i}=this;if("none"===t)return;const s=e.target.selectedItems.map((e=>(0,L.Gq)(e))).filter(Boolean);i.removeAll(),i.addMany(s)}_renderEditingInput(){const{messages:e}=this,{basemapTitle:t}=this.viewModel;return(0,Z.K)("div",{class:b.editing},(0,Z.K)("calcite-label",null,e.basemapTitle,(0,Z.K)("calcite-input",{afterCreate:e=>this._editTitleInput=e,label:e.basemapTitle,name:"basemaptitle",pattern:".*\\S+.*",placeholder:e.basemapTitle,required:!0,title:e.basemapTitle,type:"text",value:null!==t&&void 0!==t?t:void 0})))}_renderCancelButton(){const{messagesCommon:{cancel:e}}=this;return(0,Z.K)("calcite-button",{appearance:"outline",bind:this,label:e,onclick:this._toggleEditingTitle,slot:"footer",title:e,width:"full"},e)}_renderSubmitButton(){const{messagesCommon:e}=this;return(0,Z.K)("calcite-button",{label:e.form.submit,slot:"footer",title:e.form.submit,type:"submit",width:"full"},e.form.ok)}_renderEditingForm(){return this.editingTitle?(0,Z.K)("form",{bind:this,class:b.editingForm,onsubmit:this._formSubmit},(0,Z.K)("calcite-flow-item",{afterCreate:this._focusEditingFlowItemNode,afterUpdate:this._focusEditingFlowItemNode,bind:this,heading:this.visibleElements.heading?this.messages.basemapTitle:void 0,headingLevel:this.headingLevel,selected:0===this.openedLayers.length&&0===this._openedPanelItems.length,onCalciteFlowItemBack:e=>{e.preventDefault(),this._toggleEditingTitle()}},this._renderEditingInput(),this._renderCancelButton(),this._renderSubmitButton())):null}_renderEditTitleButton(){const{editingTitle:e,visibleElements:t,messagesCommon:i}=this,s=i.edit;return t.editTitleButton&&!e?(0,Z.K)("calcite-action",{bind:this,icon:"pencil",onclick:this._toggleEditingTitle,slot:"header-actions-end",text:s,title:s}):null}_renderNoLayersInfoMessage(e){return(0,Z.K)("div",{slot:"message"},e)}_renderNoLayersInfo(e,t){return(0,Z.K)("div",{class:b.itemMessage},(0,Z.K)("calcite-notice",{icon:"information",key:t,kind:"info",open:!0,width:"full"},this._renderNoLayersInfoMessage(e)))}_renderItems(){var e;const{collapsed:t,visible:i,visibleElements:{closeButton:s,collapseButton:l,heading:o,flow:n},messages:a,viewModel:r}=this,d=[(0,Z.K)("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:s,closed:!i,collapsed:t,collapsible:l,heading:o?null!==(e=r.basemapTitle)&&void 0!==e?e:a.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",selected:!this.editingTitle&&0===this.openedLayers.length&&0===this._openedPanelItems.length,onCalciteFlowItemClose:()=>this.visible=!1},this._renderEditTitleButton(),this._renderReferenceSection(),this._renderBaseSection()),this._renderEditingForm(),this._renderPanelFlowItems(),this._renderedOpenLayerFlowItems];return i?[n?(0,Z.K)("calcite-flow",{key:"root-flow"},d):d,this._renderItemTooltips()]:null}_renderLayerFlowItem(e,t){var i;const{messages:s,openedLayers:l}=this,o=e.title||this.messages.untitledLayer;return(0,Z.K)("calcite-flow-item",{afterCreate:this._focusLayerFlowItemNode,afterUpdate:this._focusLayerFlowItemNode,bind:this,"data-layer-uid":e.uid,description:o,heading:s["catalog"===e.type?"catalogLayers":"tables"],headingLevel:this.headingLevel,key:"flow-layer-list-".concat(e.uid),selected:t,onCalciteFlowItemBack:e=>{e.preventDefault(),l.pop();const t=l.at(-1);t?this._focusLayerFlowItem=t.uid:this._focusRootFlowItem=!0}},null===(i=this._layerListMap.get(e))||void 0===i?void 0:i.render())}_renderList(e,t,i){const{messages:s,dragEnabled:l,selectionMode:o,filterPlaceholder:n,baseFilterText:a,referenceFilterText:r,_baseFilterEnabled:d,_referenceFilterEnabled:c,_rootGroupUid:h}=this,m="reference"===t?s.noReferenceLayers:s.noBaseLayers,p="reference"===t?c:d;return(0,Z.K)("calcite-block",{class:b.section,collapsible:!0,heading:"reference"===t?s.referenceHeading:s.baseHeading,headingLevel:(0,M.S)(this.headingLevel),key:"block-".concat(t),open:!0},0===(null===e||void 0===e?void 0:e.length)?this._renderNoLayersInfo(m,t):null,(0,Z.K)("calcite-list",{afterCreate:e=>{"reference"===t?this._referenceListEl=e:this._baseListEl=e,e.addEventListener("focusin",this._setActiveItem),e.addEventListener("focusout",this._clearActiveItem)},afterRemoved:e=>{"reference"===t?this._referenceListEl=null:this._baseListEl=null,e.removeEventListener("focusin",this._setActiveItem),e.removeEventListener("focusout",this._clearActiveItem)},canPull:e=>this._canMove(e,"pull"),canPut:e=>this._canMove(e,"put"),displayMode:A,filterProps:F.o,[k]:t,"data-layer-type":h,dragEnabled:l,filterEnabled:p,filterPlaceholder:n,filterText:p?"reference"===t?r:a:"",group:h,key:"list-".concat(t),label:s.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:o,onCalciteListChange:e=>this._handleCalciteListChange(e),onCalciteListDragEnd:e=>this._handleCalciteListDragEnd(e.detail),onCalciteListFilter:e=>{var i,s;return this["reference"===t?"referenceFilterText":"baseFilterText"]=null!==(i=null===(s=e.currentTarget)||void 0===s?void 0:s.filterText)&&void 0!==i?i:""},onCalciteListOrderChange:e=>this._onCalciteListOrderChange(e.detail)},null===e||void 0===e?void 0:e.toArray().map((e=>this._renderItem(e,i))),null!==e&&void 0!==e&&e.length&&p?(0,Z.K)("div",{class:b.filterNoResults,slot:"filter-no-results"},(0,Z.K)("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoLayersInfoMessage(m))):null))}_renderBaseSection(){const{_visibleBaseItems:e}=this;return this.visibleElements.baseLayers?this._renderList(e,"base",1===(null===e||void 0===e?void 0:e.length)):null}_renderReferenceSection(){return this.visibleElements.referenceLayers?this._renderList(this._visibleReferenceItems,"reference",!1):null}_toggleEditingTitle(){const{editingTitle:e}=this,t=!e;this.editingTitle=t,t?this._focusEditingFlowItem=!0:this._focusRootFlowItem=!0}_formSubmit(e){var t;e.preventDefault();const i=null===(t=this._editTitleInput)||void 0===t?void 0:t.value;null!==i&&void 0!==i&&i.trim()&&(this.basemapTitle=i),this._toggleEditingTitle()}};function R(e){var t;return null===e||void 0===e||null===(t=e.closest("[".concat(k,"]")))||void 0===t?void 0:t.getAttribute(k)}(0,l._)([(0,d.MZ)()],P.prototype,"_baseListEl",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"_referenceListEl",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"_activeItem",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"_tooltipReferenceMap",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"_focusRootFlowItem",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"_focusPanelFlowItem",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"_focusLayerFlowItem",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"_focusEditingFlowItem",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"_layerListMap",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"_visibleBaseItems",null),(0,l._)([(0,d.MZ)()],P.prototype,"_visibleReferenceItems",null),(0,l._)([(0,d.MZ)()],P.prototype,"_openedPanelItems",null),(0,l._)([(0,d.MZ)()],P.prototype,"_totalBaseItems",null),(0,l._)([(0,d.MZ)()],P.prototype,"_totalReferenceItems",null),(0,l._)([(0,d.MZ)()],P.prototype,"_baseFilterEnabled",null),(0,l._)([(0,d.MZ)()],P.prototype,"_referenceFilterEnabled",null),(0,l._)([(0,d.MZ)()],P.prototype,"_renderedOpenLayerFlowItems",null),(0,l._)([(0,d.MZ)()],P.prototype,"basemapTitle",null),(0,l._)([(0,d.MZ)({readOnly:!0})],P.prototype,"catalogLayerList",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"catalogOptions",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"collapsed",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"dragEnabled",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"editingTitle",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"filterPlaceholder",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"baseFilterPredicate",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"baseFilterText",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"referenceFilterPredicate",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"referenceFilterText",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"listItemCanGiveFunction",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"listItemCanReceiveFunction",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"baseListItemCreatedFunction",null),(0,l._)([(0,d.MZ)()],P.prototype,"headingLevel",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"icon",null),(0,l._)([(0,d.MZ)()],P.prototype,"knowledgeGraphOptions",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"label",null),(0,l._)([(0,d.MZ)()],P.prototype,"layerTablesEnabled",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"mapImageOptions",void 0),(0,l._)([(0,d.MZ)(),(0,C.G)("esri/widgets/BasemapLayerList/t9n/BasemapLayerList")],P.prototype,"messages",void 0),(0,l._)([(0,d.MZ)(),(0,C.G)("esri/t9n/common")],P.prototype,"messagesCommon",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"minFilterItems",void 0),(0,l._)([(0,d.MZ)({readOnly:!0})],P.prototype,"openedLayers",void 0),(0,l._)([(0,d.MZ)({readOnly:!0})],P.prototype,"openedLayerLists",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"referenceListItemCreatedFunction",null),(0,l._)([(0,d.MZ)({readOnly:!0})],P.prototype,"tableList",void 0),(0,l._)([(0,d.MZ)({readOnly:!0})],P.prototype,"baseItems",null),(0,l._)([(0,d.MZ)({readOnly:!0})],P.prototype,"referenceItems",null),(0,l._)([(0,d.MZ)({type:B})],P.prototype,"selectedItems",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"selectionMode",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"tileOptions",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"view",null),(0,l._)([(0,T.U)("trigger-action"),(0,d.MZ)({type:m.default})],P.prototype,"viewModel",void 0),(0,l._)([(0,d.MZ)()],P.prototype,"visibilityAppearance",void 0),(0,l._)([(0,d.MZ)({type:v,nonNullable:!0})],P.prototype,"visibleElements",void 0),P=(0,l._)([(0,c.$)("esri.widgets.BasemapLayerList")],P);const O=P},84841:(e,t,i)=>{i.r(t),i.d(t,{default:()=>I});var s=i(35143),l=i(19276),o=i(54099),n=i(68134),a=i(46053),r=(i(81806),i(76460),i(47249),i(85842)),d=i(30545),c=i(50912);const h="view",m="basemap",p="base-layers",u="reference-layers",v="reference-layers-list-mode",_="base-layers-list-mode",y="base-layer-views",b="reference-layer-views",f="children",g=l.default.ofType(d.default);let L=class extends o.A.EventedAccessor{constructor(e){super(e),this.baseItems=new g,this.baseListItemCreatedFunction=null,this.checkPublishStatusEnabled=!1,this.listModeDisabled=!1,this.referenceListItemCreatedFunction=null,this.referenceItems=new g,this.view=null,this._compileBaseList=this._compileBaseList.bind(this),this._compileReferenceList=this._compileReferenceList.bind(this)}initialize(){this.addHandles([(0,n.watch)((()=>{var e,t,i;return[null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e?void 0:e.basemap,!0===(null===(t=this.view)||void 0===t?void 0:t.ready),null===(i=this.view)||void 0===i?void 0:i.basemapView]}),(()=>this._watchBasemapLayers()),n.initial),(0,n.watch)((()=>[this.baseListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._baseListItemCreatedFunctionChanged())),(0,n.watch)((()=>[this.referenceListItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled]),(()=>this._referenceListItemCreatedFunctionChanged()))],h)}destroy(){this.view=null,this._removeAllBaseItems(),this._removeAllReferenceItems()}get basemapTitle(){var e,t;return null!==(e=null===(t=this.view)||void 0===t||null===(t=t.map)||void 0===t||null===(t=t.basemap)||void 0===t?void 0:t.title)&&void 0!==e?e:null}set basemapTitle(e){this._override("basemapTitle",e)}get state(){var e;return null!==(e=this.view)&&void 0!==e&&e.ready?"ready":this.view?"loading":"disabled"}get totalBaseItems(){return this.baseItems.flatten((e=>e.children)).length}get totalReferenceItems(){return this.referenceItems.flatten((e=>e.children)).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e){var t;let{targetItem:i,fromParentItem:s,toParentItem:l,from:o,to:n,newIndex:a}=e;const r=null===i||void 0===i?void 0:i.layer;if(!r||"subtype-sublayer"===r.type||"sublayer"===r.type)return;const d=null===(t=this.view)||void 0===t||null===(t=t.map)||void 0===t?void 0:t.basemap,h=null===d||void 0===d?void 0:d.baseLayers,m=null===d||void 0===d?void 0:d.referenceLayers,p=s?(0,c.ES)(s):"base"===o?h:m,u=l?(0,c.ES)(l):"base"===n?h:m;if(!p||!u)return;const{baseItems:v,referenceItems:_}=this,y="base"===o?v:_,b="base"===n?v:_,f=(null===s||void 0===s?void 0:s.children)||y,g=(null===l||void 0===l?void 0:l.children)||b,L=u.length-a;i.parent=l||null,f.remove(i),p.remove(r),g.includes(i)||g.add(i,L),u.includes(r)||u.add(r,L),this._compileLists()}_createItemChangeHandles(e){let{items:t,key:i,callback:s}=e;this.removeHandles(i),s(),t&&this.addHandles(t.on("change",(()=>s())),i)}_createListItem(e){let{layer:t,type:i}=e;const{view:s,baseListItemCreatedFunction:l,referenceListItemCreatedFunction:o,checkPublishStatusEnabled:n,listModeDisabled:a}=this;return new d.default({layer:t,checkPublishStatusEnabled:n,listItemCreatedFunction:"base"===i?l:o,listModeDisabled:a,view:s})}_watchLayersListMode(e){let{layers:t,key:i,callback:s}=e;this.removeHandles(i),t&&!this.listModeDisabled&&this.addHandles((0,n.watch)((()=>t.filter((e=>"listMode"in e)).map((e=>e.listMode)).toArray()),(()=>s())),i)}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter((e=>"hide"!==(0,c.Qv)(e))):void 0}_compileListItems(e){let{layers:t,items:i,key:s,type:l,callback:o}=e;this._watchLayersListMode({layers:t,key:s,callback:o});const n=this._getViewableLayers(t);null!==n&&void 0!==n&&n.length?(this._createNewItems({type:l,items:i,layers:n}),this._removeItems({items:i,layers:n}),this._sortItems(i,n)):"base"===l?this._removeAllBaseItems():this._removeAllReferenceItems()}_compileReferenceList(){var e;const{referenceItems:t}=this,i=null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.referenceLayers;this._compileListItems({type:"reference",layers:i,items:t,key:_,callback:this._compileReferenceList})}_compileBaseList(){var e;const{baseItems:t}=this,i=null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.baseLayers;this._compileListItems({type:"base",layers:i,items:t,key:v,callback:this._compileBaseList})}_compileLists(){this._compileReferenceList(),this._compileBaseList()}_createNewItems(e){let{items:t,layers:i,type:s}=e;null===i||void 0===i||i.forEach((e=>{t.some((t=>t.layer===e))||t.add(this._createListItem({type:s,layer:e}))}))}_removeItems(e){let{items:t,layers:i}=e;t&&t.forEach((e=>{if(!e)return;const s=null===i||void 0===i?void 0:i.some((t=>e.layer===t));s||(this.removeHandles("".concat(f,"-").concat(e.uid)),t.remove(e),e.destroy())}))}_sortItems(e,t){e&&t&&e.sort(((e,i)=>{const s=t.indexOf(e.layer),l=t.indexOf(i.layer);return s>l?-1:s<l?1:0}))}_removeAllBaseItems(){this.baseItems.drain((e=>{this.removeHandles("".concat(f,"-").concat(e.uid)),e.destroy()}))}_removeAllReferenceItems(){this.referenceItems.drain((e=>{this.removeHandles("".concat(f,"-").concat(e.uid)),e.destroy()}))}_baseListItemCreatedFunctionChanged(){this._removeAllBaseItems(),this._compileLists()}_referenceListItemCreatedFunctionChanged(){this._removeAllReferenceItems(),this._compileLists()}_watchBasemapLayers(){const{view:e}=this;if(this.removeHandles([p,u,m,y,b]),null===e||void 0===e||!e.ready)return this._removeAllBaseItems(),void this._removeAllReferenceItems();this._compileLists(),this.addHandles([(0,n.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.baseLayers}),(e=>this._createItemChangeHandles({items:e,key:p,callback:this._compileBaseList})),n.initial),(0,n.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e||null===(e=e.basemap)||void 0===e?void 0:e.referenceLayers}),(e=>this._createItemChangeHandles({items:e,key:u,callback:this._compileReferenceList})),n.initial),(0,n.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.basemapView)||void 0===e?void 0:e.baseLayerViews}),(e=>this._createItemChangeHandles({items:e,key:y,callback:this._compileBaseList})),n.initial),(0,n.watch)((()=>{var e;return null===(e=this.view)||void 0===e||null===(e=e.basemapView)||void 0===e?void 0:e.referenceLayerViews}),(e=>this._createItemChangeHandles({items:e,key:b,callback:this._compileReferenceList})),n.initial)],m)}};(0,s._)([(0,a.MZ)({type:g,readOnly:!0})],L.prototype,"baseItems",void 0),(0,s._)([(0,a.MZ)()],L.prototype,"basemapTitle",null),(0,s._)([(0,a.MZ)()],L.prototype,"baseListItemCreatedFunction",void 0),(0,s._)([(0,a.MZ)()],L.prototype,"checkPublishStatusEnabled",void 0),(0,s._)([(0,a.MZ)({nonNullable:!0})],L.prototype,"listModeDisabled",void 0),(0,s._)([(0,a.MZ)()],L.prototype,"referenceListItemCreatedFunction",void 0),(0,s._)([(0,a.MZ)({type:g,readOnly:!0})],L.prototype,"referenceItems",void 0),(0,s._)([(0,a.MZ)({readOnly:!0})],L.prototype,"state",null),(0,s._)([(0,a.MZ)()],L.prototype,"totalBaseItems",null),(0,s._)([(0,a.MZ)()],L.prototype,"totalReferenceItems",null),(0,s._)([(0,a.MZ)()],L.prototype,"view",void 0),L=(0,s._)([(0,r.$)("esri.widgets.BasemapLayerList.BasemapLayerListViewModel")],L);const I=L}}]);
//# sourceMappingURL=83941.24f78991.chunk.js.map