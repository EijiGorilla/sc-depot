{"version":3,"file":"static/js/451.fedd1e6c.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/widgets/UtilityNetworkValidateTopology/UtilityNetworkValidateTopologyViewModel.js","../node_modules/@arcgis/core/portal/support/utils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import\"../../intl.js\";import i from\"../../core/Accessor.js\";import e from\"../../core/Collection.js\";import r from\"../../core/Error.js\";import s from\"../../core/Logger.js\";import{watch as o,initial as a,on as n}from\"../../core/reactiveUtils.js\";import{property as l}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/RandomLCG.js\";import{subclass as d}from\"../../core/accessorSupport/decorators/subclass.js\";import{UpdatingHandles as c}from\"../../core/support/UpdatingHandles.js\";import{isFeatureLayer as h,getOwningPortalUrl as p}from\"../../layers/support/layerUtils.js\";import y from\"../../portal/Portal.js\";import{hasUserTypeExtension as u}from\"../../portal/support/utils.js\";import{onLocaleChange as w}from\"../../intl/locale.js\";import{fetchMessageBundle as g}from\"../../intl/messages.js\";const v={noDirtyAreasInExtent:-2147208940,noUtilityNetworkExtension:-2147208474,cannotAcquireVersionLock_v10:-2147217146,cannotAcquireVersionLock_v11:-2147220947};let m=class extends i{constructor(t){super(t),this._activeOperationDidSucceed=!1,this._initialValidationsFinished=!1,this._dirtyAreasLayer=null,this._serverVersion=null,this._updatingHandles=new c,this._validConstructProperties=!1,this.executionError=\"\",this.extentToValidate=\"current\",this.loadErrors=new e}initialize(){const t=async()=>{this.messages||(this.messages=await g(\"esri/widgets/UtilityNetworkValidateTopology/t9n/UtilityNetworkValidateTopology\"))};t().then((()=>{this.view||(this.view=null),this.utilityNetwork||(this.utilityNetwork=null),this.addHandles([o((()=>[this.view,this.utilityNetwork]),(async()=>{const{loadErrors:t,messages:{info:{noUtilityNetwork:i,noView:e}}}=this;this._initialValidationsFinished=!1,t.removeAll(),this._validConstructProperties=!0,this._dirtyAreasLayer=null,this._serverVersion=null,\"utility\"!==this.utilityNetwork?.type&&(this.loadErrors.push(i),s.getLogger(this).error(new r(\"utilityNetworkValidateTopology:missing-property\",i)),this._validConstructProperties=!1),\"2d\"!==this.view?.type&&(this.loadErrors.push(e),s.getLogger(this).error(new r(\"utilityNetworkValidateTopology:missing-property\",e)),this._validConstructProperties=!1),this._validConstructProperties&&(this.utilityNetwork.loaded||await this.utilityNetwork.load().catch((t=>{s.getLogger(this).error(t),this._validConstructProperties=!1})),await this._setDirtyAreasLayer()),this._validConstructProperties&&await this._validateNetworkExtension()}),a),n((()=>this.view?.map?.layers),\"change\",(async()=>{const{loadErrors:t,messages:{info:{noUtilityNetwork:i}}}=this,e=t.find((t=>t===i));this._initialValidationsFinished=!1,e||(t.removeAll(),await this._validateNetworkExtension(),await this._setDirtyAreasLayer()),this._initialValidationsFinished=!0})),w(t)])}))}destroy(){this._updatingHandles.destroy()}get state(){return this.loadErrors.length||!this._validConstructProperties?\"disabled\":this.executionError?\"failed\":this._updatingHandles.updating?\"executing\":this._activeOperationDidSucceed?\"success\":this._initialValidationsFinished?\"ready\":\"loading\"}set utilityNetwork(t){this._get(\"utilityNetwork\")!==t&&this._set(\"utilityNetwork\",t)}set view(t){this._get(\"view\")!==t&&this._set(\"view\",t)}async validateTopology(){const{messages:{info:{cannotAcquireVersionLock:t,noDirtyAreasInExtent:i}},utilityNetwork:e,view:s}=this;if(!this.loadErrors.length){this._activeOperationDidSucceed=!1,this._set(\"executionError\",\"\");const o={gdbVersion:e?.gdbVersion,outSpatialReference:s.spatialReference?.clone()||null,validateArea:\"current\"===this.extentToValidate?s.extent.clone():e.fullExtent.clone()};this._updatingHandles.addPromise(e?.validateTopology(o).then((()=>{this._activeOperationDidSucceed=!0}),(e=>{let s=\"Error: \"+e;if(e instanceof r&&e.details?.raw)switch(e.details.raw.extendedCode){case v.noDirtyAreasInExtent:s=i;break;case v.cannotAcquireVersionLock_v10:case v.cannotAcquireVersionLock_v11:s=t;break;default:s=e.details.message}this._set(\"executionError\",s)})))}}async _setDirtyAreasLayer(){const{messages:{info:{noDirtyAreasLayer:t}}}=this,i=this.view?.map.allLayers.items.filter((t=>h(t))).find((t=>t.parsedUrl?.path===this.utilityNetwork?.networkSystemLayers.dirtyAreasLayerUrl));i?(this._dirtyAreasLayer=i,await this._dirtyAreasLayer.load(),this._serverVersion=this._dirtyAreasLayer.version??0,this._validConstructProperties=!0):(this.loadErrors.includes(t)||(this.loadErrors.push(t),s.getLogger(this).error(new r(\"utilityNetworkValidateTopology:missing-layer\",t))),this._validConstructProperties=!1)}async _validateNetworkExtension(){const{messages:{info:{noAdvancedEditingUserTypeExtension:t,noUtilityNetworkServiceUserTypeExtension:i}}}=this,e=await p(this.utilityNetwork.layerUrl),o=new y({url:e});await o.load();const a=o.user?.username??\"\",n=Number(this._serverVersion)<=11.1?\"utilityNetwork\":\"advediting\";if(!await u(o,a,n)){const e=Number(this._serverVersion)<=11.1?i:t;this.loadErrors.push(e),s.getLogger(this).error(new r(\"utilityNetworkValidateTopology:no-user-type-extension\",e)),this._validConstructProperties=!1}this._initialValidationsFinished=!0}};t([l()],m.prototype,\"_initialValidationsFinished\",void 0),t([l()],m.prototype,\"_dirtyAreasLayer\",void 0),t([l()],m.prototype,\"_validConstructProperties\",void 0),t([l({readOnly:!0})],m.prototype,\"executionError\",void 0),t([l()],m.prototype,\"extentToValidate\",void 0),t([l()],m.prototype,\"loadErrors\",void 0),t([l()],m.prototype,\"messages\",void 0),t([l({readOnly:!0})],m.prototype,\"state\",null),t([l()],m.prototype,\"utilityNetwork\",null),t([l()],m.prototype,\"view\",null),m=t([d(\"esri.widgets.UtilityNetworkValidateTopology.UtilityNetworkValidateTopologyViewModel\")],m);const _=m;export{_ as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{id as e}from\"../../kernel.js\";import n from\"../../request.js\";async function r(r,t,s){const u=e?.findCredential(r.restUrl);if(!u)return null;if(\"loaded\"===r.loadStatus&&\"\"===t&&r.user?.sourceJSON&&!1===s)return r.user.sourceJSON;const o={responseType:\"json\",query:{f:\"json\"}};if(s&&(o.query.returnUserLicenseTypeExtensions=!0),\"\"===t){const e=await n(r.restUrl+\"/community/self\",o);if(e.data){const n=e.data;if(n?.username)return n}return null}const i=await n(r.restUrl+\"/community/users/\"+t,o);if(i.data){const e=i.data;return e.error?null:e}return null}async function t(e,n,t){const s=await r(e,n,!0);return s?.privileges?.includes(t)??!1}async function s(e,n,t){const s=await r(e,n,!0);return s?.userLicenseTypeExtensions?.includes(t)??!1}export{t as hasPrivilege,s as hasUserTypeExtension,r as lookupUser};\n"],"names":["v","m","i","constructor","t","super","this","_activeOperationDidSucceed","_initialValidationsFinished","_dirtyAreasLayer","_serverVersion","_updatingHandles","c","_validConstructProperties","executionError","extentToValidate","loadErrors","e","initialize","async","messages","g","then","view","utilityNetwork","addHandles","o","_this$utilityNetwork","_this$view","info","noUtilityNetwork","noView","removeAll","type","push","s","getLogger","error","r","loaded","load","catch","_setDirtyAreasLayer","_validateNetworkExtension","a","n","_this$view2","map","layers","find","w","destroy","state","length","updating","_get","_set","validateTopology","cannotAcquireVersionLock","noDirtyAreasInExtent","_s$spatialReference","gdbVersion","outSpatialReference","spatialReference","clone","validateArea","extent","fullExtent","addPromise","_e$details","details","raw","extendedCode","message","_this$view3","_this$_dirtyAreasLaye","noDirtyAreasLayer","allLayers","items","filter","h","_t$parsedUrl","_this$utilityNetwork2","parsedUrl","path","networkSystemLayers","dirtyAreasLayerUrl","version","includes","_o$user$username","_o$user","noAdvancedEditingUserTypeExtension","noUtilityNetworkServiceUserTypeExtension","p","layerUrl","y","url","user","username","Number","u","l","prototype","readOnly","d","_","_r$user","findCredential","restUrl","loadStatus","sourceJSON","responseType","query","f","returnUserLicenseTypeExtensions","data","_s$privileges$include","_s$privileges","privileges","_s$userLicenseTypeExt","_s$userLicenseTypeExt2","userLicenseTypeExtensions"],"sourceRoot":""}