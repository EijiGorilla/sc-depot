"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[8674],{8674:(e,t,a)=>{a.r(t),a.d(t,{default:()=>F});var i=a(35143),s=a(19276),o=a(5632),r=a(68134),l=a(46053),n=(a(81806),a(76460),a(47249),a(85842)),d=a(70445),c=a(76192),h=a(25329),u=a(63544),p=a(99464),y=a(63778),v=(a(50076),a(38283));let m=class extends v.default{_compileList(){var e;const t=null===(e=this.view)||void 0===e||null===(e=e.map)||void 0===e?void 0:e.allLayers;if(!t)return;const a=t.filter(p.gl);this._watchLayersListMode(a);const i=this._getViewableLayers(a);null!==i&&void 0!==i&&i.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}};m=(0,i._)([(0,n.$)("esri.widgets.OrientedImageryViewer.components.OverlayLayersListViewModel")],m);const L=m;let _=class extends y.default{constructor(){super(...arguments),this._rootListEl=null,this.viewModel=new L,this.selectionMode="multiple",this.visibilityAppearance=void 0}initialize(){super.initialize(),this.addHandles([(0,r.watch)((()=>this._rootListEl),(()=>{this._rootListEl&&(this._rootListEl.selectionAppearance="icon")}),r.syncAndInitial)])}};(0,i._)([(0,l.MZ)()],_.prototype,"_rootListEl",void 0),(0,i._)([(0,l.MZ)()],_.prototype,"viewModel",void 0),(0,i._)([(0,l.MZ)()],_.prototype,"selectionMode",void 0),(0,i._)([(0,l.MZ)()],_.prototype,"visibilityAppearance",void 0),_=(0,i._)([(0,n.$)("esri.widgets.OrientedImageryViewer.components.OverlayLayersList")],_);const g=_;var w=a(94126),C=a(98108),M=(a(76099),a(54761));let I=class extends(o.A.IdentifiableMixin(h.default)){constructor(e){super(e),this._previousAction=null,this.closed=!1,this.dataCaptureEnabled=!1,this.dataCaptureLayer=null,this.imageGeometryField=null,this.imageReferenceField=null,this.layerList=new g({selectionMode:"multiple"}),this.messages=null,this.overlayedLayers=new s.default,this.showCameraLocations=!1,this.showMapFeatures=!1,this._createSelectedItemsHandle=()=>{this.removeHandles("selected-items"),this.addHandles(this._trackLayerSelectionChanges(),"selected-items")},this._createDataCaptureLayerHandle=()=>(0,r.watch)((()=>({dataCaptureLayer:this.dataCaptureLayer,operationalItems:this.layerList.operationalItems})),((e,t)=>{let{dataCaptureLayer:a,operationalItems:i}=e;if(!a&&null!==t&&void 0!==t&&t.dataCaptureLayer){var s;const e=i.find((e=>e.layer===t.dataCaptureLayer));e&&(null===(s=e.actionsSections)||void 0===s||s.items.forEach((e=>{e.items.forEach((e=>{"create-features"===e.id&&(e.value=!1)}))})))}}),r.syncAndInitial),this._handleSelectedItemsChange=e=>{let{added:t,removed:a}=e;t.forEach((e=>{var t;this.overlayedLayers.includes(e.layer)||null===(t=this.onLayerSelected)||void 0===t||t.call(this,e)})),a.forEach((e=>{var t;this.overlayedLayers.includes(e.layer)&&(null===(t=this.onLayerDeselected)||void 0===t||t.call(this,e))})),this.overlayedLayers.removeAll(),this.overlayedLayers.addMany(this.layerList.selectedItems.items.map((e=>e.layer)))},this._layerListTriggerActionHandle=()=>(0,r.on)((()=>this.layerList),"trigger-action",(e=>{const{action:t,item:{layer:a}}=e;this._resetPreviousAction(t),"create-features"===t.id&&this._toggleDataCaptureLayer(t,a)})),this._resetPreviousAction=e=>{var t;"toggle"===(null===(t=this._previousAction)||void 0===t?void 0:t.type)&&this._previousAction!==e&&(this._previousAction.value=!1,this._previousAction=null)},this._toggleDataCaptureLayer=(e,t)=>{var a;this._previousAction=e;const i=e.value;this.dataCaptureLayer=i?t:null,null===(a=this.onDataCaptureLayerChanged)||void 0===a||a.call(this,this.dataCaptureLayer)},this._trackLayerSelectionChanges=()=>(0,r.on)((()=>this.layerList.selectedItems),"change",this._handleSelectedItemsChange),this._watchLayerListForListItemCreatedFunction=()=>(0,r.watch)((()=>({layerList:this.layerList,listItemCreatedFunction:this._listItemCreatedFunction})),(()=>{this.layerList.listItemCreatedFunction=this._listItemCreatedFunction}),r.syncAndInitial),this._watchSelectedItems=()=>(0,r.watch)((()=>this.layerList.selectedItems),this._createSelectedItemsHandle,r.syncAndInitial)}initialize(){this.addHandles([this._watchSelectedItems(),this._layerListTriggerActionHandle(),this._watchLayerListForListItemCreatedFunction(),this._createDataCaptureLayerHandle()])}loadDependencies(){return(0,w.W)({list:()=>Promise.all([a.e(46870),a.e(38841),a.e(65641),a.e(75802)]).then(a.bind(a,75802)),"list-item":()=>Promise.resolve().then(a.bind(a,70205)),panel:()=>Promise.resolve().then(a.bind(a,32647)),switch:()=>Promise.resolve().then(a.bind(a,8989))})}get _listItemCreatedFunction(){const{dataCaptureEnabled:e,imageGeometryField:t,imageReferenceField:a}=this;return e&&t&&a?async e=>{const{item:i}=e,o=i.layer,{dataCaptureLayer:l,overlayedLayers:n,messages:{createFeaturesFromImage:h},layerList:u}=this,y=n.includes(o),{selectedItems:v}=u;if(function(e,t,a){e&&t.items.push(a)}(y,v,i),await(null===o||void 0===o?void 0:o.load()),!o||!(0,p.gE)(o,t,a)||!(0,d.S)(o))return;const m=l===o,L=function(e,t,a){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=new c.default({icon:"pencil",id:"create-features",title:e,value:i});return t.addHandles((0,r.watch)((()=>a.includes(t)),(e=>{o.visible=e}),r.syncAndInitial)),function(e,t){const a=new s.default;a.add(e),t.actionsSections=new s.default([a])}(o,t),o}(h,i,v,m);m&&(this._previousAction=L)}:null}get view(){var e;return null===(e=this.layerList)||void 0===e?void 0:e.view}set view(e){this.layerList.view=e}_renderCameraLocationsSwitch(e){return(0,M.K)("calcite-list-item",{bind:this,label:this.messages.overlayCameraLocations,onclick:this._toggleShowCameraLocations},(0,M.K)("calcite-switch",{bind:this,checked:e,class:u.AH.overlaysSwitch,onchange:this._toggleShowCameraLocations,scale:"s",slot:"actions-end"}))}_renderOverlayMapFeatures(e){var t;return(0,M.K)("calcite-list-item",{bind:this,label:null===(t=this.messages)||void 0===t?void 0:t.overlayMapFeatures,onclick:this._toggleShowMapFeatures},(0,M.K)("calcite-switch",{bind:this,checked:e,class:u.AH.overlaysSwitch,onchange:this._toggleShowMapFeatures,scale:"s",slot:"actions-end"}))}_renderList(e){return e?(0,M.K)("div",{class:u.AH.imageOverlaysLayerList},this.layerList.render()):null}_renderPanel(){const{closed:e,messages:t,showCameraLocations:a,showMapFeatures:i}=this;return(0,M.K)("calcite-panel",{bind:this,closable:!0,closed:e,heading:t.imageOverlays,onCalcitePanelClose:this.onImageOverlaysClosed},(0,M.K)("calcite-list",{label:t.imageOverlays},this._renderCameraLocationsSwitch(a),this._renderOverlayMapFeatures(i)),this._renderList(i))}_toggleShowCameraLocations(e){var t;e.stopPropagation(),this.showCameraLocations=!this.showCameraLocations,null===(t=this.onShowCameraLocationsChanged)||void 0===t||t.call(this,this.showCameraLocations)}_toggleShowMapFeatures(e){var t;e.stopPropagation(),this.showMapFeatures=!this.showMapFeatures,null===(t=this.onShowMapFeaturesChanged)||void 0===t||t.call(this,this.showMapFeatures)}render(){const e=this.layerList.operationalItems.items.length,t=this.showMapFeatures&&0===e,a=this.showMapFeatures&&e>0,i={[C.D.widget]:!0,[u.AH.imageOverlaysNoResult]:t,[u.AH.imageOverlaysIncreasedHeight]:a,[u.AH.imageOverlays]:!t&&!a};return(0,M.K)("div",{class:this.classes(i)},this._renderPanel())}};(0,i._)([(0,l.MZ)()],I.prototype,"_previousAction",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"_listItemCreatedFunction",null),(0,i._)([(0,l.MZ)()],I.prototype,"closed",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"dataCaptureEnabled",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"dataCaptureLayer",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"imageGeometryField",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"imageReferenceField",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"layerList",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"messages",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"onDataCaptureLayerChanged",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"onImageOverlaysClosed",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"onLayerDeselected",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"onLayerSelected",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"onShowCameraLocationsChanged",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"onShowMapFeaturesChanged",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"overlayedLayers",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"showCameraLocations",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"showMapFeatures",void 0),(0,i._)([(0,l.MZ)()],I.prototype,"view",null),I=(0,i._)([(0,n.$)("esri.widgets.OrientedImageryViewer.components.ImageOverlays")],I);const F=I}}]);
//# sourceMappingURL=8674.99ff6089.chunk.js.map