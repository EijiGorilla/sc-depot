"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[60831],{60831:(e,t,i)=>{i.r(t),i.d(t,{default:()=>S});var n=i(35143),r=i(91967),s=i(76931),a=i(31633),o=i(46053),c=(i(81806),i(76460),i(47249),i(85842)),l=i(19247),u=i(23701),d=i(13312),p=i(7137),h=i(73953),m=i(80963),w=i(45417),f=i(47818);function v(e){let{state:{paddedViewState:t},spatialReference:i,width:n}=e;return i.isWrappable&&t.worldScreenWidth<n}function g(e,t){const{x:i,y:n}=e?(0,w.webMercatorToGeographic)(t,!0):t;return[i,n]}let _=class extends r.default{constructor(e){super(e),this.scaleComputedFrom=(0,s.tc)(),this.view=null}get state(){var e;return null!==(e=this.view)&&void 0!==e&&e.ready&&"2d"===this.view.type?(0,f.O)(this.view)&&!this.view.inGeographicLayout?"disabled":"ready":"disabled"}getScaleBarProperties(e,t){if("disabled"===this.state||isNaN(e)||!t||!this.view)return null;const i=this._getDistanceInMeters();return null==i?null:this._getScaleBarProps(e,i,t)}_getDistanceInMeters(){const{state:e,spatialReference:t}=this.view;if(!(0,m.fn)(t))return null;const{isGeographic:i}=t,n=function(e){var t,i;const{isWebMercator:n,wkt:r,wkt2:s}=e;return n||null!==(t=null===(i=s||r)||void 0===i?void 0:i.includes("WGS_1984_Web_Mercator"))&&void 0!==t&&t}(t);var r;if(!i&&!n)return e.extent.width*(null!==(r=(0,a.Ao)(t))&&void 0!==r?r:1);const[s,o]=this._getScaleMeasuringPoints(),c=n||i&&!(0,p.isSupported)(t)?d.default.WGS84:t,l=new u.default({paths:[[g(n,s),g(n,o)]],spatialReference:c}),w=(0,h.straightLineDensify)(l,10);let f;try{[f]=(0,p.geodesicLengths)([w],"meters")}catch(v){return null}return f}_getScaleMeasuringPoints(){const e=this.view,{width:t,height:i,position:n,spatialReference:r}=e;if(v(e)){const e=(0,m.Vp)(r),{valid:t}=e;return[new l.default(t[0],0,r),new l.default(t[1],0,r)]}let a=this.scaleComputedFrom.y-n[1];a>i?a=i:a<0&&(a=0);const o=(0,s.tc)(0,a),c=(0,s.tc)(t,a);return[e.toMap(o),e.toMap(c)]}_getScaleBarProps(e,t,i){const n=this.view,r=e*t/(v(n)?n.state.paddedViewState.worldScreenWidth:n.width);if(r<.001)return null;const s=function(e,t){switch(t){case"metric":return e>1e3?{distance:(0,a.oU)(e,"meters","kilometers"),unit:"kilometer"}:e>1?{distance:e,unit:"meter"}:e>.01?{distance:(0,a.oU)(e,"meters","centimeters"),unit:"centimeter"}:{distance:(0,a.oU)(e,"meters","millimeters"),unit:"millimeter"};case"imperial":return e>1609.344?{distance:(0,a.oU)(e,"meters","miles"),unit:"mile"}:e>.3048?{distance:(0,a.oU)(e,"meters","feet"),unit:"foot"}:{distance:(0,a.oU)(e,"meters","inches"),unit:"inch"}}}(r,i),{distance:o,unit:c}=s;let l=o,u=0;for(;l>=1;)l/=10,u++;const{min:d,max:p}=function(e){return e>.5?{min:.5,max:1}:e>.2?{min:.2,max:.5}:{min:.1,max:.2}}(l),h=p/l>=l/d?d:p;return{length:e*(h/l),value:10**u*h,unit:c}}};(0,n._)([(0,o.MZ)()],_.prototype,"scaleComputedFrom",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],_.prototype,"state",null),(0,n._)([(0,o.MZ)()],_.prototype,"view",void 0),_=(0,n._)([(0,c.$)("esri.widgets.ScaleBar.ScaleBarViewModel")],_);const S=_}}]);
//# sourceMappingURL=60831.a7ccabe6.chunk.js.map