"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[63733,87137],{63733:(t,i,e)=>{e.r(i),e.d(i,{default:()=>d});var s=e(35143),o=e(46053),n=(e(81806),e(76460),e(47249),e(85842)),r=e(5364),a=e(25515),l=e(65624),c=e(5682),h=e(64519),u=e(731);let y=class extends((0,l.dM)((0,c.j)(a.default))){constructor(t){super(t),this.elevationInfo=null,this.graphics=new h.Y,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(t){return this.graphics.add(t),this}addMany(t){return this.graphics.addMany(t),this}removeAll(){return this.graphics.removeAll(),this}remove(t){this.graphics.remove(t)}removeMany(t){this.graphics.removeMany(t)}on(t,i){return super.on(t,i)}graphicChanged(t){this.emit("graphic-update",t)}};(0,s._)([(0,o.MZ)({type:u.A})],y.prototype,"elevationInfo",void 0),(0,s._)([(0,o.MZ)((0,r.C)(h.Y,"graphics"))],y.prototype,"graphics",void 0),(0,s._)([(0,o.MZ)({type:["show","hide"]})],y.prototype,"listMode",void 0),(0,s._)([(0,o.MZ)()],y.prototype,"screenSizePerspectiveEnabled",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],y.prototype,"type",void 0),(0,s._)([(0,o.MZ)({constructOnly:!0})],y.prototype,"internal",void 0),y=(0,s._)([(0,n.$)("esri.layers.GraphicsLayer")],y);const d=y},69120:(t,i,e)=>{function s(t,i,e){if(!i||null===t||void 0===t||!t.map)return;const{map:s}=t,o=s.layers.find((t=>t===i));o||s.add(i,e),o&&null!=e&&s.layers.reorder(o,e)}function o(t,i){const e="subtype-sublayer"===(null===i||void 0===i?void 0:i.type)?i.parent:i;return t.allLayerViews.find((t=>{const i=t.layer;return i===e||"sublayers"in i&&null!=i.sublayers&&i.sublayers.includes(e)}))}e.d(i,{Y:()=>s,i:()=>o})},87137:(t,i,e)=>{e.r(i),e.d(i,{default:()=>g});var s=e(35143),o=e(39356),n=(e(11265),e(91967)),r=e(19276),a=e(50076),l=e(76460),c=e(68134),h=e(46053),u=(e(81806),e(47249),e(85842)),y=e(19451),d=e(63733),v=e(41568),m=e(38996),p=e(69120),A=e(38042),w=e(63860);const _=-2147208504;let b=class extends n.default{constructor(t){super(t),this._internalGraphicsLayerConnectivity=this._createInternalGraphicsLayer("Connectivity Associations (Internal)"),this._internalGraphicsLayerStructuralAttachment=this._createInternalGraphicsLayer("Structural Attachment Associations (Internal)"),this._initialValidationsFinished=!1,this._updatingHandles=new y.U,this.autoRefreshAssociations=!1,this.connectivityAssociationsLineSymbol=new m.default({style:"short-dash",width:2,color:[190,159,159,1]}),this.executionError="",this.loadErrors=new r.default,this.maxAllowableAssociations=250,this.showAssociationsEnabled=!1,this.showArrowsConnectivity=!1,this.showArrowsStructuralAttachment=!1,this.structuralAttachmentAssociationsLineSymbol=new m.default({style:"short-dash",width:2,color:[159,190,159,1]})}initialize(){const t=async()=>{this.messages||(this.messages=await(0,w.ud)("esri/widgets/UtilityNetworkAssociations/t9n/UtilityNetworkAssociations"))};t().then((()=>{this.view||(this.view=null),this.utilityNetwork||(this.utilityNetwork=null),this.addHandles([(0,c.watch)((()=>[this.view,this.utilityNetwork]),(async()=>{var t,i;const{loadErrors:e,messages:{info:{noUtilityNetwork:s,noView:o}}}=this;this._initialValidationsFinished=!1,e.removeAll();let n=!1,r=!1;this.removeAssociations(),"2d"===(null===(t=this.view)||void 0===t?void 0:t.type)?((0,p.Y)(this.view,this._internalGraphicsLayerConnectivity),(0,p.Y)(this.view,this._internalGraphicsLayerStructuralAttachment),n=!0):(this.loadErrors.push(o),l.A.getLogger(this).error(new a.default("utilityNetworkAssociations:missing-property",o))),"utility"===(null===(i=this.utilityNetwork)||void 0===i?void 0:i.type)?r=!0:(this.loadErrors.push(s),l.A.getLogger(this).error(new a.default("utilityNetworkAssociations:missing-property",s))),n&&r&&this.showAssociationsEnabled&&await this.showAssociations(),this._internalGraphicsLayerConnectivity.visible=this.includeConnectivityAssociations,this._internalGraphicsLayerStructuralAttachment.visible=this.includeStructuralAttachmentAssociations,this._initialValidationsFinished=!0}),{initial:!0}),(0,c.watch)((()=>{var t;return[null===(t=this.view)||void 0===t?void 0:t.stationary,this.showAssociationsEnabled,this.maxAllowableAssociations]}),(async()=>{var t;(null===(t=this.view)||void 0===t?void 0:t.stationary)&&this.showAssociationsEnabled&&(this.includeConnectivityAssociations||this.includeStructuralAttachmentAssociations)&&await this.showAssociations()})),(0,c.watch)((()=>[this.showArrowsConnectivity]),(()=>{const t=this.connectivityAssociationsLineSymbol.clone();t.marker=null,this.showArrowsConnectivity&&(t.marker=new v.default({color:this.connectivityAssociationsLineSymbol.color,placement:"end",style:"arrow"}));for(const i of this._internalGraphicsLayerConnectivity.graphics)i.symbol=t})),(0,c.watch)((()=>[this.showArrowsStructuralAttachment]),(()=>{const t=this.structuralAttachmentAssociationsLineSymbol.clone();t.marker=null,this.showArrowsStructuralAttachment&&(t.marker=new v.default({color:this.structuralAttachmentAssociationsLineSymbol.color,placement:"end",style:"arrow"}));for(const i of this._internalGraphicsLayerStructuralAttachment.graphics)i.symbol=t})),(0,c.watch)((()=>{const{cap:t,color:i,style:e,width:s,marker:o}=this.connectivityAssociationsLineSymbol;return[t,i,e,s,o]}),(()=>{const t=this.connectivityAssociationsLineSymbol.clone();for(const i of this._internalGraphicsLayerConnectivity.graphics)i.symbol=t;this.showArrowsConnectivity=!1,t.marker=null,this.connectivityAssociationsLineSymbol.marker&&(this.showArrowsConnectivity=!0,t.marker=new v.default({color:this.connectivityAssociationsLineSymbol.color,placement:"end",style:"arrow"}))})),(0,c.watch)((()=>{const{cap:t,color:i,style:e,width:s,marker:o}=this.structuralAttachmentAssociationsLineSymbol;return[t,i,e,s,o]}),(()=>{const t=this.structuralAttachmentAssociationsLineSymbol.clone();for(const i of this._internalGraphicsLayerStructuralAttachment.graphics)i.symbol=t;this.showArrowsStructuralAttachment=!1,t.marker=null,this.structuralAttachmentAssociationsLineSymbol.marker&&(this.showArrowsStructuralAttachment=!0,t.marker=new v.default({color:this.structuralAttachmentAssociationsLineSymbol.color,placement:"end",style:"arrow"}))})),(0,A.oQ)(t)])}))}destroy(){this._updatingHandles.destroy(),this.view=null,this._removeInternalGraphicsLayers()}set includeConnectivityAssociations(t){this._set("includeConnectivityAssociations",t),this._internalGraphicsLayerConnectivity.visible=t}set includeStructuralAttachmentAssociations(t){this._set("includeStructuralAttachmentAssociations",t),this._internalGraphicsLayerStructuralAttachment.visible=t}get state(){return this.loadErrors.length?"disabled":this._updatingHandles.updating?"executing":""!==this.executionError?"warning":this._initialValidationsFinished?"ready":"loading"}get utilityNetwork(){return this.utilityNetwork}set utilityNetwork(t){this._get("utilityNetwork")!==t&&this._set("utilityNetwork",t)}get view(){return this.view}set view(t){this._get("view")!==t&&this._set("view",t)}removeAssociations(){this._internalGraphicsLayerConnectivity.removeAll(),this._internalGraphicsLayerStructuralAttachment.removeAll()}async showAssociations(){var t,i,e,s;const{messages:{info:{maxAllowableAssociationsExceeded:n,noAssociationsFound:r,noAssociationTypeSpecified:l}},utilityNetwork:c}=this;this._set("executionError","");const h={extent:null===(t=this.view)||void 0===t?void 0:t.extent,gdbVersion:null===(i=this.utilityNetwork)||void 0===i?void 0:i.gdbVersion,maxGeometryCount:this.maxAllowableAssociations,moment:null===(e=this.utilityNetwork)||void 0===e?void 0:e.historicMoment,outSpatialReference:null===(s=this.view)||void 0===s?void 0:s.spatialReference.clone(),returnConnectivityAssociations:this.includeConnectivityAssociations,returnAttachmentAssociations:this.includeStructuralAttachmentAssociations};this._updatingHandles.addPromise(null===c||void 0===c?void 0:c.synthesizeAssociationGeometries(h).then((t=>{let i=[],e=[];return null!==t&&void 0!==t&&t.maxGeometryCountExceeded?(this.removeAssociations(),void this._set("executionError",n)):0===(null===t||void 0===t?void 0:t.associations.length)?(this.removeAssociations(),void this._set("executionError",r)):void(t&&(i=null===t||void 0===t?void 0:t.associations.filter((t=>{let{associationType:i}=t;return"connectivity"===i})).map((t=>(this.connectivityAssociationsLineSymbol.marker=null,this.showArrowsConnectivity&&(this.connectivityAssociationsLineSymbol.marker=new v.default({color:this.connectivityAssociationsLineSymbol.color,placement:"end",style:"arrow"})),new o.default({geometry:t.geometry.clone(),symbol:this.connectivityAssociationsLineSymbol})))),e=t.associations.filter((t=>{let{associationType:i}=t;return"attachment"===i})).map((t=>(this.structuralAttachmentAssociationsLineSymbol.marker=null,this.showArrowsStructuralAttachment&&(this.structuralAttachmentAssociationsLineSymbol.marker=new v.default({color:this.structuralAttachmentAssociationsLineSymbol.color,placement:"end",style:"arrow"})),new o.default({geometry:t.geometry.clone(),symbol:this.structuralAttachmentAssociationsLineSymbol})))),this._internalGraphicsLayerConnectivity.removeAll(),i.length>0&&this._internalGraphicsLayerConnectivity.addMany(i),this._internalGraphicsLayerStructuralAttachment.removeAll(),e.length>0&&this._internalGraphicsLayerStructuralAttachment.addMany(e)))}),(t=>{var i;let e="Error: "+t;t instanceof a.default&&null!==(i=t.details)&&void 0!==i&&i.raw&&(e=t.details.raw.extendedCode===_?l:t.details.message),this._set("executionError",e)})))}_createInternalGraphicsLayer(t){return new d.default({listMode:"hide",internal:!0,title:t})}_removeInternalGraphicsLayers(){var t;this._internalGraphicsLayerConnectivity&&this._internalGraphicsLayerStructuralAttachment&&(null===(t=this.view)||void 0===t?void 0:t.map)&&(this.view.map.remove(this._internalGraphicsLayerConnectivity),this.view.map.remove(this._internalGraphicsLayerStructuralAttachment))}};(0,s._)([(0,h.MZ)()],b.prototype,"_initialValidationsFinished",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"autoRefreshAssociations",void 0),(0,s._)([(0,h.MZ)({type:m.default,nonNullable:!0})],b.prototype,"connectivityAssociationsLineSymbol",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],b.prototype,"executionError",void 0),(0,s._)([(0,h.MZ)({type:Boolean,value:!0})],b.prototype,"includeConnectivityAssociations",null),(0,s._)([(0,h.MZ)({type:Boolean,value:!0})],b.prototype,"includeStructuralAttachmentAssociations",null),(0,s._)([(0,h.MZ)()],b.prototype,"loadErrors",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"maxAllowableAssociations",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"messages",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"showAssociationsEnabled",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"showArrowsConnectivity",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"showArrowsStructuralAttachment",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],b.prototype,"state",null),(0,s._)([(0,h.MZ)({type:m.default,nonNullable:!0})],b.prototype,"structuralAttachmentAssociationsLineSymbol",void 0),(0,s._)([(0,h.MZ)()],b.prototype,"utilityNetwork",null),(0,s._)([(0,h.MZ)()],b.prototype,"view",null),b=(0,s._)([(0,u.$)("esri.widgets.UtilityNetworkAssociations.UtilityNetworkAssociationsViewModel")],b);const g=b}}]);
//# sourceMappingURL=87137.556117b6.chunk.js.map