"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[98156],{98156:(t,e,n)=>{n.r(e),n.d(e,{getTimeExtentFromLayers:()=>f,getTimeSliderSettingsFromWebDocument:()=>v,toLocalTimeExtent:()=>p,toUTCTimeExtent:()=>T});var l=n(18690),i=n(53084),u=n(18288),o=n(59187),r=n(42052),a=n(72027);function s(t){return void 0!==t.timeInfo}async function d(t,e){var n,l;return null!==(n=null===(l=t.widgets)||void 0===l||null===(l=l.timeSlider)||void 0===l?void 0:l.fullTimeExtent)&&void 0!==n?n:f(t.allLayers,e)}function m(t){const{numStops:e,stopInterval:n,stops:l}=t;return l?{dates:(0,i.clone)(l)}:n?{interval:n.clone()}:{count:null!==e&&void 0!==e?e:5}}async function f(t,e){if(0===t.length)return o.default.allTime;await Promise.all(t.map((t=>t.load({signal:e}))));const n=t.filter(s),i=t.filter((t=>!s(t)&&null!=t.visibilityTimeExtent));if(0===n.length&&0===i.length)return o.default.allTime;const u=[],r=[];for(const l of n){var a;"feature"!==(null===l||void 0===l?void 0:l.type)&&"map-image"!==(null===l||void 0===l?void 0:l.type)||null===(a=l.timeInfo)||void 0===a||!a.hasLiveData?r.push(l):u.push(l)}const d=t=>null==t||t.isAllTime,m=[...r.map((t=>{var e,n;const l=null===(e=t.timeInfo)||void 0===e?void 0:e.fullTimeExtent,{visibilityTimeExtent:i}=t;return null!==(n=null===l||void 0===l?void 0:l.intersection(i))&&void 0!==n?n:i})),...i.map((t=>t.visibilityTimeExtent))];if(m.some(d))return o.default.allTime;const f=u.map((async t=>{var n,l,i,u;const o=null!==(n=null===(l=await t.fetchRecomputedExtents({signal:e}))||void 0===l?void 0:l.timeExtent)&&void 0!==n?n:null===(i=t.timeInfo)||void 0===i?void 0:i.fullTimeExtent,{visibilityTimeExtent:r}=t;return null!==(u=null===o||void 0===o?void 0:o.intersection(r))&&void 0!==u?u:r})),c=(await Promise.allSettled(f)).map((t=>"fulfilled"===t.status?t.value:null));if(c.some(d))return o.default.allTime;const v=[...c,...m].filter(l.Ru);return 0===v.length?o.default.allTime:v.reduce(((t,e)=>t.union(e)))}function c(t,e){var n;const l=t.currentTimeExtent;if(!l)return null;const{start:i,end:u}=l,r=null!==(n=null!==i&&void 0!==i?i:u)&&void 0!==n?n:null;switch(e){case"time-window":return new o.default({start:i,end:u});case"cumulative-from-start":return new o.default({start:null,end:r});case"cumulative-from-end":return new o.default({start:r,end:null});case"instant":return new o.default({start:r,end:r})}}async function v(t,e){var n,l;if(!(0,r.r)(t)&&!function(t){return null!=t&&"object"==typeof t&&a.X in t}(t))return null;await t.load({signal:e});const i=null===t||void 0===t||null===(n=t.widgets)||void 0===n?void 0:n.timeSlider;if(!i)return null;const u=await d(t,e),o=i.loop,s=function(t){var e;const n=null!==(e=t.numThumbs)&&void 0!==e?e:2,l=t.currentTimeExtent;if(l){const{start:t,end:e}=l;return null!=t&&null!=e&&t.getTime()===e.getTime()?"instant":2===n?"time-window":null==t||0===t.getTime()?"cumulative-from-start":"cumulative-from-end"}return 2===n?"time-window":"cumulative-from-start"}(i);return{fullTimeExtent:u,loop:o,mode:s,playRate:null!==(l=i.stopDelay)&&void 0!==l?l:2e3,stops:m(i),timeExtent:c(i,s)}}function T(t){if(!t)return t;const{start:e,end:n}=t;return new o.default({start:null!=e?(0,u.S1)(e,-e.getTimezoneOffset(),"minutes"):e,end:null!=n?(0,u.S1)(n,-n.getTimezoneOffset(),"minutes"):n})}function p(t){if(!t)return t;const{start:e,end:n}=t;return new o.default({start:null!=e?(0,u.S1)(e,e.getTimezoneOffset(),"minutes"):e,end:null!=n?(0,u.S1)(n,n.getTimezoneOffset(),"minutes"):n})}}}]);
//# sourceMappingURL=98156.8939dc4a.chunk.js.map