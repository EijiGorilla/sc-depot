"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[9912,61472,87531],{9912:(e,t,i)=>{i.r(t),i.d(t,{applyTextFormattingHTML:()=>B,createFieldInfoMap:()=>Q,findRelatedLayer:()=>le,findUtilityNetwork:()=>ce,fixTokens:()=>D,formatAttributes:()=>X,formatEditInfo:()=>$,formatValueToFieldInfo:()=>j,getAllFieldInfos:()=>Y,getFieldInfo:()=>K,getFieldInfoLabel:()=>E,getFixedFieldName:()=>A,getFixedFieldNames:()=>L,getHighlightKeyForFeature:()=>de,getSourceLayer:()=>k,graphicCallback:()=>F,htmlEntities:()=>J,isAssociatedFeatureSupportedLayer:()=>z,isExpressionField:()=>M,isFeatureSupportedLayer:()=>P,isGraphicForRelatableFeatureSupportedLayer:()=>V,isRelatableFeatureSupportedLayer:()=>R,isRelatableLayer:()=>q,isRelatedField:()=>ie,preLayerQueryCallback:()=>ae,preRequestCallback:()=>oe,querySourceLayer:()=>ee,queryUpdatedFeature:()=>te,shouldOpenInNewTab:()=>T,substituteAttributes:()=>N,substituteFieldsInLinksAndAttributes:()=>H});var r=i(89379),n=i(81806),s=i(76460),a=i(88685),o=i(65256),l=i(50265),c=i(53430),h=i(31933),u=i(42633),d=i(98976),p=i(67478);const f=()=>s.A.getLogger("esri.widgets.Feature.support.featureUtils"),y=/href=(""|'')/gi,v=/(\{([^{\r\n]+)\})/g,m=/'/g,g=/^\s*expression\//i,b=/(\n)/gi,w=/[\u00A0-\u9999<>&]/gim,x=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,_=/^(?:mailto:|tel:)/,G="relationships/",I=(0,o.J2)("short-date-short-time");function k(e){var t;if(null!=e)return null!==(t=e.sourceLayer||e.layer)&&void 0!==t?t:void 0}async function F(e){let{type:t,value:i,event:r}=e;try{return"function"==typeof i?i(r):await i}catch(n){return void f().error("error",'An error occurred when calling the "'.concat(t,'" function'),{error:n,graphic:r.graphic,value:i})}}function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(e)return!_.test(e.trim().toLowerCase())}function M(e){return!!e&&g.test(e)}function E(e,t){const i=function(e,t){if(!t||!M(t)||!e)return;const i=t.replace(g,"").toLowerCase();return e.find((e=>{let{name:t}=e;return t.toLowerCase()===i}))}(t,null===e||void 0===e?void 0:e.fieldName);return i?i.title||null:e?e.label||e.fieldName:null}function A(e,t){const i=O(t,e);return i?i.name:e}function L(e,t){return e&&e.map((e=>A(e,t)))}function O(e,t){var i;return e&&"function"==typeof e.getField&&t&&null!==(i=e.getField(t))&&void 0!==i?i:null}function Z(e){return"".concat(e).trim()}function H(e){let{attributes:t,globalAttributes:i,layer:n,text:s,expressionAttributes:a,fieldInfoMap:o}=e;return s?N({formattedAttributes:i,template:U(s,(0,r.A)((0,r.A)((0,r.A)({},i),a),t),n),fieldInfoMap:o}):""}function N(e){let{formattedAttributes:t,template:i,fieldInfoMap:r}=e;return Z(function(e){return e.replaceAll(y,"")}((0,a.HC)((0,a.HC)(i,(e=>function(e,t){const i=t.get(e.toLowerCase());return"{".concat((null===i||void 0===i?void 0:i.fieldName)||e,"}")}(e,r))),t)))}function C(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=(0,r.A)({},e);return Object.keys(i).forEach((e=>function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=t[e];if("string"==typeof r){const n="%27",s=(i?encodeURIComponent(r):r).replaceAll(m,n);t[e]=s}}(e,i,t))),i}function D(e,t){return e.replaceAll(v,((e,i,r)=>{const n=O(t,r);return n?"{".concat(n.name,"}"):i}))}function U(e,t,i){const r=D(e,i);return r?r.replaceAll(x,((e,i,r)=>function(e,t,i){const r=(t=Z(t))&&"{"!==t[0];return(0,a.HC)(e,C(i,r||!1))}(e,i||r,t))):r}function P(e){return null!=e&&"object"==typeof e&&"fieldsIndex"in e&&"geometryType"in e&&"getField"in e&&"load"in e&&"loaded"in e&&"objectIdField"in e&&"spatialReference"in e&&"type"in e&&("feature"===e.type||"scene"===e.type||"subtype-group"===e.type||"subtype-sublayer"===e.type||"sublayer"===e.type)&&"when"in e}function q(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"queryObjectIds"in e&&"queryRelatedFeatures"in e&&"queryRelatedFeaturesCount"in e&&"relationships"in e}function R(e){return P(e)&&q(e)}function z(e){return!(!(e&&"object"==typeof e&&"createQuery"in e&&"getField"in e&&"queryFeatureCount"in e&&"queryFeatures"in e&&"queryObjectIds"in e&&"capabilities"in e&&"fields"in e&&"fieldsIndex"in e&&"type"in e)||"feature"!==e.type&&"subtype-group"!==e.type&&"subtype-sublayer"!==e.type&&"sublayer"!==e.type||!("when"in e))&&("subtype-sublayer"===e.type&&"parent"in e&&e.parent&&"object"==typeof e.parent?"globalIdField"in e.parent:"globalIdField"in e)}function V(e){return!!e&&"object"==typeof e&&"sourceLayer"in e&&R(e.sourceLayer)}function j(e,t){const{fieldInfos:i,fieldName:n,preventPlacesFormatting:s,layer:a,timeZone:o}=t,h=K(i,n),d=O(a,n);if(h&&!(0,c.isRasterPixelValueField)(n)){var p;const t=null===d||void 0===d?void 0:d.type,i=null===(p=h.format)||void 0===p?void 0:p.dateFormat;if("date"===t||"date-only"===t||"time-only"===t||"timestamp-offset"===t||i)return(0,u.i0)(e,{format:i,fieldType:t,timeZoneOptions:{layerTimeZone:a&&"preferredTimeZone"in a?a.preferredTimeZone:null,viewTimeZone:o,datesInUnknownTimezone:!(!a||!("datesInUnknownTimezone"in a))&&!!a.datesInUnknownTimezone}})}const f=null===h||void 0===h?void 0:h.format;return"string"==typeof e&&(0,c.isRasterPixelValueField)(n)&&f?function(e,t){return e=e.trim(),/\d{2}-\d{2}/.test(e)?e:e.includes(",")?S(e,",",", ",t):e.includes(";")?S(e,";","; ",t):e.includes(" ")?S(e," "," ",t):(0,l.ZV)(Number(e),(0,l.yx)(t))}(e,f):"string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,f))||null==e||null==f?B(e):(0,l.ZV)(e,s?(0,r.A)((0,r.A)({},(0,l.yx)(f)),{},{minimumFractionDigits:0,maximumFractionDigits:20}):(0,l.yx)(f))}function S(e,t,i,r){return e.trim().split(t).map((e=>(0,l.ZV)(Number(e),(0,l.yx)(r)))).join(i)}function K(e,t){if(null!==e&&void 0!==e&&e.length&&t)return e.find((e=>{var i;return(null===(i=e.fieldName)||void 0===i?void 0:i.toLowerCase())===t.toLowerCase()}))}function $(e,t,i,n){const{creatorField:s,creationDateField:a,editorField:l,editDateField:c}=e;if(!t)return;const h=(0,p.hv)(n&&"preferredTimeZone"in n?n.preferredTimeZone:null,!(!n||!("datesInUnknownTimezone"in n))&&!!n.datesInUnknownTimezone,i,I,"date"),u=(0,r.A)((0,r.A)({},I),h),d=t[c];if("number"==typeof d){const e=t[l];return{type:"edit",date:(0,o.Yq)(d,u),user:e}}const f=t[a];if("number"==typeof f){const e=t[s];return{type:"create",date:(0,o.Yq)(f,u),user:e}}return null}function Q(e,t){const i=new Map;if(!e)return i;for(const r of e){if(!r.fieldName)continue;const e=A(r.fieldName,t);r.fieldName=e,i.set(e.toLowerCase(),r)}return i}function Y(e){const t=[];if(!e)return t;const{fieldInfos:i,content:r}=e;return i&&t.push(...i),r&&Array.isArray(r)?(r.forEach((e=>{if("fields"===e.type){const i=null===e||void 0===e?void 0:e.fieldInfos;i&&t.push(...i)}})),t):t}function J(e){return e.replaceAll(w,(e=>"&#".concat(e.charCodeAt(0),";")))}function B(e){return"string"==typeof e?e.replaceAll(b,'<br class="esri-text-new-line" />'):e}function W(e){var t;const{value:i,fieldName:r,fieldInfos:s,fieldInfoMap:a,layer:o,graphic:l,timeZone:h}=e;if(null==i)return"";const d=function(e){let{fieldName:t,value:i,graphic:r,layer:s}=e;if(ie(t))return null;if(!s||"function"!=typeof s.getFieldDomain)return null;const a=r&&s.getFieldDomain(t,{feature:r,excludeImpliedDomains:(0,n.A)("esri-widget-legacy-field-domain-calculation")});return a&&"coded-value"===a.type?a.getName(i):null}({fieldName:r,value:i,graphic:l,layer:o});if(d)return d;const p=function(e){let{fieldName:t,graphic:i,layer:r}=e;if(ie(t))return null;if(!r||"function"!=typeof r.getFeatureType)return null;const{typeIdField:n}=r;if(!n||t!==n)return null;const s=r.getFeatureType(i);return s?s.name:null}({fieldName:r,graphic:l,layer:o});if(p)return p;if(a.get(r.toLowerCase()))return j(i,{fieldInfos:s||Array.from(a.values()),fieldName:r,layer:o,timeZone:h});const f=null===o||void 0===o||null===(t=o.fieldsIndex)||void 0===t?void 0:t.get(r);return f&&((0,u.fs)(f)||(0,c.isTimeOnlyField)(f))?(0,u.i0)(i,{fieldType:f.type,timeZoneOptions:{layerTimeZone:o&&"preferredTimeZone"in o?o.preferredTimeZone:null,viewTimeZone:h,datesInUnknownTimezone:!(!o||!("datesInUnknownTimezone"in o))&&!!o.datesInUnknownTimezone}}):B(i)}function X(e){let{fieldInfos:t,attributes:i,layer:r,graphic:n,fieldInfoMap:s,relatedInfos:a,timeZone:o}=e;const l={};return null!==a&&void 0!==a&&a.forEach((e=>function(e){var t,i;let{attributes:r,relatedInfo:n,fieldInfoMap:s,fieldInfos:a,layer:o,timeZone:l}=e;r&&n&&(null!==(t=n.relatedFeatures)&&void 0!==t&&t.forEach((e=>re({attributes:r,graphic:e,relatedInfo:n,fieldInfoMap:s,fieldInfos:a,layer:o,timeZone:l}))),null===(i=n.relatedStatsFeatures)||void 0===i||i.forEach((e=>re({attributes:r,graphic:e,relatedInfo:n,fieldInfoMap:s,fieldInfos:a,layer:o,timeZone:l}))))}({attributes:l,relatedInfo:e,fieldInfoMap:s,fieldInfos:t,layer:r,timeZone:o}))),i&&Object.keys(i).forEach((e=>{const a=i[e];l[e]=W({fieldName:e,fieldInfos:t,fieldInfoMap:s,layer:r,value:a,graphic:n,timeZone:o})})),l}async function ee(e,t){var i;const{layer:r,graphic:n,outFields:s,objectIds:a,returnGeometry:o,spatialReference:l}=e,c=a[0];if("number"!=typeof c&&"string"!=typeof c){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:r,graphic:n,objectId:c,requiredFields:s};return f().warn(e,t),null}if(null===(i=(0,h.BR)(r))||void 0===i||null===(i=i.operations)||void 0===i||!i.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:r,graphic:n,requiredFields:s,returnGeometry:o};return f().warn(e,t),null}const u=r.createQuery();return u.objectIds=a,u.outFields=null!==s&&void 0!==s&&s.length?s:[r.objectIdField],u.returnGeometry=!!o,u.returnZ=!!o,u.returnM=!!o,u.outSpatialReference=l,(await r.queryFeatures(u,t)).features[0]}async function te(e,t){let{graphic:i,popupTemplate:n,layer:s,spatialReference:a}=e;if(!s||!n)return;if("function"==typeof s.load&&await s.load(t),!i.attributes)return;const o=s.objectIdField,l=i.attributes[o];if(null==l)return;const h=[l],u=await n.getRequiredFields(s.fieldsIndex),p=(0,c.featureHasFields)(u,i),f=p?[]:u.includes(o)?u:[...u,o],y=n.returnGeometry||await async function(e){var t;if(null===(t=e.expressionInfos)||void 0===t||!t.length)return!1;const i=await(0,d.lw)(),{arcadeUtils:{hasGeometryFunctions:r}}=i;return r(e)}(n);if(p&&!y)return;const v=await ee({layer:s,graphic:i,outFields:f,objectIds:h,returnGeometry:y,spatialReference:a},t);v&&(v.geometry&&(i.geometry=v.geometry),v.attributes&&(i.attributes=(0,r.A)((0,r.A)({},i.attributes),v.attributes)))}function ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return!!e&&e.includes(G)}function re(e){let{attributes:t,graphic:i,relatedInfo:r,fieldInfos:n,fieldInfoMap:s,layer:a,timeZone:o}=e;t&&i&&r&&Object.keys(i.attributes).forEach((e=>{const l=function(e){return"".concat(G).concat(e.layerId,"/").concat(e.fieldName)}({layerId:r.relation.id.toString(),fieldName:e}),c=i.attributes[e];t[l]=W({fieldName:l,fieldInfos:n,fieldInfoMap:s,layer:a,value:c,graphic:i,timeZone:o})}))}const ne=e=>{if(!e)return!1;const t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},se=e=>{var t;let{layer:i,method:r,query:n,definitionExpression:s}=e;if(null===(t=i.capabilities)||void 0===t||null===(t=t.query)||void 0===t||!t.supportsCacheHint||"attachments"===r)return;const a=null!=n.where?n.where:null,o=null!=n.geometry?n.geometry:null;ne(s)||ne(a)||"extent"===(null===o||void 0===o?void 0:o.type)||"tile"===n.resultType||(n.cacheHint=!0)},ae=e=>{var t;let{query:i,layer:r,method:n}=e;se({layer:r,method:n,query:i,definitionExpression:"".concat(r.definitionExpression," ").concat(null!==(t=r.serviceDefinitionExpression)&&void 0!==t?t:"")})},oe=e=>{var t;let{queryPayload:i,layer:r,method:n}=e;se({layer:r,method:n,query:i,definitionExpression:"".concat(r.definitionExpression," ").concat(null!==(t=r.serviceDefinitionExpression)&&void 0!==t?t:"")})};function le(e,t,i){var r,n;return e&&t&&i?"sublayer"===t.type?ue({layers:null===(r=t.layer)||void 0===r?void 0:r.sublayers,map:e,relatedLayer:t,relationship:i})||ue({layers:null===(n=t.layer)||void 0===n?void 0:n.subtables,map:e,relatedLayer:t,relationship:i}):ue({layers:e.allLayers,map:e,relatedLayer:t,relationship:i})||ue({layers:e.allTables,map:e,relatedLayer:t,relationship:i}):null}function ce(e,t){var i;return e&&"utilityNetworks"in e&&t?null===(i=e.utilityNetworks)||void 0===i?void 0:i.find((e=>e.isUtilityLayer(t))):null}function he(e,t){return null===e||void 0===e?void 0:e.allTables.find((e=>{var i;return"feature"===e.type&&e.layerId===t.id&&e.url===(null===(i=t.layer)||void 0===i?void 0:i.url)}))}function ue(e){let{map:t,relationship:i,relationship:{relatedTableId:r},relatedLayer:n,layers:s}=e;if(!s)return null;for(const o of s){var a;if("map-image"===o.type){const e=ue({layers:o.sublayers,map:t,relatedLayer:n,relationship:i})||ue({layers:o.subtables,map:t,relatedLayer:n,relationship:i});if(e)return e;continue}if(!R(o))continue;if("sublayer"===n.type){if(o!==n&&o.id===r)return o.isTable?he(t,o):o;continue}const e="scene"===n.type&&n.associatedLayer?n.associatedLayer.url:n.url;if(!e)return null;if("sublayer"!==o.type){if(o!==n&&o.url===e&&o.layerId===r)return o}else if(o!==n&&(null===(a=o.layer)||void 0===a?void 0:a.url)===e&&o.id===r)return o.isTable?he(t,o):o}return null}function de(e){const t=e.getObjectId();return null!=t?"oid:".concat(t):"uid:".concat(e.uid)}},20072:(e,t,i)=>{i.d(t,{A:()=>d});var r=i(35143),n=i(91967),s=i(46053),a=(i(81806),i(76460),i(47249),i(85842)),o=i(69120),l=i(1723),c=i(90992),h=i(9912);let u=class extends n.default{constructor(e){super(e),this.view=null,this.highlightName=l.Tv}add(e){const t=!e||Array.isArray(e)?e:[e];(null===t||void 0===t?void 0:t.length)&&t.forEach((e=>this._highlight(e)))}remove(e){const t=!e||Array.isArray(e)?e:[e];(null===t||void 0===t?void 0:t.length)&&t.forEach((e=>this._removeHighlight(e)))}removeAll(){this.removeAllHandles()}_highlight(e){const t=(0,o.i)(this.view,e.layer);(0,c.Of)(t)&&this.addHandles(t.highlight(e,{name:this.highlightName}),(0,h.getHighlightKeyForFeature)(e))}_removeHighlight(e){e&&this.removeHandles((0,h.getHighlightKeyForFeature)(e))}};(0,r._)([(0,s.MZ)()],u.prototype,"view",void 0),(0,r._)([(0,s.MZ)({constructOnly:!0})],u.prototype,"highlightName",void 0),u=(0,r._)([(0,a.$)("esri.views.draw.support.HighlightHelper")],u);const d=u},61472:(e,t,i)=>{i.r(t),i.d(t,{default:()=>L});var r=i(35143),n=i(54099),s=i(53084),a=i(68134),o=i(46053),l=(i(81806),i(76460),i(85842)),c=i(63733),h=i(86875),u=i(38996),d=i(76940),p=i(71523),f=i(20072),y=i(69120);class v{constructor(e,t,i,r,n){this.graphic=e,this.index=t,this.x=i,this.y=r,this.viewEvent=n,this.type="graphic-click"}}class m{constructor(e,t,i,r,n){this.graphic=e,this.index=t,this.x=i,this.y=r,this.viewEvent=n,this.type="graphic-double-click"}}class g{constructor(e,t,i,r,n,s,a,o,l,c){this.graphic=e,this.allGraphics=t,this.index=i,this.x=r,this.y=n,this.dx=s,this.dy=a,this.totalDx=o,this.totalDy=l,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-start"}preventDefault(){this.defaultPrevented=!0}}class b{constructor(e,t,i,r,n,s,a,o,l,c){this.graphic=e,this.allGraphics=t,this.index=i,this.x=r,this.y=n,this.dx=s,this.dy=a,this.totalDx=o,this.totalDy=l,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move"}preventDefault(){this.defaultPrevented=!0}}class w{constructor(e,t,i,r,n,s,a,o,l,c){this.graphic=e,this.allGraphics=t,this.index=i,this.x=r,this.y=n,this.dx=s,this.dy=a,this.totalDx=o,this.totalDy=l,this.viewEvent=c,this.defaultPrevented=!1,this.type="graphic-move-stop"}preventDefault(){this.defaultPrevented=!0}}class x{constructor(e,t,i,r,n){this.graphic=e,this.index=t,this.x=i,this.y=r,this.viewEvent=n,this.type="graphic-pointer-over"}}class _{constructor(e,t,i,r,n){this.graphic=e,this.index=t,this.x=i,this.y=r,this.viewEvent=n,this.type="graphic-pointer-out"}}class G{constructor(e,t,i,r,n){this.graphic=e,this.index=t,this.x=i,this.y=r,this.viewEvent=n,this.type="graphic-pointer-down"}}class I{constructor(e,t,i,r,n){this.graphic=e,this.index=t,this.x=i,this.y=r,this.viewEvent=n,this.type="graphic-pointer-up"}}var k=i(57308),F=i(91720),T=i(11500);const M="indicator-symbols";let E=class extends n.A.EventedAccessor{constructor(e){super(e),this._activeGraphic=null,this._dragEvent=null,this._hoverGraphic=null,this._indicators=[],this._initialDragGeometry=null,this._manipulators=[],this._layerViews=null,this.type="graphic-mover",this.callbacks={onGraphicClick(){},onGraphicDoubleClick(){},onGraphicMoveStart(){},onGraphicMove(){},onGraphicMoveStop(){},onGraphicPointerOver(){},onGraphicPointerOut(){},onGraphicPointerDown(){},onGraphicPointerUp(){}},this.enableMoveAllGraphics=!1,this.graphics=[],this.indicatorsEnabled=!1,this.layer=new c.default({listMode:"hide",internal:!0,title:"GraphicMover highlight layer"}),this.view=null}initialize(){(0,y.Y)(this.view,this.layer),this._highlightHelper=new f.A({view:this.view}),this.refresh(),this.addHandles([(0,a.watch)((()=>this.graphics.length),(()=>this.refresh())),(0,a.when)((()=>{var e;return null===(e=this.view)||void 0===e?void 0:e.ready}),(()=>{this.addHandles([this.view.on("immediate-click",(e=>this._clickHandler(e)),k.o.TOOL),this.view.on("double-click",(e=>this._doubleClickHandler(e)),k.o.TOOL),this.view.on("pointer-down",(e=>this._pointerDownHandler(e)),k.o.TOOL),this.view.on("pointer-move",(e=>this._pointerMoveHandler(e)),k.o.TOOL),this.view.on("pointer-up",(e=>this._pointerUpHandler(e)),k.o.TOOL),this.view.on("drag",(e=>this._dragHandler(e)),k.o.TOOL),this.view.on("key-down",(e=>this._keyDownHandler(e)),k.o.TOOL)])}),{once:!0,initial:!0}),(0,a.watch)((()=>this.view),(e=>{this._highlightHelper.removeAll(),this._highlightHelper.view=e}))])}destroy(){var e;this._removeIndicators(),null!==(e=this.view.map)&&void 0!==e&&e.remove(this.layer),this.layer.destroy(),this.reset(),this._manipulators.forEach((e=>e.destroy())),this._manipulators=null}set highlightsEnabled(e){var t,i;null!==(t=this._highlightHelper)&&void 0!==t&&t.removeAll(),this._set("highlightsEnabled",e),e&&(null===(i=this._highlightHelper)||void 0===i||i.add(this.graphics))}get state(){const e=this.view.ready,t=this.graphics.length>0,i=this._activeGraphic;return e&&t?i?"moving":"active":e?"ready":"disabled"}refresh(){this.reset(),this._setup()}reset(){this._activeGraphic=null,this._hoverGraphic=null,this._dragEvent=null,this._highlightHelper.removeAll()}updateGeometry(e,t){const i=this.graphics[e];i&&(i.set("geometry",t),this._setUpIndicators())}_setup(){this._setUpHighlights(),this._setUpIndicators(),this._setUpManipulators(),this._syncLayerViews()}_clickHandler(e){const t=this._findTargetGraphic((0,T.ZV)(e));if(t){const i=new v(t,this.graphics.indexOf(t),e.x,e.y,e);this.emit("graphic-click",i),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(i)}}_doubleClickHandler(e){const t=this._findTargetGraphic((0,T.ZV)(e));if(t){const i=new m(t,this.graphics.indexOf(t),e.x,e.y,e);this.emit("graphic-double-click",i),this.callbacks.onGraphicDoubleClick&&this.callbacks.onGraphicDoubleClick(i)}}_pointerDownHandler(e){const t=this._findTargetGraphic((0,T.ZV)(e));if(t){this._activeGraphic=t;const{x:i,y:r}=e,n=new G(t,this.graphics.indexOf(t),i,r,e);this.emit("graphic-pointer-down",n),this.callbacks.onGraphicPointerDown&&this.callbacks.onGraphicPointerDown(n)}else this._activeGraphic=null}_pointerUpHandler(e){if(this._activeGraphic){const{x:t,y:i}=e,r=this.graphics.indexOf(this._activeGraphic),n=new I(this._activeGraphic,r,t,i,e);this.emit("graphic-pointer-up",n),this.callbacks.onGraphicPointerUp&&this.callbacks.onGraphicPointerUp(n)}}_pointerMoveHandler(e){if(this._dragEvent)return;const t=this._findTargetGraphic((0,T.ZV)(e));if(t){const{x:i,y:r}=e;if(this._hoverGraphic){if(this._hoverGraphic===t)return;const n=this.graphics.indexOf(this._hoverGraphic),s=new _(this.graphics[n],n,i,r,e);this._hoverGraphic=null,this.emit("graphic-pointer-out",s),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(s)}const n=this.graphics.indexOf(t),s=new x(t,n,i,r,e);return this._hoverGraphic=t,this.emit("graphic-pointer-over",s),void(this.callbacks.onGraphicPointerOver&&this.callbacks.onGraphicPointerOver(s))}if(this._hoverGraphic){const{x:t,y:i}=e,r=this.graphics.indexOf(this._hoverGraphic),n=new _(this.graphics[r],r,t,i,e);this._hoverGraphic=null,this.emit("graphic-pointer-out",n),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(n)}}_dragHandler(e){var t;if("start"!==e.action&&!this._dragEvent||null===(t=this._activeGraphic)||void 0===t||!t.geometry)return;"start"===e.action&&this._removeIndicators(),e.stopPropagation();const{action:i,x:r,y:n}=e,a=this.graphics.indexOf(this._activeGraphic),o=this._dragEvent?r-this._dragEvent.x:0,l=this._dragEvent?n-this._dragEvent.y:0,c=r-e.origin.x,h=n-e.origin.y,u="start"===i?this._activeGraphic.geometry:this._initialDragGeometry,d=(0,p.lR)(u,c,h,this.view);if(this._activeGraphic.geometry=d,this.enableMoveAllGraphics&&this.graphics.forEach((e=>{e!==this._activeGraphic&&(e.geometry=(0,p.lR)(e.geometry,o,l,this.view))})),this._dragEvent=e,"start"===i){this._initialDragGeometry=(0,s.clone)(u);const t=new g(this._activeGraphic,this.graphics,a,r,n,o,l,c,h,e);this.emit("graphic-move-start",t),this.callbacks.onGraphicMoveStart&&this.callbacks.onGraphicMoveStart(t),t.defaultPrevented&&this._activeGraphic.set("geometry",u)}else if("update"===i){const t=new b(this._activeGraphic,this.graphics,a,r,n,o,l,c,h,e);this.emit("graphic-move",t),this.callbacks.onGraphicMove&&this.callbacks.onGraphicMove(t),t.defaultPrevented&&(this._activeGraphic.geometry=u)}else{const t=new w(this._activeGraphic,this.graphics,a,r,n,o,l,c,h,e);this._dragEvent=null,this._activeGraphic=null,this._setUpIndicators(),this.emit("graphic-move-stop",t),this.callbacks.onGraphicMoveStop&&this.callbacks.onGraphicMoveStop(t),t.defaultPrevented&&(this.graphics[a].set("geometry",this._initialDragGeometry),this._setUpIndicators()),this._initialDragGeometry=null}}_keyDownHandler(e){"a"!==e.key&&"d"!==e.key&&"n"!==e.key||"moving"!==this.state||e.stopPropagation()}_findTargetGraphic(e){const t=this.view.toMap(e),i=this.graphics;let r=null,n=Number.MAX_VALUE;this._syncLayerViews();const s=this._layerViews.flatMap((e=>"graphicsViews"in e?Array.from(e.graphicsViews(),(e=>e.hitTest(t))).flat():e.graphicsView.hitTest(t))).filter((e=>i.includes(e))).sort(((e,t)=>i.indexOf(e)-i.indexOf(t)));return s.length?s[0]:(this._manipulators.forEach((t=>{const i=t.intersectionDistance(e);null!=i&&i<n&&(n=i,r=t.graphic)})),r)}_syncLayerViews(){this._layerViews=[];const e=new Set;for(const t of this.graphics){const i=(0,y.i)(this.view,t.layer);i&&e.add(i)}this._layerViews=[...e]}_setUpManipulators(){const{graphics:e,view:t}=this;this._manipulators.forEach((e=>e.destroy())),this._manipulators=e.length?e.map((e=>new F.l({graphic:e,view:t}))):[]}_setUpHighlights(){this.highlightsEnabled&&this._highlightHelper.add(this.graphics)}_setUpIndicators(){if(this._removeIndicators(),this.indicatorsEnabled){for(const e of this.graphics){const t=e.clone();t.symbol=A(e),this._indicators.push(t),this.addHandles((0,a.watch)((()=>e.symbol),(()=>this._setUpIndicators())),M)}this.layer.addMany(this._indicators)}}_removeIndicators(){this.removeHandles(M),this._indicators.length&&(this.layer.removeMany(this._indicators),this._indicators.forEach((e=>e.destroy())),this._indicators=[])}};function A(e){if(null==e.symbol)return null;switch(e.symbol.type){case"cim":return new d.default({style:"circle",size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case"picture-marker":{const{xoffset:t,yoffset:i,height:r,width:n}=e.symbol,s=r===n?n:Math.max(r,n);return new d.default({xoffset:t,yoffset:i,size:s,style:"square",color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-marker":{const{xoffset:t,yoffset:i,size:r,style:n}=e.symbol;return new d.default({xoffset:t,yoffset:i,style:"circle"===n?"circle":"square",size:r+2,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-fill":return new h.default({color:[0,0,0,0],outline:{style:"dash",color:[255,127,0,1],width:1}});case"simple-line":return new u.default({color:[255,127,0,1],style:"dash",width:1});case"text":{const{xoffset:t,yoffset:i}=e.symbol;return new d.default({xoffset:t,yoffset:i,size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}default:return null}}(0,r._)([(0,o.MZ)()],E.prototype,"_activeGraphic",void 0),(0,r._)([(0,o.MZ)({readOnly:!0})],E.prototype,"type",void 0),(0,r._)([(0,o.MZ)()],E.prototype,"callbacks",void 0),(0,r._)([(0,o.MZ)()],E.prototype,"enableMoveAllGraphics",void 0),(0,r._)([(0,o.MZ)()],E.prototype,"graphics",void 0),(0,r._)([(0,o.MZ)({value:!1})],E.prototype,"highlightsEnabled",null),(0,r._)([(0,o.MZ)()],E.prototype,"indicatorsEnabled",void 0),(0,r._)([(0,o.MZ)()],E.prototype,"layer",void 0),(0,r._)([(0,o.MZ)({readOnly:!0})],E.prototype,"state",null),(0,r._)([(0,o.MZ)()],E.prototype,"view",void 0),E=(0,r._)([(0,l.$)("esri.views.draw.support.GraphicMover")],E);const L=E},71523:(e,t,i)=>{i.d(t,{Cy:()=>o,UT:()=>u,hs:()=>c,lR:()=>l,wW:()=>h});var r=i(15941),n=i(2413),s=i(65391),a=i(5262);function o(e,t,i,r){var n,s;if(null==r||e.hasZ||(r=void 0),"point"===e.type)return e.x+=t,e.y+=i,e.hasZ&&null!=r&&(e.z+=r),e;if("multipoint"===e.type){const n=e.points;for(let e=0;e<n.length;e++)n[e]=d(n[e],t,i,r);return e}if("extent"===e.type)return e.xmin+=t,e.xmax+=t,e.ymin+=i,e.ymax+=i,null!=r&&(null!==(n=e.zmin)&&void 0!==n||(e.zmin=0),e.zmin+=r,null!==(s=e.zmax)&&void 0!==s||(e.zmax=0),e.zmax+=r),e;const o=(0,a.$K)(e),l="polyline"===e.type?e.paths:e.rings;for(let a=0;a<o.length;a++){const e=o[a];for(let n=0;n<e.length;n++)e[n]=d(e[n],t,i,r)}return"paths"in e?e.paths=l:e.rings=l,e}function l(e,t,i,r,n){const s=e.clone(),l=r.resolution;if("point"===s.type){if(n)o(s,t*l,-i*l);else{const e=r.state.transform,n=r.state.inverseTransform,a=e[0]*s.x+e[2]*s.y+e[4],o=e[1]*s.x+e[3]*s.y+e[5];s.x=n[0]*(a+t)+n[2]*(o+i)+n[4],s.y=n[1]*(a+t)+n[3]*(o+i)+n[5]}return s}if("multipoint"===s.type){if(n)o(s,t*l,-i*l);else{const e=s.points,n=r.state.transform,a=r.state.inverseTransform;for(let r=0;r<e.length;r++){const s=e[r],o=n[0]*s[0]+n[2]*s[1]+n[4],l=n[1]*s[0]+n[3]*s[1]+n[5],c=a[0]*(o+t)+a[2]*(l+i)+a[4],h=a[1]*(o+t)+a[3]*(l+i)+a[5];e[r]=p(s,c,h,void 0)}}return s}if("extent"===s.type){if(n)o(s,t*l,-i*l);else{const e=r.state.transform,n=r.state.inverseTransform,a=e[0]*s.xmin+e[2]*s.ymin+e[4],o=e[1]*s.xmin+e[3]*s.ymin+e[5],l=e[0]*s.xmax+e[2]*s.ymax+e[4],c=e[1]*s.xmax+e[3]*s.ymax+e[5];s.xmin=n[0]*(a+t)+n[2]*(o+i)+n[4],s.ymin=n[1]*(a+t)+n[3]*(o+i)+n[5],s.xmax=n[0]*(l+t)+n[2]*(c+i)+n[4],s.ymax=n[1]*(l+t)+n[3]*(c+i)+n[5]}return s}if(n)o(s,t*l,-i*l);else{const e=(0,a.$K)(s),n="polyline"===s.type?s.paths:s.rings,o=r.state.transform,l=r.state.inverseTransform;for(let r=0;r<e.length;r++){const n=e[r];for(let e=0;e<n.length;e++){const r=n[e],s=o[0]*r[0]+o[2]*r[1]+o[4],a=o[1]*r[0]+o[3]*r[1]+o[5],c=l[0]*(s+t)+l[2]*(a+i)+l[4],h=l[1]*(s+t)+l[3]*(a+i)+l[5];n[e]=p(r,c,h,void 0)}}"paths"in s?s.paths=n:s.rings=n}return s}function c(e,t,i,r){if("point"===e.type){const{x:n,y:s}=e,a=r?r[0]:n,o=r?r[1]:s,l=e.clone(),c=(n-a)*t+a,h=(s-o)*i+o;return l.x=c,l.y=h,l}if("multipoint"===e.type){const o=(0,a.$K)(e),l=(0,n.vt)(),[c,h,u,d]=(0,s.Yz)(l,[o]),f=r?r[0]:(c+u)/2,y=r?r[1]:(d+h)/2,v=e.clone(),m=v.points;for(let e=0;e<m.length;e++){const r=m[e],[n,s]=r,a=(n-f)*t+f,o=(s-y)*i+y;m[e]=p(r,a,o,void 0)}return v}if("extent"===e.type){const{xmin:n,xmax:s,ymin:a,ymax:o}=e,l=r?r[0]:(n+s)/2,c=r?r[1]:(o+a)/2,h=e.clone();if(h.xmin=(n-l)*t+l,h.ymax=(o-c)*i+c,h.xmax=(s-l)*t+l,h.ymin=(a-c)*i+c,h.xmin>h.xmax){const e=h.xmin,t=h.xmax;h.xmin=t,h.xmax=e}if(h.ymin>h.ymax){const e=h.ymin,t=h.ymax;h.ymin=t,h.ymax=e}return h}const o=(0,a.$K)(e),l=(0,n.vt)(),[c,h,u,d]=(0,s.Yz)(l,o),f=r?r[0]:(c+u)/2,y=r?r[1]:(d+h)/2,v=e.clone(),m="polyline"===v.type?v.paths:v.rings;for(let n=0;n<o.length;n++){const e=o[n];for(let r=0;r<e.length;r++){const s=e[r],[a,o]=s,l=(a-f)*t+f,c=(o-y)*i+y;m[n][r]=p(s,l,c,void 0)}}return"paths"in v?v.paths=m:v.rings=m,v}function h(e,t,i,r,n,s){const a=Math.sqrt((i-e)*(i-e)+(r-t)*(r-t));return Math.sqrt((n-e)*(n-e)+(s-t)*(s-t))/a}function u(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=Math.atan2(t.y-i.y,t.x-i.x)-Math.atan2(e.y-i.y,e.x-i.x),a=Math.atan2(Math.sin(s),Math.cos(s));return n?a:(0,r.KJ)(a)}function d(e,t,i,r){return p(e,e[0]+t,e[1]+i,null!=e[2]&&null!=r?e[2]+r:void 0)}function p(e,t,i,r){const n=[t,i];return e.length>2&&n.push(null!=r?r:e[2]),e.length>3&&n.push(e[3]),n}}}]);
//# sourceMappingURL=61472.77a95202.chunk.js.map