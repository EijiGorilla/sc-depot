"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[91505,95401],{770:(e,t,a)=>{a.d(t,{bG:()=>s,Ty:()=>o,YJ:()=>u,Fq:()=>c,vt:()=>l});var n=a(53084),i=a(42633);class r{constructor(e){const{name:t,label:a,description:n,schemes:r}=e;this.name=t,this.label=a,this.description=n,this.schemes=r;const s=e.basemapGroups||i.Np;let l=[];Object.keys(s).forEach((e=>{l=l.concat(s[e])})),this.supportedBasemaps=l,this.basemapGroups=s}isBasemapSupported(e){const t=(0,i.T1)(e,this.supportedBasemaps);return!(!t||!this.supportedBasemaps.includes(t))}getRawSchemes(e){const{basemapId:t,basemapTheme:a}=function(e,t,a){let n=null,r=null;if(t&&(n=(0,i.T1)(t,e,!1),n)){const e=(0,i.BV)(n);null!=e&&(r=e)}return!n&&a&&(n="dark"===a?"dark-gray":"gray",r=a),n||r||(n="gray",r="light"),{basemapId:n,basemapTheme:r}}(this.supportedBasemaps,e.basemap,e.basemapTheme);let r=a;if(t){const e=(0,i.BV)(t,this.basemapGroups);null!=e&&(r=e)}let s=e.geometryType;"multipoint"===s?s="point":"mesh"===s&&(s="polygon");const l=this.schemes[s]||this.schemes.default;return{schemesInfo:(0,n.clone)(l[r]),basemapId:t,basemapTheme:a}}}function s(e){const t=e.themeDictionary,a=new Map;for(const n in t){const e=t[n];a.set(n,new r(e))}return a}function l(e,t){const a=[];return e.forEach((e=>{e.isBasemapSupported(t)&&a.push({name:e.name,label:e.label,description:e.description,basemaps:[...e.supportedBasemaps]})})),a}function o(e,t){if(!e)return;if(!t)return;let a=null;const n=[t.primaryScheme,...t.secondarySchemes];for(const r of n){var i;if((null===(i=r.name)||void 0===i?void 0:i.toLowerCase())===e.toLowerCase()){a=r;break}}return a}function u(e,t,a){if(!e&&!t)return[];if(!a)return[];const n=!(null!==e&&void 0!==e&&e.length),i=!(null!==t&&void 0!==t&&t.length),r=[a.primaryScheme,...a.secondarySchemes],s=[];for(const l of r){const a=!!n||e.some((e=>l.tags.includes(e))),r=!i&&t.some((e=>l.tags.includes(e)));a&&!r&&s.push(l)}return s}function c(e){const t=e.theme;if(t)return t.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme})}},17782:(e,t,a)=>{a.r(t),a.d(t,{createRenderer:()=>k,regenerateRenderer:()=>G});var n=a(89379),i=a(59784),r=a(50076),s=a(68002),l=a(47662),o=a(9922),u=a(33766);function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=Math.round(e);if(a<=1)return 1;const n=a.toString().length;for(let i=n-1>=3?3:n-1;i>=0;i--){const n=10**i,r=Math.floor(e/n)*n,s=Math.ceil(e/n)*n,l=Math.round((r+s)/2),o=Math.abs(e-r)/e*100,u=Math.abs(e-s)/e*100,c=Math.abs(e-l)/e*100,d=Math.min(o,u,c);if(d<=t){if(d===o){a=r;break}if(d===u){a=s;break}if(d===c){a=l;break}}}return a}var d=a(53680),m=a(51006),p=a(16525),f=a(53986),y=a(28383),h=a(90494),b=a(42633),g=a(11563);const v=["layer"],w=["layerAdapter"];async function S(e){const t=await async function(e){if(!(e&&e.layer&&e.attributes))throw new r.default("summary-statistics-for-attributes:missing-parameters","'layer' and 'attributes' parameters are required");if(e.attributes.some((e=>!!e.valueExpression))&&!e.view)throw new r.default("summary-statistics-for-attributes:missing-parameters","View is required when 'valueExpression' is specified in attributes");e.forBinning&&(0,h.p)(e,"summary-statistics-for-attributes");const{layer:t}=e,a=(0,f.A)(e,v),i=[g.mb.CSVLayer,g.mb.FeatureLayer,g.mb.OGCFeatureLayer,g.mb.GeoJSONLayer,g.mb.KnowledgeGraphSublayer,g.mb.ParquetLayer,g.mb.WFSLayer],s=e.forBinning?g.Mi:i,l=(0,g.Jg)(t,s,e.forBinning);if(!l)throw new r.default("summary-statistics-for-attributes:invalid-parameters","'layer' must be one of these types: "+(0,g.Ho)(s).join(", "));const o=(0,n.A)({layerAdapter:l},a);o.includeZeros=null==o.includeZeros||o.includeZeros,o.includeNegatives=null==o.includeNegatives||o.includeNegatives;const u=o.view,c=null!=o.signal?{signal:o.signal}:null;await Promise.all([null===u||void 0===u?void 0:u.when(),l.load(c)]);const d=[];for(const n of o.attributes){const e=await(0,b.EG)({field:n.field,valueExpression:n.valueExpression});Array.prototype.push.apply(d,e)}const m=(0,y.MH)(l,d,"summary-statistics-for-attributes:invalid-parameters");if(m)throw m;return o}(e),{layerAdapter:a}=t,i=(0,f.A)(t,w),s=(0,y.D9)(i.attributes,i.includeZeros,i.includeNegatives);return a.summaryStatistics({valueExpression:s.valueExpression,sqlExpression:s.sqlExpression,sqlWhere:s.sqlWhere,view:i.view,filter:i.filter,outStatisticTypes:b.XR,signal:i.signal})}var E=a(98976);function x(e,t,a){return null!=e&&isFinite(e)&&(null===t||void 0===t||t||0!==e)&&(null===a||void 0===a||a||e>=0)}async function T(e){var t;const{features:a,attributes:n,includeZeros:i,includeNegatives:r,view:s}=e;let l=0,o=0,u=1/0,c=-1/0,d=null;const m=new Map;for(let y=0;y<n.length;y++){const{valueExpression:e}=n[y];if(e){if(!d){const{arcadeUtils:e}=await(0,E.lw)();d=e}m.set(y,d.createFunction(e))}}const p=s?null===(t=d)||void 0===t?void 0:t.getViewInfo({viewingMode:"2d"===s.type?"map":s.viewingMode,scale:s.scale,spatialReference:s.spatialReference}):null;for(const y of a){const e=y.geometry,t=y.attributes;if(e){const a=e.extent;if(a){const e=a.width*a.height;if(e>0){var f;let a=0;const h=null===(f=d)||void 0===f?void 0:f.createExecContext(y,p,null===s||void 0===s?void 0:s.timeZone);for(let e=0;e<n.length;e++){const{field:s,valueExpression:l}=n[e];let o=null;if(s)o=t[s];else if(l){const t=m.get(e);o=d.executeFunction(t,h)}x(o,i,r)&&(a+=o||0)}if(x(a,i,r)){const t=a/e;++l,o+=t,t<u&&(u=t),t>c&&(c=t)}}}}}return{minDensity:u!==1/0?u:null,maxDensity:c!==-1/0?c:null,avgDensity:l?o/l:null}}var V=a(91505);const B=500;async function I(e){var t,a,i;const s=e.view;if(!(null!==e&&void 0!==e&&e.layer&&s&&null!==(t=e.attributes)&&void 0!==t&&t.length))throw new r.default("dot-density-renderer:missing-parameters","'layer', 'view' and 'attributes' parameters are required");if(e.attributes.length>8)throw new r.default("dot-density-renderer:invalid-parameters","Dot density renderer does not support more than 8 attributes");e.forBinning&&(0,h.p)(e,"dot-density-renderer");const l=(0,n.A)((0,n.A)({},e),{},{view:s,layer:e.layer,attributes:e.attributes}),o=[g.mb.FeatureLayer,g.mb.ParquetLayer,g.mb.KnowledgeGraphSublayer,g.mb.OGCFeatureLayer,g.mb.GeoJSONLayer,g.mb.WFSLayer],u=e.forBinning?g.Mi:o,c=(0,g.Jg)(l.layer,u,e.forBinning);if(!c)throw new r.default("dot-density-renderer:invalid-parameters","'layer' must be one of these types: "+(0,g.Ho)(u).join(", "));null!==(a=l.dotBlendingEnabled)&&void 0!==a||(l.dotBlendingEnabled=!0),null!==(i=l.dotValueOptimizationEnabled)&&void 0!==i||(l.dotValueOptimizationEnabled=!0);const d=null!=l.signal?{signal:l.signal}:null;if(await Promise.all([s.when(),c.load(d)]),"polygon"!==c.geometryType)throw new r.default("dot-density-renderer:not-supported","Dot density renderer is supported for polygon layers only");const p=[],f=l.attributes;for(const n of f){const e=await(0,b.EG)({field:n.field,valueExpression:n.valueExpression});p.push(...e)}const y=(0,m.MH)(c,p.filter(Boolean),"dot-density-renderer:invalid-parameters");if(y)throw y;return(0,n.A)((0,n.A)({},l),{},{layer:c})}function A(e){return{dotValue:1,referenceScale:e.scale,minSliderValue:1,maxSliderValue:100}}async function D(e){const{view:t,layer:a,attributes:n,signal:i,filter:r}=e,l=await a.getSampleFeatures({view:t,sampleSize:B,returnGeometry:!0,filter:r,signal:i},"json"),[o,u]=await Promise.all([(0,p.A)({features:l,geometryType:a.geometryType}),S({layer:a,attributes:n,filter:r,includeZeros:!1,includeNegatives:!1,view:t,signal:i})]),d=null!=o&&"avgSize"in o&&o.avgSize,m=u.avg;if(!d||!m)return A(t);const f=(0,s.i1)(t.scale,t.spatialReference);return{dotValue:c(m/(d*d/(f*f)*.1))||1,referenceScale:t.scale,minSliderValue:1,maxSliderValue:c(m)}}async function O(e){const{view:t,layer:a,attributes:n,signal:i,filter:r}=e,l=[];for(const s of n){const e=await(0,b.EG)({field:s.field,valueExpression:s.valueExpression});l.push(...e)}const o=await a.getSampleFeatures({view:t,sampleSize:B,requiredFields:l,filter:r,returnGeometry:!0,signal:i},"json"),{minDensity:u,maxDensity:d,avgDensity:m}=await T({features:o,attributes:n,includeZeros:!1,includeNegatives:!1,view:t});if(!m||!u||!d)return A(t);const p=(0,s.i1)(t.scale,t.spatialReference),f=p*p,y=c(u*f),h=c(d*f);let g=c(m*f*10)||1;return g>h&&(g=h),{dotValue:g,referenceScale:t.scale,minSliderValue:y,maxSliderValue:h}}async function k(e){const t=await I(e),a=t.layer,n=a.geometryType,s=await async function(e){let t=e.dotDensityScheme,a=null,n=null;const i=await(0,m.Ib)(e.basemap,e.view);if(a=null!=i.basemapId?i.basemapId:null,n=null!=i.basemapTheme?i.basemapTheme:null,t)return{scheme:(0,V.cloneScheme)(t),basemapId:a,basemapTheme:n};const r=(0,V.getSchemes)({numColors:e.attributes.length,basemapTheme:n});return r&&(t=r.primaryScheme,a=r.basemapId,n=r.basemapTheme),{scheme:t,basemapId:a,basemapTheme:n}}(t),c=null===s||void 0===s?void 0:s.scheme;if(!c)throw new r.default("dot-density-renderer:insufficient-info","Unable to find dot-density scheme");const d=t.view,p=t.filter,f={layer:a,view:d,filter:p,attributes:t.attributes,signal:t.signal},y={layer:t.layer,view:d,filter:p,signal:t.signal},[h,b]=await Promise.all([t.trueDensity?O(f):D(f),t.outlineOptimizationEnabled?(0,u.A)(y).catch(m.ou):null]),{dotValue:g,referenceScale:v,minSliderValue:w,maxSliderValue:S}=h,E=(0,i.Iy)(c.colors,t.attributes.length),x=t.attributes.map(((e,t)=>({field:e.field,valueExpression:e.valueExpression,label:e.label,valueExpressionTitle:e.valueExpressionTitle,color:E[t]}))),T=new l.default({attributes:x,dotBlendingEnabled:t.dotBlendingEnabled,outline:b?(0,m.qc)(c,n,b.opacity):null,dotValue:g,referenceScale:t.dotValueOptimizationEnabled?v:null,legendOptions:t.legendOptions});return null!==b&&void 0!==b&&b.visualVariables.length&&(T.visualVariables=b.visualVariables.map((e=>e.clone()))),T.authoringInfo=new o.default({type:"dot-density",minSliderValue:w,maxSliderValue:S}),{renderer:T,dotDensityScheme:c,basemapId:s.basemapId,basemapTheme:s.basemapTheme}}async function G(e){const{creatorParameters:t,renderer:a}=await async function(e){const t="regenerate-dot-density-renderer";await(0,d.AC)(e,t);const a=await(0,d.mE)(e);if("dot-density"!==(0,d.UJ)(a))throw new r.default("".concat(t,":invalid-parameters"),"Renderer is invalid");const{layer:i,forBinning:s,filter:l,view:o,signal:u}=e,c=(0,d.DW)(a),m=a.attributes.map((e=>({field:e.field,valueExpression:e.valueExpression,label:e.label,valueExpressionTitle:e.valueExpressionTitle}))),p=await I({layer:i,attributes:m,dotValueOptimizationEnabled:null!=a.referenceScale,outlineOptimizationEnabled:c,forBinning:s,filter:l,view:o,signal:u});return(0,n.A)((0,n.A)({},e),{},{creatorParameters:p,renderer:a})}(e),{layer:i,attributes:s,outlineOptimizationEnabled:l,view:o,signal:c,filter:p}=t,f={layer:i,view:o,filter:p,attributes:s,signal:c},[y,h]=await Promise.all([t.trueDensity?O(f):D(f),l?(0,u.A)({layer:i,view:o,signal:c,filter:p}).catch(m.ou):null]),{dotValue:b,referenceScale:g,minSliderValue:v,maxSliderValue:w}=y;return a.dotValue=b,a.referenceScale=t.dotValueOptimizationEnabled?g:null,a.authoringInfo&&(a.authoringInfo.minSliderValue=v,a.authoringInfo.maxSliderValue=w),(0,d.ke)(a,null===h||void 0===h?void 0:h.visualVariables,d._i),{renderer:a}}},91505:(e,t,a)=>{a.r(t),a.d(t,{cloneScheme:()=>h,getSchemeByName:()=>f,getSchemes:()=>p,getSchemesByTag:()=>y,getThemes:()=>m});var n=a(89379),i=a(69539),r=a(18690),s=a(59784),l=a(89132),o=a(770);const u={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"}},c=["vibrant-rainbow","cat-dark","predominant-v2","predominant-v1","predominance-race","desert-blooms","tropical-bliss","under-the-sea","ocean-bay","cat-light","predominant-v4","predominance-money","predominant-v3","predominance-race-ethnic","pastel-chalk","predominance-rainbow","predominance-sequence","cat-popup-olympic-sunset"],d=(0,o.bG)({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for visualizing features using the density of randomly placed dots.",schemes:{default:{light:{primary:"predominant-v5",secondary:c,common:{outline:u.light,fillOpacity:.8}},dark:{primary:"predominant-v5",secondary:c,common:{outline:u.dark,fillOpacity:.8}}}}}}});function m(e){return(0,o.vt)(d,e)}function p(e){const t=(0,o.Fq)({basemap:e.basemap,basemapTheme:e.basemapTheme,theme:d.get("default")});if(!t)return;const{schemesInfo:a,basemapId:n,basemapTheme:i}=t,s=a.common,l=e.numColors;return{primaryScheme:b(a.primary,s,l),secondarySchemes:a.secondary.map((e=>b(e,s,l))).filter(r.Ru),basemapId:n,basemapTheme:i}}function f(e){return(0,o.Ty)(e.name,p(e))}function y(e){return(0,o.YJ)(e.includedTags,e.excludedTags,p(e))}function h(e){if(!e)return;const t=(0,n.A)({},e);return t.tags=[...t.tags],t.colors&&(t.colors=t.colors.map((e=>new i.default(e)))),t.outline&&(t.outline={color:t.outline.color&&new i.default(t.outline.color),width:t.outline.width}),t}function b(e,t,a){const n=l.A[e];if(n)return function(e){return{name:e.name,tags:[...e.tags],colors:e.colors.map((e=>new i.default(e))),outline:{color:new i.default(e.outline.color),width:e.outline.width},opacity:e.opacity}}({name:n.name,tags:n.tags,colors:n[a]||(0,s.Iy)(n.stops,a),opacity:t.fillOpacity,outline:t.outline})}}}]);
//# sourceMappingURL=95401.da5a6ae2.chunk.js.map