"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[13888,57274],{13888:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var o=s(35143),r=s(46053),l=(s(81806),s(76460),s(47249),s(85842)),i=s(25329);const n="esri-search-result-renderer",a={base:n,showMoreResults:"".concat(n,"__more-results--show-more-results"),moreResults:"".concat(n,"__more-results"),moreResultsList:"".concat(n,"__more-results-list"),moreResultsHeader:"".concat(n,"__more-results-header"),moreResultsItem:"".concat(n,"__more-results-item"),moreResultsListHeader:"".concat(n,"__more-results-list-header")};var u=s(97537),c=s(98108),d=s(20459),h=s(63582),v=s(54761);s(76099);let p=class extends i.default{constructor(e,t){super(e,t),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}destroy(){this.viewModel=null}render(){const e={[a.showMoreResults]:this.showMoreResultsOpen};return(0,v.K)("div",{class:this.classes(a.base,c.D.widget)},(0,v.K)("div",{class:this.classes(a.moreResults,e),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return(0,v.K)("div",{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){var e;const t=null===(e=this.viewModel)||void 0===e?void 0:e.selectedResult,s=(null===t||void 0===t?void 0:t.name)||"";return(0,v.K)("div",{class:a.moreResultsItem,key:"esri-search-renderer__result-name"},s)}_renderMoreResultsLists(){var e;const{viewModel:t}=this;if(!t)return[];const s=t.results;if((null!==(e=t.resultCount)&&void 0!==e?e:0)<2)return null;const o=null===s||void 0===s?void 0:s.map((e=>this._renderMoreResultsList(e)));return(0,v.K)("div",{class:a.moreResultsList,key:"esri-search-renderer__more-results-container"},o)}_renderMoreResultsButton(){var e;const{messages:t,viewModel:s}=this;return s?(null!==(e=s.resultCount)&&void 0!==e?e:0)<2?null:(0,v.K)("div",{class:a.moreResultsItem,key:"esri-search-renderer__more-results-button"},(0,v.K)("a",{bind:this,class:c.D.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?t.hideMoreResults:t.showMoreResults)):null}_renderMoreResultsHeader(e,t){return(0,v.K)("div",{class:a.moreResultsListHeader,key:"esri-search-result-renderer__header-".concat(t)},e)}_renderMoreResultsList(e){var t,s,o,r;const{results:l}=e,i=null!==(t=null===l||void 0===l?void 0:l.length)&&void 0!==t?t:0,n=i>0,a=null===(s=this.viewModel)||void 0===s?void 0:s.selectedResult,u=1===i&&l[0]===a,c=this._getSourceName(e.source,e.sourceIndex),d=(null!==(o=null===(r=this.viewModel)||void 0===r||null===(r=r.results)||void 0===r?void 0:r.length)&&void 0!==o?o:0)>1&&!u?this._renderMoreResultsHeader(c,e.sourceIndex):null,h=n&&l.map(((e,t)=>this._renderMoreResultsListItem(e,t))),p=n&&!u?(0,v.K)("ul",{key:"esri-search-result-renderer__list-".concat(e.sourceIndex)},h):null;return n?(0,v.K)("div",{key:"esri-search-result-renderer__results-".concat(e.sourceIndex)},d,p):null}_renderMoreResultsListItem(e,t){var s;return e!==(null===(s=this.viewModel)||void 0===s?void 0:s.selectedResult)?(0,v.K)("li",{key:"esri-search-result-renderer__list-item-".concat(t)},(0,v.K)("a",{bind:this,class:c.D.anchor,"data-result":e,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},e.name)):null}_showMoreResultsClick(e){var t;e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const s=null===(t=this.viewModel)||void 0===t||null===(t=t.view)||void 0===t?void 0:t.popup;s&&"reposition"in s&&s.reposition()}_selectResultClick(e){var t;e.preventDefault();const s=e.currentTarget["data-result"];null===(t=this.viewModel)||void 0===t||t.select(s)}_getSourceName(e,t){return t===u.default.ALL_INDEX?this.messages.all:e.name}};(0,o._)([(0,r.MZ)(),(0,h.G)("esri/widgets/Search/t9n/Search")],p.prototype,"messages",void 0),(0,o._)([(0,r.MZ)()],p.prototype,"showMoreResultsOpen",void 0),(0,o._)([(0,r.MZ)()],p.prototype,"viewModel",void 0),(0,o._)([(0,d.$)()],p.prototype,"_showMoreResultsClick",null),(0,o._)([(0,d.$)()],p.prototype,"_selectResultClick",null),p=(0,o._)([(0,l.$)("esri.widgets.Search.SearchResultRenderer")],p);const _=p},57274:(e,t,s)=>{s.r(t),s.d(t,{default:()=>C});var o=s(35143),r=(s(11265),s(63241)),l=s(76460),i=s(30726),n=s(50346),a=s(68134),u=s(52394),c=s(46053),d=(s(81806),s(47249),s(85842)),h=s(25329);const v="esri-search",p={base:v,autocomplete:"".concat(v,"__autocomplete"),dropdown:"".concat(v,"__dropdown"),container:"".concat(v,"__container"),form:"".concat(v,"__form")};var _=s(13888),g=s(97537),m=s(94126),M=s(98108),w=(s(76099),s(63582)),b=s(12254),S=s(54761),y=s(39348);let R=class extends h.default{constructor(e,t){super(e,t),this._currentLocationValue="".concat(this.id,"-search-use-current-location"),this._autocompleteNode=null,this._focusAbortController=null,this._searchResultRenderer=new _.default,this._suggestController=null,this._searchController=null,this._lastSearchTerm="",this._locateFailed=!1,this._showNoResults=!1,this.disabled=!1,this.messages=null,this.messagesCommon=null,this.viewModel=new g.default,this._renderSearchResultsContent=()=>this._searchResultRenderer,this.addHandles([(0,a.watch)((()=>this.viewModel),(e=>this._searchResultRenderer.viewModel=e),a.initial),(0,a.watch)((()=>this.viewModel.results),(()=>this._searchResultRenderer.showMoreResultsOpen=!1)),(0,a.watch)((()=>{var e;return null===(e=this.viewModel)||void 0===e?void 0:e.defaultPopupTemplate}),(e=>{e&&(e.content=this._renderSearchResultsContent)}),a.initial)])}loadDependencies(){return(0,m.W)({autocomplete:()=>Promise.all([s.e(46870),s.e(38841),s.e(19637)]).then(s.bind(s,19637)),"autocomplete-item-group":()=>s.e(64767).then(s.bind(s,64767)),"autocomplete-item":()=>s.e(5065).then(s.bind(s,5065)),button:()=>Promise.resolve().then(s.bind(s,43285)),dropdown:()=>Promise.resolve().then(s.bind(s,24482)),"dropdown-group":()=>Promise.resolve().then(s.bind(s,5368)),"dropdown-item":()=>Promise.resolve().then(s.bind(s,84660)),notice:()=>s.e(12261).then(s.bind(s,12261))})}destroy(){var e;this._cancelQueries(),this._searchResultRenderer=(0,i.pR)(this._searchResultRenderer),null===(e=this._focusAbortController)||void 0===e||e.abort()}get _isDisabled(){const{state:e}=this.viewModel;return"disabled"===e||"loading"===e||this.disabled}get _showCurrentLocation(){var e;return this.locationEnabled&&!(null!==(e=this.searchTerm)&&void 0!==e&&e.trim())}get _effectiveActiveMenu(){const{activeMenu:e}=this;return this._isDisabled?"none":"warning"===e?"suggestion":e}get activeMenu(){return"none"}set activeMenu(e){"warning"===e&&(0,r.ck)(l.A.getLogger(this),"activeMenu","warning",{replacement:"Use the value 'suggestion' instead",version:"4.32",warnOnce:!0}),this._overrideIfSome("activeMenu",e)}get activeSource(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(e){this.viewModel.activeSourceIndex=e}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(e){this.viewModel.allPlaceholder=e}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(e){this.viewModel.autoNavigate=e}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(e){this.viewModel.autoSelect=e}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return"search"}set icon(e){this._overrideIfSome("icon",e)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(e){this.viewModel.includeDefaultSources=e}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(e){this.viewModel.locationEnabled=e}get maxResults(){return this.viewModel.maxResults}set maxResults(e){this.viewModel.maxResults=e}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(e){this.viewModel.maxSuggestions=e}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(e){this.viewModel.minSuggestCharacters=e}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get portal(){var e;return null===(e=this.viewModel)||void 0===e?void 0:e.portal}set portal(e){this.viewModel&&(this.viewModel.portal=e)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(e){this.viewModel.resultGraphic=e}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(e){this.viewModel.resultGraphicEnabled=e}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(e){this.viewModel.searchAllEnabled=e}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(e){this.viewModel.searchTerm=e}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(e){this.viewModel.sources=e}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(e){this.viewModel.suggestionsEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}clear(){this._locateFailed=!1,this.viewModel.clear()}focus(){this._handleFocus(),this._emitFocus()}blur(){var e;null!==(e=this._autocompleteNode)&&void 0!==e&&e.blur(),this._emitBlur()}async search(e){this._cancelQueries();const t=new AbortController,{signal:s}=t;this._searchController=t;try{const o=await this.viewModel.search(e,{signal:s});if(this._searchController!==t)return;return null!==o&&void 0!==o&&o.numResults||(this._showNoResults=!0,this.activeMenu="suggestion"),this._searchController=null,o}catch(o){if(this._searchController!==t)return;return void(this._searchController=null)}}async suggest(e){this._cancelSuggest();const t=new AbortController,{signal:s}=t;this._suggestController=t;try{const o=await this.viewModel.suggest(e,null,{signal:s});if(this._suggestController!==t)return;return this._suggestController=null,null!==o&&void 0!==o&&o.numResults&&(this.activeMenu="suggestion",this._scrollToTopSuggestion()),o}catch(o){return this._suggestController!==t||(this._suggestController=null),null}}render(){return(0,S.K)("div",{class:this.classes(p.base,M.D.widget)},(0,S.K)("div",{class:p.container},this._renderSourcesMenu(),this._renderForm()))}_handleInputKeydown(e){"Tab"===e.key&&this._cancelSuggest()}_emitFocus(){this.emit("search-focus")}_emitBlur(){this.emit("search-blur")}async _handleFocus(){var e,t;null!==(e=this._focusAbortController)&&void 0!==e&&e.abort(),this._focusAbortController=new AbortController;const s=this._focusAbortController.signal;await(0,n.ignoreAbortErrors)((0,u.waitAnimationFrame)(s)),null===(t=this._autocompleteNode)||void 0===t||t.setFocus()}_renderSourcesMenu(){const{messages:e,_isDisabled:t,_effectiveActiveMenu:s}=this,{allSources:o,searchAllEnabled:r}=this.viewModel;return o.length>1?(0,S.K)("calcite-dropdown",{bind:this,class:p.dropdown,disabled:t,open:"source"===s,overlayPositioning:"fixed",onCalciteDropdownClose:this._handleSourceClose,onCalciteDropdownOpen:this._handleSourceOpen,onCalciteDropdownSelect:this._handleSourceSelect},(0,S.K)("calcite-button",{appearance:"outline-fill",iconStart:"caret-down",kind:"neutral",label:e.searchIn,slot:"trigger"}),(0,S.K)("calcite-dropdown-group",{groupTitle:e.searchIn},r?this._renderSource(g.default.ALL_INDEX):null,o.map(((e,t)=>this._renderSource(t))).toArray())):null}_renderUseCurrentLocation(){const{_currentLocationValue:e}=this;return(0,S.K)("calcite-autocomplete-item",{heading:this.messages.useCurrentLocation,iconStart:"gps-on",key:e,value:e})}_handleAutocompleteCreate(e){this._autocompleteNode=e}_handleCalciteAutocompleteTextInput(e){const t=e.target.inputValue;t!==this.viewModel.searchTerm&&(this.viewModel.searchTerm=t,t||this.clear(),this.suggest())}_handleAutocompleteOpen(){this.activeMenu="suggestion"}_handleAutocompleteClose(){"suggestion"===this.activeMenu&&(this.activeMenu="none")}_handleCalciteAutocompleteChange(e){var t;const s=e.target.value;if(s===this._currentLocationValue)return void this._useCurrentLocation();const o=null===(t=this.viewModel.suggestions)||void 0===t?void 0:t.flatMap((e=>{var t;return null!==(t=e.results)&&void 0!==t?t:[]})),r=null===o||void 0===o?void 0:o.find((e=>"".concat(e.key)=="".concat(s)));r&&this.search(r)}_renderAutocomplete(){var e,t;const{_effectiveActiveMenu:s,messages:o,_isDisabled:r}=this,{maxInputLength:l,placeholder:i,searchTerm:n,state:a}=this.viewModel,u=null!==(e=null!==(t=this.label)&&void 0!==t?t:o.searchButtonTitle)&&void 0!==e?e:"";return(0,S.K)("calcite-autocomplete",{afterCreate:this._handleAutocompleteCreate,autocomplete:"off",bind:this,class:p.autocomplete,disabled:r,icon:this.icon,inputValue:n,label:u,loading:"searching"===a,maxLength:l,name:this.id,onblur:this._emitBlur,onfocus:this._emitFocus,onkeydown:this._handleInputKeydown,open:"suggestion"===s,overlayPositioning:"fixed",placeholder:i,title:n?"":i,onCalciteAutocompleteChange:this._handleCalciteAutocompleteChange,onCalciteAutocompleteClose:this._handleAutocompleteClose,onCalciteAutocompleteOpen:this._handleAutocompleteOpen,onCalciteAutocompleteTextChange:this._handleCalciteAutocompleteTextInput,onCalciteAutocompleteTextInput:this._handleCalciteAutocompleteTextInput},this._renderSuggestions(),this._renderNotices())}_renderForm(){return(0,S.K)("form",{bind:this,class:p.form,disabled:this._isDisabled,key:p.form,onsubmit:this._formSubmit,role:"search"},this._renderAutocomplete())}_renderSuggestGroup(e){var t;return null===(t=e.results)||void 0===t?void 0:t.map((e=>this._renderSuggestion(e)))}_renderSuggestions(){const{suggestions:e}=this.viewModel;return this._showNoResults?null:this._showCurrentLocation?this._renderUseCurrentLocation():null===e||void 0===e?void 0:e.map((e=>this._renderSuggestResults(e)))}_renderSuggestResults(e){var t;const{allSources:s,activeSourceIndex:o}=this.viewModel,{sourceIndex:r}=e,l=null===(t=e.results)||void 0===t?void 0:t.length,i=s.length>1&&o===g.default.ALL_INDEX,n=this._getSourceName(r);return l&&i?(0,S.K)("calcite-autocomplete-item-group",{heading:n,key:"suggestion-group-".concat(n,"-").concat(r)},this._renderSuggestGroup(e)):this._renderSuggestGroup(e)}_renderSuggestion(e){var t;return(0,S.K)("calcite-autocomplete-item",{heading:null!==(t=e.text)&&void 0!==t?t:this.messages.untitledResult,key:"suggestion_".concat(e.key),value:"".concat(e.key)})}_renderSource(e){const t=this._getSourceName(e);return(0,S.K)("calcite-dropdown-item",{"data-source-index":"".concat(e),key:"source-".concat(t,"-").concat(e),selected:e===this.viewModel.activeSourceIndex},t)}_renderNoResultsWarning(e){const{messages:t}=this,s=e?(0,y.V)(t.noResultsFoundForValue,{value:'"'.concat(e,'"')}):t.noResultsFound;return(0,S.K)("calcite-notice",{icon:"exclamation-mark-triangle",key:"no-results-warning",kind:"warning",open:!0,slot:"content-bottom"},(0,S.K)("div",{slot:"title"},t.noResults),(0,S.K)("div",{slot:"message"},s))}_renderLocateError(){return(0,S.K)("calcite-notice",{icon:"exclamation-mark-circle",key:"locate-warning",kind:"danger",open:!0,slot:"content-bottom"},(0,S.K)("div",{slot:"message"},this.messages.locateError))}_renderNotices(){var e;return this._locateFailed?this._renderLocateError():this._showNoResults?this._renderNoResultsWarning(null!==(e=this._lastSearchTerm)&&void 0!==e?e:this.viewModel.searchTerm):null}async _useCurrentLocation(){this._cancelQueries();const e=new AbortController,{signal:t}=e;this._searchController=e;try{await this.viewModel.searchNearby({signal:t})}catch(v){(0,n.isAbortError)(v)||(this._locateFailed=!0)}finally{this._searchController=null}}_handleSourceOpen(){this.activeMenu="source"}_handleSourceClose(){"source"===this.activeMenu&&(this.activeMenu="none")}_handleSourceSelect(e){const t=e.target.selectedItems[0].getAttribute("data-source-index");t&&(this.viewModel.activeSourceIndex=parseInt(t,10))}_cancelSuggest(){this.activeMenu="none",this._locateFailed=!1,this._showNoResults=!1,this._suggestController=(0,i.DC)(this._suggestController)}_cancelQueries(){this._cancelSuggest(),this._searchController=(0,i.DC)(this._searchController)}_scrollToTopSuggestion(){var e;null===(e=this._autocompleteNode)||void 0===e||e.scrollContentTo({top:0})}_formSubmit(e){e.preventDefault(),this.activeMenu="none",this._lastSearchTerm=this.searchTerm,this.searchTerm&&this.search()}_getSourceName(e){const{messages:t}=this,{allSources:s}=this.viewModel,o=s.at(e);return e===g.default.ALL_INDEX?t.all:(null===o||void 0===o?void 0:o.name)||t.untitledSource}};(0,o._)([(0,c.MZ)()],R.prototype,"_locateFailed",void 0),(0,o._)([(0,c.MZ)()],R.prototype,"_showNoResults",void 0),(0,o._)([(0,c.MZ)()],R.prototype,"_isDisabled",null),(0,o._)([(0,c.MZ)()],R.prototype,"_showCurrentLocation",null),(0,o._)([(0,c.MZ)()],R.prototype,"_effectiveActiveMenu",null),(0,o._)([(0,c.MZ)()],R.prototype,"activeMenu",null),(0,o._)([(0,c.MZ)({readOnly:!0})],R.prototype,"activeSource",null),(0,o._)([(0,c.MZ)()],R.prototype,"activeSourceIndex",null),(0,o._)([(0,c.MZ)()],R.prototype,"allPlaceholder",null),(0,o._)([(0,c.MZ)({readOnly:!0})],R.prototype,"allSources",null),(0,o._)([(0,c.MZ)()],R.prototype,"autoNavigate",null),(0,o._)([(0,c.MZ)()],R.prototype,"autoSelect",null),(0,o._)([(0,c.MZ)({readOnly:!0})],R.prototype,"defaultSources",null),(0,o._)([(0,c.MZ)()],R.prototype,"disabled",void 0),(0,o._)([(0,c.MZ)()],R.prototype,"goToOverride",null),(0,o._)([(0,c.MZ)()],R.prototype,"icon",null),(0,o._)([(0,c.MZ)()],R.prototype,"includeDefaultSources",null),(0,o._)([(0,c.MZ)()],R.prototype,"label",null),(0,o._)([(0,c.MZ)()],R.prototype,"locationEnabled",null),(0,o._)([(0,c.MZ)()],R.prototype,"maxResults",null),(0,o._)([(0,c.MZ)()],R.prototype,"maxSuggestions",null),(0,o._)([(0,c.MZ)(),(0,w.G)("esri/widgets/Search/t9n/Search")],R.prototype,"messages",void 0),(0,o._)([(0,c.MZ)(),(0,w.G)("esri/t9n/common")],R.prototype,"messagesCommon",void 0),(0,o._)([(0,c.MZ)()],R.prototype,"minSuggestCharacters",null),(0,o._)([(0,c.MZ)()],R.prototype,"popupEnabled",null),(0,o._)([(0,c.MZ)()],R.prototype,"popupTemplate",null),(0,o._)([(0,c.MZ)()],R.prototype,"portal",null),(0,o._)([(0,c.MZ)()],R.prototype,"resultGraphic",null),(0,o._)([(0,c.MZ)()],R.prototype,"resultGraphicEnabled",null),(0,o._)([(0,c.MZ)({readOnly:!0})],R.prototype,"results",null),(0,o._)([(0,c.MZ)()],R.prototype,"searchAllEnabled",null),(0,o._)([(0,c.MZ)()],R.prototype,"searchTerm",null),(0,o._)([(0,c.MZ)({readOnly:!0})],R.prototype,"selectedResult",null),(0,o._)([(0,c.MZ)()],R.prototype,"sources",null),(0,o._)([(0,c.MZ)({readOnly:!0})],R.prototype,"suggestions",null),(0,o._)([(0,c.MZ)()],R.prototype,"suggestionsEnabled",null),(0,o._)([(0,c.MZ)()],R.prototype,"view",null),(0,o._)([(0,b.U)(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),(0,c.MZ)({type:g.default})],R.prototype,"viewModel",void 0),R=(0,o._)([(0,d.$)("esri.widgets.Search")],R);const C=R}}]);
//# sourceMappingURL=57274.e2897414.chunk.js.map