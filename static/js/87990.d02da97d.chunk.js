"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[87990],{76281:(e,i,a)=>{a.r(i),a.d(i,{cloneScheme:()=>w,getSchemes:()=>z,getThemes:()=>h});var n=a(89379),r=a(69539),l=a(770),o=a(80791);const t=[128,128,128,1],s=[128,128,128,1],d="4px",u="40px",m={primary:{color:[227,139,79,1],noDataColor:t,outline:{color:[255,255,255,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:d,maxSize:u,opacity:.8},secondary:[{color:[128,128,128,1],noDataColor:t,outline:{color:[255,255,255,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:d,maxSize:u,opacity:.8},{color:[255,255,255,1],noDataColor:t,outline:{color:[128,128,128,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:d,maxSize:u,opacity:.8}]},c={primary:{color:[227,139,79,1],noDataColor:s,outline:{color:[92,92,92,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:d,maxSize:u,opacity:.8},secondary:[{color:[178,178,178,1],noDataColor:s,outline:{color:[92,92,92,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:d,maxSize:u,opacity:.8},{color:[26,26,26,1],noDataColor:s,outline:{color:[128,128,128,.25],width:"1px"},noDataSize:"4px",size:"12px",minSize:d,maxSize:u,opacity:.8}]},p=[0,0,0,0],f={color:p,outline:{color:[166,166,166,.25],width:"1px"}},v={color:p,outline:{color:[153,153,153,.25],width:"1px"}},y=(0,l.bG)({themeDictionary:{default:{name:"default",label:"Default",description:"Default theme for visualizing features by varying their size to show data.",schemes:{point:{light:m,dark:c},polyline:{light:{primary:{color:[226,119,40,1],noDataColor:t,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},secondary:[{color:[77,77,77,1],noDataColor:t,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},{color:[153,153,153,1],noDataColor:t,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"}]},dark:{primary:{color:[226,119,40,1],noDataColor:s,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},secondary:[{color:[255,255,255,1],noDataColor:s,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},{color:[153,153,153,1],noDataColor:s,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"}]}},polygon:{light:{primary:{marker:m.primary,background:v,opacity:m.primary.opacity},secondary:[{marker:m.secondary[0],background:v,opacity:m.secondary[0].opacity},{marker:m.secondary[1],background:v,opacity:m.secondary[1].opacity}]},dark:{primary:{marker:c.primary,background:f,opacity:c.primary.opacity},secondary:[{marker:c.secondary[0],background:f,opacity:c.secondary[0].opacity},{marker:c.secondary[1],background:f,opacity:c.secondary[1].opacity}]}}}}}});function h(e){return(0,l.vt)(y,e)}function z(e){if("mesh"===e.geometryType)return null;const i=(0,l.Fq)({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme,theme:y.get("default")});if(!i)return;const{schemesInfo:a,basemapId:n,basemapTheme:r}=i;return{primaryScheme:b(e,a.primary),secondarySchemes:a.secondary.map((i=>b(e,i))).filter(Boolean),basemapId:n,basemapTheme:r}}function w(e){if(!e)return;const i=(0,n.A)({},e);return"color"in i&&i.color&&(i.color=new r.default(i.color)),"noDataColor"in i&&i.noDataColor&&(i.noDataColor=new r.default(i.noDataColor)),"outline"in i&&i.outline&&(i.outline={color:i.outline.color&&new r.default(i.outline.color),width:i.outline.width}),"marker"in i&&i.marker&&(i.marker=w(i.marker)),"background"in i&&i.background&&(i.background=w(i.background)),i}function b(e,i){const a="mesh"!==e.geometryType&&e.worldScale?e.view:null;switch(e.geometryType){case"point":case"multipoint":{const e=i;return g({color:e.color,noDataColor:e.noDataColor,outline:e.outline,size:e.size,noDataSize:e.noDataSize,minSize:e.minSize,maxSize:e.maxSize,opacity:e.opacity||1},a)}case"polyline":{const e=i;return function(e,i){return{color:new r.default(e.color),noDataColor:new r.default(e.noDataColor),width:i?(0,o._J)(e.width,i):e.width,noDataWidth:i?(0,o._J)(e.noDataWidth,i):e.noDataWidth,minWidth:i?(0,o._J)(e.minWidth,i):e.minWidth,maxWidth:i?(0,o._J)(e.maxWidth,i):e.maxWidth,opacity:1}}({color:e.color,noDataColor:e.noDataColor,width:e.width,noDataWidth:e.noDataWidth,minWidth:e.minWidth,maxWidth:e.maxWidth},a)}case"polygon":{const e=i,n=e.marker;return delete n.opacity,function(e,i){const a=g(e.marker,i);return delete a.opacity,{marker:a,background:{color:new r.default(e.background.color),outline:{color:new r.default(e.background.outline.color),width:e.background.outline.width}},opacity:e.opacity}}({marker:n,background:e.background,opacity:e.opacity||1},a)}}}function g(e,i){return{color:new r.default(e.color),noDataColor:new r.default(e.noDataColor),outline:{color:new r.default(e.outline.color),width:e.outline.width},size:i?(0,o._J)(e.size,i):e.size,noDataSize:i?(0,o._J)(e.noDataSize,i):e.noDataSize,minSize:i?(0,o._J)(e.minSize,i):e.minSize,maxSize:i?(0,o._J)(e.maxSize,i):e.maxSize,opacity:e.opacity}}},87990:(e,i,a)=>{a.r(i),a.d(i,{createAgeRenderer:()=>me,createClassBreaksRenderer:()=>de,createContinuousRenderer:()=>oe,createVisualVariables:()=>re,regenerateAgeRenderer:()=>ce,regenerateClassBreaksRenderer:()=>ue,regenerateContinuousRenderer:()=>te,regenerateVisualVariables:()=>le,updateRendererWithReferenceSize:()=>se});var n=a(89379),r=a(59784),l=a(50076),o=a(76931),t=a(40565),s=a(63860),d=a(63844),u=a(9922),m=a(30839),c=a(45430),p=a(23994),f=a(43996),v=a(32695),y=a(43327),h=a(4815),z=a(17237),w=a(33766),b=a(53986),g=a(27084),x=a(16525),S=a(90494),T=a(11563);const E=["layer"],V=.1,k=.25,D=.1,A=.1;function B(e){let i=0;for(const a of e)i+=a;return i/e.length}function I(e,i){const a=null!==i&&void 0!==i?i:B(e),n=e.reduce(((e,i)=>e+(i-a)**2),0);return Math.sqrt(n/e.length)}async function O(e,i){const{view:a}=i;if(i.forBinning){const i=e[Math.floor(e.length/2)].geometry,n=(0,g.HA)(i);if(!n)throw new l.default("reference-size:insufficient-info","Extent is invalid");const r=Math.abs(n.xmax-n.xmin),t=Math.abs(n.ymax-n.ymin),s=Math.min(r,t);return{size:(0,o.PN)(s/a.resolution),isGrid:!0}}const{isGrid:n,avgSize:r}=await async function(e,i){const a=await(0,x.A)({features:e,geometryType:i});if(!(a&&"avgSize"in a&&a.avgSize))throw new l.default("reference-size:insufficient-info","average polygon size is invalid");const n=a.avgSize,r=[],o=[];for(const l of e){const e=(0,g.HA)(l.geometry);if(!e){r.push(0),o.push(0);continue}const i=Math.abs(e.xmax-e.xmin),a=Math.abs(e.ymax-e.ymin);r.push(i/a),o.push(Math.sqrt(i*a))}const t=Number(B(r).toFixed(2)),s=Number(I(r,t).toFixed(2)),d=I(o),u=Number((d/n).toFixed(2));return{isGrid:s<=D&&t>=1-k&&t<=1+k&&u<=A,avgSize:n}}(e,i.layerAdapter.geometryType);return{size:(0,o.PN)((n?r*(1-V):.75*r)/a.resolution),isGrid:n}}async function W(e){const i=await async function(e){const{view:i}=e;if(!(e&&i&&e.layer))throw new l.default("reference-size:missing-parameters","'view' and 'layer' parameters are required");e.forBinning&&(0,S.p)(e,"reference-size");const{layer:a}=e,r=(0,b.A)(e,E),o=e.forBinning?T.Mi:T.J4,t=(0,T.Jg)(a,o,e.forBinning);if(!t)throw new l.default("reference-size:invalid-parameters","'reference-size' must be one of these types: "+(0,T.Ho)(o).join(", "));const s=(0,n.A)((0,n.A)({layerAdapter:t},r),{},{view:i});await i.when();const d=null!=s.signal?{signal:s.signal}:null;if(await t.load(d),!e.forBinning&&"polygon"!==t.geometryType)throw new l.default("reference-size:not-supported","reference-size is not supported for geometryType: ".concat(t.geometryType));return s}(e),a=await i.layerAdapter.getSampleFeatures((0,n.A)({sampleSize:-1,returnGeometry:!0},i),"json");if(null===a||void 0===a||!a.length)throw new l.default("reference-size:insufficient-info","No features are available to calculate statistics");return O(a,i)}var F=a(31650),C=a(99738),q=a(53680),R=a(51006),M=a(27208),G=a(42633),J=a(76281),P=a(94439);const U=2**53-1;async function _(e){if(!(e&&e.layer&&(e.field||e.valueExpression||e.sqlExpression)))throw new l.default("size-visual-variable:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(e.valueExpression&&!e.sqlExpression&&!e.view)throw new l.default("size-visual-variable:missing-parameters","View is required when 'valueExpression' is specified");if("reference-size"===e.theme&&!e.view&&!e.field)throw new l.default("size-visual-variable:missing-parameters","'view' and 'field' are required when 'theme' is 'reference-size'");if("reference-size"===e.theme&&e.valueExpression)throw new l.default("size-visual-variable:missing-parameters","'valueExpression' is not supported when 'theme' is 'reference-size'");e.forBinning&&(0,S.p)(e,"size-visual-variable");const i=(0,n.A)({},e),a=e.forBinning?T.Mi:T.J4,r=(0,T.Jg)(i.layer,a,e.forBinning);if(!r)throw new l.default("size-visual-variable:invalid-parameters","'layer' must be one of these types: "+(0,T.Ho)(a).join(", "));"height"===i.axis&&(i.sizeOptimizationEnabled=!1);const o=null!=i.signal?{signal:i.signal}:null;await r.load(o);const t=r.geometryType;if("mesh"===t)throw new l.default("size-visual-variable:invalid-parameters","Size visualization is not applicable to layers with 'mesh' geometry type");if(i.worldScale){if("polyline"===t||"polygon"===t)throw new l.default("size-visual-variable:not-supported","'worldScale' sizing is not supported for polyline and polygon layers");if(!i.view||"3d"!==i.view.type)throw new l.default("size-visual-variable:invalid-parameters","'view' parameter should be an instance of SceneView when 'worldScale' parameter is true")}if("reference-size"===i.theme&&!e.forBinning&&"polygon"!==t)throw new l.default("size-visual-variable:invalid-parameters","Reference size is only supported for polygon layers");const s=await(0,G.EG)({field:i.field,normalizationField:i.normalizationField,valueExpression:i.valueExpression}),d=(0,R.MH)(r,s,"size-visual-variable:invalid-parameters");if(d)throw d;return await N(i),(0,n.A)((0,n.A)({},i),{},{layer:r})}async function H(e){var i;if(!(e&&e.layer&&(e.field||e.valueExpression||e.sqlExpression)))throw new l.default("size-continuous-renderer:missing-parameters","'layer' and 'field', 'valueExpression' or 'sqlExpression' parameters are required");if(e.valueExpression&&!e.sqlExpression&&!e.view)throw new l.default("size-continuous-renderer:missing-parameters","View is required when 'valueExpression' is specified");e.forBinning&&(0,S.p)(e,"size-continuous-renderer");const a=(0,n.A)({},e);a.symbolType=a.symbolType||"2d",null!==(i=a.defaultSymbolEnabled)&&void 0!==i||(a.defaultSymbolEnabled=!0);const r=e.forBinning?T.Mi:T.J4,o=(0,T.Jg)(a.layer,r,e.forBinning);if(!o)throw new l.default("size-continuous-renderer:invalid-parameters","'layer' must be one of these types: "+(0,T.Ho)(r).join(", "));const t=null!=a.signal?{signal:a.signal}:null;await o.load(t);const s=o.geometryType,d=a.symbolType.includes("3d");if(a.outlineOptimizationEnabled="reference-size"!==a.theme&&"polygon"===s&&a.outlineOptimizationEnabled,"mesh"===s)throw new l.default("size-continuous-renderer:invalid-parameters","Size visualization is not applicable to layers with 'mesh' geometry type");if(d&&("polyline"===s||"polygon"===s))throw new l.default("size-continuous-renderer:not-supported","3d symbols are not supported for polyline and polygon layers");if(a.symbolType.includes("3d-volumetric")&&(!a.view||"3d"!==a.view.type))throw new l.default("size-continuous-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or 3d-volumetric-uniform");if("reference-size"===a.theme&&!e.forBinning&&"polygon"!==s)throw new l.default("size-continuous-renderer:invalid-parameters","Reference size is only supported for polygon layers");const u=await(0,G.EG)({field:a.field,normalizationField:a.normalizationField,valueExpression:a.valueExpression}),m=(0,R.MH)(o,u,"size-continuous-renderer:invalid-parameters");if(m)throw m;return await N(a),(0,n.A)((0,n.A)({},a),{},{layer:o})}async function N(e){const i=e.layer;if(("polygon"===i.geometryType||e.forBinning)&&e.view&&e.field&&!e.valueExpression&&(!e.theme||"reference-size"===e.theme)){var a,n;try{var r;e.referenceSizeResult=null!==(r=e.referenceSizeResult)&&void 0!==r?r:await W({layer:i,view:e.view,filter:e.filter,forBinning:e.forBinning,signal:e.signal})}catch(l){}!e.theme&&null!==(a=e.referenceSizeResult)&&void 0!==a&&a.isGrid&&(e.theme="reference-size"),(null===(n=e.referenceSizeOptions)||void 0===n?void 0:n.symbolStyle)||(e.referenceSizeOptions?e.referenceSizeOptions.symbolStyle="circle":e.referenceSizeOptions={symbolStyle:"circle"})}}async function j(e){var i,a,r;if(!e||!(e.layer&&e.view&&e.sizeStops))throw new l.default("update-renderer-with-reference-size:missing-parameters","'layer', 'view and 'sizeStops' parameters are required");const{view:o,forBinning:t}=e,s=e.forBinning?T.Mi:T.J4,d=(0,T.Jg)(e.layer,s,e.forBinning);if(!d)throw new l.default("update-renderer-with-reference-size:invalid-parameters","'layer' must be one of these types: "+(0,T.Ho)(s).join(", "));const u=d.layer;let m=e.renderer;if(!m)if(e.forBinning){if(!("featureReduction"in u&&u.featureReduction&&"renderer"in u.featureReduction&&u.featureReduction.renderer)||"class-breaks"!==u.featureReduction.renderer.type&&"unique-value"!==u.featureReduction.renderer.type)throw new l.default("update-renderer-with-reference-size:invalid-parameters","Feature reduction renderer is not supported");m=u.featureReduction.renderer}else{if(!("renderer"in u)||!u.renderer||"class-breaks"!==u.renderer.type&&"unique-value"!==u.renderer.type)throw new l.default("update-renderer-with-reference-size:invalid-parameters","Renderer is not supported");m=u.renderer}const c=m.authoringInfo;if(!c||null===c||void 0===c||null===(i=c.visualVariables)||void 0===i||!i.some((e=>"reference-size"===e.theme)))throw new l.default("update-renderer-with-reference-size:invalid-parameters","'renderer.authoringInfo.visualVariables' should have an authoringInfoVisualVariable with 'theme' set to 'reference-size'");const p=null!==(a=e.isGrid)&&void 0!==a?a:null===(r=await W({view:o,layer:u,forBinning:t}))||void 0===r?void 0:r.isGrid;return(0,n.A)((0,n.A)({},e),{},{isGrid:p,renderer:m,layer:d})}async function L(e){var i,a;if(!e||!e.layer||!e.field&&!e.valueExpression)throw new l.default("size-class-breaks-renderer:missing-parameters","'layer' and 'field' or 'valueExpression' parameters are required");if(e.valueExpression&&!e.view)throw new l.default("size-class-breaks-renderer:missing-parameters","View is required when 'valueExpression' is specified");e.forBinning&&(0,S.p)(e,"size-class-breaks-renderer");const r=(0,n.A)({},e);r.symbolType=r.symbolType||"2d",null!==(i=r.defaultSymbolEnabled)&&void 0!==i||(r.defaultSymbolEnabled=!0),null!==(a=r.classificationMethod)&&void 0!==a||(r.classificationMethod="equal-interval"),r.normalizationType=(0,G.Wy)(r);const o=e.forBinning?T.Mi:T.J4,t=(0,T.Jg)(r.layer,o,e.forBinning);if(!t)throw new l.default("size-class-breaks-renderer:invalid-parameters","'layer' must be one of these types: "+(0,T.Ho)(o).join(", "));if((null==r.minValue||null==r.maxValue)&&(null!=r.minValue||null!=r.maxValue))throw new l.default("size-class-breaks-renderer:missing-parameters","Both 'minValue' and 'maxValue' are required when specifying custom data range");const s=null!=r.signal?{signal:r.signal}:null;await t.load(s);const d=t.geometryType,u=r.symbolType.includes("3d");if(r.outlineOptimizationEnabled="polygon"===d&&r.outlineOptimizationEnabled,"mesh"===d)throw new l.default("size-class-breaks-renderer:invalid-parameters","Size visualization is not applicable to layers with 'mesh' geometry type");if(u&&("polyline"===d||"polygon"===d))throw new l.default("size-class-breaks-renderer:not-supported","3d symbols are not supported for polyline and polygon layers");if(r.symbolType.includes("3d-volumetric")&&(!r.view||"3d"!==r.view.type))throw new l.default("size-class-breaks-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or 3d-volumetric-uniform");const m=await(0,G.EG)({field:r.field,normalizationField:r.normalizationField}),c=(0,R.MH)(t,m,"size-class-breaks-renderer:invalid-parameters");if(c)throw c;return(0,n.A)((0,n.A)({},r),{},{layer:t})}function Z(e){const i=(0,n.A)({},e);delete i.basemap,delete i.sizeScheme,delete i.legendOptions,delete i.symbolType,delete i.defaultSymbolEnabled;const a=i;return a.analyzeData=!(null!=i.minValue&&null!=i.maxValue),a}function K(e){var i;const a=(0,n.A)({},e),r=!(null===(i=a.symbolType)||void 0===i||!i.includes("3d-volumetric")),l=a;return l.worldScale=r,r&&(l.axis="3d-volumetric-uniform"===a.symbolType?"all":"height"),delete a.symbolType,delete a.defaultSymbolEnabled,l}async function Q(e){var i,a;if(!(e&&e.layer&&e.view&&e.startTime&&e.endTime))throw new l.default("size-age-renderer:missing-parameters","'layer', 'view', 'startTime', 'endTime' parameters are required");const r=(0,n.A)({},e);null!==(i=r.symbolType)&&void 0!==i||(r.symbolType="2d"),null!==(a=r.defaultSymbolEnabled)&&void 0!==a||(r.defaultSymbolEnabled=!0);const o=(0,T.Jg)(r.layer,T.J4);if(!o)throw new l.default("size-age-renderer:invalid-parameters","'layer' must be one of these types: "+(0,T.Ho)(T.J4).join(", "));const t=null!=r.signal?{signal:r.signal}:null;await o.load(t);const s=o.geometryType,d=r.symbolType.includes("3d");if(r.outlineOptimizationEnabled="polygon"===s&&r.outlineOptimizationEnabled,"mesh"===s)throw new l.default("size-age-renderer:invalid-parameters","Size visualization is not applicable to layers with 'mesh' geometry type");if(d&&("polyline"===s||"polygon"===s))throw new l.default("size-age-renderer:not-supported","3d symbols are not supported for polyline and polygon layers");if(r.symbolType.includes("3d-volumetric")&&(!r.view||"3d"!==r.view.type))throw new l.default("size-age-renderer:invalid-parameters","'view' parameter should be an instance of SceneView when 'symbolType' parameter is '3d-volumetric' or 3d-volumetric-uniform");const u=(0,M.verifyDates)(o,r.startTime,r.endTime,"size-age-renderer:invalid-parameters");if(u)throw u;if(r.unit&&!M.supportedAgeUnits.includes(r.unit))throw new l.default("size-age-renderer:invalid-unit","Supported units are: ".concat(M.supportedAgeUnits.join(", ")));return(0,n.A)((0,n.A)({},r),{},{layer:o})}async function X(e){let i=e.sizeScheme,a=null,n=null;const r=await(0,R.Ib)(e.basemap,e.view);if(a=null!=r.basemapId?r.basemapId:null,n=null!=r.basemapTheme?r.basemapTheme:null,i)return{scheme:(0,J.cloneScheme)(i),basemapId:a,basemapTheme:n};const l=(0,J.getSchemes)({basemapTheme:n,geometryType:e.geometryType,worldScale:e.worldScale,view:e.view});return l&&(i=l.primaryScheme,a=l.basemapId,n=l.basemapTheme),{scheme:i,basemapId:a,basemapTheme:n}}function Y(e,i){switch(i){case"point":case"multipoint":{const i=e;return[(0,v.o)(i.minSize),(0,v.o)(i.maxSize)]}case"polyline":{const i=e;return[(0,v.o)(i.minWidth),(0,v.o)(i.maxWidth)]}case"polygon":{const i=e;return[(0,v.o)(i.marker.minSize),(0,v.o)(i.marker.maxSize)]}}}function $(e,i){e.transformationType===h._w.ClampedLinear&&"below"===i&&e.flipSizes()}function ee(e,i){if("reference-size"===i.theme&&null!=e.min&&null!=e.max&&null!=e.avg&&null!=e.stddev){const i=100,a=0,n=0,r=1,l=e.avg,o=e.min,t=e.max,s=e.stddev,d=0!==l?s/l:0,u=o>n&&o<r&&t<2*r&&d<.5,m=o>a&&o<i&&t<2*i&&d<.5;return{minDataValue:u?n:m?a:o,maxDataValue:u?r:m?i:l+2*s,defaultValuesUsed:!1}}const{theme:a,field:n}=i,r=i.layer,l=n&&"function"!=typeof n?r.getField(n):null,o=(0,G.fs)(l);return(0,R.Gc)(e,a,o,"above"===a||"below"===a)}async function ie(e,i,a,n){var r,o;const{theme:s,field:d,normalizationField:p,minValue:v,maxValue:h,axis:z}=e,w=e.layer.geometryType,b=await X({basemap:e.basemap,geometryType:w,sizeScheme:e.sizeScheme,worldScale:e.worldScale,view:e.view}),g=b.scheme;if(!g)throw new l.default("size-visual-variable:insufficient-info","Unable to find size scheme");const x=await async function(e,i,a,n,r){return"reference-size"===a&&i?[1,i.size]:e?[e.minSize,e.maxSize]:Y(n,r)}(a,n,s,g,w),{minDataValue:S,maxDataValue:T,defaultValuesUsed:E}=ee(i,e),V=[],k="height"===z,D=k?z:void 0,A=x[0];let B=x[1];if(k&&"number"==typeof A&&"number"==typeof B){const e=(0,R.Nl)({minSize:A,maxSize:B},D);V.push(new f.default({axis:"width-and-depth",minSize:e.minSize})),B=e.maxSize}const I=new f.default({field:null!==d&&void 0!==d?d:void 0,valueExpression:e.valueExpression,valueExpressionTitle:e.valueExpressionTitle,valueUnit:"unknown",normalizationField:p,axis:D,minSize:A,maxSize:B,minDataValue:S,maxDataValue:T,legendOptions:(0,t.PZ)(y.A,e.legendOptions)});$(I,s),V.unshift(I);const O=new c.default("reference-size"===s?{type:"size",field:e.field,normalizationField:e.normalizationField,sizeStops:(0,C.SB)(I).map((e=>{let{label:i,size:a,value:n}=e;return new m.A({label:i,size:a,value:n})})),theme:s,referenceSizeScale:null!==n&&void 0!==n&&n.isGrid||e.sizeOptimizationEnabled?null===e||void 0===e||null===(r=e.view)||void 0===r?void 0:r.scale:void 0,referenceSizeSymbolStyle:null===(o=e.referenceSizeOptions)||void 0===o?void 0:o.symbolStyle,minSliderValue:null!=v?v:i.min,maxSliderValue:null!=h?h:i.max}:{type:"size",theme:s,minSliderValue:null!=v?v:i.min,maxSliderValue:null!=h?h:i.max}),W=new u.default({visualVariables:[O]});return{basemapId:b.basemapId,basemapTheme:b.basemapTheme,visualVariables:V,statistics:i,isGrid:null===n||void 0===n?void 0:n.isGrid,defaultValuesUsed:E,sizeScheme:(0,J.cloneScheme)(g),authoringInfo:W}}async function ae(e,i,a,n,r){var l,o,t;const u=await(0,s.ud)("esri/smartMapping/t9n/smartMapping"),m=r.layer,c=r.field,p=m.geometryType,f=r.defaultSymbolEnabled,v=(0,J.cloneScheme)(e.sizeScheme),y="polygon"===p,h=y?v.marker:v,z=y?v.background:null,w=y?"point":p,b=null===i||void 0===i?void 0:i.opacity,g=e.isGrid,x="reference-size"===r.theme,S=x?[]:e.visualVariables.map((e=>e.clone()));(null===i||void 0===i||null===(l=i.visualVariables)||void 0===l?void 0:l.length)&&S.push(...i.visualVariables.map((e=>e.clone())));const T=x?(0,C.D8)({view:r.view,field:c,normalizationField:n,sizeStops:(0,C.SB)(e.visualVariables[0]),sizeByScaleEnabled:g||!!r.sizeOptimizationEnabled}):null;return{renderer:new d.default({backgroundFillSymbol:!g&&z?(0,R.v5)(p,{type:r.symbolType,color:z.color,outline:(0,R.qc)(z,p,b)}):null,classBreakInfos:[{minValue:-9007199254740991,maxValue:U,symbol:T?(0,C.zm)({type:(null===(o=r.referenceSizeOptions)||void 0===o?void 0:o.symbolStyle)||"circle",color:h.color,primitiveOverrides:T}):(0,R.v5)(w,{type:r.symbolType,color:h.color,size:(0,R.N6)(h,w),outline:(0,R.qc)(h,w,b)})}],defaultLabel:f?u.other:null,defaultSymbol:f&&!x?(0,R.v5)(w,{type:r.symbolType,color:h.noDataColor,size:(0,R.N6)(h,w,!0),outline:(0,R.qc)(h,w,b)}):null,field:c,normalizationField:n,normalizationType:a,valueExpression:r.valueExpression,valueExpressionTitle:r.valueExpressionTitle,visualVariables:S,authoringInfo:null===(t=e.authoringInfo)||void 0===t?void 0:t.clone()}),visualVariables:e.visualVariables.map((e=>e.clone())),statistics:e.statistics,defaultValuesUsed:e.defaultValuesUsed,isGrid:g,sizeScheme:(0,J.cloneScheme)(e.sizeScheme),basemapId:e.basemapId,basemapTheme:e.basemapTheme}}async function ne(e,i){var a,n,r;const l=await(0,s.ud)("esri/smartMapping/t9n/smartMapping"),t=e.layer,m=e.defaultSymbolEnabled,c=t.geometryType,f="polygon"===c,v=null===(a=e.symbolType)||void 0===a?void 0:a.includes("3d-volumetric"),y=await X({basemap:e.basemap,geometryType:c,sizeScheme:e.sizeScheme,worldScale:v,view:e.view}),h=y.scheme,{result:z,outlineResult:w}=i,b=null!==(n=null===z||void 0===z?void 0:z.classBreakInfos)&&void 0!==n?n:[],g=e.classificationMethod,x=e.normalizationType,S=f?h.marker:h,T=f?h.background:null,E=f?"point":c,V=Y(S,E),k=v?(0,R.Nl)({minSize:V[0],maxSize:V[1]},"height"):null,D=function(e,i){const a=(0,o.cr)(e.minSize),n=((0,o.cr)(e.maxSize)-a)/(i>=4?i-1:i),r=[];for(let l=0;l<i;l++)r.push(a+n*l);return r}({minSize:V[0],maxSize:k?k.maxSize:V[1]},b.length),A=null===w||void 0===w?void 0:w.opacity,B=new d.default({backgroundFillSymbol:T&&(0,R.v5)(c,{type:e.symbolType,color:T.color,outline:(0,R.qc)(T,c,A)}),classBreakInfos:b.map(((i,a)=>({minValue:i.minValue,maxValue:i.maxValue,symbol:(0,R.v5)(E,{type:e.symbolType,color:S.color,size:D[a],widthAndDepth:null===k||void 0===k?void 0:k.minSize,outline:(0,R.qc)(S,E,A)}),label:i.label}))),defaultLabel:m?l.other:null,defaultSymbol:m?(0,R.v5)(E,{type:e.symbolType,color:S.noDataColor,size:(0,R.N6)(S,E,!0),widthAndDepth:null===k||void 0===k?void 0:k.minSize,outline:(0,R.qc)(S,E,A)}):null,field:e.field,valueExpression:e.valueExpression,valueExpressionTitle:e.valueExpressionTitle,normalizationType:x,normalizationField:e.normalizationField,normalizationTotal:"percent-of-total"===x?null===z||void 0===z?void 0:z.normalizationTotal:void 0,legendOptions:e.legendOptions,authoringInfo:new u.default({type:"class-breaks-size",classificationMethod:g,standardDeviationInterval:e.standardDeviationInterval})});return"standard-deviation"!==g&&(0,p.setLabelsForClassBreaks)({classBreakInfos:B.classBreakInfos,classificationMethod:g,normalizationType:x,round:!0}),null!==w&&void 0!==w&&null!==(r=w.visualVariables)&&void 0!==r&&r.length&&(B.visualVariables=w.visualVariables.map((e=>e.clone()))),{renderer:B,sizeScheme:(0,J.cloneScheme)(h),classBreaksResult:z,defaultValuesUsed:!!i.defaultValuesUsed,basemapId:y.basemapId,basemapTheme:y.basemapTheme}}async function re(e){const i=await _(e),{view:a,field:n,valueExpression:r,minValue:l,maxValue:o,layer:t,normalizationField:s,signal:d,statistics:u,filter:m}=i,c=s?"field":void 0,[p,f]=await Promise.all([null!==u&&void 0!==u?u:(0,R.g2)({layer:t,field:n,valueExpression:r,sqlExpression:i.sqlExpression,sqlWhere:i.sqlWhere,normalizationType:c,normalizationField:s,filter:m,minValue:l,maxValue:o,view:a,signal:d}),i.sizeOptimizationEnabled?(0,F.default)({view:a,layer:t,signal:d,filter:m}).catch(R.ou):null]);return ie(i,p,f,i.referenceSizeResult)}async function le(e){var i,a,r;const{view:o,filter:t,renderer:s,signal:d,creatorParameters:u}=await async function(e){var i,a,r;const o="regenerate-size-visual-variables";(0,q.AC)(e,o);const t=await(0,q.mE)(e),s=(0,q.UJ)(t);if(!s||!["size-continuous","univariate-color-size","color-size","relationship-size","type-size"].includes(s))throw new l.default("".concat(o,":invalid-parameters"),"Renderer is invalid");const d=(0,q.wx)(t,"size");if(!d)throw new l.default("".concat(o,":invalid-parameters"),"Renderer does not have a size visual variable authoringInfo");const u=d.theme,m="reference-size"===u,c=null===(i=t.visualVariables)||void 0===i?void 0:i.find(q.OW);if(!c&&!m)throw new l.default("".concat(o,":invalid-parameters"),"Renderer does not have a size visual variable");let p=d.field,f=d.normalizationField,v=null,y=null;p||(null!==c&&void 0!==c&&c.field?(p=c.field,f=c.normalizationField):t.field?(p=t.field,f=t.normalizationField):(v=null!==(a=null===c||void 0===c?void 0:c.valueExpression)&&void 0!==a?a:t.valueExpression,y=null!==(r=null===c||void 0===c?void 0:c.valueExpressionTitle)&&void 0!==r?r:t.valueExpressionTitle));const{layer:h,forBinning:z,filter:w,view:b,signal:g}=e,x=(0,q.Rv)(t),S=await _({layer:h,field:p,valueExpression:v,valueExpressionTitle:y,normalizationField:f,theme:u,sizeOptimizationEnabled:x,forBinning:z,filter:w,view:b,signal:g});return(0,n.A)((0,n.A)({},e),{},{creatorParameters:S,renderer:t})}(e),{field:c,normalizationField:p,valueExpression:v,theme:y,layer:h,sizeOptimizationEnabled:z,referenceSizeResult:w,valueExpressionTitle:b}=u,g=p?"field":void 0,[x,S]=await Promise.all([(0,R.g2)({layer:h,field:c,valueExpression:v,normalizationField:p,normalizationType:g,filter:t,view:o,signal:d}),z?(0,F.default)({view:o,layer:h,signal:d,filter:t}).catch(R.ou):null]),T=function(e,i,a){return"reference-size"===a&&i?[1,i.size]:e?[e.minSize,e.maxSize]:null}(S,w,y),{minDataValue:E,maxDataValue:V}=ee(x,{theme:y,layer:h,field:c}),k=null===(i=s.visualVariables)||void 0===i?void 0:i.find(q.OW),D=null!==(a=null!==k&&void 0!==k&&k.stops?null:k)&&void 0!==a?a:new f.default({field:null!==c&&void 0!==c?c:void 0,valueExpression:v,valueExpressionTitle:b,valueUnit:"unknown",normalizationField:p});T&&(D.minSize=T[0],D.maxSize=T[1]),D.minDataValue=E,D.maxDataValue=V,$(D,y);const A=(0,q.wx)(s,"size");return A.minSliderValue=x.min,A.maxSliderValue=x.max,"reference-size"===y&&(A.sizeStops=(0,C.SB)(D).map((e=>{let{label:i,size:a,value:n}=e;return new m.A({label:i,size:a,value:n})})),A.referenceSizeScale=null!==w&&void 0!==w&&w.isGrid||z?null===o||void 0===o?void 0:o.scale:void 0),{visualVariables:"reference-size"===y?[]:[D],isGrid:!(null===w||void 0===w||!w.isGrid),authoringInfo:null===(r=s.authoringInfo)||void 0===r?void 0:r.clone(),statistics:x}}async function oe(e){const i=await H(e),a={layer:i.layer,view:i.view,filter:i.filter,signal:i.signal},[n,r]=await Promise.all([re(K(i)),i.outlineOptimizationEnabled?(0,w.A)(a).catch(R.ou):null]),l=i.normalizationField;return ae(n,r,l?"field":void 0,l,i)}async function te(e){var i;const{renderer:a,view:r,signal:o,filter:t,creatorParameters:s,forBinning:d}=await async function(e){const i="regenerate-size-continuous-renderer";(0,q.AC)(e,i);const a=await(0,q.mE)(e),r=(0,q.UJ)(a);if(!r||!["size-continuous","univariate-color-size"].includes(r))throw new l.default("".concat(i,":invalid-parameters"),"Renderer is invalid");const{authoringInfo:o,field:t,normalizationField:s,valueExpression:d,valueExpressionTitle:u}=a,m=null===o||void 0===o?void 0:o.visualVariables.find((e=>"size"===e.type)),c=m.theme,{layer:p,forBinning:f,filter:v,view:y,signal:h}=e,z=(0,q.DW)(a),w=(0,q.Rv)(a),b=await H({layer:p,field:t,valueExpression:d,valueExpressionTitle:u,normalizationField:s,theme:c,outlineOptimizationEnabled:z,sizeOptimizationEnabled:w,forBinning:f,filter:v,view:y,signal:h});return(0,n.A)((0,n.A)({},e),{},{creatorParameters:b,renderer:a})}(e),{layer:u,outlineOptimizationEnabled:m,theme:c,referenceSizeResult:p}=s,[f,v]=await Promise.all([le((0,n.A)((0,n.A)({},e),{},{referenceSizeResult:p})),m?(0,w.A)({layer:u,view:r,filter:t,signal:o}).catch(R.ou):null]),y=f.isGrid,h="reference-size"===c;(0,q.ke)(a,f.visualVariables,q.Jy),(0,q.ke)(a,null===v||void 0===v?void 0:v.visualVariables,q._i),(0,q.Hj)(a,f.authoringInfo,"size");const z=f.statistics;return h?{renderer:await se({layer:u,renderer:a,view:r,forBinning:d,sizeStops:null===(i=(0,q.wx)(a,"size","reference-size"))||void 0===i?void 0:i.sizeStops,isGrid:y}),isGrid:y,statistics:z}:{renderer:a,statistics:z}}async function se(e){var i,a,n;const{layer:o,referenceSizeOptions:t,renderer:s,sizeScheme:d,sizeStops:c,typeScheme:p,view:f,isGrid:v}=await j(e),y=s.clone();null!==(i=y.authoringInfo)&&void 0!==i||(y.authoringInfo=new u.default);const h=y.authoringInfo.visualVariables.find((e=>"reference-size"===e.theme)),z=null!==(a=e.field)&&void 0!==a?a:null===h||void 0===h?void 0:h.field,w=null!==(n=e.normalizationField)&&void 0!==n?n:null===h||void 0===h?void 0:h.normalizationField;if(!z)throw new l.default("update-renderer-with-reference-size:invalid-parameters","'field' parameter or authoring info with 'field' is required.");const b=(0,C.D8)({view:f,field:z,normalizationField:w,sizeStops:c,sizeByScaleEnabled:v||!!e.sizeOptimizationEnabled}),g=(null===t||void 0===t?void 0:t.symbolStyle)||(null===h||void 0===h?void 0:h.referenceSizeSymbolStyle)||"circle";if("class-breaks"===y.type){const e="polygon"===("geometryType"in o?o.geometryType:null)&&d&&"marker"in d?d.marker:null;y.classBreakInfos.forEach((i=>{var a;const n=null!==(a=null===e||void 0===e?void 0:e.color)&&void 0!==a?a:(0,P.Sx)(i.symbol,1);"cim"===i.symbol.type?(0,C.oz)(i.symbol,{type:g,color:n,primitiveOverrides:b}):n&&(i.symbol=(0,C.zm)({type:g,color:n,primitiveOverrides:b}))}))}else if("unique-value"===y.type){var x,S;const e=y.uniqueValueGroups,i="polygon"===("geometryType"in o?o.geometryType:null)&&p&&"colors"in p?p.colors:null,a=i?(0,r.Iy)(i,null!==(x=null===(S=y.uniqueValueInfos)||void 0===S?void 0:S.length)&&void 0!==x?x:0):null;let n=0;if(e){for(const i of e)for(const e of null!==(T=i.classes)&&void 0!==T?T:[]){var T,E;const i=a?a[n]:(0,P.Sx)(e.symbol,1);"cim"===(null===(E=e.symbol)||void 0===E?void 0:E.type)?(0,C.oz)(e.symbol,{type:g,color:i,primitiveOverrides:b}):i&&(e.symbol=(0,C.zm)({type:g,color:i,primitiveOverrides:b})),n++}y.uniqueValueGroups=e}}return h&&(h.field=z,h.normalizationField=w,h.sizeStops=c.map((e=>{let{label:i,size:a,value:n}=e;return new m.A({label:i,size:a,value:n})})),h.referenceSizeScale=v||e.sizeOptimizationEnabled?f.scale:void 0,h.referenceSizeSymbolStyle=g),y}async function de(e){const i=await L(e);return ne(i,await(0,R.Pv)(Z(i),i.outlineOptimizationEnabled))}async function ue(e){const{renderer:i,creatorParameters:a}=await async function(e){const i="regenerate-size-class-breaks-renderer";await(0,q.AC)(e,i);const a=await(0,q.mE)(e);if("size-class-breaks"!==(0,q.UJ)(a))throw new l.default("".concat(i,":invalid-parameters"),"Renderer is invalid");const{authoringInfo:r,field:o,normalizationField:t,normalizationType:s,normalizationTotal:d,valueExpression:u,valueExpressionTitle:m}=a,{classificationMethod:c,standardDeviationInterval:p}=r,f=a.classBreakInfos.length,{layer:v,forBinning:y,filter:h,view:z,signal:w}=e,b=(0,q.DW)(a),g=await L({layer:v,field:o,valueExpression:u,valueExpressionTitle:m,normalizationType:s,normalizationField:t,normalizationTotal:d,classificationMethod:c,standardDeviationInterval:p,numClasses:f,outlineOptimizationEnabled:b,forBinning:y,filter:h,view:z,signal:w});return(0,n.A)((0,n.A)({},e),{},{creatorParameters:g,renderer:a})}(e),{outlineOptimizationEnabled:r,normalizationType:o,classificationMethod:t}=a,{result:s,outlineResult:d}=await(0,R.Pv)(Z(a),r),u=s.classBreakInfos;if(a.numClasses!==u.length)throw new l.default("regenerate-class-breaks-renderer:invalid-parameters","The number of class breaks generated does not match the number of class breaks in the renderer.");return i.classBreakInfos.forEach(((e,i)=>{e.minValue=u[i].minValue,e.maxValue=u[i].maxValue,e.label=u[i].label})),i.normalizationTotal="percent-of-total"===o?s.normalizationTotal:void 0,"standard-deviation"!==t&&(0,p.setLabelsForClassBreaks)({classBreakInfos:i.classBreakInfos,classificationMethod:t,normalizationType:o,round:!0}),(0,q.ke)(i,null===d||void 0===d?void 0:d.visualVariables,q._i),{renderer:i}}async function me(e){var i;const a=await Q(e),{defaultSymbolEnabled:r,view:l,startTime:o,endTime:t,symbolType:s,minValue:d,maxValue:u,signal:m,filter:c,layer:p}=a,[f,v]=await Promise.all([a.unit?{unit:a.unit,statistics:null,valueExpression:null}:await(0,z.A)({view:l,layer:p,startTime:o,endTime:t,minValue:d,maxValue:u,signal:m,filter:c}),a.outlineOptimizationEnabled?(0,w.A)({layer:p,view:l,filter:c,signal:m}).catch(R.ou):null]),{unit:y,statistics:h}=f,{valueExpression:b,title:g}=await(0,R.l7)(a,y),x=await re(K({layer:p,basemap:a.basemap,valueExpression:b,symbolType:s,statistics:h,legendOptions:{title:g},theme:a.theme,sizeScheme:a.sizeScheme,sizeOptimizationEnabled:a.sizeOptimizationEnabled,view:a.view,minValue:d,maxValue:u,filter:c,signal:m})),S={layer:p,valueExpression:b,defaultSymbolEnabled:r,symbolType:s},T=await ae(x,v,null,null,S),E=null===(i=T.renderer.authoringInfo)||void 0===i?void 0:i.visualVariables;return null!==E&&void 0!==E&&E.forEach((e=>(0,R.f3)(e,o,t,y))),(0,n.A)((0,n.A)({},T),{},{unit:y})}async function ce(e){var i;const{renderer:a,creatorParameters:r}=await async function(e){const i="regenerate-size-age-renderer";await(0,q.AC)(e,i);const a=await(0,q.mE)(e);if("size-age"!==(0,q.UJ)(a))throw new l.default("".concat(i,":invalid-parameters"),"Renderer is invalid");const{authoringInfo:r}=a,o=null===r||void 0===r?void 0:r.visualVariables.find((e=>"size"===e.type)),t=o.startTime,s=o.endTime,d=o.units,u=o.theme,{layer:m,filter:c,view:p,signal:f}=e,v=(0,q.DW)(a),y=(0,q.Rv)(a),h=await Q({layer:m,startTime:t,endTime:s,unit:d,theme:u,outlineOptimizationEnabled:v,sizeOptimizationEnabled:y,filter:c,view:p,signal:f});return(0,n.A)((0,n.A)({},e),{},{creatorParameters:h,renderer:a})}(e),{layer:o,outlineOptimizationEnabled:t,sizeOptimizationEnabled:s,startTime:d,endTime:u,theme:m,view:c,signal:p,filter:f}=r,[v,y]=await Promise.all([(0,z.A)({view:c,layer:o,startTime:d,endTime:u,signal:p,filter:f}),t?(0,w.A)({layer:o,view:c,filter:f,signal:p}).catch(R.ou):null]),{unit:h,statistics:b}=v,{valueExpression:g,title:x}=await(0,R.l7)(r,h),S=await re(K({layer:o,valueExpression:g,statistics:b,legendOptions:{title:x},sizeOptimizationEnabled:s,theme:m,view:c,filter:f,signal:p}));(0,q.ke)(a,S.visualVariables,q.Jy),(0,q.ke)(a,null===y||void 0===y?void 0:y.visualVariables,q._i),a.authoringInfo=S.authoringInfo.clone();const T=null===(i=a.authoringInfo)||void 0===i?void 0:i.visualVariables;return null!==T&&void 0!==T&&T.forEach((e=>(0,R.f3)(e,d,u,h))),{renderer:a}}}}]);
//# sourceMappingURL=87990.d02da97d.chunk.js.map