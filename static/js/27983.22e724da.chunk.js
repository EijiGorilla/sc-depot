"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[27983,39778],{6196:(e,t,i)=>{i.d(t,{O:()=>o});var a=i(41508),n=i(36642),r=i(82816);async function o(e,t,i,o){return i=a.default.from(i||{}),(0,n.R7)(e,"submitJob",i,null!==t&&void 0!==t?t:{},o).then((t=>{let{data:i}=t;const a=r.default.fromJSON(i);return a.sourceUrl=e,a}))}},11392:(e,t,i)=>{i.d(t,{g:()=>o});var a=i(41508),n=i(36642),r=i(64693);async function o(e,t,i,o){return i=a.default.from(i||{}),(0,n.R7)(e,"execute",i,null!==t&&void 0!==t?t:{},o).then((async e=>{var t,i,a,o;let{data:l}=e;return{results:await Promise.all(null!==(t=null===(i=l.results)||void 0===i?void 0:i.map(n.D4))&&void 0!==t?t:[]),messages:null!==(a=null===(o=l.messages)||void 0===o?void 0:o.map((e=>r.default.fromJSON(e))))&&void 0!==a?a:[]}}))}},27983:(e,t,i)=>{i.r(t),i.d(t,{execute:()=>J,getGpPrintParams:()=>U,getGpServerUrl:()=>z,getMode:()=>k,getTasks:()=>C,printCacheMap:()=>_});var a=i(89379),n=i(55171),r=i(3825),o=i(45802),l=i(76931),s=i(90534),u=i(65215),d=i(53430),c=i(46530),y=i(15492),p=i(54994),f=i(11392),m=i(6196),v=i(92706),g=i(39907),h=i(69539),b=i(86875),w=i(38996),S=i(76940),I=i(90992);function L(e){var t;if(!e.attributionVisible)return;let i;return"function"==typeof e.originOf&&"user"===e.originOf("copyright")&&(i=e.copyright),i||!e.hasAttributionData?(null!==i&&void 0!==i||(i=null===(t=e.portalItem)||void 0===t?void 0:t.accessInformation),null!==i&&void 0!==i||(i=e.copyright),null!==i&&void 0!==i?i:void 0):void 0}function D(e){return"bing-maps"===(null===e||void 0===e?void 0:e.type)}function x(e){return e&&"blendMode"in e&&"effect"in e}function T(e){return"catalog"===e.layer.type}function P(e){return"group"===e.layer.type}function O(e){const t=e.layer;if(x(t)){const i=t.blendMode;if((!i||"normal"===i)&&(t.effect||"featureEffect"in e&&e.featureEffect))return!0}return!1}var M=i(39778);const A=new o.J({"Attribute List Letter ANSI A Landscape":"attribute-list-letter-ansi-a-landscape","Attribute List Letter ANSI A Portrait":"attribute-list-letter-ansi-a-portrait","Attribute List With Group Letter ANSI A Landscape":"attribute-list-with-group-letter-ansi-a-landscape","Attribute List With Group Letter ANSI A Portrait":"attribute-list-with-group-letter-ansi-a-portrait","Page per Feature Letter ANSI A Landscape":"page-per-feature-letter-ansi-a-landscape","Page per Feature Letter ANSI A Portrait":"page-per-feature-letter-ansi-a-portrait"}),E=(A.fromJSON.bind(A),A.toJSON.bind(A)),V={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},N=new o.J({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),F=new o.J({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),_=new Map;async function J(e,t,i){const a=await R(e,i),n=await U(t,a);if("sync"===await k(e,i)){var r;const{results:t}=await(0,f.g)(e,n,void 0,i);return null===t||void 0===t||null===(r=t[0])||void 0===r?void 0:r.value}const o=await(0,m.O)(e,n,void 0,i);await o.waitForJobCompletion({interval:t.updateDelay});const{value:l}=await o.fetchResultData("Output_File",null,i);return l}async function R(e,t){var i,a;const n=z(e),o=null!==(i=_.get(n))&&void 0!==i?i:{gpServerUrl:n,legendLayerNameMap:{},legendLayers:[]};return null!==(a=o.gpMetadata)&&void 0!==a||(o.gpMetadata=(await(0,r.default)(n,(0,p.jV)({f:"json"},t))).data),o.cimVersion=o.gpMetadata.cimVersion,_.set(n,o),o}async function k(e,t){return function(e){var t;return null!==(t=e.gpMetadata)&&void 0!==t&&t.executionType?F.fromJSON(e.gpMetadata.executionType):"sync"}(await R(e,t))}async function C(e,t){return(await R(e,t)).gpMetadata.tasks}async function U(e,t){t=t||{is11xService:!1,legendLayerNameMap:{},legendLayers:[]};const i=e.template||new M.default;null==i.showLabels&&(i.showLabels=!0);const a=i.exportOptions;let r;const o=(0,g.U)(i.layout);if(a&&(r={dpi:a.dpi},"map_only"===(null===o||void 0===o?void 0:o.toLowerCase())||""===o)){const{width:e,height:t}=a;r.outputSize=null!=e&&null!=t?[e,t]:void 0}const l=i.layoutOptions;let s;if(l){var u,d;let e,t;"Miles"===l.scalebarUnit||"Kilometers"===l.scalebarUnit?(e="Kilometers",t="Miles"):"Meters"!==l.scalebarUnit&&"Feet"!==l.scalebarUnit||(e="Meters",t="Feet"),s={titleText:l.titleText,authorText:l.authorText,copyrightText:l.copyrightText,customTextElements:l.customTextElements,elementOverrides:l.elementOverrides,scaleBarOptions:e||t?{metricUnit:null!==(u=N.toJSON(e))&&void 0!==u?u:void 0,metricLabel:e?V[e]:void 0,nonMetricUnit:null!==(d=N.toJSON(t))&&void 0!==d?d:void 0,nonMetricLabel:t?V[t]:void 0}:void 0}}let c=null;(null===l||void 0===l?void 0:l.legendLayers)&&(c=l.legendLayers.map((e=>{const i=e.layerId;t.legendLayerNameMap[i]=e.title;const a={id:i};return e.subLayerIds&&(a.subLayerIds=e.subLayerIds),a})));const y=await async function(e,t,i){var a;const n=e.view;let r=n.spatialReference;const o={operationalLayers:await G(n,t,i)};t.includeTables&&(o.tables=await async function(e){const t=[],i=[];for(const o of e.map.allTables)"feature"!==o.type||o.loaded||i.push(o.load());i.length&&await Promise.allSettled(i);for(const o of e.map.allTables){var a;if("feature"===o.type&&o.loaded&&o.isTable&&"feature-layer"===(null===(a=o.source)||void 0===a?void 0:a.type)){var n;const e={id:(r=fe(o)).id,title:r.title,customParameters:r.customParameters,layerDefinition:{definitionExpression:null===(n=r.layerDefinition)||void 0===n?void 0:n.definitionExpression},url:r.url};de(e,o),t.push(e)}}var r;return t.length?t:void 0}(n));let l=e.extent||i.ssExtent||n.extent;if(null!==(a=r)&&void 0!==a&&a.isWrappable&&(l=l.clone()._normalize(!0),r=l.spatialReference),o.mapOptions={extent:l&&l.toJSON(),spatialReference:r&&r.toJSON(),showAttribution:t.attributionVisible},i.ssExtent=null,n.background&&(o.background=n.background.toJSON()),n.rotation&&(o.mapOptions.rotation=-n.rotation),t.scalePreserved&&(o.mapOptions.scale=t.outScale||n.scale),null!=n.timeExtent){const e=null!=n.timeExtent.start?n.timeExtent.start.getTime():null,t=null!=n.timeExtent.end?n.timeExtent.end.getTime():null;o.mapOptions.time=[e,t]}return t.reportOptions&&(o.reportOptions=t.reportOptions),o}(e,i,t);if(y.operationalLayers){const e=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),t=/[\u0600-\u06FF]/,i=i=>{var a;const n=i.text,r=i.font,o=null===r||void 0===r||null===(a=r.family)||void 0===a?void 0:a.toLowerCase();n&&r&&("arial"===o||"arial unicode ms"===o)&&(r.family=e.test(n)?"Arial Unicode MS":"Arial","normal"!==r.style&&t.test(n)&&(r.family="Arial Unicode MS"))};for(const a of y.operationalLayers){var p;if(null!==(p=a.featureCollection)&&void 0!==p&&p.layers)for(const e of a.featureCollection.layers){var f,m;if(null!==(f=e.layerDefinition)&&void 0!==f&&null!==(f=f.drawingInfo)&&void 0!==f&&null!==(f=f.renderer)&&void 0!==f&&f.symbol){const t=e.layerDefinition.drawingInfo.renderer;"esriTS"===t.symbol.type&&i(t.symbol)}if(null!==(m=e.featureSet)&&void 0!==m&&m.features)for(const t of e.featureSet.features)t.symbol&&"esriTS"===t.symbol.type&&i(t.symbol)}}}e.outSpatialReference&&(y.mapOptions.spatialReference=e.outSpatialReference.toJSON()),Object.assign(y,{exportOptions:r,layoutOptions:s||{}}),Object.assign(y.layoutOptions,{legendOptions:{operationalLayers:null!=c?c:t.legendLayers.slice()}}),t.legendLayers.length=0,_.set(t.gpServerUrl,t);const h={Web_Map_as_JSON:JSON.stringify(y),Format:v.U.toJSON(i.format),Layout_Template:o,Layout_Item_ID:void 0,Report_Template:E(i.report),Report_Item_ID:void 0};if(i.layoutItem){delete h.Layout_Template;const e=i.layoutItem;await e.load(),"public"!==e.access&&n.id&&await n.id.getCredential(t.gpServerUrl),h.Layout_Item_ID=JSON.stringify({id:e.id})}if(i.reportItem){delete h.Report_Template;const e=i.reportItem;await e.load(),"public"!==e.access&&n.id&&await n.id.getCredential(t.gpServerUrl),h.Report_Item_ID=JSON.stringify({id:e.id})}return e.extraParameters&&Object.assign(h,e.extraParameters),h}function z(e){let t=e;const i=t.lastIndexOf("/GPServer/");return i>0&&(t=t.slice(0,i+9)),t}async function G(e,t,i){var a;const n=[],r={layerView:null,printTemplate:t,view:e};let o=0;t.scalePreserved&&(o=t.outScale||e.scale);const l=function(e,t){const i=e.allLayerViews.items;if(t===e.scale)return i.filter((e=>!e.suspended));const a=new Array;for(const n of i){const e=n.parent;e&&e!==n.view&&(T(e)||P(e))&&!a.includes(e)||n.visible&&n.visibleAtCurrentTimeExtent&&(0,I.E5)(n.layer.effectiveScaleRange,t)&&a.push(n)}return a}(e,o);for(const s of l){const e=s.layer;if(!e.loaded||"layers"in e)continue;let t;r.layerView=s,t=O(s)?await te(e,r,i):D(e)?Z(e):"csv"===(null===e||void 0===e?void 0:e.type)?await W(e,r,i):"catalog-footprint"===(null===e||void 0===e?void 0:e.type)?await B(e,r,i):"feature"===(null===e||void 0===e?void 0:e.type)?await K(e,r,i):"geojson"===(null===e||void 0===e?void 0:e.type)?await q(e,r,i):"graphics"===(null===e||void 0===e?void 0:e.type)?await Q(e,r,i):"imagery"===(null===e||void 0===e?void 0:e.type)?H(e,i):"imagery-tile"===(null===e||void 0===e?void 0:e.type)?await $(e,r,i):"kml"===(null===e||void 0===e?void 0:e.type)?await X(e,r,i):"map-image"===(null===e||void 0===e?void 0:e.type)?Y(e,r,i):"map-notes"===(null===e||void 0===e?void 0:e.type)?await ee(r,i):"open-street-map"===(null===e||void 0===e?void 0:e.type)?{type:"OpenStreetMap"}:"stream"===(null===e||void 0===e?void 0:e.type)?await ie(e,r,i):"subtype-group"===(null===e||void 0===e?void 0:e.type)?await ae(e,i):"tile"===(null===e||void 0===e?void 0:e.type)?ne(e,i):"vector-tile"===(null===e||void 0===e?void 0:e.type)?await re(e,r,i):"web-tile"===(null===e||void 0===e?void 0:e.type)?oe(e):"wfs"===(null===e||void 0===e?void 0:e.type)?await le(e,r,i):"wms"===(null===e||void 0===e?void 0:e.type)?se(e,i):"wmts"===(null===e||void 0===e?void 0:e.type)?ue(e):await te(e,r,i),t&&(Array.isArray(t)?n.push(...t):(t.id=e.id,t.title=i.legendLayerNameMap[e.id]||e.title,t.opacity=s.fullOpacity,t.minScale=e.minScale||0,t.maxScale=e.maxScale||0,x(e)&&e.blendMode&&"normal"!==e.blendMode&&(t.blendMode=e.blendMode),n.push(t)))}if(o)for(const s of n)s.minScale=0,s.maxScale=0;if(null!==(a=e.graphics)&&void 0!==a&&a.length){const a=await j(null,e.graphics,t,i);a&&n.push(a)}return n}function Z(e){return{culture:e.culture,key:e.key,type:"BingMaps"+("aerial"===e.style?"Aerial":"hybrid"===e.style?"Hybrid":"Road")}}async function B(e,t,i){let{layerView:a,printTemplate:n}=t;if(parseFloat(i.cimVersion)<3.1)return j(e,await pe(a),n,i);const r=e.parent,o={id:(l=fe(r,"web-map")).id,url:l.url,layerType:l.layerType,customParameters:l.customParameters,dynamicGroupLayer:{visibility:!1},footprintLayer:l.footprintLayer,layerDefinition:l.layerDefinition};var l;return de(o,r),o}async function W(e,t,i){e.legendEnabled&&i.legendLayers.push({id:e.id});const a=t.layerView,n=t.printTemplate;if(!(a.filter||e.portalItem&&"public"!==e.portalItem.access)){const t=fe(e,"web-map");return t.type="CSV",delete t.popupInfo,delete t.layerType,t.showLabels=n.showLabels&&e.labelsVisible,t}return j(e,await pe(a),n,i)}async function j(e,t,i,a){var n;let r;const o={layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}},l={layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}},s={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}},c={layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}},y={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}};if(y.layerDefinition.name="textLayer",delete y.layerDefinition.drawingInfo,e){var p;if("esri.layers.FeatureLayer"===e.declaredClass||"esri.layers.StreamLayer"===e.declaredClass?o.layerDefinition.name=l.layerDefinition.name=s.layerDefinition.name=c.layerDefinition.name=a.legendLayerNameMap[e.id]||(null===(p=e.arcgisProps)||void 0===p?void 0:p.title)||e.title:"esri.layers.GraphicsLayer"===e.declaredClass&&(t=e.graphics.items),e.renderer){const t=e.renderer.toJSON(),i=o.layerDefinition.drawingInfo;i&&(i.renderer=t);const a=l.layerDefinition.drawingInfo;a&&(a.renderer=t);const n=s.layerDefinition.drawingInfo;n&&(n.renderer=t);const r=c.layerDefinition.drawingInfo;r&&(r.renderer=t)}if(i.showLabels&&e.labelsVisible&&"function"==typeof e.write){var f;const t=null===(f=fe(e,"web-map").layerDefinition)||void 0===f||null===(f=f.drawingInfo)||void 0===f?void 0:f.labelingInfo;if(t){r=!0;const e=o.layerDefinition.drawingInfo;e&&(e.labelingInfo=t);const i=l.layerDefinition.drawingInfo;i&&(i.labelingInfo=t);const a=s.layerDefinition.drawingInfo;a&&(a.labelingInfo=t);const n=c.layerDefinition.drawingInfo;n&&(n.labelingInfo=t)}}}let m;(null===e||void 0===e?void 0:e.renderer)||r||(delete o.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo,delete s.layerDefinition.drawingInfo,delete c.layerDefinition.drawingInfo);const v=null===e||void 0===e?void 0:e.fieldsIndex,g=null===e||void 0===e?void 0:e.renderer;if(v){const t=new Set;r&&await(0,d.collectLabelingFields)(t,e),g&&"function"==typeof g.collectRequiredFields&&await g.collectRequiredFields(t,v),m=Array.from(t);const i=v.fields.map((e=>e.toJSON()));o.layerDefinition.fields=i,l.layerDefinition.fields=i,s.layerDefinition.fields=i,c.layerDefinition.fields=i}const h=null===(n=t)||void 0===n?void 0:n.length;let b;for(let d=0;d<h;d++){const e=t[d]||t.at(d);if(!1!==e.visible&&e.geometry){var w,S,I;if(b=e.toJSON(),b.hasOwnProperty("popupTemplate")&&delete b.popupTemplate,null!==(w=b.geometry)&&void 0!==w&&w.z&&delete b.geometry.z,b.symbol&&(b.symbol.angle||delete b.symbol.angle,me(b.symbol)?b.symbol=await ce(b.symbol,a):b.symbol.text&&delete b.attributes),(!i||!i.forceFeatureAttributes)&&null!==(S=m)&&void 0!==S&&S.length){const e={};for(const t of m){var L;(null===(L=b.attributes)||void 0===L?void 0:L.hasOwnProperty(t))&&(e[t]=b.attributes[t])}b.attributes=e}"polygon"===e.geometry.type?o.featureSet.features.push(b):"polyline"===e.geometry.type?l.featureSet.features.push(b):"point"===e.geometry.type?null!==(I=b.symbol)&&void 0!==I&&I.text?y.featureSet.features.push(b):s.featureSet.features.push(b):"multipoint"===e.geometry.type?c.featureSet.features.push(b):"extent"===e.geometry.type&&(b.geometry=u.default.fromExtent(e.geometry).toJSON(),o.featureSet.features.push(b))}}const D=[o,l,c,s,y].filter((e=>e.featureSet.features.length>0));for(const u of D){var x;const e=u.featureSet.features.every((e=>e.symbol));if(e&&(!i||!i.forceFeatureAttributes))for(const t of u.featureSet.features)delete t.attributes;e&&delete u.layerDefinition.drawingInfo,(null===(x=u.layerDefinition.drawingInfo)||void 0===x?void 0:x.renderer)&&await ye(u.layerDefinition.drawingInfo.renderer,a)}return D.length?{featureCollection:{layers:D},showLabels:r}:null}async function K(e,t,i){var a,n,r,o;let l;const s=e.renderer,u=parseFloat(i.cimVersion);if("binning"===(null===(a=e.featureReduction)||void 0===a?void 0:a.type)||"cluster"===(null===(n=e.featureReduction)||void 0===n?void 0:n.type)&&u<2.9||"pie-chart"===(null===s||void 0===s?void 0:s.type)||"dot-density"===(null===s||void 0===s?void 0:s.type)&&u<2.6)return te(e,t,i);e.legendEnabled&&i.legendLayers.push({id:e.id});const d=t.layerView,{printTemplate:p,view:f}=t,m="feature-layer"!==(null===(r=e.source)||void 0===r?void 0:r.type)&&"ogc-feature"!==(null===(o=e.source)||void 0===o?void 0:o.type);if(d.filter||m||!s||"field"in s&&null!=s.field&&!e.getField(s.field)){const t=await pe(d);l=await j(e,t,p,i)}else{var v,g,I,D,x,T,P,O,M;if(l={id:(E=fe(e)).id,title:E.title,url:E.url,layerType:E.layerType,customParameters:E.customParameters,layerDefinition:E.layerDefinition,charts:p.includeCharts?E.charts:void 0},p.attributionVisible&&(l.credits=L(e)),l.showLabels=p.showLabels&&e.labelsVisible,de(l,e),null===(v=l.layerDefinition)||void 0===v||null===(v=v.featureReduction)||void 0===v||delete v.disablePopup,null===(g=l.layerDefinition)||void 0===g||null===(g=g.featureReduction)||void 0===g||delete g.popupInfo,d.displayFilterEnabled||null===(I=l.layerDefinition)||void 0===I||delete I.displayFilterInfo,null!==(D=l.layerDefinition)&&void 0!==D&&null!==(D=D.drawingInfo)&&void 0!==D&&D.renderer&&(delete l.layerDefinition.minScale,delete l.layerDefinition.maxScale,await ye(l.layerDefinition.drawingInfo.renderer,i),"visualVariables"in s&&null!==(x=s.visualVariables)&&void 0!==x&&x[0])){const e=s.visualVariables[0];if("size"===e.type&&e.maxSize&&"number"!=typeof e.maxSize&&e.minSize&&"number"!=typeof e.minSize){const t=(0,y.getSizeRangeAtScale)(e,f.scale);l.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=t.minSize,l.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=t.maxSize}}const t=(0,c.E)(d);if(t&&(null!==(P=(T=l).layerDefinition)&&void 0!==P||(T.layerDefinition={}),l.layerDefinition.definitionExpression=l.layerDefinition.definitionExpression?"(".concat(l.layerDefinition.definitionExpression,") AND (").concat(t,")"):t),e.gdbVersion&&(null!==(M=(O=l).layerDefinition)&&void 0!==M||(O.layerDefinition={}),l.layerDefinition.gdbVersion=e.gdbVersion),d.hasHighlight&&"highlightIds"in d){var A;const t=d;l.selectionObjectIds=t.highlightIds,l.selectionSymbol=function(e,t){var i,a,n,r,o;const l=null!==(i=null===(a=t.color)||void 0===a?void 0:a.clone())&&void 0!==i?i:new h.default([0,255,255]),s=null!==(n=null===(r=t.haloColor)||void 0===r?void 0:r.clone())&&void 0!==n?n:l.clone();switch(e){case"envelope":case"polygon":return l.a*=null!==(o=t.fillOpacity)&&void 0!==o?o:.25,new b.default({color:l,outline:new w.default({color:s}),style:"solid"});case"polyline":return new w.default({color:s});default:return s.a=1,new S.default({color:s,outline:null})}}(e.geometryType,null!==(A=t.highlightOptions)&&void 0!==A?A:f.highlightOptions)}}var E;return l}async function q(e,t,i){var a,n;return"binning"===(null===(a=e.featureReduction)||void 0===a?void 0:a.type)||"cluster"===(null===(n=e.featureReduction)||void 0===n?void 0:n.type)?te(e,t,i):(e.legendEnabled&&i.legendLayers.push({id:e.id}),j(e,await pe(t.layerView),t.printTemplate,i))}async function Q(e,t,i){let{printTemplate:a}=t;return j(e,null,a,i)}function H(e,t){var i,a,n;e.legendEnabled&&t.legendLayers.push({id:e.id});const r={layerType:(o=fe(e)).layerType,customParameters:o.customParameters};var o;return r.bandIds=e.bandIds,r.compressionQuality=e.compressionQuality,r.format=e.format,r.interpolation=e.interpolation,(e.mosaicRule||e.definitionExpression)&&(r.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.rasterFunction&&(r.renderingRule=e.rasterFunction.toJSON()),e.renderer&&(null!==(i=r.layerDefinition)&&void 0!==i||(r.layerDefinition={}),null!==(n=(a=r.layerDefinition).drawingInfo)&&void 0!==n||(a.drawingInfo={}),r.layerDefinition.drawingInfo.renderer=e.renderer.toJSON()),de(r,e),r}async function $(e,t,i){var a;if("flow"===(null===(a=e.renderer)||void 0===a?void 0:a.type))return te(e,t,i);e.legendEnabled&&i.legendLayers.push({id:e.id});const n={bandIds:(r=fe(e)).bandIds,customParameters:r.customParameters,interpolation:r.interpolation,layerDefinition:r.layerDefinition};var r;return n.layerType="ArcGISImageServiceLayer",de(n,e),n}async function X(e,t,i){const n=t.printTemplate;if(!e.portalItem||"public"===e.portalItem.access){const t=fe(e,"web-map");return t.type="kml",delete t.layerType,t.url=(0,s.normalize)(e.url),t}const r=[],o=t.layerView,l="data:image/png;base64,";o.allVisibleMapImages.forEach(((t,i)=>{const a={id:"".concat(e.id,"_image").concat(i),type:"image",title:e.id,minScale:e.minScale||0,maxScale:e.maxScale||0,opacity:o.fullOpacity,extent:t.extent};t.href.startsWith(l)?a.imageData=t.href.slice(22):a.url=t.href,r.push(a)}));const u=[...o.allVisiblePoints.items,...o.allVisiblePolylines.items,...o.allVisiblePolygons.items],d=(0,a.A)({id:e.id},await j(null,u,n,i));return r.push(d),r}function Y(e,t,i){var a;let n,{printTemplate:r,view:o}=t;const l={id:e.id,subLayerIds:[]};let s=[];const u=o.scale,d=e=>{const t=0===u,i=0===e.minScale||u<=e.minScale,a=0===e.maxScale||u>=e.maxScale;if(e.visible&&(t||i&&a))if(e.sublayers)e.sublayers.forEach(d);else{const t=e.toExportImageJSON(),i={id:e.id,name:e.title,layerDefinition:{definitionExpression:t.definitionExpression,drawingInfo:t.drawingInfo,orderBy:t.orderBy,source:t.source}};s.unshift(i),l.subLayerIds.push(e.id)}};var c;return e.sublayers&&e.sublayers.forEach(d),s.length&&(s=s.map((e=>{let{id:t,name:i,layerDefinition:a}=e;return{id:t,name:i,layerDefinition:a}})),n={layerType:(c=fe(e)).layerType,customParameters:c.customParameters},n.layers=s,n.visibleLayers=null!==(a=e.capabilities)&&void 0!==a&&null!==(a=a.exportMap)&&void 0!==a&&a.supportsDynamicLayers?void 0:l.subLayerIds,r.attributionVisible&&(n.credits=L(e)),e.gdbVersion&&(n.gdbVersion=e.gdbVersion),de(n,e),e.legendEnabled&&i.legendLayers.push(l)),n}async function ee(e,t){let{layerView:i,printTemplate:a}=e;const n=[],r=i.layer;if(null!=r.featureCollections)for(const o of r.featureCollections){const e=await j(o,o.source,a,t);e&&n.push(...e.featureCollection.layers)}else if(null!=r.sublayers)for(const o of r.sublayers){const e=await j(null,o.graphics,a,t);e&&n.push(...e.featureCollection.layers)}return{featureCollection:{layers:n}}}async function te(e,t,i){var a;let{printTemplate:n,view:r}=t;const o={type:"image"},u={format:"png",ignoreBackground:!0,ignorePadding:!0,layers:[e]};0!==r.rotation&&(u.rotation=0);const d=i.ssExtent||r.state.extent.clone();let c=96,y=!0,p=!0;if(n.exportOptions){const e=n.exportOptions;null!=e.dpi&&e.dpi>0&&(c=e.dpi),null!=e.width&&e.width>0&&(y=e.width%2==r.width%2),null!=e.height&&e.height>0&&(p=e.height%2==r.height%2)}if("map-only"===n.layout&&n.scalePreserved&&(!n.outScale||n.outScale===r.scale)&&96===c&&(!y||!p)&&r.state.extent.equals(r.extent)&&(u.area={x:0,y:0,width:r.width,height:r.height},y||(u.area.width-=1),p||(u.area.height-=1),!i.ssExtent)){const e=r.toMap((0,l.tc)(u.area.width,u.area.height));d.ymin=e.y,d.xmax=e.x,i.ssExtent=d}o.extent=d.clone()._normalize(!0).toJSON();const f=await r.takeScreenshot(u);return o.imageData=null===(a=(0,s.dataComponents)(f.dataUrl))||void 0===a?void 0:a.data,o}async function ie(e,t,i){let{layerView:a,printTemplate:n}=t;return e.legendEnabled&&i.legendLayers.push({id:e.id}),j(e,await pe(a),n,i)}async function ae(e,t){if(e.legendEnabled)for(const n of e.sublayers)n.legendEnabled&&t.legendLayers.push({id:n.id});const i={customParameters:(a=fe(e)).customParameters,effect:a.effect,layerDefinition:a.layerDefinition,layerType:a.layerType,layers:a.layers,url:a.url};var a;if(Array.isArray(i.layers))for(const n of i.layers)delete n.popupInfo;return de(i,e),i}function ne(e,t){e.legendEnabled&&t.legendLayers.push({id:e.id});const i={layerType:(a=fe(e)).layerType,customParameters:a.customParameters};var a;return de(i,e),i}async function re(e,t,i){const a=t.layerView;if(e.serviceUrl&&e.styleUrl&&!a.spriteSourceChanged&&!a.styleChanged){const t=(0,p.gf)(e.styleUrl,e.apiKey),a=(0,p.gf)(e.serviceUrl,e.apiKey);if(!t&&!a||"2.1.0"!==i.cimVersion){const i={type:"VectorTileLayer"};return i.styleUrl=(0,s.normalize)(e.styleUrl),i.token=t,a!==t&&(i.additionalTokens=[{url:e.serviceUrl,token:a}]),i}}return te(e,t,i)}function oe(e){var t;const i={type:"WebTiledLayer",urlTemplate:null===(t=e.urlTemplate)||void 0===t?void 0:t.replace(/\${/g,"{"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(i.subDomains=e.subDomains),i}async function le(e,t,i){return parseFloat(i.cimVersion)<3.5?te(e,t,i):(e.legendEnabled&&i.legendLayers.push({id:e.id}),{layerType:(a=fe(e,"web-map")).layerType,layerDefinition:a.layerDefinition,url:a.url,wfsInfo:a.wfsInfo});var a}function se(e,t){let i;const a=[],n=e=>{e.visible&&(e.sublayers?e.sublayers.forEach(n):e.name&&a.unshift(e.name))};return e.sublayers&&e.sublayers.forEach(n),a.length&&(e.legendEnabled&&t.legendLayers.push({id:e.id,subLayerIds:a}),i={type:"wms",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:a,url:(0,s.normalize)(e.url),version:e.version}),i}function ue(e){const t=e.activeLayer;return{type:"wmts",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:(0,s.normalize)(e.url)}}function de(e,t){t.url&&(e.url=(0,s.normalize)(e.url||t.url),e.token=(0,p.gf)(e.url,t.apiKey))}async function ce(e,t){t.canvas||(t.canvas=document.createElement("canvas"));const i=1024;t.canvas.width=i,t.canvas.height=i;const a=t.canvas.getContext("2d");let n,o;if(e.path){var s;const t=new Path2D(e.path);t.closePath(),a.fillStyle=Array.isArray(e.color)?"rgba(".concat(e.color[0],",").concat(e.color[1],",").concat(e.color[2],",").concat(e.color[3]/255,")"):"rgb(0,0,0)",a.fill(t);const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;const i=e.canvas.width,a=e.canvas.height,n=e.getImageData(0,0,i,a).data;let r,o,l,s,u,d;e:for(o=a;o--;)for(r=i;r--;)if(n[4*(i*o+r)+3]>t){d=o;break e}if(!d)return null;e:for(r=i;r--;)for(o=d+1;o--;)if(n[4*(i*o+r)+3]>t){u=r;break e}e:for(r=0;r<=u;++r)for(o=d+1;o--;)if(n[4*(i*o+r)+3]>t){l=r;break e}e:for(o=0;o<=d;++o)for(r=l;r<=u;++r)if(n[4*(i*o+r)+3]>t){s=o;break e}return{x:l,y:s,width:u-l,height:d-s}}(a);if(!r)return null;a.clearRect(0,0,i,i);const u=(0,l.Lz)(e.size)/Math.max(r.width,r.height);a.scale(u,u);const d=i/u,c=d/2-r.width/2-r.x,y=d/2-r.height/2-r.y;if(a.translate(c,y),Array.isArray(e.color)&&a.fill(t),null!==(s=e.outline)&&void 0!==s&&s.width&&Array.isArray(e.outline.color)){const i=e.outline;a.lineWidth=(0,l.Lz)(i.width)/u,a.lineJoin="round",a.strokeStyle="rgba(".concat(i.color[0],",").concat(i.color[1],",").concat(i.color[2],",").concat(i.color[3]/255,")"),a.stroke(t),r.width+=a.lineWidth,r.height+=a.lineWidth}r.width*=u,r.height*=u;const p=a.getImageData(512-r.width/2,512-r.height/2,Math.ceil(r.width),Math.ceil(r.height));n=p.width,o=p.height,a.canvas.width=n,a.canvas.height=o,a.putImageData(p,0,0)}else{const t="image/svg+xml"===e.contentType?"data:image/svg+xml;base64,"+e.imageData:e.url,i=(await(0,r.default)(t,{responseType:"image"})).data;n=(0,l.Lz)(e.width),o=(0,l.Lz)(e.height),a.canvas.width=n,a.canvas.height=o,a.drawImage(i,0,0,a.canvas.width,a.canvas.height)}return{type:"esriPMS",imageData:a.canvas.toDataURL("image/png").slice(22),angle:e.angle,contentType:"image/png",height:(0,l.PN)(o),width:(0,l.PN)(n),xoffset:e.xoffset,yoffset:e.yoffset}}async function ye(e,t){const i=e.type;if("simple"===i&&me(e.symbol))e.symbol=await ce(e.symbol,t);else if("uniqueValue"===i||"classBreaks"===i){me(e.defaultSymbol)&&(e.defaultSymbol=await ce(e.defaultSymbol,t));const a=e["uniqueValue"===i?"uniqueValueInfos":"classBreakInfos"];if(a)for(const e of a)me(e.symbol)&&(e.symbol=await ce(e.symbol,t))}}async function pe(e){return e.queryFeatures(e.createQuery()).then((e=>e.features))}function fe(e,t){var i;return null!==(i=e.write({},{ignorePersistenceEnabled:!0,origin:t}))&&void 0!==i?i:{}}function me(e){var t;return e&&(e.path||"image/svg+xml"===e.contentType||(null===(t=e.url)||void 0===t?void 0:t.endsWith(".svg")))}},39778:(e,t,i)=>{i.r(t),i.d(t,{default:()=>u});var a=i(35143),n=i(91967),r=i(46053),o=(i(81806),i(76460),i(47249),i(85842)),l=i(98662);let s=class extends n.default{constructor(e){super(e),this.attributionVisible=!0,this.exportOptions={width:800,height:1100,dpi:96},this.forceFeatureAttributes=!1,this.format="png32",this.includeCharts=!1,this.includeTables=!1,this.label=null,this.layout="map-only",this.layoutItem=null,this.layoutOptions=null,this.outScale=0,this.report=null,this.reportItem=null,this.reportOptions=null,this.scalePreserved=!0,this.showLabels=!0}};(0,a._)([(0,r.MZ)()],s.prototype,"attributionVisible",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"exportOptions",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"forceFeatureAttributes",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"format",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"includeCharts",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"includeTables",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"label",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"layout",void 0),(0,a._)([(0,r.MZ)({type:l.default})],s.prototype,"layoutItem",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"layoutOptions",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"outScale",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"report",void 0),(0,a._)([(0,r.MZ)({type:l.default})],s.prototype,"reportItem",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"reportOptions",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"scalePreserved",void 0),(0,a._)([(0,r.MZ)()],s.prototype,"showLabels",void 0),s=(0,a._)([(0,o.$)("esri.rest.support.PrintTemplate")],s);const u=s},39907:(e,t,i)=>{i.d(t,{U:()=>r,r:()=>n});const a=new(i(45802).J)({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),n=a.fromJSON.bind(a),r=a.toJSON.bind(a)},92706:(e,t,i)=>{i.d(t,{U:()=>a});const a=(0,i(45802).O)()({AIX:"aix",EPS:"eps",GIF:"gif",JPG:"jpg",PDF:"pdf",PNG32:"png32",PNG8:"png8",SVG:"svg",SVGZ:"svgz",TIFF:"tiff"},{ignoreUnknown:!1})}}]);
//# sourceMappingURL=27983.22e724da.chunk.js.map